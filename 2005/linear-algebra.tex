%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\def\STUDENT{} % \def すると計算問題の解答を印刷しなくなる.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% 線形代数学演習---行列の標準形
% 
% 黒木 玄 (東北大学理学部数学教室, kuroki@math.tohoku.ac.jp)
%
% この演習問題集は2003年度における東北大学理学部数学科2年生前期の
% 代数学序論B演習のために作成されました. コメントは歓迎しますが,
% 回答できなかったり, 時間の都合で無視してしまわざるを得ない場合は
% お許し下さい.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt,twoside]{jarticle}
%\documentclass[12pt]{jarticle}
\usepackage{amsmath,amssymb,amscd}
\usepackage{enshu}
%\usepackage{showkeys}
\allowdisplaybreaks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifx\STUDENT\undefined
%
% 教師専用
%
\newcommand\commentout[1]{#1}
\setcounter{page}{1}       % この数から始まる
\setcounter{section}{0}    % この数の次から始まる
\setcounter{theorem}{0}    % この数の次から始まる
\setcounter{question}{0}   % この数の次から始まる
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% 生徒専用
%
\newcommand\commentout[1]{}
\setcounter{page}{1}       % この数から始まる
\setcounter{section}{0}    % この数の次から始まる
\setcounter{theorem}{0}    % この数の次から始まる
\setcounter{question}{0}   % この数の次から始まる
\setcounter{footnote}{0}   % この数の次から始まる
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{\bf 線形代数学演習---行列の標準形
  \thanks{この演習問題集は2003年度における東北大学理学部数学科2年生前期の
    代数学序論B演習のために作成された.}
%  \ifx\STUDENT\undefined\\{\normalsize 教師用\quad(計算問題の略解付き)}\fi}
  \ifx\STUDENT\undefined\\{\normalsize 計算問題の略解付き}\fi}

\author{黒木 玄 \quad (東北大学大学院理学研究科数学専攻)}

\date{最終更新2003年11月21日 \quad (作成2003年5月29日)}

\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{行列の指数函数}
\label{sec:exp}

複素 $n$ 次正方行列 $A$ の指数函数 $\exp A = e^A$ を次のように定める:
\begin{equation*}
  \exp A = e^A 
  = \sum_{k=0}^\infty \frac{1}{k!} A^k
  = E + A + \frac{1}{2}A^2 + \frac{1}{3!}A^3 + \frac{1}{4!}A^4 + \cdots.
\end{equation*}
ここで $E$ は単位行列である.
この演習では, この定義の無限級数が複素正方行列 $A$ に関して広義一様絶対収束
するという事実や $A$ の成分に関する偏微分を項別微分によって計算できるという
事実などを証明抜きで自由に用いて良い.  無限級数の収束性などについては気にせ
ずに形式的な計算を自由に行なって良い.

\bigskip

{\Large この演習の主要な目標の一つは
具体的に与えられた正方行列 $A$ に対して $e^{At}$ を
計算できるようになることである.}

\bigskip

他にも様々な目標があるが, この演習を受講する人はこの目標を常に頭の片隅に置い
ておくことが望ましい.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{行列の指数函数の基本性質}
\label{sec:sec-exp-properties}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ は複素正方行列であるとする. 
  このとき, 複素数 $t$ の行列値函数 $e^{At}$ は次を満たしている:
  \begin{equation*}
    \od{t}e^{At} = A e^{At} = e^{At} A,
    \qquad e^{A0} = E.
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$, $P$ は複素 $n$ 次正方行列であり, $P$ は逆行列を持つと仮定する.
  このとき,
  \begin{equation*}
    e^{PAP^{-1}} = P e^A P^{-1}.
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:exp(A+B)}
  2つの複素 $n$ 次正方行列 $A$, $B$ が互いに可換%
  \footnote{$A$ と $B$ が{\bf 可換 (commutative)} であるとは $AB = BA$ が成
    立することである.}%
  ならば,
  \begin{equation*}
    e^{A+B} = e^A e^B = e^B e^A.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $AB=BA$ であれば次の二項定理を利用できる:
\begin{equation*}
  (A + B)^k = \sum_{i=0}^k \binom{k}{i} A^i B^{k-i}.
\end{equation*}
ここで,
\begin{equation*}
  \binom{k}{i} = \frac{k!}{i!(k-i)!}.
\qed
\end{equation*}

\medskip
\noindent 
注意: 可換性の仮定は本質的である.  その条件を外すとこの問題の結論は一般に成
立しなくなる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  \(
    A =
    \begin{bmatrix}
      1 & 0 \\
      0 & -1 \\
    \end{bmatrix}
  \) と %
  \(
    B =
    \begin{bmatrix}
      0 & 1 \\
      0 & 0 \\
    \end{bmatrix}
  \) に対して $e^{At+Bs}\ne e^{At} e^{Bs} \ne e^{Bs} e^{At}$.
  \qed
\end{question}

\noindent
ヒント:   \(
  e^{At} =
  \begin{bmatrix}
    e^t & 0 \\
    0 & e^{-t} \\
  \end{bmatrix}
\), \(
  e^{Bs} =
  \begin{bmatrix}
    1 & s \\
    0 & 1 \\
  \end{bmatrix}
\), \(
  e^{At+Bs} =
  \begin{bmatrix}
    e^t & s t^{-1} \sinh t \\
    0 & e^{-t} \\
  \end{bmatrix}
\).
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{簡単に計算できる行列の指数函数の例}
\label{sec:sec-exp-easy}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  複素正方行列 $A$, $B$, $C$ を次のように定義する:
  \begin{equation*}
    A =
    \begin{bmatrix}
      \alpha & 0 \\
      0 & \beta \\
    \end{bmatrix},
    \quad
    B =
    \begin{bmatrix}
      \alpha & 1 \\
      0 & \alpha \\
    \end{bmatrix},
    \quad
    C =
    \begin{bmatrix}
      0 & -1 \\
      1 &  0 \\
    \end{bmatrix}.
  \end{equation*}
  ここで $\alpha,\beta\in\C$ である. 
  $e^{At}$, $e^{Bt}$, $e^{Ct}$ を計算せよ. 
  $e^{C(t+s)} = e^{Ct}e^{Cs}$ から三角函数の加法公式を導け.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ は複素 $m$ 次正方行列であり, $B$ は複素 $n$ 次正方行列であるとし, %
  $m+n$ 次正方行列 $X$ を %
  \(
    X =
    \begin{bmatrix}
      A & 0 \\
      0 & B \\
    \end{bmatrix}
  \)
  と定める. このとき, %
  \(
    e^X =
    \begin{bmatrix}
      e^A & 0 \\
      0 & e^B \\
    \end{bmatrix}.
    \qed
  \)
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:exp-Jordan}
  複素数 $\alpha$ に対して $k$ 次正方行列 $J = J(k,\alpha)$ を次のように定め
  る:
  \begin{equation*}
    J = J(k,\alpha) = 
    \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
    \end{bmatrix}
    \quad (\text{$k$ 次正方行列}).
  \end{equation*}
  この形の行列を {\bf Jordan ブロック}と呼ぶ.
  $e^{Jt}$ を計算せよ. \qed
\end{question}

\noindent
ヒント: 対角成分の一つ右上に $1$ が並び他の成分が $0$ の $n$ 次
正方行列を $N$ と書くと, $J = \alpha E + N$ である. 
$\alpha E$ と $N$ は互いに可換なので, \qref{q:exp(A+B)} より,
\begin{equation*}
  e^{Jt} = e^{\alpha t E} e^{tN} = e^{\alpha t} e^{tN}.
\end{equation*}
よって, $e^{tN}$ を計算すれば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{定数係数線形常微分方程式と定数係数線形差分方程式への応用}
\label{sec:sec-exp-app}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip

函数 $f$ に対して, 
\begin{equation*}
  a_n(x)f^{(n)}+a_{n-1}(x)f^{(n-1)}+\cdots+a_2(x)f''+a_1(x)f'+a_0(x)f
\end{equation*}
を対応させる微分作用素を
\begin{equation*}
  a_n(x)\partial^n+\cdots+a_2(x)\partial^2+a_1(x)\partial+a_0(x)
\end{equation*}
と書くことにする. 例えば, 
\begin{align*}
  & \partial f = df/dx = f', \\
  & (\partial^2 + a(x)) f = f'' + a(x)f, \\
  & (\partial + a(x))(\partial + b(x))f = (\partial + a(x))(f'+b(x)f) \\
  & \quad
    = f'' +(b(x)f)' + a(x)(f'+b(x)f) 
    = f'' + (a(x)+b(x))f' + (b'(x) + a(x)b(x)) f.
\end{align*}

\begin{question}
  次の線形常微分方程式の解空間を求めよ:
  \begin{equation*}
    (\partial - \alpha_1)^{k_1} \cdots (\partial - \alpha_m)^{k_m} u = 0.
  \end{equation*}
  ここで, $\alpha_1,\ldots,\alpha_m$ は互いに異なる複素数であり, 
  $k_1,\ldots,k_m$ は正の整数であるとする.
  \qed
\end{question}

\noindent ヒント: 公式 %
\( %
  \partial (e^{\alpha x} f) = e^{\alpha x} (\partial + \alpha) f
\) %
より,
\( %
  (\partial - \alpha)^k(e^{\alpha x} f)
  = e^{\alpha x} \partial^k f
\) %
が成立することがわかる. これより, 線形常微分方程式
\begin{equation*}
  (\partial - \alpha)^k u = 0
  \tag{$*$}
\end{equation*}
の任意の解は
\begin{equation*}
  u = (a_0 + a_1 x + \cdots + a_{k-1} x^{k-1}) e^{\alpha x},
  \qquad
  \text{$a_i$ は定数}
\end{equation*}
と表わされることがわかる. なお, 上の問題を解くために, 
問題の方程式の解の全体が自然に $(k_1 + \cdots + k_m)$ 次元のベクトル空間をな
すという結果を用いて良い. 
\qed

\medskip
\noindent
参考: $v_0,v_1,\ldots,v_{k-1}$ を
\( %
  v_j = (\partial - \alpha)^j u
  \quad
  (j=0,1,\ldots,k-1)
\) %
と定め, 
\begin{equation*}
  v =
  \begin{bmatrix}
    v_0 \\ \vdots \\ v_{k-1}
  \end{bmatrix},
  \quad
  J =
  \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
  \end{bmatrix}
  \quad (\text{$k$ 次正方行列})
\end{equation*}
と置くと, 方程式 ($*$) は方程式 $\partial v = J v$ に変換される.
$J$ が Jordan ブロックの形になっていることに注意せよ.
線形常微分方程式 $\partial v = J v$ の一般解は
\begin{equation*}
  v = e^{Jx}v_0, \qquad \text{$v_0$ は定数ベクトル}
\end{equation*}
と書ける.  この結果に問題 \qref{q:exp-Jordan} を適用しても上のヒントの結論が
得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bigskip

整数 $x\in\Z$ の函数 $f(x)$ に対して, 整数 $x$ の函数
\begin{equation*}
  x\mapsto
  a_n(x)f(x+n)+a_{n-1}(x)f(x+n-1)+\cdots+a_1(x)f(x+1)+a_0(x)f(x)
\end{equation*}
を対応させる差分作用素を
\begin{equation*}
  a_n(x)\sigma^n+a_{n-1}(x)\sigma^{n-1}
  +\cdots+a_2(x)\sigma^2+a_1(x)\sigma+a_0(x)
\end{equation*}
と書くことにする. 例えば, 
\begin{align*}
  & \sigma f(x) = f(x+1), \\
  & (\sigma^2 + a(x))f(x) = f(x+1) + a(x)f(x), \\
  & (\sigma + a(x))(\sigma + b(x))f(x) = (\sigma + a(x))(f(x+1)+b(x)f(x)) \\
  & \quad
    = f(x+2) + b(x+1)f(x+1) + a(x)(f(x+1)+b(x)f(x)) \\
  & \quad
    = f(x+2) + (a(x)+b(x+1))f(x+1) + (b(x+1) + a(x)b(x))f(x).
\end{align*}

\begin{question}
  次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    (\sigma - \alpha_1)^{k_1} \cdots (\sigma - \alpha_m)^{k_m} u = 0.
  \end{equation*}
  ここで, $\alpha_1,\ldots,\alpha_m$ は $0$ でない互いに異なる複素数で
  あり, $k_1,\ldots,k_m$ は正の整数であるとする.
  \qed
\end{question}

\noindent ヒント: 公式 %
\( %
  (\sigma-\alpha)(\alpha^x f(x)) = \alpha^{x+1}(\sigma-1)f(x)
\) %
より,
\( %
  (\sigma - \alpha)^k(\alpha^xf(x))
  = \alpha^{x+k}(\sigma-1)^k f(x)
\) %
が成立することがわかる. これより, $\alpha\ne0$ のとき線形差分方程式
\begin{equation*}
  (\sigma - \alpha)^k u = 0
  \tag{$*$}
\end{equation*}
の任意の解は
\begin{equation*}
  u(x) = (a_0 + a_1 x + a_2 x^{[2]}+\cdots + a_{k-1} x^{[k-1]}) \alpha^x,
  \qquad
  \text{$a_i$ は定数}
\end{equation*}
と表わされることがわかる. ここで,
\begin{equation*}
  x^{[i]} = x(x-1)\cdots(x-i+1)
\end{equation*}
である. $x^{[i]}$ は $(\sigma - 1)x^{[i]}=ix^{[i-1]}$ を満たしている.
\qed

\medskip
\noindent
参考: $v_0,v_1,\ldots,v_{k-1}$ を
\( %
  v_j = (\sigma - \alpha)^j u
  \quad
  (j=0,1,\ldots,k-1)
\) %
と定め, 
\begin{equation*}
  v =
  \begin{bmatrix}
    v_0 \\ \vdots \\ v_{k-1}
  \end{bmatrix},
  \quad
  J =
  \begin{bmatrix}
    \alpha   & 1      &        & \bigzerou \\
             & \alpha & \ddots &   \\
             &        & \ddots & 1 \\
    \bigzerol &     &        & \alpha
  \end{bmatrix}
  \quad (\text{$k$ 次正方行列})
\end{equation*}
と置くと, 方程式 ($*$) は方程式 $\sigma v = J v$ に変換される.
$J$ が Jordan ブロックの形になっていることに注意せよ.
線形差分方程式 $\sigma v = J v$ の一般解は次のようになる:
\begin{equation*}
  v = J^x v_0, \qquad \text{$v_0$ は定数ベクトル}
\end{equation*}
と書ける.  この結果を用いて上のヒントの結論を導くこともできる. 

対角成分の一つ右上に $1$ が並び他の成分が $0$ の $n$ 次
正方行列を $N$ と書くと, $J = \alpha E + N$ である. 
$\alpha E$ と $N$ は互いに可換なので, 
$x$ が $0$ 以上の整数のとき二項定理が適用できる. $N^k=0$ であるから,
\begin{equation*}
  J^x 
  = (\alpha E + N)^x 
  = \sum_{i=0}^{k-1} \binom{x}{i} \alpha^{x-i}N^i.
\end{equation*}
ここで,
\begin{equation*}
  \binom{x}{i} = \frac{x(x-1)\cdots(x-i+1)}{i!} = \frac{x^{[i]}}{i!}.
\end{equation*}
これは $x$ が負の整数であっても定義されていることに注意せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  整数 $x$ の函数 $u$ に関する次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    u(x+2) - 5 u(x+1) + 6 u(x) = 0.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: この問題の方程式は $(\sigma-2)(\sigma-3)u = 0$ と書き直せる. 
よって, 解は $u(x) =  a 2^x + b 3^x$ の形をしている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  整数 $x$ の函数 $u$ に関する次の線形差分方程式の解空間を求めよ:
  \begin{equation*}
    u(x+2) - 4 u(x+1) + 4 u(x) = 0.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: この問題の方程式は $(\sigma-2)^2 u = 0$ と書き直せる. よって,
解は $u(x) =  2^x(a + bx)$ の形をしている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{$2$ 次正方行列}
\label{sec:2x2}

この節では, $2$ 次正方行列の行列式, 固有値, 固有ベクトル, ジョルダン標準形
(Jordan normal form) などを扱う. 
一般の $n$ 次正方行列の理論をやる前に, $n=2$ の場合をやっておくことはイメー
ジをつかむために役に立つ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{線形代数の復習}

複素 $n$ 次正方行列 $A$ と複素数 $\alpha$ に
対して, $0$ でない縦ベクトル $u$ で
\begin{equation*}
  A u = \alpha u
\end{equation*}
を満たすものが存在するとき,  $\alpha$ を $A$ の{\bf 固有値 (eigen value)}と
呼び, $u$ を $A$ の{\bf 固有ベクトル (eigen vector)}と呼ぶ.
行列 $A$ を与えてその固有値と固有ベクトルをすべて求める問題を固有値問題と呼ぶ.
固有値 $\alpha$ に対して,
\begin{equation*}
  \Ker(A - \alpha E)
  = \{\, u\in\C^n \mid Au = \alpha u \,\}
\end{equation*}
を $\alpha$ に対応する{\bf 固有空間 (eigen space)}と呼ぶ.

複素 $n$ 次正方行列 $A$ と複素数 $\alpha$ に $0$ でない縦ベクトル $u$ が
ある $k=1,2,3,\ldots$ に関して
\begin{equation*}
  (A - \alpha E)^k u = 0
\end{equation*}
を満たしているとき, $u$ を $A$ の{\bf 一般固有ベクトル}と呼ぶ.
$(A - \alpha E)^k u = 0$ となる最小の $k$ を取るとき,
$k=1$ ならば $u$ は固有ベクトルになり,
$k>1$ の場合には $v = (A - \alpha E)^{k-1}u$ と置けば $v$ は固有値 $\alpha$ 
に対する固有ベクトルになる.  よって $\alpha$ は $A$ の固有値になる. 
行列 $A$ を与えてその固有値と一般固有ベクトルをすべて求める問題を
一般固有値問題と呼ぶ.  固有値 $\alpha$ に対して, 
\begin{equation*}
  W(A,\alpha) 
  = \{\, u\in\C^n \mid (A - \alpha E)^k u = 0 \ (\exists k = 1,2,3,\ldots)\,\}
\end{equation*}
を $\alpha$ に対応する{\bf 一般固有空間 (generalized eigen space)}と呼ぶ.

複素 $n$ 次正方行列 $A$ に対して, 
その{\bf トレース (trace)}, {\bf 行列式 (determinant)} を
それぞれ $\trace A$, $\det A = |A|$ と書くことにし, 
$A$ の{\bf 特性多項式 (characteristic polynomial)} $p_A(\lambda)$ を
次のように定める:
\begin{equation*}
  p_A(\lambda) = \det(\lambda E - A).
\end{equation*}
ここで, $E$ は $n$ 次単位行列である. 
このとき $\lambda$ に関する $n$ 次方程式 $p_A(\lambda)=0$ を $A$ の
{\bf 特性方程式 (characteristic equation)} と呼ぶ. 
%たとえば $2$ 次正方行列
%\begin{equation*}
%  A = 
%  \begin{bmatrix}
%    a & b \\
%    c & d \\
%  \end{bmatrix}
%\end{equation*}
%に対して,
%\begin{equation*}
%  \trace A = a + d,
%  \qquad
%  \det A = |A| = ad - bc.
%\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:char-poly-2.1}
  複素 $2$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ について以下が成立する
  ことを直接的な計算によって証明せよ: 
  \begin{enumerate}
  \item[(1)] \( p_A(\lambda) = \lambda^2 - \trace(A)\lambda + \det(A) \).
  \item[(2)] \( p_A(A) = 0 \) \quad ($2$ 次正方行列の Cayley-Hamilton の定理).
  \qed
  \end{enumerate}
\end{question}

\noindent 
参考: この結果は受験数学の勉強でおなじみであろう.
忘れた人は復習して欲しい.  また, Cayley-Hamilton の定理も全く同じ形で成
立する. 以下の問題の結論のほとんどが一般の $n$ 次正方行列に対して適切に
一般化される. なお, Cayley-Hamilton の定理の証明として,
\begin{equation*}
 p_A(A) = \det(AE - A) = \det(A - A) = \det 0 = 0
\end{equation*}
は{\bf 誤り}である. 

どこがまずいかを理解するためには記号に騙されないようにしなければいけない.
$p_A(A)$ は行列である.  $AE - A$ も行列である.  
しかし $\det(AE-A)$ は数である.  
$p_A(A)=\det(AE-A)$ という計算は左辺が行列で右辺が数なのでナンセンスである.

しかし, 実は上のナンセンスな計算にかなり近い考え方で 
Cayley-Hamilton の定理を証明することができる
(佐武 \cite{satake} 137頁, 杉浦 \cite{sugiura} 65--66頁).
\secref{sec:Cayley-Hamilton} の前半でその方法を紹介する.

ついでに述べておけば, 「$\det 0$」の $0$ は行列のゼロであるが, 
その次の「$= 0$」の $0$ は数のゼロである.
この2つの「$0$」は同じ記号で書かれているが意味が違うことに注意しなければいけ
ない.  この演習ではベクトルのゼロも単に「$0$」と書く.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  2つの縦ベクトル %
  $u=\tp{[a\ c]}$, $v=\tp{[b\ d]}$ に対して%
  \footnote{$\tp{[\ ]}$ は転置を意味している.}, 2次正方行列 $A$ を
  \begin{equation*}
    A := [u\ v] = \begin{bmatrix} a & b \\ c & d \end{bmatrix}
  \end{equation*}
  と定める. このとき, 以下の条件は互いに同値であることを直接証明せよ:
  \begin{enumerate}
  \item[(a)] $A$ の逆行列が存在する.
  \item[(b)] $\det(A) \ne 0$.
  \item[(c)] 任意の $\xi,\eta\in\C$ に対して, %
    $\xi u + \eta v = 0$ ならば $\xi = \eta = 0$.
  \qed
  \end{enumerate}
\end{question}

\noindent 
解説: このように $u$ と $v$ が一次独立であるという条件 (c) と
条件 (a), (b) は同値なのである. もちろん, 同様の結果が $n$ 次正方行列に対し
ても成立する. 一般の場合を証明するには線形代数の一般論を展開することが自然で
あるが, $n=2$ の特殊な場合は直接計算のみで証明することも易しいので, 
一度は経験しておくべきである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:det-nxn}
  $A$ は $n$ 次正方行列であるとする. このとき以下の条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] $A$ の逆行列が存在する.
  \item[(b)] $\det A \ne 0$.
  \item[(c)] $A$ の $n$ 本の列ベクトルは一次独立である.
  \item[(d)] $A$ の $n$ 本の行ベクトルは一次独立である.
  \item[(e)] 任意のゼロでない縦ベクトル $u$ に対して $Au\ne0$.
    \qed
  \end{enumerate}
\end{question}

\noindent 
ヒント: 線形代数の任意の教科書を参照せよ. なお, 
この問題の結論はその証明を復習した後では証明抜きで自由に用いて良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ は複素 $n$ 次正方行列であり, $p_A(\lambda)$ はその特性多項式であるとす
  る.  このとき, 複素数 $\alpha$ が $A$ の固有値であるための必要十分条件
  は $p_A(\alpha)=0$ が成立することである. 
  \qed
\end{question}

\noindent 
ヒント: 問題 \qref{q:det-nxn} を $A - \alpha E$ に適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  任意の $a,b,c\in\C$ に対して, $a\ne0$ならば, 
  ある $\alpha,\beta\in\C$ で次を満たすものが存在することを厳密に証明せよ:
  \begin{equation*}
    a \lambda^2 + b \lambda + c 
    = a(\lambda - \alpha)(\lambda - \beta).
    \qed
  \end{equation*}
\end{question}

\noindent 
参考: これは $2$ 方程式に関する結果だが, 
同様のことが任意の複素係数 $n$ 次代数方程式に対して成立する(代数学の基本定理). 
これ以後この演習では代数学の基本定理を証明抜きで自由に用いて良いことにする. 
(代数学の基本定理には様々な証明の仕方がある. おそらく複素函数論の授業で証明
の仕方の一つを習うことになるだろう.)
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{2次正方行列の Jordan 標準形と指数函数の計算の仕方}
\label{sec:2x2-Jordan}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-2.1}
  複素 $2$ 次正方行列 $A$ の特性方程式 $p_A(\lambda)=0$ の解
  を $\alpha$, $\beta$ と書くことにする. 
  $\alpha \ne \beta$ であるとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A \ne \alpha E$ かつ $A \ne \beta E$.
  \item[(2)] 行列 $A - \beta E$ の $0$ でない列ベクトルの1つを $u$ と書き%
    \footnote{行列 $X=\begin{bmatrix}a&b\\c&d\end{bmatrix}$ に対して, 
      ベクトル $\begin{bmatrix}a\\c\end{bmatrix}$,
      $\begin{bmatrix}b\\d\end{bmatrix}$ を $X$ の列ベクトルと呼ぶ.
      $X \ne 0$ ならば列ベクトルの少なくともいずれか片方は $0$ ではない.}, %
    行列 $A - \alpha E$ の $0$ でない列ベクトルの1つを $v$ と書くことにする. 
    このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \qquad  Av = \beta v.
    \end{equation*}
    (ヒント: $Au=\alpha u$ と $(A-\alpha E)u=$ は同値である.
    この考え方は今後自由に使われる. 
    Cayley-Hamilton の定理より $(A-\alpha E)(A-\beta E)=0$ であるが, 
    その等式を $A-\alpha E$ が $A-\beta E$ の2本の列ベクトルに作用する式とみ
    なしてみよ.  この考え方も今後頻繁に用いられる.)
  \item[(3)] $2$ 次正方行列 $P$ を $P := [u\ v]$ と定めると%
    \footnote{縦ベクトル $u=\begin{bmatrix}a\\c\end{bmatrix}$, 
      $v=\begin{bmatrix}b\\d\end{bmatrix}$ に対して, 
      $[u\ v] = \begin{bmatrix}a&b\\c&d\end{bmatrix}$ であると考えよ.}, %
    $P$ は逆行列を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P = \begin{bmatrix}\alpha & 0\\0 & \beta\end{bmatrix}.
    \end{equation*}
  \item[(5)] 任意の $k=1,2,3,\ldots$ に対して,
    \begin{equation*}
      A^k = P \begin{bmatrix}\alpha^k & 0\\0 & \beta^k\end{bmatrix} P^{-1}.
    \end{equation*}
  \item[(6)] 任意の $t\in\C$ に対して,
    \begin{equation*}
      e^{At} =
      P
      \begin{bmatrix}
        e^{\alpha t} & 0 \\
        0 & e^{\alpha t} \\
      \end{bmatrix}
      P^{-1}.
    \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-2.2}
  2次正方行列 $A$ の特性方程式 $p_A(\lambda)=0$ が
  重解 $\alpha$ を持ち,  $A \ne \alpha E$ であると仮定する.
  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] 行列 $A - \alpha E$ の $0$ でない列ベクトルの1つを $u$ と書くこと
    にする. このとき, $Au = \alpha u$ が成立する. 
    (ヒント: $(A-\alpha E)(A-\alpha E)=0$.)
  \item[(2)] ある縦ベクトル $v$ で $(A - \alpha E)v=u$ を満たすものが存在する.
    (ヒント: $u$ が $A - \alpha E$ の
    左側の列ベクトルならば $v=\tp{[1\ 0]}$ とし, 
    右側の列ベクトルならば $v=\tp{[0\ 1]}$ とすれば良い.)
  \item[(3)] $P := [u\ v]$ と置くと $P$ は逆行列を持つ.
    (ヒント: $u$ と $v$ の一次結合に $A - \alpha E$ を作用させてみよ.)
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P = \begin{bmatrix}\alpha & 1\\0 & \alpha\end{bmatrix}.
    \end{equation*}
  \item[(5)] 任意の $k=1,2,3,\ldots$ に対して,
    \begin{equation*}
      A^k = 
      P
      \begin{bmatrix} \alpha^k & k\alpha^{k-1} \\ 0 & \alpha^k \end{bmatrix}
      P^{-1}. 
    \end{equation*}
  \item[(6)] 任意の $t\in\C$ に対して,
    \begin{equation*}
      e^{At} =
      P
      \begin{bmatrix}
        e^{\alpha t} & t e^{\alpha t} \\
        0            &   e^{\alpha t} \\
      \end{bmatrix}
      P^{-1}.
    \qed
    \end{equation*}
  \end{enumerate}
\end{question}

以上によって, 複素 $2$ 次正方行列 $A$ に対して, 正則行列 $P$ をうまくとって,
$P^{-1}AP$ を次のどちらかの形にできることがわかった:
\begin{equation*}
  \begin{bmatrix} \alpha & 0 \\ 0 & \beta \\ \end{bmatrix},
  \qquad
  \begin{bmatrix} \alpha & 1 \\ 0 & \alpha \\ \end{bmatrix}.
\end{equation*}
この結果は任意の複素 $n$ 次正方行列 (より一般には代数閉体上の $n$ 次正方行列) 
に拡張される (Jordan標準型の理論).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{2次正方行列の Jordan 標準形の計算と応用}
\label{sec:2x2-calc-app}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:[0,4;-1,4]]}
  行列 %
  \(
    A =
    \begin{bmatrix}
       0 & 4 \\
      -1 & 4 \\
    \end{bmatrix}
  \) の固有値と固有ベクトルをすべて求めよ. \qed
\end{question}

\commentout{
\noindent
略解: $p_A(\lambda)=(\lambda-2)^2$ かつ $A\ne 2E$. 
よって固有値は $2$ だけ. 固有ベクトルとして $A - 2E$ の列ベクトルが取れる.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:k-jou}
  以下の行列の $k$ 乗を求めよ ($k=1,2,3,\ldots$):
  \begin{equation*}
    \text{(1)}\quad
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix},
    \qquad
    \text{(2)}\quad
    \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix},
    \qquad
    \text{(3)}\quad
    \begin{bmatrix} 1 & - 1 \\ 1 & 3 \end{bmatrix},
    \qquad
    \text{(4)}\quad
    \begin{bmatrix} 5 & 1 \\ -1 & 3 \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent 
ヒント: 問題 \qref{q:char-poly-2.1}, \qref{q:normal-form-2.1}, 
\qref{q:normal-form-2.2} の結果を使うことを考えよ.
\qed

\commentout{
\medskip
\noindent
略解:
\begin{enumerate}
\item[(1)] 
  \( %
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}^2
    = 5 \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}
  \) %
  より, %
  \( %
    \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}^k
    = 5^{k-1} \begin{bmatrix} 1 & 2 \\ 2 & 4 \end{bmatrix}
  \). %
\item[(2)] 
  \( %
    \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix}^2 = 4E
  \) %
  を用いて $k$ の偶奇で場合分けするか, 問題 \qref{q:normal-form-2.1} の
  結果を用いて,
  {\small
  \begin{equation*}
      \begin{bmatrix} 1 & 3 \\ 1 & -1 \end{bmatrix}^k
    = \begin{bmatrix} 3 & -1 \\ 1 & 1 \end{bmatrix}
      \begin{bmatrix} 2^k & 0 \\ 0 & (-2)^k \end{bmatrix}
      \frac{1}{4}
      \begin{bmatrix} 1 & 1 \\ -1 & 3 \end{bmatrix}
    = \frac{1}{4}
      \begin{bmatrix}
        3\cdot 2^k + (-2)^k & 3\cdot 2^k - 3\cdot(-2)^k \\
               2^k - (-2)^k &        2^k + 3\cdot(-2)^k
      \end{bmatrix}.
  \end{equation*}
  }
\item[(3)] 問題 \qref{q:normal-form-2.2} の結果を用いて,
  \begin{equation*}
      \begin{bmatrix} 1 & -1 \\ 1 & 3 \end{bmatrix}^k
    = \begin{bmatrix} -1 & 1 \\ 1 & 0 \end{bmatrix}
      \begin{bmatrix} 2^k & k\cdot 2^{k-1} \\ 0 & 2^k \end{bmatrix}
      \begin{bmatrix} 0 & 1 \\ 1 & 1 \end{bmatrix}
    = \begin{bmatrix}
        2^k - k\cdot 2^{k-1} & -k\cdot 2^{k-1} \\
        k\cdot 2^{k-1}       & 2^k + k\cdot 2^{k-1}
      \end{bmatrix}.
  \end{equation*}
\item[(4)] 問題 \qref{q:normal-form-2.2} の結果を用いて,
  \begin{equation*}
      \begin{bmatrix} 5 & 1 \\ -1 & 3 \end{bmatrix}^k
    = \begin{bmatrix} 1 & 0 \\ -1 & 1 \end{bmatrix}
      \begin{bmatrix} 4^k & k\cdot 4^{k-1} \\ 0 & 4^k \end{bmatrix}
      \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix}
    = \begin{bmatrix}
        4^k + k\cdot 4^{k-1} & k\cdot 4^{k-1} \\
        - k\cdot 4^{k-1}     & 4^k - k\cdot 4^{k-1}
      \end{bmatrix}.
  \end{equation*}
\end{enumerate}
以上の式が実際に正しいことを $k=1,2,3$ の場合に確かめてみよ.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:shokichimondaiwotoke}
  次の微分方程式の初期値問題を解け:
  \begin{alignat*}{3}
    \ddot x & = - 2 x +   y, &
    x(0) & = - 1, &
    \dot x(0) & = 1, 
    \\
    \ddot y & =     x - 2 y, &
    \qquad y(0) & = 1, &
    \qquad \dot y(0) & = 1.
  \end{alignat*}
  ここで, $\dot x$, $\ddot x$, etc は $t$ による導函数 $dx/dt$,
  $d^2x/dt^2$, etc を表わしているものとする.  \qed
\end{question}

\noindent
ヒント: 縦ベクトル値函数 $u$ を % 
$u=\tp{[x\ y]}$ と定め, 行列 $A$ を %
$A=\begin{bmatrix}-2&1\\1&-2\end{bmatrix}$ と定め, 縦ベクトル $u_0$, $u_1$ 
を $u_0=\tp{[-1\ 1]}$, $u_1=\tp{[1\ 1]}$ と定めると, 
問題の方程式は次のように書き直される:
\begin{equation*}
  \ddot u = Au, \qquad u(0)=u_0, \qquad \dot u(0)=u_1.
\end{equation*}
このとき, 可逆行列 $P$ を用いて, $u=Pv$ と置くと, この方程式は次のように変
形される:
\begin{equation*}
  \ddot v = P^{-1}APv, \qquad v(0)=P^{-1}u_0, \qquad \dot v(0)=P^{-1}u_1.
\end{equation*}
問題 \qref{q:normal-form-2.1} の方法を使うと, 適当な $P$ を見付けて %
$P^{-1}AP$ を実対角行列にできることがわかる. (実は, $P$ として直交行列がと
れることもわかる.) その対角成分は負であるので, 問題は次の形の微分方程式を解
くことに帰着されることがわかる:
\begin{equation*}
  \ddot z = - \alpha^2 z, \qquad z(0)=a, \qquad \dot z(0)= \alpha b
  \qquad (\alpha > 0).
\end{equation*}
この方程式の解は
\( %
  z = a \cos \alpha t + b \sin \alpha t
\) %
である.
\qed

\commentout{
\medskip
\noindent
略解: 
\( \displaystyle %
  P = \frac{1}{\sqrt{2}}
  \begin{bmatrix}
    1 & -1 \\
    1 & 1 
  \end{bmatrix}
\) %
と置くと, $P$ は直交行列(すなわち $P^{-1}=\tp{P}$)でかつ,
\( %
  P^{-1}AP =
  \begin{bmatrix}
    -1 &  0 \\
     0 & -3 
  \end{bmatrix}
\). %
よって,
\( %
  \begin{bmatrix} x \\ y \end{bmatrix} 
  = P \begin{bmatrix} X \\ Y \end{bmatrix} 
\) %
と置くと, 問題の方程式は次の方程式に変換される:
\begin{align*}
  & \ddot X = - X, \qquad X(0) = 0, \qquad \dot X(0) = \sqrt{2},
  \\
  & \ddot Y = - Y, \qquad Y(0) = \sqrt{2}, \qquad \dot Y(0) = 0.
\end{align*}
これを解くと,
\begin{equation*}
  X = \sqrt{2} \sin t, \qquad Y = \sqrt{2} \cos \sqrt{3} t.
\end{equation*}
よって, $x$, $y$ は
\begin{equation*}
  x = \sin t - \cos\sqrt{3}t, 
  \qquad
  y = \sin t + \cos\sqrt{3}t.
\end{equation*}
となる. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{$3$ 次正方行列}
\label{sec:3x3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$3$ 次以上の正方行列の特性多項式}
\label{sec:char-polyn}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ は $n$ 次正方行列であり, $\alpha$ はその固有値であり, 
  $u$ は対応する固有ベクトルであるとする. 
  このとき, 文字 $\lambda$ の任意の多項式 $f(\lambda)$ に
  対して $f(A)u=f(\alpha)u$ が成立する. 
  \qed
\end{question}

\noindent 
ヒント: たとえば $f(\lambda)=\lambda^k$ のとき $f(A)u = A^k u = \alpha^k u$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:char-poly-3.1}
  複素 $3$ 次正方行列 $A=[a_{ij}]$ の特性多項式 $p_A(\lambda)$ に対して以下
  が成立することを直接的な計算によって証明せよ: 
  \begin{enumerate}
  \item[(1)] 
    $p_A(\lambda) = \lambda^3 - \trace(A)\lambda^2 + b\lambda - \det(A)$.
    ここで,
    \begin{align*}
      &
      \trace(A) = a_{11} + a_{22} + a_{33}, 
      \\ &
      b = 
      \begin{vmatrix}
        a_{11} & a_{12} \\
        a_{21} & a_{22} \\
      \end{vmatrix}
      +
      \begin{vmatrix}
        a_{11} & a_{13} \\
        a_{31} & a_{33} \\
      \end{vmatrix}
      +
      \begin{vmatrix}
        a_{22} & a_{23} \\
        a_{32} & a_{33} \\
      \end{vmatrix},
      \\ &
      \det(A) =
        a_{11}a_{22}a_{33}
      + a_{12}a_{23}a_{31}
      + a_{13}a_{21}a_{32}
      - a_{11}a_{23}a_{32}
      - a_{13}a_{22}a_{31}
      - a_{12}a_{21}a_{33}.
    \end{align*}
  \item[(2)] \( p_A(A) = 0 \) \quad ($3$ 次正方行列の Cayley-Hamilton の定理).
  \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  複素 $n$ 次正方行列 $A=[a_{ij}]$ の特性多項式を
  \begin{equation*}
    p_A(\lambda) 
    = \lambda^n - s_1 \lambda^{n-1} + s_2 \lambda^{t-2} + \cdots + (-1)^n s_n
  \end{equation*}
  と書くとき,
  \begin{equation*}
    s_k = \sum_{1\le i_1<\cdots<i_k\le n}
    \begin{vmatrix}
      a_{i_1i_1} & \cdots & a_{i_1i_k} \\
      \vdots     &        & \vdots \\
      a_{i_ki_1} & \cdots & a_{i_ki_k} \\
    \end{vmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent 
解説: この問題の結論は上の問題 \qref{q:char-poly-3.1} (1) の一般化になってい
る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$3$ 次正方行列の Jordan 標準形の求め方}
\label{sec:3x3-Jordan}

以下の問題 %
$\text{\qref{q:normal-form-3.1}},\ldots,\text{\qref{q:normal-form-3.5}}$ を
解く前に \qref{q:jordan-3x3-1} を先に解いて感じをつかんでおいた方が良いかも
しれない. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-3.1}
  複素 $3$ 次正方行列 $A$ が
  互いに異なる3つの固有値 $\alpha$, $\beta$, $\gamma$ を持つとき, 
  以下が成立する:
  \begin{enumerate}
  \item[(1)] 
    $(A - \alpha E)(A - \beta E) \ne 0$ 
    かつ $(A - \alpha E)(A - \gamma E) \ne 0$ 
    かつ $(A - \beta E)(A - \gamma E) \ne 0$.
    (ヒント: $\gamma$ に対応する固有ベクトルに $(A - \alpha E)(A - \beta E)$ 
    を作用させると $0$ にならないことがわかる.)
  \item[(2)] 
    $(A - \beta E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $u$ と書き,
    $(A - \alpha E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $v$ と書き,
    $(A - \alpha E)(A - \beta E)$ の $0$ でない列ベクトルの1つを $w$ と書く
    ことにする.  このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \quad  Av = \beta v, \quad Aw = \gamma w.
    \end{equation*}
    (ヒント: $(A-\alpha E)(A-\beta E)(A-\gamma E)=0$)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u\ v\ w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 0 & 0 \\
        0 & \beta & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-3.2}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^2 (\lambda - \gamma),
    \qquad \alpha \ne \gamma
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)(A - \gamma E)\ne 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $(A - \alpha E)^2 \ne 0$.
    (ヒント: $\gamma$ に対応する固有ベクトルに $(A - \alpha E)^2$ 
    を作用させると $0$ にならないことがわかる.)
  \item[(2)] 
    $(A - \alpha E)(A - \gamma E)$ の $0$ でない列ベクトルの1つを $u$ と書き,
    $(A - \alpha E)^2$ の $0$ でない列ベクトルの1つを $w$ と書くことにする. 
    このとき次が成立する:
    \begin{equation*}
      Au = \alpha u,  \qquad Aw = \gamma w.
    \end{equation*}
  \item[(3)] $A - \gamma E$ の $0$ でない列ベクトル $v$ 
    で $u = (A - \alpha E)v$ を満たすものが存在する.
  \item[(4)] $3$ 次正方行列 $P$ を $P := [u\ v\ w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(5)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-3.3}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^2 (\lambda - \gamma),
    \qquad \alpha \ne \gamma
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)(A - \gamma E) = 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A - \alpha E$ の $0$ でない列ベクトル $w$ を取れる.
  \item[(2)] $A - \gamma E$ の2つの列ベクトル $u$, $v$ で一次独立なものを取
    れる.
    (ヒント: もしもそうでないならば $\rank(A - \gamma E) = 1$ となる.
    したがって $\gamma$ に対応する固有空間の次元
    は $3-\rank(A - \gamma E)=2$ になる.  そのとき, 
    特性多項式 $p_A(\lambda)$ は $(\lambda-\gamma)^2$ で割り切れる
    ので最初の仮定に反する.)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u\ v\ w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 0 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \gamma \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-3.4}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^3
  \end{equation*}
  という形をしており,
  \begin{equation*}
    (A - \alpha E)^2 \ne 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $(A - \alpha E)^2$ の $0$ でない列ベクトルの1つを $u$ とすると, 
    ある縦ベクトル $w$ で $u = (A - \alpha E)^2 w$ を満たすものが
    存在する.  $v = (A - \alpha E)w$ と置く.
  \item[(2)] $3$ 次正方行列 $P$ を $P := [u\ v\ w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(3)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 1 \\
        0 & 0 & \alpha \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}\label{q:normal-form-3.5}
  複素 $3$ 次正方行列 $A$ の特性多項式 $p_A(\lambda)$ は
  \begin{equation*}
    p_A(\lambda) = (\lambda - \alpha)^3
  \end{equation*}
  という形をしており,
  \begin{equation*}
    A \ne \alpha E, \qquad (A - \alpha E)^2 = 0
  \end{equation*}
  が成立していると仮定する.  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $A - \alpha E$ の $0$ でない列ベクトルの1つを $u$ とする.
    ある縦ベクトル $v$ で $(A - \alpha E)v = u$ を満たすものが存在する.
  \item[(2)] $u$ と一次独立な縦ベクトル $w$ で $Aw=\alpha w$ を満たすものが
    存在する.  (ヒント: もしもそうでなければ $3 - \rank(A - \alpha) = 1$ で
    ある.  しかし, $(A - \alpha E)^2 = 0$ より %
    $2(3 - \rank(A - \alpha E)) \ge 3$ であるから, 矛盾する.)
  \item[(3)] $3$ 次正方行列 $P$ を $P := [u\ v\ w]$ と定めると $P$ は逆行列
    を持つ. 
  \item[(4)] 次が成立する:
    \begin{equation*}
      P^{-1} A P 
      = 
      \begin{bmatrix}
        \alpha & 1 & 0 \\
        0 & \alpha & 0 \\
        0 & 0 & \alpha \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

以上によって, 複素 $3$ 次正方行列 $A$ に対して, 正則行列 $P$ をうまくとって,
$P^{-1}AP$ を次のどれかの形にできることがわかった:
\begin{equation*}
  \begin{bmatrix}
    \alpha & 0 & 0 \\
    0 & \beta  & 0 \\
    0 & 0 & \gamma \\
  \end{bmatrix},
  \qquad
  \begin{bmatrix}
    \alpha & 1 & 0 \\
    0 & \alpha & 0 \\
    0 & 0 & \gamma \\
  \end{bmatrix},
  \qquad
  \begin{bmatrix}
    \alpha & 1 & 0 \\
    0 & \alpha & 1 \\
    0 & 0 & \alpha \\
  \end{bmatrix}.
\end{equation*}
すなわち, 複素 $3$ 次正方行列は上の形の行列のどれかに相似である.  この形の行
列を {\bf Jordan 標準形}と呼ぶ.

この結果は任意の複素 $n$ 次正方行列 (より一般には代数閉体上の $n$ 次正方行列)
に対して拡張される(Jordan標準型の理論).  以上の $n=3$ の場合でもまだわかり難
いかもしれないが, 任意の複素 $n$ 次正方行列 $A$ は問題 \qref{q:exp-Jordan} 
の $J = J(k,\alpha)$ の形の行列を対角線に並べた行列と相似になることを証明で
きる.  $A$ と相似な $J$ の形の行列を対角線に並べた行列を $A$ の{\bf Jordan 
標準形} と呼ぶ.  $J$ の形の行列を並べる順序だけが違う Jordan 標準形は同じも
のだとみなす.  二つの複素 $n$ 次正方行列 (より一般には代数閉体上の二つの $n$ 
次正方行列) が互いに相似であるための必要十分条件は同じ Jordan 標準形を持つこ
とであることが講義の方で証明されることになる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:jordan-3x3-1}
  以下の行列の Jordan 標準形と標準形に相似変換する行列を求めよ:
  \begin{equation*}
    \text{(1)}\quad
    A =
    \begin{bmatrix}
      -1 &  0 &  0 \\
      -5 &  2 &  3 \\
      -1 &  0 & -1 \\
    \end{bmatrix},
    \qquad
    \text{(2)}\quad
    B =
    \begin{bmatrix}
      3 & 0 & -1 \\
      1 & 4 & -7 \\
      0 & 1 & -1 \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: (1) $p_A(\lambda)=(\lambda+1)^2(\lambda-2)$ で
かつ $(A+E)(A-2E)\ne 0$ なので問題 \qref{q:normal-form-3.2} を使えば良い. 
(2) $p_B(\lambda)=(\lambda-2)^3$ でかつ $(A-2E)^2\ne0$ なので
問題 \qref{q:normal-form-3.4} を使えば良い.

\commentout{
\medskip\noindent
略解: 計算結果は次のようになる:
\begin{align*}
  &
  \text{(1)} \quad
  A = PJP^{-1},
  \quad
  P =
  \begin{bmatrix}
     0 &  1 &  0 \\
     1 &  1 & -1 \\
    -1 &  1 &  0 \\
  \end{bmatrix},
  \quad
  J = 
  \begin{bmatrix}
    -1 &  1 &  0 \\
     0 & -1 &  0 \\
     0 &  0 &  2 \\
  \end{bmatrix},
  \\ &
  \text{(2)} \quad
  B = QKQ^{-1},
  \quad
  Q =
  \begin{bmatrix}
    1 & 1 & 1 \\
    3 & 1 & 0 \\
    1 & 0 & 0 \\
  \end{bmatrix},
  \quad
  K = 
  \begin{bmatrix}
    2 & 1 & 0 \\
    0 & 2 & 1 \\
    0 & 0 & 2 \\
  \end{bmatrix}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{内積とノルム}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{内積とノルムの基本性質}

複素 $m\times n$ 行列 $A$ に対して, その転置行列を $\tp{A}$ と
書き, $A$ の各成分の複素共役を取ってできる行列を $\compconj{A}$ と書
く. $A$ の{\bf 随伴行列 (adjoint matrix)} $A^*$ を
\begin{equation*}
  A^* := \compconj{\tp{A}} = \tp{\compconj{A}}
\end{equation*}
と定める. すなわち,
\begin{equation*}
  A =
  \begin{bmatrix}
    a_{11} & a_{12} & \cdots & a_{1n} \\
    a_{21} & a_{22} & \cdots & a_{2n} \\
    \vdots & \vdots &        & \vdots \\
    a_{m1} & a_{m2} & \cdots & a_{mn} \\
  \end{bmatrix}
  \implies
  A^* =
  \begin{bmatrix}
    \compconj{a_{11}} & \compconj{a_{21}} & \cdots & \compconj{a_{m1}} \\
    \compconj{a_{12}} & \compconj{a_{22}} & \cdots & \compconj{a_{m2}} \\
    \vdots            & \vdots            &        & \vdots \\
    \compconj{a_{1n}} & \compconj{a_{2n}} & \cdots & \compconj{a_{mn}} \\
  \end{bmatrix}.
\end{equation*}
たとえば, $x$ が縦ベクトルならば $x^*$ は横ベクトルになり, 逆も成立する:
\begin{equation*}
  x = 
  \begin{bmatrix}
    x_1 \\ \vdots \\ x_n
  \end{bmatrix}
  \implies
  x^* = 
  \begin{bmatrix}
    \compconj{x_1} & \cdots & \compconj{x_n}
  \end{bmatrix}.
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A,A_1,A_2$ は複素 $l\times m$ 行列であり, 
  $B$ は複素 $m\times n$ 行列であるとし,
  $a_1,a_2\in\C$ とすると以下が成立する:
  \begin{enumerate}
  \item $(AB)^* = B^*A^*$.
  \item $(a_1A_1+a_2A_2)^* = \compconj{a_1}A_1^* + \compconj{a_2}A_2^*$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

縦ベクトルからなる $n$ 次元複素ベクトル空間 $\C^n$ に標準的な
内積 $\bra\ ,\ \ket$ を次のように定める:
\begin{equation*}
  \bra x, y \ket := x^* y = \sum_{i=1}^n \compconj{x_i}y_i,
  \qquad
  \left(
  x =
  \begin{bmatrix}
    x_1 \\ \vdots \\ x_n
  \end{bmatrix},
  \quad
  y =
  \begin{bmatrix}
    y_1 \\ \vdots \\ y_n
  \end{bmatrix},
  \quad
  x_i, y_i\in\C
  \right).
\end{equation*}
$\text{横ベクトル}\times\text{縦ベクトル}$ がスカラーになることに注意せよ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[内積の基本性質]
\label{q:inner-prod-axioms}
  $x,x_1,x_2,y,y_1,y_2\in\C^n$ と $a_1,a_2,b_1,b_2\in\C$ に対して以下が成立
  する: 
  \begin{enumerate}
  \item $\bra y, x\ket = \compconj{\bra x, y\ket}$.
  \item $\bra x, b_1y_1+b_2y_2\ket
    = b_1\bra x, y_1\ket + b_2\bra x, y_2\ket$
    \quad{\bf (線形性)}.
  \item $\bra a_1x_1+a_2x_2, y\ket
    = \compconj{a_1}\bra x_1, y\ket + \compconj{a_2}\bra x_2, y\ket$
    \quad{\bf (反線形性)}.
  \item $\bra x, x\ket \ge 0$ であり,
    等号が成立するための必要十分条件は $x=0$ である. 
  \end{enumerate}
  これらを内積の基本性質と呼ぶことにする. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

一般に複素ベクトル空間 $V$ に問題 \qref{q:inner-prod-axioms} の性質
を満たす写像 $\bra\ ,\ \ket:V\times V\to\C$ が与えられている
とき, $V$ を{\bf 前 Hilbert 空間 (pre-Hilbert space)}と呼び%
\footnote{{\bf Hilbert 空間 (Hilbert space)} とは完備な pre-Hilbert 空間のこ
  とである. 完備であるとは任意の Cauchy 列が収束することである. この段階では
  完備性の有無については気にしなくて良い.  意識を集中して欲しいのは内積の基
  本性質 (公理) だけを用いて, どれだけの結論を導き出せるかについてである.}, %
$\bra\ ,\ \ket$ を{\bf 内積 (inner product, scalar product)} と呼ぶ.
問題 \qref{q:inner-prod-axioms} の結果より, 
標準的な内積を入れた $\C^n$ は pre-Hilbert 空間である.

$V$ が pre-Hilbert 空間であるとき, $x\in V$ のノルム $\norm{x}$ を次のように
定義する:
\begin{equation*}
  \norm{x} := \sqrt{\bra x, x \ket}.
\end{equation*}
たとえば, $V=\C^n$ のとき $x = \tp{[x_1\ \cdots\ x_n]}$ ならば
\begin{equation*}
  \norm{x} = \left(\sum_{i=1}^n|x_i|^2\right)^{1/2}.
\end{equation*}

前 Hilbert 空間の2つのベクトル $x,y$ が $\bra x, y\ket = 0$ を満たしていると
き, $x$ と $y$ は直交していると言う. ノルムが $1$ に等しいベクトルは単位ベク
トルと呼ばれる. 前 Hilbert 空間 $V$ の基底 $\{v_i\}_{i\in I}$ が
\begin{equation*}
  \bra v_i, v_j \ket = \delta_{ij} \qquad (i,j\in I)
\end{equation*}
を満たしているとき,  $\{v_i\}_{i\in I}$ は $V$ の
{\bf 正規直交基底 (orthonormal basis)} であると言う.
ここで $\delta_{ij}$ は Kronecker のデルタである.
すなわち, $i=j$ ならば $\delta_{ij}=1$ であり, 
$i\ne j$ ならば $\delta_{ij}=0$ である.
たとえば, $\C^n$ における標準的な基底
\begin{equation*}
  e_1 =
  \begin{bmatrix}
    1 \\ 0 \\ \vdots \\ 0
  \end{bmatrix},
  \quad
  e_2 =
  \begin{bmatrix}
    0 \\ 1 \\ \vdots \\ 0
  \end{bmatrix},
  \quad
  \dots,
  \quad
  e_n =
  \begin{bmatrix}
    0 \\ 0 \\ \vdots \\ 1
  \end{bmatrix}
\end{equation*}
は $\C^n$ の正規直交基底である.  正規直交基底の理論は Fourier 解析の理論の抽
象化とみなせる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $f(z)$ が $z$ に関する複素 Laurent 多項式であるとは,
  \begin{equation*}
    f(z) = \sum_{k=-m}^n a_k z^k
    \qquad (a_k\in\C,\ m,n\in\Z_{\ge0})
  \end{equation*}
  と表示可能な有理式であることである. 
  複素 Laurent 多項式全体の集合を $\C[z,z^{-1}]$ と書く. 
  写像 $\bra\ ,\ \ket : \C[z,z^{-1}]\times\C[z,z^{-1}]\to\C$ を
  \begin{equation*}
    \bra f, g\ket 
    := \int_0^1 \compconj{f(e^{2\pi i x})} g(e^{2\pi i x})\,dx
    \qquad \bigl(f,g\in\C[z,z^{-1}]\bigr)
  \end{equation*}
  と定めると, $\bra\ ,\ \ket$ は内積の基本性質を満たしており, 
  $\C[z,z^{-1}]$ は pre-Hilbert 空間になる. 
  さらに, $\{z^k\}_{k\in\Z}$ は $\C[z,z^{-1}]$ の正規直交基底になる.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Hermite-polyn-1}
  複素係数の1変数多項式全体の集合を $V = \C[x]$ と書く. 
  $\C[x]$ は自然に複素ベクトル空間とみなせる.
  各多項式 $f(x)\in V$ は自然に $\R$ 上の函数とみなせる.
  写像 $\bra\ ,\ \ket : V\times V\to\C$ を
  \begin{equation*}
    \bra f, g\ket := \int_{-\infty}^\infty \compconj{f(x)} g(x)\,e^{-x^2}dx
    \qquad \bigl(f,g\in V\bigr)
  \end{equation*}
  と定めると, $\bra\ ,\ \ket$ は内積の基本性質を満たしており, 
  $V = \C[x]$ は pre-Hilbert 空間になる. 
  $\{x^k\}_{k\in\Z_{\ge 0}}$ は $V = \C[x]$ の基底であるが, 正規直交基底では
  ない.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  閉区間 $[a,b]$ 上の複素数値連続函数全体の空間を $C([a,b])$ と書くことにす
  る. $C([a,b])$ は自然に複素ベクトル空間をなす.
  写像 $\bra\ ,\ \ket : C([a,b])\times C([a,b])\to\C$ を
  \begin{equation*}
    \bra f, g\ket := \int_a^b \compconj{f(x)} g(x)\,dx
    \qquad \bigl(f,g\in C([a,b])\bigr)
  \end{equation*}
  と定めると, $C([a,b])$ は pre-Hilbert 空間をなす%
  \footnote{$C([a,b])$ を完備化することによって得られる Hilbert 空間
    を $[a,b]$ 上の $L_2$ 空間と呼び, $L_2([a,b])$ のように表わす.}. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Cauchy-Schwarz の不等式]
\label{q:Cauchy-Schwarz}
  $V$ は pre-Hilbert 空間であるとする. 
  このとき, 任意の $x,y\in V$ に対して,
  \begin{equation*}
    |\bra x, y\ket| \le \norm{x}\cdot\norm{y}.
  \end{equation*}
  等号が成立するための必要十分条件は $x,y$ のどちらかがもう一方の複素数倍に
  なっていることである.
  \qed
\end{question}

\noindent
ヒント: $x\ne0$ と仮定して良い.  
$z=y-ax$ が $x$ と直交するように $a\in\C$ を
定め, $y$ のノルムの2乗を $x$ と $z$ で表わしてみよ.
\qed

\commentout{
\medskip
\noindent
略解: $a = \bra x,y\ket/\bra x,x\ket$ であるから, 
\begin{equation*}
  \norm{y}^2
  = \bra z+ax, z+ax \ket
  = \bra z, z\ket + |a|^2 \bra x, x\ket
  \ge |a|^2 \bra x, x\ket
  = \frac{|\bra x,y\ket|^2}{\norm{x}^2}.
\end{equation*}
ここで, 2つ目の等号で $x$ と $z$ が直交することを用いた.
途中の不等号で等号が成立するための必要十分条件
は $z=0$ すなわち $y=ax$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[ノルムの基本性質]
\label{q:norm-axioms}
  $V$ が pre-Hilbert 空間であるとき, 
  $x,y\in V$ と $a\in\C$ に対して以下が成立する:
  \begin{enumerate}
  \item $\norm{x}\ge 0$ であり, 
    等号が成立するための必要十分条件は $x=0$ である.
  \item $\norm{ax}=|a|\cdot\norm{x}$.
  \item $\norm{x+y}\le\norm{x}+\norm{y}$
    \quad {\bf (三角不等式)}. 
    \qed
  \end{enumerate}
\end{question}

\noindent 
ヒント: 三角不等式の証明には Cauchy-Schwarz の不等式
と $\Repart\bra x,y\ket\le|\bra x,y\ket|$ を使う.
\qed

\medskip
\noindent
参考: pre-Hilbert 空間の場合には次も成立している: 三角不等式において
等号が成立するための必要十分条件は $x,y$ のどちらかがもう一方の非負の
実数倍になっていること (直観的には $x,y$ が同じ方向を向いていること) である.
余裕があればこの事実も示してみよ.
\qed

\commentout{
\medskip
\noindent
略解: 三角不等式のみを証明しよう. $x,y\in V$ に対して,
\begin{equation*}
  (\norm{x}+\norm{y})^2 - \norm{x+y}^2
  = 2(\norm{x}\cdot\norm{y} - \Repart\bra x,y\ket)
  \le 2(\norm{x}\cdot\norm{y} - |\bra x,y\ket|)
  \le 0.
\end{equation*}
1つ目の不等号は $\Repart\bra x,y\ket\le|\bra x,y\ket|$ より.
2つ目の不等号は Cauchy-Schwarz の不等式より.
$x\ne 0$ のとき, 2つの不等号が共に等号になるための必要十分条件
はある $a\in\C$ が存在して $y=ax$ 
かつ $\Repart a = |a|$ が成立することである.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

一般に, 複素ベクトル空間 $V$ に問題 \qref{q:norm-axioms} の性質を持つ
写像 $\norm{{\ }}:V\to\R$ が与えられている
とき, $V$ を{\bf ノルム空間 (normed vector space)}と
呼び, $\norm{{\ }}$ を{\bf ノルム (norm)} と呼ぶ.

複素ベクトル空間 $V$ における2つのノルム $\norm{{\ }}_1$, $\norm{{\ }}_2$ 
が{\bf 同値 (equivalent)} であるとはある定数 $A,B>0$ が存在して, 
任意の $x\in V$ に対して $A\norm{x}_1\le\norm{x}_2\le B\norm{x}_1$ が成立す
ることであると定義する.

\begin{question}
\label{q:norm-1-infty}
  $\C^n$ にノルム $\norm{{\ }}_1$, $\norm{{\ }}_\infty$ を次のように定め
  ることができることを示せ%
  \footnote{実は任意の $p\ge 0$ に対してノルムを次のように定めることができる:
    \begin{equation*}
      \norm{x}_p := \left(\sum_{i=1}^n |x_i|^p \right)^{1/p}.
    \end{equation*}
    $\C^n$ の標準的なノルムは $\norm{{\ }}_2$ である.
    しかし, 後で説明されるようにすべてのノルムは互いに同値になるので
    不等式を評価するときにどのノルムを用いても本質的に変わりはない.}:
  \begin{equation*}
    \norm{x}_1 := \sum_{i=1}^n |x_i|,
    \quad
    \norm{x}_\infty := \max_{1\le i\le n}|x_i|
    \qquad
    \bigl(x=\tp{[x_1\ \cdots\ x_n]}\in\C^n\bigr).
  \end{equation*}
  さらに, この2つのノルムが互いに同値であることを証明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $\norm{x}_\infty \le \norm{x}_1 \le n\norm{x}_\infty$. \qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$V$ がノルム空間であるとき $V$ 内の点列 $\{v_n\}_{n=1}^\infty$ が 
{\bf Cauchy 列 (Cauchy sequence)} もしくは {\bf 基本列 (fundamental sequence)} 
であるとは $\norm{v_m-v_n}\to 0$ ($m,n\to\infty$) となることである%
\footnote{「$\norm{v_m-v_n}\to 0$ ($m,n\to\infty$)」が成立するとは
  「任意に $\eps>0$ が与えられても十分に $N$ 大きく
  すれば $\norm{v_m-v_n}\le\eps$ ($m,n\ge N$) が成立する」
  ということである.  これは「どんなに小さな $\eps>0$ が与えられても
  点列のあるところから先の部分 $v_N,v_{N+1},v_{N+2},\ldots$ は直径 $\eps$ の
  範囲内に分布している」と言い直すことができる.

  直観的に Cauchy 列はある点に収束して行くように見える点列のことである.
  しかし無限次元の場合には収束先がもとの空間内に存在するとは限らない.
  収束しているように見える点列が常に収束しているという条件を仮定しておかない
  と不便な場合が多い. 次の「完備性 (completeness)」の定義を見よ.}.
ノルム空間 $V$ が{\bf 完備 (complete)} であるとは $V$ における任意の Cauchy 
列が収束することである%
\footnote{「$V$ における点列 $\{v_n\}_{n=1}^\infty$ が $v\in V$ に収束する」
  とは「任意に $\eps>0$ が与えられても十分に $N$ を大きく
  すれば $\norm{v-v_n}\le\eps$ ($n\ge N$) が成立する」ということである.
  これは「許容できる誤差の上限 $\eps>0$ をどんなに小さくしても, 
  点列のあるところから先の部分 $v_N,v_{N+1},v_{N+2},\ldots$ は
  どれも $v$ を誤差 $\eps$ 以内で近似している」と言い換えることができる.
  収束性の厳密の定義は「いくらでも近似できる」という直観を正確に言い直しただ
  けである.}.
たとえば $\R$ 上の1次元ベクトル空間 $\R$ にノルムを絶対値で定めれば実数体
の完備性より $\R$ は完備なノルム空間になる.

一般に{\bf 完備なノルム空間 (complete normed vector space)} を 
{\bf Banach 空間 (Banach space)} と呼ぶ. 

たとえば有限次元ノルム空間は常に完備になるので Banach 空間である. 
有限次元複素ベクトル空間に入るノルムは互いにすべて同値になり, 
どのノルムに関しても $\C^n$ は完備になる.

\begin{question}
\label{q:norm-equiv}
  $\C^n$ におけるノルムはすべて互いに同値になることを証明せよ. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:norm-1-infty} の $\norm{{\ }}_1$ と $\C^n$ における
任意のノルム $\norm{{\ }}$ が同値であることを示せば
良い.  $\norm{{\ }}$ に関する三角不等式を用いて, $\norm{x}\le B \norm{x}_1$ 
の側が証明される.  $\norm{x}\ge A \norm{x}_1$ の側を証明するため
には $\norm{{\ }}_1$ の定める位相に関してコンパクトな
集合 $\{\,x\in\C^n\mid\norm{x}_1=1\,\}$ 上の実数値連続函数 $\norm{{\ }}$ が
最小値を持つことを使えば良い.
函数解析 (位相解析) の教科書を見れば答が書いてあるはず.
\qed

\commentout{
\medskip
\noindent
略解: $B=\max_{1\le i\le n}\norm{e_i} > 0$ と置くと,
\begin{equation*}
  \norm{x} 
  \le \sum_{i=1}^n |x_i|\,\norm{e_i} 
  \le B \sum_{i=1}^n |x_i|
  = B \norm{x}_1.
\end{equation*}
これより $\norm{{\ }}$ は $\norm{{\ }}_1$ から定まる位相に関して連
続になることもわかる.  したがって, $\norm{{\ }}$ はコンパクト
集合 $\{\,x\in\C^n\mid\norm{x}_1=1\,\}$ 上で最小値 $A>0$ を持つ. 
このとき, $x\ne0$ ならば
\begin{equation*}
  \norm{x}
  = \norm{\frac{x}{\norm{x}_1}} \norm{x}_1
  \ge A \norm{x}_1.
  \qed
\end{equation*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\C^n$ は標準的なノルムに関して完備であることを証明せよ. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:inner=norm}
  pre-Hilbert 空間においてノルムは内積を用いて定義されたが, 
  逆にノルムを用いて内積を表示することもできる:
  \begin{equation*}
    4\bra x,y\ket 
    = \norm{x+y}^2 - \norm{x-y}^2 - i\norm{x+iy}^2 + i\norm{x-iy}^2.
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\medskip
\noindent
参考: 
複素 $m\times n$ 行列全体の集合を $M_{m,n}(\C)$ と書くことにする($M$ は 
Matrix の頭文字).  このとき, $A,B\in M_{m,n}(\C)$ に対して,
\begin{equation*}
  \bra A, B\ket := \trace(A^*B), \qquad
  \norm{A} := \sqrt{\bra A, A\ket}
\end{equation*}
と定めると,
\begin{equation*}
  \bra A, B\ket = \sum_{i=1}^m\sum_{j=1}^n \compconj{a_{ij}} b_{ij},
  \qquad
  \norm{A} = \left(\sum_{i=1}^m\sum_{j=1}^n |a_{ij}|^2\right)^{1/2}
\end{equation*}
が成立している.  これによって, $M_{m,n}(\C)$ も pre-Hilbert 空間をなす%
\footnote{一般に有限次元の pre-Hilbert 空間は Hilbert 空間になる.
よって, $M_{m,n}(\C)$ は Hilbert 空間になる.}.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Schmidt の正規直交化法と岩沢分解}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Schmidt の正規直交化法]
\label{q:Schmidt}
  $V$ は pre-Hilbert 空間であり, 
  $x_1,\dots,x_n\in V$ は一次独立であると仮定し, 
  $k=1,\dots,n$ に対して $v_k,p_k\in V$ を帰納的に,
  \begin{equation*}
    v_k := x_k - \sum_{i=1}^{k-1} \bra p_i, x_k\ket p_i,
    \quad
    p_k := v_k / \norm{v_k}
    \qquad (k=1,\dots,n).
  \end{equation*}
  と定める. (特に, $v_1 = x_1$, $p_1 = x_1 / \norm{x_1}$.) %
  このとき, $p_1,\dots,p_n$ の張る $V$ の部分空間は $x_1,\dots,x_n$ の
  張る $V$ の部分空間は等しく, 
  \begin{equation*}
    \bra p_k, p_l \ket = \delta_{kl}
    \qquad (k,l=1,\dots,n)
  \end{equation*}
  が成立する. ここで $\delta_{kl}$ は Kronecker のデルタである. 
  特に $V=\C^n$ のとき $p_1,\dots,p_n$ は $V$ の正規直交基底である. \qed
\end{question}

\noindent
ヒント: 数学的帰納法.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

複素 $n$ 次正方行列全体のなす複素ベクトル空間を $M_n(\C)$ と書くことにする.
$M_n(\C)$ の部分集合 $GL_n(\C)$, $U(n)$, $A_n$, $N_n(\C)$ を以下のように定義
する:
\begin{align*}
  &
  GL_n(\C) :=  \{\, A\in M_n(\C) \mid \det A \ne 0 \,\},
  \\ &
  U(n) := \{\, A\in M_n(\C) \mid A^* A = A A^* = E \,\},
  \\ &
  A_n := \{\, \diag(a_1,\dots,a_n) \mid a_i > 0 \,\},
  \\ &
  N_n(\C) := \left\{\,
    \left.
    \begin{bmatrix}
      1 & a_{12} & a_{13} & \cdots & a_{1n} \\
        &   1    & a_{23} & \cdots & a_{2n} \\
        &        &   1    & \ddots & \vdots \\
        &        &        & \ddots & a_{n-1,n} \\
      \bigzerol & &       &        &   1 \\
    \end{bmatrix}
    \,\right|\,
    a_{ij}\in\C
  \,\right\}.
\end{align*}
ここで, $\diag(a_1,\dots,a_n)$ は $a_1,\dots,a_n$ を対角成分とする対角行列で
ある.  $N_n(\C)$ は対角成分がすべて $1$ の上三角行列全体の集合である.
後で群の定義を習えばすぐにわかるように, 以上で定義した行列の集合はすべて行列
の積に関して群をなす. 
$GL_n(\C)$ は $n$ 次の{\bf 複素一般線形群 (complex general linear group)} と
呼ばれ, $U(n)$ は $n$ 次の{\bf ユニタリー群 (unitary group)} と呼ばれている.
$U(n)$ に含まれる行列は{\bf ユニタリー行列 (unitary matrix)} と呼ばれる.

\begin{question}
\label{q:unitary-orthonormal}
  $P\in M_n(\C)$ の中の $n$ 本の列ベクトルを左から $p_1,\dots,p_n$ と書くこ
  とにする. すなわち $P = [p_1\ \cdots\ p_n]$.  このとき,
  \begin{equation*}
    P\in U(n) \iff \text{$p_1,\dots,p_n$ は $\C^n$ の正規直交基底}.
    \qed
  \end{equation*}
\end{question}

以上の準備のもとで $\C^n$ の基底への Schmidt の正規直交化法の適用を次のよう
に言い直すことができる.

\begin{question}[複素一般線形群の岩沢分解]
\label{q:iwasawa-decomp-GLn(C)}
  次の写像は全単射である:
  \begin{equation*}
    U(n)\times A_n \times N_n(\C) \to GL_n(\C),
    \quad (K,A,N) \mapsto X = KAN.
  \end{equation*}
  この結果を $GL_n(\C)$ の岩沢分解と呼ぶ. \qed
\end{question}

\noindent
ヒント:  逆写像の構成の仕方. $X\in GL_n(\C)$ の中の $n$ 本の
列ベクトル $x_1,\dots,x_n$ は $\C^n$ の基底をなす. 
その基底に Schmidt の正規直交化法を適用すると,
\begin{equation*}
  x_k = \bra p_1,x_k\ket p_1 + \cdots + \bra p_{k-1},x_k\ket p_{k-1} +\norm{v_k} p_k 
  \qquad (k=1,\dots,n)
\end{equation*}
であるから, これを書き直すと,
\begin{equation*}
  X = [x_1\ \cdots\ x_n] =
  [p_1\ \cdots\ p_n]
  \begin{bmatrix}
    \norm{v_1} & \bra p_1,x_2\ket & \bra p_1,x_3\ket & \cdots & \bra p_1,x_n\ket \\
               & \norm{v_2}       & \bra p_2,x_3\ket & \cdots & \bra p_2,x_n\ket \\
               &                  & \norm{v_3}       & \ddots & \vdots \\
               &                  &                  & \ddots & \bra p_{n-1},x_n\ket \\
    \bigzerol  &                  &                  &        & \norm{v_n} \\
  \end{bmatrix}.
\end{equation*}
複素一般線形群の岩沢分解は任意の正則な複素 $n$ 次正方行列がユニタリー行列と
対角成分が正の実数であるような上三角行列の積に一意的に分解されることと同値で
ある. 
\qed

\medskip
\noindent
参考: 位相について習えばすぐに証明できるようになることだが, $U(n)$ はコンパ
クト群であり, $A_n$ は $\R^n$ と同相であり, $N_n(\C)$ は $\R^{n(n-1)}$ と
同相である.  複素一般線形群の岩沢分解は $GL_n(\C)$ が位相空間としてコンパク
ト群とユークリッド空間 $\R^{n^2}$ の直積に同相であることを意味している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:iwasawa-decomp-GLn(R)}
  実数の範囲内での Schmidt の正規直交化法と
  実一般線形群の岩沢分解を定式化して証明せよ. \qed
\end{question}

\noindent
ヒント: $\tp{A}A=A\tp{A}=E$ を満たす実 $n$ 次正方行列全体のな
す集合を $O(n)$ と書いて{\bf 直交群 (orthogonal group)} と呼び, $O(n)$ の元
を{\bf 直交行列 (orthogonal matrix)} と呼ぶ.  このとき, 行列の積の定める写像
\begin{equation*}
  O(n)\times A_n \times N_n(\R) \to GL_n(\R),
  \quad (K,A,N) \mapsto X = KAN.
\end{equation*}
は全単射になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Hermite-polyn-2}
  問題 \qref{q:Hermite-polyn-1} の状況を考える. 
  $1,x,x^2,x^3,x^4\in V$ に Schmidt の正規直交化法を適用してみよ.
  \qed
\end{question}

\noindent
ヒント: 内積の計算については次の問題 \qref{q:In} を見よ.
正規直交化の結果を $v_0,v_1,v_2,v_3,v_4$ と書くと, 
各 $v_n$ は $(\text{最高次の係数が $2^n$ の整数係数多項式})\big/
\sqrt{2^nn!\sqrt{\pi}}$ の形になる.
しかも $v_0,v_2,v_4$ は偶函数になり, $v_1,v_3$ は奇函数になる.
\qed

\medskip
\noindent
参考: 問題 \qref{q:Hermite-polyn-1}, \qref{q:Hermite-polyn-2} は
実は Hermite の多項式の理論の一部分になっている.  
Hermite の多項式に関しては\secref{sec:Hermite-polynomials}および
寺沢 \cite{terakan} の 144--146 頁を参照せよ%
\footnote{実はこの参考が問題 \qref{q:Hermite-polyn-2} の最大のヒントになって
  いる. 岩沢分解 \qref{q:iwasawa-decomp-GLn(C)} より,
  \begin{equation*}
    v_n(x)=a_{0n}+a_{1n}x+\cdots+a_{nn}x^n,
    \qquad a_{mn}\in\R, \quad a_{nn}>0
  \end{equation*}
  の形の $v_0,\dots,v_4$ で $\bra v_m,v_n\ket = \delta_{mn}$ を満たすものを
  見付ければ良い. そのような $v_n$ たちは Hermite の多項式に関する結果を
  よく眺めると見付かってしまう.}.
\qed

\commentout{
\medskip
\noindent
略解: 実は Hermite の多項式 $H_n(x)=(-1)^ne^{x^2}\odfrac{^n}{x^n}e^{-x^2}$ 
をそのノルム $\sqrt{2^nn!\sqrt{\pi}}$ で割ったものが答になる. 
問題 \qref{q:Hermite-polyn-2} に解答するためには $n=4$ まで計算すれば良い:
\begin{alignat*}{2}
  & H_0(x) = 1, &
  \qquad
  & \norm{H_0}^2 = 2^0\cdot0!\sqrt{\pi} = \sqrt{\pi},
  \\
  & H_1(x) = 2x, &
  \qquad
  & \norm{H_1}^2 = 2^1\cdot1!\sqrt{\pi} = 2\sqrt{\pi},
  \\
  & H_2(x) = 4x^2 - 2, &
  \qquad
  & \norm{H_2}^2 = 2^2\cdot2!\sqrt{\pi} = 8\sqrt{\pi},
  \\
  & H_3(x) = 8x^3 - 12x, &
  \qquad
  & \norm{H_3}^2 = 2^3\cdot3!\sqrt{\pi} = 48\sqrt{\pi},
  \\
  & H_4(x) = 16x^4 - 48x^2 + 12, &
  \qquad
  & \norm{H_4}^2 = 2^4\cdot4!\sqrt{\pi} = 384\sqrt{\pi}.
\end{alignat*}
よって, $1,x,x^2,x^3,x^4$ を正規直交化した結果 $v_0,v_1,v_2,v_3,v_4$ は次の
ようになる:
\begin{align*}
  &
  v_0(x) = H_0(x)/\norm{H_0} = \pi^{-1/4},
  \\ &
  v_1(x) = H_1(x)/\norm{H_1} =\pi^{-1/4}\sqrt{2}x,
  \\ &
  v_2(x) = H_2(x)/\norm{H_2} 
  =\pi^{-1/4}\left(\sqrt{2}x^2 - \frac{\sqrt{2}}{2}\right),
  \\ &
  v_3(x) = H_3(x)/\norm{H_3} 
  =\pi^{-1/4}\left( \frac{2\sqrt{3}}{3}x^3 - \sqrt{3}x\right),
  \\ &
  v_4(x) = H_4(x)/\norm{H_4} 
  =\pi^{-1/4}\left(
    \frac{\sqrt{6}}{3}x^4 - \sqrt{6}x^2 + \frac{\sqrt{6}}{4}
  \right).
\end{align*}
直接的に Schmidt の正規直交化法を適用するとかなり面倒な計算が必要になるが, 
結果は以上と一致することが確かめられる.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:In}
  $I_n=\int_{-\infty}^\infty x^n e^{-x^2}dx$ 
  \enspace ($n=0,1,2,\ldots$) を計算せよ.
  \qed
\end{question}

\medskip
\noindent
ヒント: $n$ が偶数の場合は $I(a)=\int_{-\infty}^\infty e^{-ax^2}dx$ 
\enspace ($a>0$) を計算して, $a$ で微分すれば良い.  
$n$ が奇数の場合は $I_n = 0$ となる.
\qed

\commentout{
\medskip
\noindent
略解: $I(a) = \sqrt{\pi} a^{-1/2}$ である. なぜならば
\begin{equation*}
  I(a)^2 = \int_{\R^2} e^{-a(x^2+y^2)}\,dx\,dy
  = \int_0^{2\pi}d\theta \int_0^\infty e^{-ar^2} r\,dr
  = \frac{\pi}{a}.
\end{equation*}
$I_{2k}$ は次のように計算される:
\begin{equation*}
  I_{2k} = \left.\left(-\od{a}\right)^k I(a)\right|_{a=1}
  = \frac{1\cdot3\cdots(2k-1)}{2^k}\sqrt{\pi}.
\qed
\end{equation*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\medskip

ガンマ函数 $\Gamma(s)$ は次のように定義されたのであった:
\begin{equation*}
  \Gamma(s) := \int_0^\infty y^{s-1} e^{-y}\,dy
  \qquad (\Repart s > 0).
\end{equation*}
そして, ガンマ函数は次の函数等式を満たしているのであった:
\begin{equation*}
  \Gamma(s+1) = s\Gamma(s).
\end{equation*}
$y=x^2$ と変数変換すれば $I_{2k} = \Gamma(k+\frac{1}{2})$ であることがわかる.
よって, 函数等式と $\Gamma(1/2)=\sqrt{\pi}$ から $I_{2k}$ を計算することもで
きる.

\begin{question}
\label{q:Gamma-function}
  $\Repart s > 0$ においてガンマ函数の定義式の右辺の積分が絶対収束することお
  よびガンマ函数の函数等式を証明せよ. 
  さらに, $\Gamma(n+1)=n!$ ($n\in\Z_{\ge0}$), $\Gamma(1/2)=\sqrt{\pi}$ を示せ.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Cauchy-Schwarz の不等式について}
\label{sec:Cauchy-Schwarz}

Cauchy-Schwarz の不等式 \qref{q:Cauchy-Schwarz} について解説を追加しておく.

Cauchy-Schwarz の不等式がまだ「ああやってもこうやっても明らか」に見えていな
い人は難しく考え過ぎているからである.  特殊な場合における Cauchy-Schwarz の
不等式を様々なやり方で証明しておけば段々「これは当然成立すべき不等式であり, 
必要最小限どれだけの条件があれば Cauchy-Schwarz の不等式が成立するかは内積の
公理の形にまとめられている」ということが納得できてくるはずである.  しかし,
そのためには様々な場合について時間をかけて色々考えてみる必要がある.  どうい
うことに時間をかけるべきかについての実例を以下に示すことにする.

実2次元の場合に $a=\tp{[a_1,a_2]}, b=\tp{[b_1,b_2]} \in\R^2$ の内積が
\begin{equation*}
  \bra a,b\ket = a_1b_1 + a_2b_2
\end{equation*}
と定義されている場合は
\begin{align*}
  \bra a,a\ket \bra b,b\ket - \bra a,b\ket^2
  &
  = (a_1^2+a_2^2)(b_1^2+b_2^2) - (a_1b_1 + a_2b_2)^2
  \\ &
  = (a_1^2b_1^2 + a_1^2b_2^2 + a_2^2b_1^2 + a_2^2b_2^2)
  - (a_1^2b_1^2 + 2a_1b_1a_2b_2 + a_2^2b_2^2)
  \\ &
  = a_1^2b_2^2 - 2a_1b_1b_2b_2 + a_2^2b_1^2
  \\ &
  = (a_1b_2 - a_2b_1)^2
  \ge 0.
\end{align*}
よって次の Cauchy-Schwarz の不等式が成立する:
\begin{equation*}
  \bra a,b\ket^2 \le \bra a,a\ket \bra b,b\ket
  \quad\text{すなわち}\quad
  |\bra a,b\ket| \le \norm{a}\cdot\norm{b}.
\end{equation*}
実3次元の場合も同様の計算が可能である.  
実際, $a=\tp{[a_1,a_2,a_3]}, b=\tp{[b_1,b_2,b_3]} \in\R^3$ の内積が
\begin{equation*}
  \bra a,b\ket = a_1b_1 + a_2b_2 + a_3b_3
\end{equation*}
と定義されているならば,
\begin{align*}
  \bra a,a\ket \bra b,b\ket - \bra a,b\ket^2
  &
  = (a_1^2+a_2^2+a_3^2)(b_1^2+b_2^2+b_3^2) - (a_1b_1 + a_2b_2 + a_3b_3)^2
  \\ &
  = ( \hphantom{+\,}
    a_1^2b_1^2 + a_1^2b_2^2 + a_1^2b_3^2
  \\ &
  \hphantom{= (}
  + a_2^2b_1^2 + a_2^2b_2^2 + a_2^2b_3^2
  \\ &
  \hphantom{= (}
  + a_3^2b_1^2 + a_3^2b_2^2 + a_3^2b_3^2
  ) 
  \\ &
  - ( \hphantom{+\,}
    a_1b_1a_1b_1 + a_1b_1a_2b_2 + a_1b_1a_3b_3
  \\ &
  \hphantom{= (}
  + a_2b_2a_1b_1 + a_2b_2a_2b_2 + a_2b_2a_3b_3
  \\ &
  \hphantom{= (} 
  + a_3b_3a_1b_1 + a_3b_2a_2b_2 + a_3b_3a_3b_3
  ) 
  \\ &
  = (a_1^2b_2^2 - 2a_1b_1a_2b_2 + a_2^2b_1^2)
  \\ &
  + (a_1^2b_3^2 - 2a_1b_1a_3b_3 + a_3^2b_1^2)
  \\ &
  + (a_2^2b_3^2 - 2a_2b_2a_3b_3 + a_3^2b_2^2)
  \\ &
  = (a_1b_2 - a_2b_1)^2
  + (a_1b_3 - a_3b_1)^2
  + (a_2b_3 - a_3b_2)^2
  \ge 0.
\end{align*}
計算のポイントは3つ目の等号である.
2つ目の等号の後の式の前者の括弧の中と後者の括弧の中の「対角成分」は互いにキ
ャンセルし, 前者と後者の括弧の中の $i<j$ に対する「$(i,j)$ 成分」と「$(j,i)$ 
成分」をまとめて並べ直せば3つ目の等号が成立することがわかる.

ここまでたどり着けば実 $n$ 次元の場合も同様の計算が可能であることが容易に想
像できるはずである. なぜならば上に説明した3つ目の等号の導き方は次元によらな
い方法だからである%
\footnote{$n$ が一般の場合の結果を得るために $n$ が小さな場合の議論をよく観
  察して「それがうまく行く仕組み」を見抜くという考え方は非常に重要である.}.

実際, $a=\tp{[a_1,\dots,a_n]}, b=\tp{[b_1,\dots,b_n]} \in\R^2$ の内積が
\begin{equation*}
  \bra a,b\ket = \sum_{i=1}^n a_ib_i = a_1b_1 + \cdots + a_nb_n
\end{equation*}
と定義されているならば,
{\small
\begin{align*}
  &
  \bra a,a\ket \bra b,b\ket - \bra a,b\ket^2
  \\ 
  &
  = (a_1^2 + a_2^2 + \cdots + a_n^2)(b_1^2 + b_2^2 + \cdots + b_n^2) 
%  \\ &
  - (a_1b_1 + a_2b_2 + \cdots + a_nb_n)^2
  \\ &
  = ( \hphantom{+\,}
    a_1^2b_1^2 + a_1^2b_2^2 + a_1^2b_3^2 + \cdots + a_1^2b_n^2
  \\ &
  \hphantom{= (} 
  + a_2^2b_1^2 + a_2^2b_2^2 + a_2^2b_3^2 + \cdots + a_2^2b_n^2
  \\ &
  \hphantom{= (} 
  + a_3^2b_1^2 + a_3^2b_2^2 + a_3^2b_3^2 + \cdots + a_3^2b_n^2
  \\ &
  \hphantom{= (} 
  + \cdots\cdots
  \\ &
  \hphantom{= (} 
  + a_n^2b_1^2 + a_n^2b_2^2 + a_n^2b_3^2 + \cdots + a_n^2b_n^2
  ) 
  \\ &
  - ( \hphantom{+\,}
    a_1b_1a_1b_1 + a_1b_1a_2b_2 + a_1b_1a_3b_3 + \cdots + a_1b_1a_nb_n
  \\ &
  \hphantom{= (} 
  + a_2b_2a_1b_1 + a_2b_2a_2b_2 + a_2b_2a_3b_3 + \cdots + a_2b_2a_nb_n
  \\ &
  \hphantom{= (} 
  + a_3b_3a_1b_1 + a_3b_2a_2b_2 + a_3b_3a_3b_3 + \cdots + a_3b_3a_nb_n
  \\ &
  \hphantom{= (} 
  + \cdots\cdots
  \\ &
  \hphantom{= (} 
  + a_nb_na_1b_1 + a_nb_na_2b_2 + a_nb_na_3b_3 + \cdots + a_nb_na_nb_n
  ) 
  \\ &
  = (a_1^2b_2^2 - 2a_1b_1a_2b_2 + a_2^2b_1^2)
%  \\ &
  + (a_1^2b_3^2 - 2a_1b_1a_3b_3 + a_3^2b_1^2)
%  \\ &
  + \cdots
%  \\ & 
  + (a_1^2b_n^2 - 2a_1b_1a_nb_n + a_n^2b_1^2)
  \\ &
  + (a_2^2b_3^2 - 2a_2b_2a_3b_3 + a_3^2b_2^2)
%  \\ &
  + \cdots
%  \\ &
  + (a_2^2b_n^2 - 2a_2b_2a_nb_n + a_n^2b_2^2)
  \\ &
  + \cdots\cdots
  \\ &
  + (a_{n-1}^2b_n^2 - 2a_{n-1}b_{n-1}a_nb_n + a_n^2b_{n-1}^2)
  \\ &
  = (a_1b_2 - a_2b_1)^2
  + (a_1b_3 - a_3b_1)^2
  + \cdots
  + (a_1b_n - b_na_1)^2
  \\ &
  + (a_2b_3 - a_3b_2)^2
  + \cdots
  + (a_2b_n - b_na_2)^2
  \\ &
  + \cdots\cdots
  \\ &
  + (a_{n-1}b_n - b_na_{n-1})^2
  \\ &
  \ge 0.
\end{align*}
}繰り返しになるが計算のポイントは3つ目の等号である.
2つ目の等号の後の式の前者の括弧の中と後者の括弧の中の「対角成分」は互いにキ
ャンセルし, 前者と後者の括弧の中の $i<j$ に対する「$(i,j)$ 成分」と「$(j,i)$ 
成分」をまとめて並べ直せば3つ目の等号が成立することがわかる.

上の計算は $\cdots$ という記号を多用して視覚的直下に訴える方法を
取ったが $\cdots$ を $\sum$ で置き換えて以下のように計算することもできる:
\begin{align*}
  \bra a,a\ket \bra b,b\ket - \bra a,b\ket^2
  &
  = \sum_i a_i^2 \sum_j b_j^2
  - \sum_i a_ib_i \sum_j a_jb_j
  \\ &
  = \sum_{i,j} a_i^2b_j^2
  - \sum_{i,j} a_ib_ia_jb_j
  \\ &
  = \sum_i a_i^2b_i^2 + \sum_{i<j}(a_i^2b_j^2 + a_j^2b_i^2)
  - \sum_i (a_ib_i)^2 - \sum_{i<j} 2a_ib_ia_jb_j
  \\ &
  = \sum_{i<j}(a_i^2b_j^2 - 2a_ib_ia_jb_j + a_j^2b_i^2)
  \\ &
  = \sum_{i<j}(a_ib_j - a_jb_i)^2
  \ge 0.
\end{align*}
もう, うんざりしているかもしれないが, 計算のポイントは3つ目の等号である.
3つ目の等号では $(i,j)$ に関する和を $(i,i)$ に関する和と $i<j$ に
対する $(i,j)$ と $(j,i)$ に関する和に分解することによって得られる.
そして $(i,i)$ に関する和の部分がキャンセルして第4の等号が成立する.

同様の計算は区間 $[a,b]$ 上の実数値連続函数 $f$, $g$ の内積が
\begin{equation*}
  \bra f, g\ket = \int_a^b f(x)g(x)\,dx
\end{equation*}
と定義されている場合にも可能である.
実際 $S=[a,b]^2$, $T = \{\,(x,y)\in K\mid x<y\,\}$ と置くと%
\footnote{$S$ は square (正方形) の頭文字であり, $T$ は triangle 
  (三角形) の頭文字である.},
{\small
\begin{align*}
%  &
  \bra f,f\ket \bra g,g\ket - \bra f,g\ket^2
%  \\ 
  &
  = \int_a^b f(x)^2\,dx \int_a^b g(y)^2dy 
  - \int_a^b f(x)g(x)\,dx \int_a^b f(y)g(y)\,dy
  \\ &
  = \iint_K f(x)^2g(y)^2\,dx\,dy
  - \iint_K f(x)g(x)f(y)g(y)\,dx\,dy 
  \\ &
  = \iint_T \bigl(f(x)^2g(y)^2 + f(y)^2g(x)^2\bigr) \,dx\,dy
  - \iint_T 2f(x)g(x)f(y)g(y)\,dx\,dy
  \\ &
  = \iint_T \bigl(
      f(x)^2g(y)^2 - 2f(x)g(x)f(y)g(y) + f(y)^2g(x)^2
    \bigr) \,dx\,dy
  \\ &
  = \iint_T \bigl(f(x)g(y) - f(y)g(x)\bigr)^2 \,dx\,dy
  \ge 0.
\end{align*}
}もう説明の必要がないと思うが, 計算のポイントは3つ目の等号である.
3つ目の等号は正方形 $S=[a,b]^2$ 上での積分を
上三角 $T=\{x<y\}$ と下三角 $\{x>y\}$ の上での積分に分解し, 
後者の積分変数の $x,y$ を引っくり返して上三角 $T$ 上の積分にまとめ直すこと
によって得られる.  対角線 $x=y$ 上の積分を無視して良いのは対角線の
面積が $0$ であるからその上の積分が常に $0$ になるからだと考えてもよいし,
$\sum$ を用いた計算の場合と同様にキャンセルして消えると考えても構わない.

それでは $a,b$ が複素ベクトルだったり, $f,g$ が複素数値函数の場合はどのよう
に考えれば良いのだろうか?  様々な考え方があるが, もっとも素朴な考え方は複素
数 $z$ と2つの実数の組 $(x,y)$ が $z=x+iy$ によって一対一に対応していること
を用いて, 実ベクトルや実数値函数に関して得られた結果が複素ベクトルや複素数値
函数の場合にどのように翻訳されるかを考えてみることである.

まず, 複素1次元の場合について考えよう. 複素数1つと実数2つの組は一対一に対応
しているので1つの複素数は実2次元のベクトルだとみなすことができる.  
実2次元の場合の内積を複素数を用いて表現することを考えよう.
それができれば実 $2n$ 次元の場合の結果を複素 $n$ 次元の場合に翻訳できる.

$a,b\in\C$ が $a=a'+ia''$, $b=b'+ib''$ ($a',a'',b',b''\in\R$) と表わされてい
るとすると
\begin{equation*}
  \cc{a}b = (a'b' + a''b'') + i(a'b'' - a''b')
\end{equation*}
であるから
\begin{equation*}
  \Repart \cc{a}b = a'b' + a''b''.
\end{equation*}
右辺は実2次元ベクトル $\tp{[a',a'']}$ と $\tp{[b',b'']}$ の内積に一致してい
る%
\footnote{それでは虚部 $\Impart \cc{a}b = a'b'' - a''b'$ 
  は $\tp{[a',a'']}$ と $\tp{[b',b'']}$ の外積(もしくはベクトル積)になってい
  る.  より正確に説明すると以下の通りである. 

  ベクトル解析において2つの実3次元ベクトル %
  $\mathbf{a}=\tp{[a_1,a_2,a_3]}$, $\mathbf{b}=\tp{[b_1,b_2,b_3]}$
  に対して{\bf 外積 (outer product)}もしくは{\bf ベクトル積 (vector product)} 
  が次のように定義される:
  \begin{equation*}
    \mathbf{a}\times\mathbf{b} = 
    \tp{[
      a_2b_3-a_3b_2,\,
      a_3b_1-a_1b_3,\,
      a_1b_2-a_2b_1
    ]}.
  \end{equation*}
  よって $\mathbf{a}=\tp{[a',a'',0]}$, $\mathbf{b}=\tp{[b',b'',0]}$ なら
  ば $\mathbf{a}\times\mathbf{b}=\tp{[0,0,a'b''-a''b']}$ の第 $3$ 成分
  は $\Impart \cc{a}b$ に一致する.

  $\mathbf{a}\times\mathbf{b}$ は $\mathbf{a}$ と $\mathbf{b}$ に垂直でその
  長さが $\mathbf{a}$, $\mathbf{b}$ を2辺とする平行四辺形の面積に等しいベク
  トルになる.  そのようなベクトルは2つ存在するが $\mathbf{a}\times\mathbf{b}$ 
  は $(\mathbf{a},\mathbf{b},\mathbf{a}\times\mathbf{b})$ が右手系をなすよう
  に選ばれている.

  特に $a'b''-a''b'$ はベクトル $\tp{[a',a'']}$ と $\tp{[b',b'']}$ を2辺とす
  る平行四辺形の面積に等しい.  (そのことを証明してみよ.)

  複素数を使えば実2次元ベクトルの世界を1つの数で扱うことができる.
  実は同様に Hamilton の四元数を用いれば実3次元ベクトルの世界を1つの数で
  扱うことができる.  研究してみよ.
  }.  %
そして $|a|$, $|b|$ はそれぞれ
実2次元ベクトル $\tp{[a',a'']}$ と $\tp{[b',b'']}$ のノルムに等しいことも
わかる.
よって, 実2次元の場合の Cauchy-Schwarz の不等式は次のように翻訳される:
\begin{equation*}
  |\Repart \cc{a}b| \le |a|\cdot|b|.
\end{equation*}
この不等式は複素数についてよく理解していれば自明であるが,
実ベクトルの Cauchy-Schwarz の不等式を複素ベクトルの場合に翻訳するときの
出発点になるだけではなく, 本質的な議論はこれで尽きているのである.

複素 $n$ 次元ベクトル $a=\tp{[a_1,\dots,a_n]}\in\C^n$ が与えられている
とき, 各成分 $a_k$ を $a_k = a'_k + ia''_k$ ($a'_k,a''_k\in\R$) と表わして
おき, 実 $2n$ 次元ベクトル $\mathbf{a}\in\R^{2n}$ を $
  \mathbf{a} = \tp{[a'_1,a''_1,\dots,a'_n,a''_n]}
$ と定める.  $b\in\C^n$ に対する $\mathbf{b}\in\R^{2n}$ も同様とする.
複素 $n$ 次元ベクトル $a$, $b$ の内積と
実 $2n$ 次元ベクトル $\mathbf{a}$, $\mathbf{b}$ の内積が
次のように定められているとする:
\begin{equation*}
  \bra a,b\ket 
  = \sum_{k=1}^n \cc{a_k}b_k
  \in\C,
  \qquad
  \bra\mathbf{a},\mathbf{b}\ket 
  = \sum_{k=1}^n (a'_kb'_k + a''_kb''_k)
  \in\R.
\end{equation*}
このとき上の方で説明した $n=1$ の場合の結果より,
\begin{equation*}
  \Repart \bra a,b\ket 
  = \sum_{k=1}^n \Repart \cc{a_k}b_k
  = \sum_{k=1}^n (a'_kb'_k + a''_kb''_k)
  = \bra\mathbf{a},\mathbf{b}\ket.
\end{equation*}
そして複素 $n$ 次元ベクトルのノルム $\norm{a}$, $\norm{b}$ はそれぞれ
実 $2n$ 次元ベクトルのノルム $\norm{\mathbf{a}}$, $\norm{\mathbf{b}}$ の
ノルムに等しいこともわかる.
よって実 $2n$ 次元ベクトルに関する Cauchy-Schwarz の不等式は次のように
翻訳される:
\begin{equation*}
  |\Repart \bra a,b\ket| \le \norm{a}\cdot\norm{b}.
\end{equation*}
この結果から複素ベクトルの Cauchy-Schwarz の不等式
\begin{equation*}
  |\bra a,b\ket| \le \norm{a}\cdot\norm{b}
\end{equation*}
が容易に導かれる.  実際 $\bra a,b\ket$ を $\bra a,b\ket=re^{i\theta}$ 
($r\ge 0$, $\theta\in\R$) と極表示すると,
\begin{equation*}
  |\bra a,b\ket|
  = r
  = e^{-i\theta}\bra a,b\ket
  = \bra a, e^{-i\theta}b\ket
  = \Repart \bra a, e^{-i\theta}b\ket
  \le \norm{a}\cdot\norm{e^{-i\theta}b}
  = \norm{a}\cdot\norm{b}.
\end{equation*}
ここまでたどり着けば複素ベクトルの場合の Cauchy-Schwarz の不等式も怖くないは
ずである.

しかし, これで満足してはいけない.  なぜならば我々は2つの実ベクトルの成分の積
の和によって内積を定義するところから出発したからである.  
必ずしも内積がそのように定義されるとは限らない.
出発点でベクトルの成分を使っているせいで必要最小限どれだけの条件
があれば Cauchy-Schwarz の不等式が成立するかもはっきりしていない.

この問題への1つの回答の仕方は公理的な考え方をすることである.
内積が満たすべき必要最小限の条件は何か, その条件だけを用いて Cauchy-Schawarz 
の不等式を証明できないか,  その直観的意味は何であるか,  などなどに関する答は
多くの線形代数の教科書に書いてある.

この演習でもその考え方に沿って内積の基本性質 \qref{q:inner-prod-axioms} およ
び Cauchy-Schwarz の不等式を証明する問題 \qref{q:Cauchy-Schwarz} のヒントに
最終的な結果がまとめられている.  
虫食い状態になった問題 \qref{q:Cauchy-Schwarz} の解答例を以下に書いておこう.

\bigskip
\noindent
{\bf Cauchy-Schwarz の不等式:}\enspace
$V$ は複素ベクトル空間であり, $\bra\ ,\ \ket$ は $V$ における内積であるとする.
このとき任意の $a,b\in V$ に対して, $|\bra a,b\ket|\le\norm{a}\cdot\norm{b}$ 
が成立し, 等号が成立するための必要十分条件は $a$, $b$ の一方がもう一方の複素
数倍になることである.

\medskip
\noindent
{\bf 証明:}\enspace
$a\ne0$ と仮定して良い.  
$c=b-za$ が $a$ と直交するように $z\in\C$ を定めよう.
$0 = \bra a,c\ket = \text{\fbox{\tiny\ ア\ }} - z\text{\fbox{\tiny\ イ\ }}$ 
より $z = \text{\fbox{\tiny\ ア\ }}/\text{\fbox{\tiny\ イ\ }}$ とすれば $c$ は $a$ と直交する.
このとき, 
\begin{equation*}
  0 \le \bra c,c\ket
    = \bra b - za, c\ket
    = \text{\fbox{\tiny\ ウ\ }}
    = \text{\fbox{\tiny\ エ\ }} - z\text{\fbox{\tiny\ オ\ }}
    = \norm{b}^2 - \frac{|\bra a,b\ket|^2}{\norm{a}^2}.
\end{equation*}
ここで, 2つ目の等号で $a$ と $c$ が直交することを用いた.  最初の不等号で
等号が成立するための必要十分条件は $c=0$ すなわち $b=za$ である.
これで Cauchy-Schwarz の不等式が証明された.
\qed

\bigskip

虫に食われた部分を埋めて, この証明が実際に内積の基本性質 (公理) のみを用いて
遂行可能であることをチェックせよ.

\commentout{
\bigskip
\noindent
{\bf 虫に食われていない証明:}\enspace
$a\ne0$ と仮定して良い.  
$c=b-za$ が $a$ と直交するように $z\in\C$ を定めよう.
$0 = \bra a,c\ket = \bra a,b\ket - z\bra a,b\ket$ 
より $z = \bra a,b\ket/\bra a,b\ket$ とすれば $c$ は $a$ と直交する.
このとき, 
\begin{equation*}
  0 \le \bra c,c\ket
    = \bra b - za, c\ket
    = \bra b,c\ket
    = \bra b,b\ket - z\bra b,a\ket
    = \norm{b}^2 - \frac{|\bra a,b\ket|^2}{\norm{a}^2}.
\end{equation*}
ここで, 2つ目の等号で $a$ と $c$ が直交することを用いた.  最初の不等号で
等号が成立するための必要十分条件は $c=0$ すなわち $b=za$ である.
これで Cauchy-Schwarz の不等式が証明された.
\qed
}

\bigskip

二次函数の判別式を用いて Cauchy-Schwarz の不等式を証明することもできる.

まず, $V$ は実ベクトル空間であり, $\bra\ ,\ \ket$ は $V$ における内積である
とし, $a,b\in V$, $a\ne 0$ と仮定する. 
このとき $t\in\R$ の実数値函数 $f(t)$ を
\begin{equation*}
  f(t) 
  = \bra b - ta, b - ta\ket
  = \norm{a}^2 t^2 - 2\bra a,b\ket t + \norm{b}^2
\end{equation*}
と定めると, $f(t)\ge 0$ である.  よって $f(t)$ の判別式 $D$ は $0$ 以下でな
ければいけない:
\begin{equation*}
  0 \ge \frac{D}{4} = \bra a,b\ket^2 - \norm{a}^2\norm{b}^2.
\end{equation*}
これで $|\bra a,b\ket| \le \norm{a}\cdot\norm{b}$ が証明された.

次に, $V$ は実ベクトル空間であり, $\bra\ ,\ \ket$ は $V$ における内積である
とし, $a,b\in V$, $a\ne 0$ と仮定する.
このとき $z\in \C$ の複素数値函数 $f(z)$ を
\begin{equation*}
  f(z) = \bra b - za, b - za\ket
  = \norm{a}^2 |z|^2 - 2\Repart(\cc{z}\bra a,b\ket) + \norm{b}^2
\end{equation*}
と定めると, $f(z)\ge 0$ である.  しかし $f(z)$ は実二次函数ではないので
判別式による判定法は使えない.  

そこで $z=t\in\R$ と置くと,
\begin{equation*}
  f(z) = \norm{a}^2 t^2 - 2(\Repart\bra a,b\ket)t + \norm{b}^2.
\end{equation*}
$f(z)\ge 0$ なので右辺の判別式 $D$ は $0$ 以下である:
\begin{equation*}
  0 \ge \frac{D}{4} = |\Repart\bra a,b\ket|^2 - \norm{a}^2\norm{b}^2.
\end{equation*}
よって $|\Repart\bra a,b\ket|\le\norm{a}\cdot\norm{b}$ である.
この不等式から Cauchy-Schwarz の不等式が容易に導かれるのであった.

さらに工夫して $\bra a,b\ket$ を $\bra a,b\ket = r e^{i\theta}$ 
($r\ge 0$, $\theta\in\R$) と極表示し, $z = te^{i\theta}$ ($t\in\R$) と
置くと, $\cc{z}\bra a,b\ket = rt = |\bra a,b\ket|t$ なので,
\begin{equation*}
  f(z) = \norm{a}^2 t^2 - 2|\bra a,b\ket|t + \norm{b}^2.
\end{equation*}
$f(z)\ge 0$ なので右辺の判別式 $D$ は $0$ 以下である:
\begin{equation*}
  0 \ge \frac{D}{4} = |\bra a,b\ket|^2 - \norm{a}^2\norm{b}^2.
\end{equation*}
これで $|\bra a,b\ket| \le \norm{a}\cdot\norm{b}$ が直接に証明された.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{正規行列}
\label{sec:normal-matrix}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{正規行列, Hermite 行列, 反 Hermite 行列, ユニタリー行列}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

複素 $n$ 次正方行列 $A$ について, 
\begin{itemize}
\item $A$ は{\bf 正規行列 (normal matrix)} $\iff$ $A^*A=AA^*$;
\item $A$ は{\bf  Hermite 行列 (Hermitian matrix)} $\iff$ $A^*=A$;
\item $A$ は{\bf 反 Hermite 行列 (anti-Hermitian matrix, skew-Hermitian
    matrix)} $\iff$ $A^* = -A$;
\item $A$ は{\bf ユニタリー行列 (unitary matrix)} $\iff$ 
  $A^*A = AA^* = E$.
\end{itemize}
実 $n$ 次正方行列 $A$ について,
\begin{itemize}
\item $A$ は{\bf 実正規行列} $\iff$ $\tp{A}A=A\tp{A}$; 
\item $A$ は{\bf 実対称行列 (real symmetrix matrix)} $\iff$
  $\tp{A}=A$; 
\item $A$ は{\bf 実交代行列 (real alternating matrix, real anti-symmetric 
    matrix, real skew-symmetric matrix)} $\iff$ $\tp{A}=-A$;
\item $A$ は{\bf 直交行列 (orthogonal matrix)} $\iff$
  $\tp{A}A=A\tp{A}=E$. 
\end{itemize}
これらのすべての行列は正規行列の特別な場合である. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:normal-matrix-misc}
  複素 $n$ 次正方行列 $A$ について, 
  \begin{enumerate}
  \item $A$ は正規行列 $\iff$ 
    $\bra Ax,Ay\ket = \bra A^*x,A^*y\ket$ \quad ($x,y\in\C^n$);
  \item $A$ は Hermite 行列 $\iff$ 
    $\bra Ax,y\ket = \bra x,Ay\ket$ \quad ($x,y\in\C^n$);
  \item $A$ は反 Hermite 行列 $\iff$ 
    $\bra Ax,y\ket = - \bra x,Ay\ket$ \quad ($x,y\in\C^n$);
  \item $\sqrt{-1}A$ は反 Hermite 行列 $\iff$ $A$ は Hermite 行列;
  \item $A$ はユニタリー行列 $\iff$ 
    $\bra Ax,Ay\ket = \bra x,y\ket$ \quad ($x,y\in\C^n$);
  \item $A$ はユニタリー行列 $\iff$ 
    $\norm{Ax} = \norm{x}$ \quad ($x\in\C^n$).
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 最後の結論を導くには \qref{q:inner=norm} を使えば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  上と類似の問題を実 $n$ 次正方行列に
  ついて定式化し, それを証明せよ.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ が反 Hermite 行列ならば $e^A$ はユニタリー行列である.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Pauli のスピン行列]
\label{q:Pauli-spin-matrices}
  行列 $\sigma_1$, $\sigma_2$, $\sigma_3$ を次のように定める:
  \begin{equation*}
    \sigma_1=
    \begin{bmatrix}
      0 & 1 \\
      1 & 0 \\
    \end{bmatrix},
    \quad
    \sigma_2=
    \begin{bmatrix}
      0 & -i \\
      i & 0 \\
    \end{bmatrix},
    \quad
    \sigma_3=
    \begin{bmatrix}
      1 & 0 \\
      0 & -1 \\
    \end{bmatrix}.
  \end{equation*}
  これらを {\bf Pauli のスピン行列 (Pauli's spin matrix)} と呼ばれている. 
  Pauli のスピン行列は Hermite 行列である.  実数 $t\in\R$ に
  対して $e^{it\sigma_k}$ ($k=1,2,3$) を計算し, 
  ユニタリー行列になることを確かめよ. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ が実交代行列ならば $e^A$ は直交行列である.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  実交代行列の例を1つ (それを $A$ と書く) を挙げ, 
  実数 $t\in\R$ の函数 $e^{tA}$ を計算し, 直交行列になることを確かめよ.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{正規行列の対角化 (Toeplitz の定理)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

さてこの節の第一の目標は, 「複素 $n$ 次正方行列が正規行列であるための必要十
分条件はユニタリー行列で対角化可能であることである」という結果 (Toeplitz の
定理) を証明することである.  (実際にはその概略を示し, 細部を演習問題として解
いてもらうことになる.)

しかし, 「ユニタリー行列で対角化可能」の意味を説明しておかないとこの結果がど
うして素晴しいかを理解できなくなってしまう.  そこでまず「行列の対角化」と
「ユニタリー行列」について説明しておこう.

以下しばらくのあいだ単に行列と言えば複素 $n$ 次正方行列を意味するものとする.

2つの行列 $A$ と $B$ が{\bf 相似 (similar)} であるとは, 
ある正則行列 $P$ が存在して $P^{-1}AP = B$ が成立することである.

行列 $A=[a_{ij}]$ の成分 $a_{ij}$ は $\C^n$ の標準的な基底 $e_1,\dots,e_n$ 
に $A$ を作用させれば表われる:
\begin{equation*}
  A e_j
  = a_{1j} e_1 + \cdots + a_{nj} e_n 
  = e_1 a_{1j} + \cdots + e_n a_{nj}.
\end{equation*}
しかし, $\C^n$ には標準的でない基底が無限に存在する.  行列 $A$ が定める一次
変換の様子を理解するためには標準的な基底が必ずしも便利だとは限らない.  そこ
で, $\C^n$ の任意の基底 $p_1,\dots,p_n$ を取ると, 
$A p_i$ は $p_1,\dots,p_n$ の一次結合で一意的に表わされる:
\begin{equation*}
    A p_j
  = b_{1j} p_1 + \cdots + b_{nj} p_n
  = p_1 b_{1j} + \cdots + p_n b_{nj}
  \qquad (b_{ij}\in\C).
\end{equation*}
この式は行列を使って次のようにまとめることができる:
\begin{equation*}
  A [p_1\ \cdots\ p_n]
  =
  [p_1\ \cdots\ p_n]
  \begin{bmatrix}
    b_{11} & \cdots & b_{1n} \\
    \vdots &        & \vdots \\
    b_{n1} & \cdots & b_{nn} \\
  \end{bmatrix}.
\end{equation*}
よって, 行列 $P$, $B$ を $P=[p_1\ \cdots\ p_n]$, $B = [b_{ij}]$ と定めると,
$P$ は正則行列になり,
\begin{equation*}
  AP = PB, \quad \text{すなわち}\  P^{-1}AP=B.
\end{equation*}
よって, 行列 $A$ は行列 $B$ と相似である.  以上の議論はすべて逆転させること
ができる.  もしも行列 $A$, $B$ が相似であり,  $P^{-1}AP=B$ という関係にある
とき, $P$ の中の $n$ 本の列ベクトルのなす $\C^n$ の基底 $p_1,\dots,p_n$ に関
して $A$ の定める一次変換を表示して得られる行列が $B$ になる.

つまり, 行列 $A$ と相似な行列を考えることと $A$ の定める一次変換を標準的とは
限らない任意の基底を用いて表示し直すことは同じことである.

もしも, 行列 $A$ と相似な対角行列 $D=\diag(\alpha_1,\dots,\alpha_n)$ が存在
するとき, $A$ は{\bf 対角化可能 (diagonalizable)} もしく
は {\bf 半単純 (semisimple)} であると言う.  そのとき, $D$ は $A$ の対角化と
呼ばれる. 

さて, 行列 $A$ が $P^{-1}AP=D=\diag(\alpha_1,\dots,\alpha_n)$ と対角化可能で
あるとする.  このとき, $P$ の中の $n$ 本の列ベクトルを $p_1,\dots,p_n$ とす
ると, 
\begin{equation*}
  A [p_1\ \cdots\ p_n] = 
  [p_1\ \cdots\ p_n]
  \begin{bmatrix}
    \alpha_1  &        & \bigzerou \\
              & \ddots &           \\
    \bigzerol &        & \alpha_n  \\
  \end{bmatrix}.
\end{equation*}
これはさらに次のように書き直される:
\begin{equation*}
  A p_j = \alpha_j p_j \qquad (j=1,\dots,n).
\end{equation*}
すなわち, $\alpha_j$ は $A$ の固有値であり, $p_j$ はそれに付随する固有ベクト
ルである.  対角化可能な行列 $A$ の対角化は $A$ の固有ベクトルだけで構成され
る $\C^n$ の基底を求めることと同値である.  

さて, $\C^n$ の標準的な基底は標準的な内積に関して正規直交基底をなすのであっ
た.  上の議論では新たな基底 $p_1,\dots,p_n$ として正規直交基底とは限らない任
意の基底を考えた.  しかし, もしも可能ならば $p_1,\dots,p_n$ を正規直交基底に
取れれば便利である.  問題 \qref{q:unitary-orthonormal} の結果より, 
$p_1,\dots,p_n$ が正規直交基底であることと $P=[p_1\ \cdots\ p_n]$ がユニタリ
ー行列であることは同値である.  よって, 上の議論で新たな基底を正規直交基底に
制限することは, 正則行列 $P$ としてユニタリー行列のみを考えることと同値であ
る.

行列 $A$ がユニタリー行列 $P$ で対角化可能であるとは $P^{-1}AP$ が対角行列に
なることである.

\begin{question}
  $A$ が正規行列であり, $P$ がユニタリー行列であれば, $P^{-1}AP$ も正規行列
  である.  同様の結果が Hermite 行列, 反 Hermite 行列, ユニタリー行列につい
  ても成立する.
  \qed
\end{question}

\begin{question}
  $A$ が実正規行列であり, $Q$ が実直交行列であれば, $Q^{-1}AQ$ も実正規行列
  である.  同様の結果が実対称行列, 実交代行列, 実直交行列についても成立する.
  \qed
\end{question}

\begin{question}
\label{q:Toeplitz-easy}
  行列 $A$ がユニタリー行列で対角化可能であれば $A$ は正規行列である. 
  すなわち, あるユニタリー行列 $P$ で $P^{-1}AP$ が対角行列になるものが存在
  するならば $A$ は正規行列である.
  \qed
\end{question}

\noindent
ヒント: 対角行列は正規行列である.
\qed

\medskip

上の問題 \qref{q:Toeplitz-easy} の結果の逆を Toeplitz の定理と呼ぶ.  この節
の第一の目標は Toeplitz の定理を示すことである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[任意の行列の三角化可能性]
\label{q:triangularizable}
  任意の複素 $n$ 次正方行列 $A$ に対して,
  あるユニタリー行列 $P$ で $P^{-1}AP$ が上三角行列になるものが存在する.
  \qed
\end{question}

\noindent
ヒント: $n$ に関する数学的帰納法.  $A$ の固有値 $\alpha$ とそれに付随する固
有ベクトル $v$ が存在する. $v$ は単位ベクトルに取れ, $v$ を含む
正規直交基底 $p_1=v,p_2,\dots,p_n$ が取れる.  
このとき, $P=[p_1\ \cdots\ p_n]$ と置くと, $P^{-1}AP$ は次の形になる:
\begin{equation*}
  P^{-1}AP = 
  \begin{bmatrix}
    \alpha & b_{12} & \cdots & b_{1n} \\
       0   & b_{22} & \cdots & b_{2n} \\
    \vdots & \vdots &        & \vdots \\
       0   & b_{n2} & \cdots & b_{nn} \\
  \end{bmatrix}.
\end{equation*}
行列 $B=[b_{ij}]_{2\le i,j\le n}$ に帰納法の仮定を用いよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Toeplitz の定理]
\label{q:Toeplitz}
  任意の正規行列 $A$ に対してユニタリー行列 $P$ で $P^{-1}AP$ が対角行列にな 
  るものが存在する. すなわち, $\C^n$ の正規直交基底 $p_1,\dots,p_n$ で
  \begin{equation*}
    A p_j = \alpha_j p_j, \qquad \alpha_j \in \C
  \end{equation*}
  を満たすものが存在する. \qed
\end{question}

\noindent
ヒント: \qref{q:triangularizable} より, 正規な上三角行列が対角行列であること
を示せば十分である.  $A$ を正規な上三角行列であるとし, $A^*A=AA^*$ の両辺の
対角成分を比較してみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  正規行列 $A$ の異なる固有値に属する固有ベクトルは互いに直交する.  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  以下を示せ:
  \begin{enumerate}
  \item Hermite 行列と実対称行列の固有値は実数である.
  \item 反 Hermite 行列と実交代行列の固有値は純虚数%
    \footnote{虚数単位の実数倍を純虚数と呼ぶ.}である.
  \item ユニタリー行列と実直交行列の固有値の絶対値は $1$ である.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実正規行列の標準形}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[半単純実行列の標準形]
\label{q:real-semisimple}
  $A$ は実 $n$ 次正方行列であり, 複素正則行列を用いて対角化可能であるとする.
  このとき, 実正則行列 $Q$ で $Q^{-1}AQ$ が次の形になるものが存在する:
  \begin{equation*}
    Q^{-1}AQ =
    \begin{bmatrix}
      \alpha_1 &        &          &       &     &        &       &     \\
               & \ddots &          &       &     &        &       &     \\
               &        & \alpha_r &       &     &        &       &     \\
               &        &          &   a_1 & b_1 &        &       &     \\
               &        &          & - b_1 & a_1 &        &       &     \\
               &        &          &       &     & \ddots &       &     \\
               &        &          &       &     &        &   a_s & b_s \\
               &        &          &       &     &        & - b_s & a_s \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $r+2s=n$ かつ $\alpha_j,a_k,b_k\in\R$ であり, $b_k\ne 0$. 
  このとき, $\alpha_j$ の全体は $A$ の特性多項式の実数根の全体に一致し,
  $a_k\pm b_k i$ の全体は $A$ の特性多項式の虚数根全体に一致する. \qed
\end{question}

\noindent
ヒント: 実数の固有値に付随する固有ベクトルは実ベクトルに取れる.
虚数の固有値に付随する固有ベクトルは次のように処理する. 
$a,b\in\R$, $\alpha=a+bi$, $Ap=\alpha p$ のとき, $A$ が実行列
ならば $A\bar{p}=\bar{\alpha}\bar{p}$ である
から, $x = \Repart p = (p+\bar{p})/2$, %
$y = \Impart p = (p-\bar{p})/(2i)$ と
置くと, $Ax = ax - by$, $Ay = bx + ay$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実正規行列に対する Toeplitz の定理]
\label{q:real-Toeplitz}
  任意の実正規行列 $A$ に対して直交行列 $Q$ で $Q^{-1}AQ$ が次の形になるもの
  が存在する:
  \begin{equation*}
    Q^{-1}AQ =
    \begin{bmatrix}
      \alpha_1 &        &          &       &     &        &       &     \\
               & \ddots &          &       &     &        &       &     \\
               &        & \alpha_r &       &     &        &       &     \\
               &        &          &   a_1 & b_1 &        &       &     \\
               &        &          & - b_1 & a_1 &        &       &     \\
               &        &          &       &     & \ddots &       &     \\
               &        &          &       &     &        &   a_s & b_s \\
               &        &          &       &     &        & - b_s & a_s \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $r+2s=n$ かつ $\alpha_j,a_k,b_k\in\R$ であり, $b_k\ne 0$. 
  このとき, $\alpha_j$ $a_k \pm b_k i$ の全体は $A$ の特性多項式の根の全体に
  一致している.  \qed
\end{question}

\noindent
ヒント: 佐武 \cite{satake} の 170--171 頁.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実対称行列の対角化]
\label{q:real-symmetric}
  実対称行列 $A$ に対してある直交行列 $Q$ で $Q^{-1}AQ$ が実対角行列になるも
  のが存在する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実交代行列の標準形]
\label{q:real-alternating}
  実交代行列 $A$ に対してある直交行列 $Q$ で $Q^{-1}AQ$ が次の形になるものが
  存在する:
  \begin{equation*}
    Q^{-1}AQ =
    \begin{bmatrix}
         0     &        &          &       &     &        &       &     \\
               & \ddots &          &       &     &        &       &     \\
               &        &    0     &       &     &        &       &     \\
               &        &          &    0  & b_1 &        &       &     \\
               &        &          & - b_1 & 0   &        &       &     \\
               &        &          &       &     & \ddots &       &     \\
               &        &          &       &     &        &    0  & b_s \\
               &        &          &       &     &        & - b_s & 0   \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $b_k\in\R$ かつ $b_k\ne 0$. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[直交行列の標準形]
\label{q:orthogonal}
  直交行列 $A$ に対してある直交行列 $Q$ で $Q^{-1}AQ$ が次の形になるものが
  存在する:
  \begin{equation*}
    Q^{-1}AQ =
    \begin{bmatrix}
      E_{r_1} &          &               &              &        & & \\
              & -E_{r_2} &               &              &        & & \\
              &          &  \cos\theta_1 & \sin\theta_1 &        & & \\
              &          & -\sin\theta_1 & \cos\theta_1 &        & & \\
              &          &               &              & \ddots & & \\
              &          &               &              &        &  \cos\theta_s & \sin\theta_s \\
              &          &               &              &        & -\sin\theta_s & \cos\theta_s \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $r_1+r_2+2s=n$ かつ $\theta_k\in\R$ であり, $E_r$ は $r$ 次の単位
  行列である. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

\noindent
{\Large 　以上の結果は非常に有用である.  なぜならば多くの意味のある行列は正
  規行列になっているからである.  正規行列はユニタリー行列で対角化可能である.
  実正規行列は直交行列によって標準形に変換できる.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Cayley-Hamilton の定理}
\label{sec:Cayley-Hamilton}

以下, 単に「数」「$n$ 次正方行列」を言えば「複素数」「複素 $n$ 次正方行列」
であることにする.  体について知っている人は「体 $K$ の元」「$K$ の元を成分に
持つ $n$ 次正方行列」であると考えても良い.  $E$ は $n$ 次単位行列であるとす
る. 

数を係数とする多項式 $f(\lambda)=\sum_{i=1}^N a_i\lambda^i$ と $n$ 次正方行
列 $A$ に対して, $n$ 次正方行列 $f(A)$ を次のように定義する:
\begin{equation*}
  f(A) = \sum_{i=0}^N a_i A^i 
  = a_N A^N + a_{N-1}A^{N-1} + \cdots + a_1 A + a_0 E
\end{equation*}
$f(\lambda)$ の定数項 $a_0$ が $f(A)$ では $a_0 E$ となっていることに注意せ
よ.

\begin{theorem}[Cayley-Hamilton の定理]
  任意の $n$ 次正方行列 $A$ と
  その特性多項式 $p_A(\lambda)=\det(\lambda E - A)$ に
  ついて $p_A(A)=0$.  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Cayley-Hamilton の定理の直接的証明}
\label{sec:CH-direct}

{\bf Cayley-Hamilton の定理の直接的証明:} 
$A=[a_{ij}]$ は $n$ 次正方行列であるとし, 
その特性多項式を $p_A(\lambda)=\det(\lambda E - A)$ と表わす.
$\lambda E - A$ の $(i,j)$ 余因子を $f_{ij}(\lambda)$ と書くと,
\begin{equation*}
  p_A(\lambda)\delta_{ik}
  = \sum_{j=1}^n f_{ij}(\lambda) (\delta_{kj}\lambda - a_{kj}).
\end{equation*}
この等式の両辺は $\lambda$ の多項式なので $\lambda$ に $A$ を代入できる:
\begin{equation*}
  p_A(A)\delta_{ik} = \sum_{j=1}^n f_{ij}(A)(\delta_{kj}A - a_{kj}E).
\end{equation*}
さらにこの等式の両辺を $e_k$ に%
\footnote{$e_1,\dots,e_n$ は $K^n$ の標準的な基底.}%
左から作用させて $k=1,\dots,n$ について和を取ると, 
\begin{equation*}
  p_A(A)e_i
  = \sum_{j=1}^n f_{ij}(A)\Bigl( A e_j - \sum_{k=1}^n a_{kj} e_k \Bigr)
  = 0.
\end{equation*}
最後の等号は $Ae_j=\sum_{k=1}^n e_k a_{kj}$ から出る. 
よって $p_A(A)=0$ である.
\qed

\begin{question}
  上の証明の細部を埋め, 黒板を用いて詳しく説明せよ. \qed
\end{question}

Cayley-Hamilton の定理の上のような証明の背後には
行列係数の多項式の剰余定理が隠れている.  
直接的に行列版の剰余定理を用いることを避けている分だけ
証明が簡単になっている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{行列係数多項式の剰余定理を用いた証明}
\label{sec:CH-remainder}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

以下の証明の方針は杉浦 \cite{sugiura} の65--66頁にある.  

\begin{question}[行列係数多項式の剰余定理]
\label{q:matrix-remainder-theorem}
  $A$ は $n$ 次正方行列であり, 
  $F(\lambda)$ は $n$ 次正方行列を係数とする $\lambda$ の多項式であるとする:
  \begin{equation*}
    F(\lambda) = \sum_{i=0}^N F_i \lambda^i = \sum_{i=0}^N \lambda^i F_i,
    \qquad \text{$F_i$ は $n$ 次正方行列}.
  \end{equation*}
  このとき, 以下が成立する:
  \begin{enumerate}
  \item[(1)] $n$ 次正方行列 $R$ と $n$ 次正方行列を係数とする $\lambda$ の多 
    項式 $Q(\lambda)$ で
    \begin{equation*}
      F(\lambda) = Q(\lambda)(\lambda E - A) + R
    \end{equation*}
    を満たすものが一意に存在し, 次が成立する:
    \begin{equation*}
      R = \sum_{i=0}^N F_i A^i.
    \end{equation*}
  \item[(2)] $n$ 次正方行列 $R$ と $n$ 次正方行列を係数とする $\lambda$ の多 
    項式 $Q(\lambda)$ で
    \begin{equation*}
      F(\lambda) = (\lambda E - A)Q(\lambda) + R
    \end{equation*}
    を満たすものが一意に存在し, 次が成立する:
    \begin{equation*}
      R = \sum_{i=0}^N A^i F_i.
    \end{equation*}
  \item[(3)] 数が係数の任意の多項式 $f(\lambda)$ に対して, 
    $f(A)=0$ (行列としてゼロ) が成立するための必要十分条件は
    ある $n$ 次正方行列係数の多項式 $G(\lambda)$ 
    で $f(\lambda)E = G(\lambda)(\lambda E - A)$ を満たすものが
    存在することである.
  \item[(4)] 数が係数の任意の多項式 $f(\lambda)$ に対して, 
    $f(A)=0$ (行列としてゼロ) が成立するための必要十分条件は
    ある $n$ 次正方行列係数の多項式 $G(\lambda)$ 
    で $f(\lambda)E = (\lambda E - A)G(\lambda)$ を満たすものが
    存在することである.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $\lambda E - A$ に関して割り算の筆算の仕方がそのまま成立していること 
がすぐにわかる.  ただし, 行列の積の順序は一般に交換不可能なので右割り算と左
割り算の区別をしなければいけないことに注意しなければいけない.
たとえば $N=3$ の場合にその筆算を実行してみよ.  
一般の $N$ でも場合も同様であることがすぐに納得できるだろう.

証明の方針は以下の通り. 
(2), (4) は (1), (3) と同様に証明できるので, (1), (3) のみについて証明の方針
を説明する.

(1)の証明の方針: $N$ に関する数学的帰納法によって $R$, $Q(\lambda)$ の存在
を証明する.  (帰納法の仮定に $R$ の形に関する仮定も入れておく.)
$R$, $Q(\lambda)$ の一意性を示すために, $R_1$, $Q_1(\lambda)$ 
も $F(\lambda) = Q_1(\lambda)(\lambda E - A) + R_1$ を満たしていると仮定する.  
そのとき, $(Q(\lambda) - Q_1(\lambda))(\lambda E - A) = R_1 - R$ であるから, 
もしも $Q(\lambda) \ne Q_1(\lambda)$ ならば左辺には $\lambda$ を含む項が残る
が, 右辺は定数行列なので矛盾する. 
よって, $Q(\lambda) = Q_1(\lambda)$ かつ $R_1 = R$ である. 

(3)の証明の方針: $F(\lambda)=f(\lambda)E$ に (1) を適用すれば, ある行列係数
の多項式 $Q(\lambda)$ が存在して
\begin{equation*}
  f(\lambda)E = Q(\lambda)(\lambda E - A) + f(A)
\end{equation*}
が成立する.  よって, $f(A)=0$ ならば $G(\lambda)=Q(\lambda)$ と
置けば $f(\lambda)E = G(\lambda)(\lambda E - A)$ を満たす $G(\lambda)$ の存
在が示される.  逆に, そのような $G(\lambda)$ が存在するならば, (1) の一意性
の主張より $G(\lambda)=Q(\lambda)$ かつ $0 = f(A)$ である. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\medskip
\noindent
参考: 一般に行列係数のモニックな多項式による割り算も同様に可能である.  ここ
で, 行列係数の多項式が{\bf モニック (monic)} であるとは最高次の係数が単位行
列であることである.

\begin{question}
  $F(\lambda)$, $A(\lambda)$ は $n$ 次正方行列係数の多項式であり, 
  $A(\lambda)$ はモニックでかつ $d$ 次であるとする
  (すなわち $A(\lambda)$ の最高次の項は $E \lambda^d$). 
  このとき, $n$ 次正方行列係数の多項式 $Q(\lambda)$ と
  次数が $d-1$ 以下の $n$ 次正方行列係数の多項式 $R(\lambda)$ で
  \begin{equation*}
    F(\lambda) = Q(\lambda)A(\lambda) + R(\lambda)
  \end{equation*}
  を満たすものが一意的に存在する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:matrix-remainder-theorem} の(3)または(4)を用いて, 
  Cayley-Hamilton の定理を証明せよ. \qed
\end{question}

\noindent
ヒント: 一般に $n$ 次正方行列 $X$ に対して,
その $(j,i)$ 余因子を $(i,j)$ 成分に持つ $n$ 次正方行列を $\Delta$ と
書くと, $\Delta X = X \Delta = \det(X)E$ が成立する.  
この結果を $X = \lambda E - A$ に適用する.  $\lambda E - A$ 
の $(j,i)$ 余因子を $(i,j)$ 成分に持つ行列を $G(\lambda)$ と書くと, 
$G(\lambda)(\lambda E - A) = (\lambda E - A)G(\lambda) = p_A(\lambda) E$.
\qed

\bigskip
\noindent
{\large {\bf まとめ:} 数を係数とする多項式に関する剰余定理は行列を係数とする
  多項式に拡張される.  行列版の剰余定理を前提にすれば行列式に関する基本的な
  結果から Cayley-Hamilton の定理がただちに導かれる.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{正方行列の三角化可能性を用いた証明}
\label{sec:CH-triangulation}

Cayley-Hamilton の定理は別のやり方でも証明できる.  以下では最も素朴な方法だ
と考えられる行列の三角化可能性を用いた証明を紹介しよう.

\begin{question}
\label{q:nilpotent-matrix}
  $A$ は対角成分がすべて $0$ であるような上三角 $n$ 次正方行列であるとする.
  このとき $A^n=0$.
  \qed
\end{question}

\noindent
ヒント: $A$ の $(i,j)$ 成分を $a_{ij}$ と書くと, 
$A$ に関する仮定は $a_{ij}=0$ ($j<i+1$) と同値になる.
$A^p$ の $(i,j)$ 成分が $j<i+p$ のとき $0$ になることを示せ.
$p=1,2,3,\ldots$ に対して $A^p$ を計算するとその $0$ でない成分の
ありかがだんだん右上に移動して行く.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[複素正方行列の三角化可能性]
\label{q:triangularizable2}
  $A$ は複素 $n$ 次正方行列であるとする%
  \footnote{代数閉体の元を成分に持つ行列を考えても良い.}.  %
  $A$ の特性多項式 $p_A(\lambda)=\det(\lambda E - A)$ の互いに異なる根の全体
  は $\alpha_1,\ldots,\alpha_r$ であり, $p_A(\lambda)$ は次のように表わされ
  ているとする:
  \begin{equation*}
    p_A(\lambda)=\det(\lambda E - A)
    = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_r)^{n_r}.
  \end{equation*}
  このとき, 正則な複素 $n$ 次正方行列 $P$ で $P^{-1}AP$ が上三角行列になり, 
  しかも $P^{-1}AP$ の対角部分が特性多項式の根を重複を含めて全部並べ
  た $\diag(\alpha_1,\dots,\alpha_1,\dots,\alpha_r,\dots,\alpha_r)$ 
  (各 $\alpha_i$ が $n_i$ 個ずつ順番に並ぶ) に等しくなるものが存在する.
  \qed
\end{question}

\noindent
ヒント: $n$ に関する数学的帰納法. 
問題 \qref{q:triangularizable} の証明をやり直せば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:nilpotent-matrix}, \qref{q:triangularizable2} の結果を
  用いて Cayley-Hamilton の定理を証明せよ. \qed
\end{question}

\noindent
ヒント: $p_A(P^{-1}AP)=P^{-1}p_A(A)P$ より, 
$A$ は問題 \qref{q:triangularizable2} における $P^{-1}AP$ の
形をしていると仮定して良い.  $A$ の対角線部分には
対角成分がすべて $\alpha_i$ であるような $n_i$ 次の上三角行列が並んでいると
みなせる.  よって, $(A-\alpha_j E)^{n_j}$ の対角線部分には
対角成分がすべて $(\alpha_i-\alpha_j)^{n_i}$ であるような $n_i$ 次上三角行列
が並ぶ.  ただし, $i=j$ 番目のブロックは問題 \qref{q:nilpotent-matrix} の
結果より $n_j$ 次の巾零行列になる.  
実はこのことだけから $(A-\alpha_j)^{n_j}$ を $j=1,\dots,r$ について掛け合わ
せると零行列になることを示せる.  たとえば $r=4$ の場合は
\begin{align*}
  &
  \begin{bmatrix}
    0 & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & 0 & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & * & * \\
      & 0 & * & * \\
      &   & * & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & 0 & * \\
      & 0 & 0 & * \\
      &   & 0 & * \\
      &   &   & * \\
  \end{bmatrix}
  \begin{bmatrix}
    * & * & * & * \\
      & * & * & * \\
      &   & * & * \\
      &   &   & 0 \\
  \end{bmatrix}
  \\
  = &
  \begin{bmatrix}
    0 & 0 & 0 & 0 \\
      & 0 & 0 & 0 \\
      &   & 0 & 0 \\
      &   &   & 0 \\
  \end{bmatrix}.
  \qed
\end{align*}

\bigskip
\noindent
{\large {\bf まとめ:} 複素 $n$ 次正方行列%
  \footnote{もしくは代数閉体の元を成分に持つ $n$ 次正方行列}
  の三角化可能性を $n$ に関する帰納法で証明できる.
  その結果から Cayley-Hamilton の定理がただちに導かれる.}

\bigskip
\noindent
比較: \secref{sec:CH-direct}と\secref{sec:CH-remainder}の方法の特徴は
特性多項式の根 (固有値) を一切使わずに Cayley-Hamilton の定理を
証明できたことである.  
そのために行列式に関する基本的な結果と
(本質的に)行列係数多項式の剰余定理を用いた.  
それに対して\secref{sec:CH-triangulation}では
行列係数多項式の剰余定理を用いていないが, 
特性多項式の根を本質的に用いている.  
特性多項式の根を自由に利用するためには代数学の基本定理%
\footnote{代数学の基本定理とは「1次以上の複素係数1変数多項式は複素数の中に
  必ず根を持つ」という定理である.}
が必要になる%
\footnote{複素数体の部分体 (例えば実数体や有理数体) の元を成分に持つ行列
  ではなく, 一般の体 $K$ の元を成分に持つ行列を扱う場合
  には $K$ 係数多項式の分解体の存在定理が必要になる.}.  %
どちらの方法も一長一短なので両方覚えておくと良いだろう.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{実対称行列}
\label{sec:real-symmetric}

この節は\secref{sec:normal-matrix}の問題 \qref{q:real-symmetric} の続きであ
る.  実対称行列に関する基本的な結果とその応用について説明する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実対称行列, 実交代行列, 直交行列の定義}

正方行列 $A$ が{\bf 対称行列 (symmetric matrix)} である
とは $\tp{A}=A$ が成立することであり%
\footnote{このプリントでは行列の転置を $\tp{A}$ と表わしている. 
  しかし, 多数派は ${}^t\!A$ の方であるようだ.
  右上に転置の記号を書く場合には $A^T$ と大文字の $T$ を使うことが多い.
  この演習の転置行列の記号法は多数派にしたがっていないので注意して欲しい.}, 
$A$ が{\bf 交代行列 (alternating matrix, skew-symmetrix matrix)} 
であるとは $\tp{A}=-A$ が成立することである.
さらに, 実正方行列 $A$ が{\bf 直交行列 (orthogonal matrix)} であると
は $\tp{A}A=A\tp{A}=E$ が成立することである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $P$ は実 $n$ 次行列であるとし, 
  その列ベクトルの全体を $p_1,\dots,p_n$ と書く.  
  このとき, $P$ が直交行列であるための必要十分条件
  は $p_1,\dots,p_n$ が $\R^n$ の正規直交基底になることである. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ が $n$ 次実対称行列であり, $P$ が $n$ 次実正則行列であるとき,
  $\tp{P}AP$ も実対称行列になる. 
  特に $P$ が直交行列であれば $P^{-1}AP$ も実対称行列になる.
  同様の結果が実交代行列に関しても成立する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  任意の $n$ 次正方行列は対称行列と交代行列の和に一意的に分解可能である.
  \qed
\end{question}

\noindent
ヒント: $f$ は実軸上の任意の実数値函数であるとする. 
このとき, $g(x)=(f(x)+f(-x))/2$, $h(x)=(f(x)-f(-x))/2$ と置くと,
$f=g+h$ でかつ $g$, $h$ はそれぞれ偶函数, 奇函数になる.
任意の $f$ は偶函数 $g$ と奇函数 $h$ の和に一意的に分解される. 
たとえば, $f(x)=e^x$ のとき, $g(x)=\cosh x$, $h(x)=\sinh x$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $n$ 次実対称行列全体の集合を $\Sym_n(\R)$ と書き,
  $n$ 次実交代行列全体の集合を $\Alt_n(\R)$ と書く.
  このとき, $\Sym_n(\R)$, $\Alt_n(\R)$ は実ベクトル空間をなし,
  $\dim_\R\Sym_n(\R)=n(n+1)/2$, $\dim_\R\Alt_n(\R)=n(n-1)/2$ が成立する. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$, $B$ が $n$ 次対称行列であるとき, $AB$ も対称行列になるための必要十分
  条件は $A$ と $B$ が可換\footnote{$AB=BA$ であるということ.}であることであ
  る.  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実対称行列の対角化可能性}

\begin{question}
  $A$ が $2\times 2$ の実対称行列であるとき,
  その特性多項式 $p_A(\lambda)=\det(\lambda E - A)$ が実根を持つことを
  判別式が非負になることをチェックすることによって証明せよ. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  実対称行列の固有値はすべて実数である%
  \footnote{固有値と固有ベクトルの組は複素数と複素ベクトルの範囲で探す.}. 
  \qed
\end{question}

\noindent
ヒント: $A$ は $n$ 次の実対称行列であるとし, $\alpha$ は $A$ の固有値で
あるとし, $v$ はそれに付随する固有ベクトルであるとする.  すなわち,
$Av=\alpha v$, $\alpha\in\C$, $v\in\C^n$, $v\ne 0$.  このとき, $A$ が
実対称行列であることより $\bra Av,v\ket = \bra v,Av\ket$.  この等式の左辺と
右辺を☆☆略☆☆と計算すると $\compconj{\alpha}=\alpha$ であることがわかる.  
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

すでに問題 \qref{q:real-symmetric} で示されている「実対称行列の直交行列によ
る対角化可能性」の証明の方針をここで再度紹介することにしよう.
正規行列まで一般化した議論がわかり難いと感じる人はまず最初に実対称行列の場合
を扱ってみるのが良い.  (もしくは Hermite 行列でも良い.)

\begin{question}
\label{q:real-sym-diag-1}
  $A$ は $n$ 次実対称行列であるとし, $\alpha\in\R$ はその固有値であり, 
  $p\in\R^n$ はそれに付随する固有ベクトルであるとする.  このとき, $p$ の
  直交補空間 $W=\{\,q\in\R^n\mid\bra p,q\ket=0\,\}$ は $A$ の作用で閉じてい
  る. すなわち $AW\subset W$ が成立している. \qed
\end{question}

\noindent
ヒント: $\bra p,q\ket=0$ の
とき $\bra p, Aq\ket=\text{☆☆}=\text{☆☆}=\text{☆☆}=0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実対称行列の対角化可能性]
\label{q:real-sym-diag-2}
  問題 \qref{q:real-sym-diag-1} を用いた $n$ に関する数学的帰納法によって,
  以下を証明せよ:
  \begin{enumerate}
  \item[(1)] 任意の $n$ 次実対称行列 $A$ に対して, 
    ある直交行列 $P$ で $P^{-1}AP$ が実対角行列になるものが存在する.
  \item[(2)] 任意の $n$ 次実対称行列 $A$ に対して, $\R^n$ の
    ある正規直交基底 $p_1,\dots,p_n$ と実数 $\alpha_1,\dots,\alpha_n$ 
    で $A p_i=\alpha_i p_i$ ($i=1,\dots,n$) を満たすものが存在する.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 問題 \qref{q:real-sym-diag-1} の状況を
考え, $q_1=p$ と置き, $W$ の正規直交基底 $q_2,\dots,q_n$ を任意に取ると,
$q_1,\dots,q_n$ は $\R^n$ の正規直交基底になり, 
$Aq_1=\alpha q_1$ であり, $Aq_2,\dots,Aq_n$ は $q_2,\dots,a_n$ の実一次結合
になる.  よって, $Q = [q_1\ \cdots\ q_n]$ は直交行列になり, 
ある  $n-1$ 次の実正方行列 $B$ が存在して, $Q^{-1}AQ$ は次の形になる:
\begin{equation*}
  Q^{-1}AQ =
  \begin{bmatrix}
    \alpha & 0 \\
       0   & B \\
  \end{bmatrix}
\end{equation*}
$Q^{-1}AQ=\tp{Q}AQ$ も対称行列になるので $B$ も対称行列になる.
よって $B$ に帰納法の仮定を適用できる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

上と同様の結果は複素対称行列に対しては成立しない. 
(Hermite 行列に対してなら成立する.)

\begin{question}
\label{q:non-semisimple}
  ある複素対称行列 $A$ でどのような正則行列 $P$ を取って
  も $P^{-1}AP$ が対角行列にならないようなものが存在することを示せ. \qed
\end{question}

\noindent
ヒント: 次の問題 \qref{q:ss-cap-nip=0} を使えば $2\times 2$ の
複素行列 $A$ でそのような例を作ることは簡単である.  $A$ の成分をいつものよう
に $a,b,c,d$ と書き, $A\ne 0$, $\tp{A}=A$, $A^2=0$ を
満たす複素数 $a,b,c,d$ を探してみよ.
\qed

\commentout{
\medskip
\noindent
例: $A=
\begin{bmatrix}
  i & 1 \\
  1 & -i \\
\end{bmatrix}=
\begin{bmatrix}
  1 & 0 \\
  i & 1 \\
\end{bmatrix}^{-1}
\begin{bmatrix}
  0 & 1 \\
  0 & 0 \\
\end{bmatrix}
\begin{bmatrix}
  1 & 0 \\
  i & 1 \\
\end{bmatrix}$ は複素対称行列でかつ $A^2=0$.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ss-cap-nip=0}
  半単純%
  \footnote{正方行列 $A$ が{\bf 半単純 (semisimple)} であるとは
    ある正則行列 $P$ で $P^{-1}AP$ が対角行列になるものが存在することである.
    ただし, $A$ が実行列であっても $P$ として複素行列も考えることに注意せよ.
    ($K$ が任意の体であり, $A$ が $K$ の元を成分として持つ $n$ 次正方行列で
    あるとき, $A$ が半単純であるとは $K$ の代数閉包 $\bar{K}$ の元を成分
    として持つ $n$ 次正則行列 $P$ で $P^{-1}AP$ が対角行列になるものが存在
    することである.) 
    }%
  かつ巾零%
  \footnote{正方行列 $A$ が{\bf 巾零 (nilpotent)} であるとは
    ある自然数 $k$ で $A^k=0$ となるものが存在することである.}%
  な $n$ 次正方行列は零行列に限る.  \qed
\end{question}

\noindent
参考: 実は任意の正方行列は互いに可換な半単純行列と巾零行列の和に一意的に分解
される(Jordan分解).  上の問題の結果はその特殊な場合である.  行列の Jordan 分
解およびその精密化である Jordan 標準形の理論に関しては後で説明する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実対称行列の対角化と固有値問題}
\label{sec:real-sym-eigen-val-problem}

実対称行列の対角化可能性 \qref{q:real-sym-diag-2} の第一の解釈は実対称行列を
実一次変換とみなすことによって得られる.
第二の解釈は実対称行列を実二次形式とみなすことによって得られる.
この節の残りの部分では第一の解釈について解説し, 
第二の解釈は次の節で扱うことにする.

$A$ は $n$ 次の実正方行列であるとする.  
$A$ の実縦ベクトルへの積は $\R^n$ の一次変換%
\footnote{ベクトル空間 $V$ からそれ自身への線形写像
  を $V$ の{\bf 一次変換 (linear transformation)} と呼ぶ.}%
を定める.  逆にその一次変換を $\R^n$ の標準的な正規直交基底 $e_1,\dots,e_n$ 
に作用させれば $A$ の $(i,j)$ 成分 $a_{ij}$ が得られる:
\begin{equation*}
  Ae_j = \sum_{i=1}^n e_i a_{ij} = \sum_{i=1}^n a_{ij} e_i
  \quad (j=1,\dots,n).
\end{equation*}
しかし, $\R^n$ の基底の取り方は標準的な正規直交基底意外にも無限に存在する.
「目的に応じて基底の取り方を変える」という考え方は線形代数において最も基本的
である.  行列 $A$ の定める一次変換の性質を調べるためにはそのために最も便利な
基底を選んでおくべきである.

$A$ は $n$ 次の実対称行列であるとし, $A$ が定める $\R^n$ の一次変換について
考える.  実対称行列の対角化可能性 \qref{q:real-sym-diag-2} より, 
$\R^n$ のある正規直交 $p_1,\dots,p_n$ と実数 $\alpha_1,\dots,\alpha_n$ で 
\begin{equation*}
  A p_j = \alpha_j p_j
  \quad (j=1,\dots,n)
\end{equation*}
を満たすものが存在する.  すなわち, 基準になる正規直交基底をうまく取り直せば,
実対称対称行列が定める一次変換は正規直交基底に含まれるベクトルを実数倍する変
換に過ぎないことがわかる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $2$ 次の実対称行列 $A$ と $p_1,p_2\in\R^2$ を次のように定める:
  \begin{equation*}
    A = 
    \frac{1}{2}
    \begin{bmatrix}
      5 & 1 \\
      1 & 5 \\
    \end{bmatrix},
    \quad
    p_1 =
    \frac{1}{\sqrt{2}}
    \begin{bmatrix}
      1 \\
      1 \\
    \end{bmatrix}, 
    \quad
    p_2 =
    \frac{1}{\sqrt{2}}
    \begin{bmatrix}
      -1 \\
      1 \\
    \end{bmatrix}.
  \end{equation*}
  このとき, $p_1,p_2$ は $\R^2$ の正規直交基底であり, 
  $A$ が定める $\R^2$ の一次変換は $p_1$ を $2$ 倍し, $p_2$ を$3$ 倍する.
  すなわち, 標準的な $x$ 軸, $y$ 軸を $45$ 度傾けたものを新たな直交軸と
  すると, 行列 $A$ が定める一次変換は新たな直交軸のそれぞれを $2$ 倍, $3$ 倍
  に拡大する一次変換であることがわかる.
  (実際に図を描いてこのことをわかり易く説明せよ.)
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Cartan(A3)}
  次の実対称行列を対角化せよ:
  \begin{equation*}
    (1)\quad A_3 = 
    \begin{bmatrix}
       2 & -1 &  0 \\
      -1 &  2 & -1 \\
       0 & -1 &  2 \\
    \end{bmatrix},
    \qquad
    (2)\quad A_3^{(1)} = 
    \begin{bmatrix}
       2 & -1 &  0 & -1 \\
      -1 &  2 & -1 &  0 \\
       0 & -1 &  2 &  0 \\
      -1 &  0 & -1 &  2 \\
    \end{bmatrix},
    \qed
  \end{equation*}
\end{question}

\noindent
参考: 上の $n=3$ の場合だけではなく一般の $n$ についても上と
同様に行列 $A_n$, $A_n^{(1)}$ が定義される.
ただし, $A_1^{(1)}$ の場合だけは例外的に非対角成分を $-2$ とする.
それらの行列を $A$ 型の Cartan 行列と呼ぶ.
実は $A$ 型以外にも $B,\dots,F$ 型の Cartan 行列も定義され, 
それらは基本的な対称性を記述するための最小限のデータになっている.

\commentout{
\medskip
\noindent
略解: 直交行列 $P$, $Q$ を次のように定める:
\begin{equation*}
  P =
  \begin{bmatrix}
    -\frac{1}{\sqrt{2}} &  \frac{1}{2}        & \frac{1}{2} \\
             0          & -\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\
     \frac{1}{\sqrt{2}} &  \frac{1}{2}        & \frac{1}{2} \\
  \end{bmatrix},
  \qquad
  Q =
  \begin{bmatrix}
    \frac{1}{2} &  \frac{1}{\sqrt{2}} &         0           & -\frac{1}{2} \\
    \frac{1}{2} &         0           &  \frac{1}{\sqrt{2}} &  \frac{1}{2} \\
    \frac{1}{2} & -\frac{1}{\sqrt{2}} &         0           & -\frac{1}{2} \\
    \frac{1}{2} &         0           & -\frac{1}{\sqrt{2}} &  \frac{1}{2} \\
  \end{bmatrix}
\end{equation*}
このとき, $P^{-1}A_3 P = \diag(2, 2+\sqrt{2}, 2-\sqrt{2})$,
$Q^{-1}A_3^{(1)}Q = \diag(0,2,2,4)$. \qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ars-1}
  次の実対称行列 $A_i$ の対角化 $D_i$ と直交行列 $P_i$ で $P_i^{-1}AP_i=D_i$ 
  となるもの求めよ:
  \begin{equation*}
    A_1 =
    \left[ 
      \begin{array}{rrr}
        2 & -2 & -1 \\
        -2 & 2 & 1 \\
        -1 & 1 & 5
      \end{array}
    \right],
    \quad
    A_2 =
    \left[ 
      \begin{array}{rrr}
        -3 & -6 & 6 \\
        -6 & 1 & 3 \\
        6 & 3 & 1
      \end{array}
    \right].
  \end{equation*}
  可能ならば $P_i$ を整数だけを成分に持つ行列と対角行列の積で表わせ.
  \qed
\end{question}

\commentout{
\noindent
略解: $D_1=\diag(0,3,6)$, $D_2=\diag(6,-11,4)$, 
\begin{align*}
  &
  P_1 = 
  \left[ 
    \begin{array}{rrr}
      1 & 1 & -1 \\
      1 & -1 & 1 \\
      0 & 1 & 2
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {2} & 0 & 0 \\
      0 & \sqrt {3} & 0 \\
      0 & 0 & \sqrt {6}
    \end{array}
  \right]^{-1},
  \\ &
  P_2 =
  \left[ 
    \begin{array}{rrr}
      4 & -3 & 0 \\
      -3 & -2 & 1 \\
      3 & 2 & 1
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {34} & 0 & 0 \\
      0 & \sqrt {17} & 0 \\
      0 & 0 & \sqrt {2}
    \end{array}
  \right]^{-1}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ars-2}
  次の実対称行列 $A_i$ の対角化 $D_i$ と直交行列 $P_i$ で $P_i^{-1}AP_i=D_i$ 
  となるもの求めよ:
  \begin{equation*}
    A_3 = \left[ 
      \begin{array}{rrr}
        -1 & -6 & -6 \\
        -6 & -1 & 6 \\
        -6 & 6 & 6
      \end{array}
    \right],
    \quad
    A_4 = \left[ 
      \begin{array}{rrr}
        5 & 2 & -4 \\
        2 & 5 & -4 \\
        -4 & -4 & 3
      \end{array}
    \right].
  \end{equation*}
  可能ならば $P_i$ を整数だけを成分に持つ行列と対角行列の積で表わせ.
  \qed
\end{question}

\commentout{
\noindent
略解: $D_3=\diag(-3,-7,14)$, $D_4=\diag(3,11,-1)$, 
\begin{align*}
  &
  P_3 = 
  \left[ 
    \begin{array}{rrr}
      -3 & 1 & -2 \\
      3 & 1 & 2 \\
      -4 & 0 & 3
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {34} & 0 & 0 \\
      0 & \sqrt {2} & 0 \\
      0 & 0 & \sqrt {17}
    \end{array}
  \right]^{-1},
  \\ &
  P_4 =
  \left[ 
    \begin{array}{rrr}
      -1 & -1 & 1 \\
      1 & -1 & 1 \\
      0 & 1 & 2
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {2} & 0 & 0 \\
      0 & \sqrt {3} & 0 \\
      0 & 0 & \sqrt {6}
    \end{array}
  \right]^{-1}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ars-3}
  次の実対称行列 $A_i$ の対角化 $D_i$ と直交行列 $P_i$ で $P_i^{-1}AP_i=D_i$ 
  となるもの求めよ:
  \begin{equation*}
    A_5 =
    \left[ 
      \begin{array}{rrr}
        -2 & 2 & -1 \\
        2 & -2 & -1 \\
        -1 & -1 & 1
      \end{array}
    \right],
    \quad
    A_6 =
    \left[ 
      \begin{array}{rrr}
        -2 & -3 & -3 \\
        -3 & 3 & -2 \\
        -3 & -2 & 3
      \end{array}
    \right].
  \end{equation*}
  可能ならば $P_i$ を整数だけを成分に持つ行列と対角行列の積で表わせ.
  \qed
\end{question}

\commentout{
\noindent
略解: $D_5=\diag(-4,2,-1)$, $D_6=\diag(4,5,-5)$, 
\begin{align*}
  &
  P_5 = 
  \left[ 
    \begin{array}{rrr}
      -1 & 1 & 1 \\
      1 & 1 & 1 \\
      0 & -2 & 1
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {2} & 0 & 0 \\
      0 & \sqrt {6} & 0 \\
      0 & 0 & \sqrt {3}
    \end{array}
  \right]^{-1},
  \\ &
  P_6 =
  \left[ 
    \begin{array}{rrr}
      -1 & 0 & 2 \\
      1 & -1 & 1 \\
      1 & 1 & 1
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {3} & 0 & 0 \\
      0 & \sqrt {2} & 0 \\
      0 & 0 & \sqrt {6}
    \end{array}
  \right]^{-1}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ars-4}
  次の実対称行列 $A_i$ の対角化 $D_i$ と直交行列 $P_i$ で $P_i^{-1}AP_i=D_i$ 
  となるもの求めよ:
  \begin{equation*}
    A_7 =
    \left[ 
      \begin{array}{rrrr}
        -3 & 0 & -1 & 2 \\
        0 & 1 & 3 & 0 \\
        -1 & 3 & 0 & 2 \\
        2 & 0 & 2 & 0
      \end{array}
    \right],
    \quad
    A_8 =
    \left[ 
      \begin{array}{rrrr}
        5 & 2 & 4 & -1 \\
        2 & 0 & 2 & 2 \\
        4 & 2 & -1 & 2 \\
        -1 & 2 & 2 & 1
      \end{array}
    \right].
  \end{equation*}
  可能ならば $P_i$ を整数だけを成分に持つ行列と対角行列の積で表わせ.
  \qed
\end{question}

\commentout{
\noindent
略解: $D_7=\diag(-5,-2,1,4)$, $D_8=\diag(3,-4,8,-2)$, 
\begin{align*}
  &
  P_7 = 
  \left[ 
    \begin{array}{rrrr}
      -3 & -1 & -1 & 0 \\
      1 & -1 & 1 & 2 \\
      -2 & 1 & 0 & 2 \\
      2 & 0 & -2 & 1
    \end{array}
  \right]
  \left[ 
    \begin{array}{cccr}
      3\,\sqrt {2} & 0 & 0 & 0 \\
      0 & \sqrt {3} & 0 & 0 \\
      0 & 0 & \sqrt {6} & 0 \\
      0 & 0 & 0 & 3
    \end{array}
  \right]^{-1},
  \\ &
  P_8 =
  \left[ 
    \begin{array}{rrrr}
      -2 & 1 & 7 & 1 \\
      2 & 0 & 3 & -6 \\
      1 & -2 & 4 & 2 \\
      4 & 1 & 1 & 3
    \end{array}
  \right]
  \left[ 
    \begin{array}{rccc}
      5 & 0 & 0 & 0 \\
      0 & \sqrt {6} & 0 & 0 \\
      0 & 0 & 5\,\sqrt {3} & 0 \\
      0 & 0 & 0 & 5\,\sqrt {2}
    \end{array}
  \right]^{-1}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ars-5}
  次の実対称行列 $A_i$ の対角化 $D_i$ と直交行列 $P_i$ で $P_i^{-1}AP_i=D_i$ 
  となるもの求めよ:
  \begin{equation*}
    A_9 =
    \left[ 
      \begin{array}{rrrr}
        3 & 2 & 2 & 2 \\
        2 & 2 & -2 & 5 \\
        2 & -2 & 3 & -2 \\
        2 & 5 & -2 & 2
      \end{array}
    \right],
    \quad
    A_{10} =
    \left[ 
      \begin{array}{rrrr}
        5 & -1 & 2 & -1 \\
        -1 & 4 & -1 & 0 \\
        2 & -1 & 5 & -1 \\
        -1 & 0 & -1 & 4
      \end{array}
    \right].
    \qed
  \end{equation*}
  可能ならば $P_i$ を整数だけを成分に持つ行列と対角行列の積で表わせ.
  \qed
\end{question}

\commentout{
\noindent
略解: $D_9=\diag(-3,9,5,-1)$, $D_{10}=\diag(8,3,3,4)$, 
\begin{align*}
  &
  P_9 = 
  \left[ 
    \begin{array}{rrrr}
      0 & -1 & 1 & -2 \\
      1 & -2 & 0 & 1 \\
      0 & 1 & 1 & 2 \\
      -1 & -2 & 0 & 1
    \end{array}
  \right]
  \left[ 
    \begin{array}{cccc}
      \sqrt {2} & 0 & 0 & 0 \\
      0 & \sqrt {10} & 0 & 0 \\
      0 & 0 & \sqrt {2} & 0 \\
      0 & 0 & 0 & \sqrt {10}
    \end{array}
  \right]^{-1},
  \\ &
  P_{10} =
  \left[ 
    \begin{array}{rrrr}
      -2 & 1 & -2 & 0 \\
      1 & 1 & 1 & 1 \\
      -2 & 0 & 3 & 0 \\
      1 & 1 & 1 & -1
    \end{array}
  \right]
  \left[ 
    \begin{array}{cccc}
      \sqrt {10} & 0 & 0 & 0 \\
      0 & \sqrt {3} & 0 & 0 \\
      0 & 0 & \sqrt {15} & 0 \\
      0 & 0 & 0 & \sqrt {2}
    \end{array}
  \right]^{-1}.
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:Cartan(A3)} で定義した
  Cartan 行列 $A_3^{(1)}$ の $(i,j)$ 成分を $a_{ij}$ と書き,
  慣習にしたがって Cartan 行列の添字の $4$ を $0$ に置換する
  ために $a_{0j}=a_{4j}$, $a_{i0}=a_{i4}$ と置く.
  $a_{ij}$ ($i=1,2,3$) は Cartan 行列 $A_3$ の成分に一致している.
  $z$ の多項式を成分に持つ
  行列 $E_i,F_i,H_i$ ($i=0,1,2,3$) を次のように定める:
  {\small
  \begin{align*}
    &
    E_1 = 
    \begin{bmatrix}
      0 & 1 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    E_2 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    E_3 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 1 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    E_0 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      z & 0 & 0 & 0 \\
    \end{bmatrix},
    \\ &
    F_1 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      1 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    F_2 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    F_3 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 \\
    \end{bmatrix},
    \ %
    F_0 = 
    \begin{bmatrix}
      0 & 0 & 0 & z^{-1} \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \\ &
    H_1 = 
    \begin{bmatrix}
      1 & 0 & 0 & 0 \\
      0 &-1 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    H_2 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 \\
      0 & 0 &-1 & 0 \\
      0 & 0 & 0 & 0 \\
    \end{bmatrix},
    \ %
    H_3 = 
    \begin{bmatrix}
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 \\
      0 & 0 & 0 &-1 \\
    \end{bmatrix},
    \ %
    H_0 = 
    \begin{bmatrix}
     -1 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 1 \\
    \end{bmatrix}.
  \end{align*}
  }このとき, $i,j=0,1,2,3$ に対して以下が成立する:
  \begin{enumerate}
  \item $[H_i, E_j] = a_{ij} E_j$, \quad $[H_i, F_j] = -a_{ij} F_j$;
  \item $[E_i, F_j] = \delta_{ij} H_i$;
  \item $[E_i,[E_i, E_j]] = 0$, \quad $[F_i,[F_i, F_j]] = 0$ \quad ($i\ne j$).
  \end{enumerate}
  ここで $[X,Y]=XY-YX$ である. \qed
\end{question}

\noindent
参考: 上の問題の $E_i,F_i,H_i$ ($i=1,2,3$) は Lie 代数 $\lie{sl}_3$ の 
{\bf Chevalley 生成元 (Chevalley generators)} と呼ばれており, 
$E_i,F_i,H_i$ ($i=0,1,2,3$) はアフィン Lie 代数 $\widehat{\lie{sl}}_3$ の
{\bf Chevalley 生成元 (Chevalley generators)} と呼ばれている.
アフィン Lie 代数に関する教科書としては
谷崎 \cite{tanisaki} や脇本 \cite{wakimoto} がおすすめである. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Hadamard の不等式}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

実対称行列もしくはより一般に Hermite 行列 $A$ 
が{\bf 非負もしくは非負値 (non-negative)} であるとは
そのすべての固有値が非負であることである. 
そのとき $A\ge 0$ と書く.  
すべての固有値が正であるとき $A$ は{\bf 正もしくは正値 (positive)} で
あると言い, $A>0$ と書く.

\begin{question}
\label{q:positive-symmetric}
  $A$ は実対称行列であるとする. 
  このとき, $A$ が非負値であるための必要十分条件は
  ある実対称行列 $B$ によって $A=B^2$ と表わせることである. \qed
\end{question}

\noindent
ヒント: 十分性.  $A$ の固有値 $\alpha_i$ がすべて非負ならば
その平方根 $\beta_i$ を実数に取れる.
$D=\diag(\beta_1,\dots,\beta_n)$ と置く.
対称行列の直交行列による対角化可能性より, ある直交行列 $P$ が
存在して $A=PD^2\tp{P}=PD\tp{P}PD\tp{P}$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Cholesky 分解]
\label{q:pos-sym=RR}
  $A$ が $n$ 次正値実対称行列ならば
  対角成分が正の上三角行列 $R$ で $A=\tp{R}R$ を満たすものが
  一意に存在する.  これを $A$ の Cholesky 分解と呼ぶ.
  \qed
\end{question}

\noindent
ヒント: 存在. 問題 \qref{q:positive-symmetric} よりある実正方行列 $B$
で $A=\tp{B}B$ を満たすものが存在する%
\footnote{$B$ は実対称行列に取れるがここではその事実は必要ない.}.
$A$ は正則行列なので $B$ もそうである. 
よって $B$ の中の列ベクトルたちに Schmidt の正規直交化法を適用することによっ
て, 直交行列 $Q$ と対角成分が正の上三角行列 $R$ で $B=QR$ を満たすものが存在
する(問題 \qref{q:iwasawa-decomp-GLn(R)}).  
このとき, $A=\tp{B}B=\tp{R}R$.

一意性. $S$ も対角成分が正の上三角行列で $A=\tp{S}S$ を満たしていると
仮定する.  このとき, $\tp{R}R = \tp{S}S$ 
なので $X=RS^{-1}$ と置くと $X=\tp{(X^{-1})}$ である.
$X$ は対角成分が正の上三角行列であり, 
$X^{-1}$ は対角成分が $X$ のそれの逆数であるような上三角行列である.
よって $X=E$ すなわち $R=S$ である.
\qed

\medskip
\noindent
参考: $A$ は正値実対称行列であり, その $n$ 個の固有値は互いに
異なると仮定する.  そのとき, $A_n$ ($n=0,1,2,\dots$) を
帰納的に $A_0=A$, $A_n = \tp{R_n}R_n$ (Cholesky 分解), $A_{n+1}=R\tp{R}$ と
定める.  このとき, 列 $A_n$ はある対角行列 $D$ に収束し, 
$D$ の対角成分は $A$ の固有値が大きな順に並ぶ.  
この結果を用いれば固有値が互いに異なる正値実対称行列の固有値の近似値を
数値計算することができる.  この数値計算法とオープン戸田格子という古典可積分
系の間には直接的な関係があることが知られている.  
他にも行列の固有値の近似値を求める数値計算法には
Cholesky 分解を使う方法の他に岩沢分解 
(\qref{q:iwasawa-decomp-GLn(C)}, \qref{q:iwasawa-decomp-GLn(R)})
を使う方法 (QR法) などがある.  

数値計算のアルゴリズムと可積分系の密接な関係に関しては中村 \cite{nakamura}
を参照せよ.  行列の数値計算には GNU Octave%
\footnote{{\tt http://www.octave.org/}} というフリーソフトウェアが便利であ
る. 最近では科学技術計算に使える便利なフリーソフトウェアがたくさん存在する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:pre-Hadamard-real}
  $A=[a_{ij}]$ が $n$ 次非負値実対称行列ならば
  \begin{equation*}
    |A| \le \prod_{i=1}^n a_{ii}.
  \end{equation*}
  等号が成立するための必要十分条件は $A$ が対角行列であることである.
  \qed
\end{question}

\noindent
ヒント: $A$ が正値と仮定して不等式を証明すれば十分である. 
なぜならば $A$ が $0$ を固有値として持つ
ならば $A+\eps E > 0$ ($\eps>0$) に関する不等式
の $\eps\to 0$ の極限で $A$ 自身に関する不等式が得られるからである.
そこで $A>0$ と仮定する. 
問題 \qref{q:pos-sym=RR} より
対角成分が正の上三角行列 $R$ で $A=\tp{R}R$ を満たすものが存在する. 
このとき $A=[a_{ij}]$ は $R=[r_{ij}]$ と
すると, $a_{ii}=p_{1i}^2 + \dots + p_{ii}^2 \ge p_{ii}^2$ である. よって, 
\begin{equation*}
  \prod_{i=1}^n a_{ii} \ge \prod_{i=1}^n p_{ii}^2 = |P|^2 = |A|.
\end{equation*}
以上の議論によって不等号で等号が成立するための必要十分条件は $R$ が対角行列
であることである. そのための必要十分条件は $R$ の一意性より $A$ が対角行列で
あることである.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:positive-Hermitian}
  $A$ は Hermite 行列であるとする. 
  このとき, $A$ が非負であるための必要十分条件は
  ある Hermite 行列 $B$ によって $A=B^2$ と表わせることである. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:positive-symmetric} とまったく同じやり方.
\qed

\medskip
\noindent
解説: 実数について成立することの多くが対称行列や Hermite 行列でも成立する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:pos-Herm=RR}
  $A$ が $n$ 次正値 Hermite 行列ならば
  対角成分が正の複素上三角行列 $R$ で $A=R^*R$ を満たすものが
  一意に存在する.
  \qed
\end{question}

\noindent
ヒント: 一意性の証明は問題 \qref{q:pos-sym=RR} とまったく同様. 
存在もほとんど同様で問題 \qref{q:iwasawa-decomp-GLn(C)} を使う.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:pre-Hadamard-complex}
  $A=[a_{ij}]$ が $n$ 次非負値 Hermite 行列ならば
  \begin{equation*}
    |A| \le \prod_{i=1}^n a_{ii}.
  \end{equation*}
  等号が成立するための必要十分条件は $A$ が対角行列であることである.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:pre-Hadamard-real} とまったく同様.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:H=AA}
  任意の複素行列 $A$ に対して $H=A^*A$ は非負値 Hermite 行列になる. \qed
\end{question}

\noindent
ヒント: $H^*=A^*(A^*)^*=A^*A=H$.  $Hu=\alpha u$ とすると,
$\alpha \bra u,u\ket = \bra u,Hu\ket = \bra Au,Au\ket \ge 0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Hadamard の不等式]
  $A=[a_{ij}]$ は任意の $n$ 次複素行列であるとし, 
  $A$ の中の $n$ 本の列ベクトルを $a_1,\dots,a_n$ と表わす.
  このとき,
  \begin{equation*}
    |\det A| 
    \le \prod_{i=1}^n \norm{a_i} 
    \le n^{n/2} \left[ \max_{1\le i,j\le n} |a_{ij}| \right]^n.
  \end{equation*}
  ここで $|\det A|$ は行列 $A$ の行列式の絶対値である. \qed
\end{question}

\noindent
行列式の絶対値を上から評価しなければいけなくなったら, 
Hadamard の不等式というものがあったことを思い出そう.

\medskip
\noindent
ヒント: 問題 \qref{q:H=AA} より $H=A^*A$ と置くと $H=[h_{ij}]$ は非負値 
Hermite 行列になる. よって不等式 \qref{q:pre-Hadamard-complex} を $H$ に適用
できる.  $h_{ii}=\norm{a_i}^2$ である. よって,
\begin{equation*}
  |\det A|^2 
  = \det H
  \le \prod_{i=1}^n h_{ii}
  = \prod_{i=1}^n \norm{a_i}^2
\end{equation*}
よって $|\det A| \le \prod_{i=1}^n \norm{a_i}$ である.
$M=\max_{1\le i,j\le n} |a_{ij}|$ と置くと $\norm{a_i}^2\le nM^2$ であるか
ら, $\prod_{i=1}^n \norm{a_i}\le n^{n/2}M^n$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:real-PAQ}
  $A$ は任意の $(m,n)$ 型実行列であるとすると以下が成立する:
  \begin{enumerate}
  \item[(1)] $\tp{A}A$ は $n$ 次の対称行列になり, 
    その固有値はすべて非負の実数になる.
    そこで, $\tp{A}A$ の $0$ でない固有値の全体
    を $\gamma_1^2,\dots,\gamma_r^2$ ($\gamma_i\in\R$) と表わしておく.
  \item[(2)] ある $m$ 次の直交行列 $P$ とある $n$ 次の直交行列 $Q$ が存在して,
    \begin{equation*}
      \tp{P}AQ = 
      \begin{bmatrix}
        \gamma_1  &        &          &   &        &   & \ & \bigzerou \\
                  & \ddots &          &   &        &   & & \\
                  &        & \gamma_r &   &        &   & & \\
                  &        &          & 0 &        &   & & \\
                  &        &          &   & \ddots &   & & \\
        \bigzerol &        &          &   &        & 0 & & \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

\noindent
ヒント:  (1) $\tp{A}A q = \beta q$ とすると,
$0\le\bra Aq,Aq\ket=\bra q,\tp{A}Aq\ket=\beta\bra q,q\ket$. \quad
(2) 対称行列の対角化可能性と (1) より, ある $n$ 次の直交行列 $Q$ が存在して,
\begin{equation*}
  \tp{(AQ)}AQ =
  \tp{Q}\tp{A}AQ =
  \begin{bmatrix}
    \beta_1   &        & \bigzerou \\
              & \ddots &           \\
    \bigzerol &        & \beta_n   \\
  \end{bmatrix}.
\end{equation*}
ここで $\beta_i=\gamma_i^2$ ($i=1,\dots,r$), $\beta_i=0$ ($i=r+1,\dots,n$).
よって, $AQ$ の $i=1,\dots,r$ 番目の列ベクトルを $b_i\in\R^m$ と
書くと $\bra b_i,b_j\ket=\gamma_i^2 \delta_{ij}$ が成立しており, 
$AQ$ の $i=r+1,\dots,n$ 番目の列ベクトルは $0$ である.
よって, $p_i=b_i/\gamma_i$ ($i=1,\dots,r$) を
拡張して $\R^m$ の正規直交基底 $p_1,\dots,p_m$ を構成でき, 
直交行列 $P$ を $P=[p_1\ \cdots\ p_m]$ と定めると $\tp{P}AQ$ が上の形
になる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:complex-PAQ}
  $A$ は任意の $(m,n)$ 型複素行列であるとすると以下が成立する:
  \begin{enumerate}
  \item[(1)] $A^*A$ は $n$ 次の Hermite 行列になり, 
    その固有値はすべて非負の実数になる.
    そこで, $A^*A$ の $0$ でない固有値の全体
    を $\gamma_1^2,\dots,\gamma_r^2$ ($\gamma_i\in\R$) と表わしておく.
  \item[(2)] ある $m$ 次のユニタリー行列 $P$ と
    ある $n$ 次のユニタリー行列 $Q$ が存在して, 
    \begin{equation*}
      P^*AQ = 
      \begin{bmatrix}
        \gamma_1  &        &          &   &        &   & \ & \bigzerou \\
                  & \ddots &          &   &        &   & & \\
                  &        & \gamma_r &   &        &   & & \\
                  &        &          & 0 &        &   & & \\
                  &        &          &   & \ddots &   & & \\
        \bigzerol &        &          &   &        & 0 & & \\
      \end{bmatrix}.
      \qed
    \end{equation*}
  \end{enumerate}
\end{question}

\noindent
ヒント: 問題 \qref{q:real-PAQ} とまったく同じやり方.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{実二次形式}
\label{sec:real-quadratic-form}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実二次形式の定義}
\label{sec:def-real-q-form}

実対称行列は実二次形式の一つの表現だとみなすことができる.  
{\bf 実二次形式 (real quadratic form)} とは
有限個の文字 $x_1,\dots,x_n$ の実数係数斉次2次式のことである. すなわち,
次の形の式を実二次形式と呼ぶ:
\begin{equation*}
  Q(x) = \sum_{i=1}^n a_{ii} x_i^2 + 2 \sum_{1\le i<j\le n} a_{ij}x_ix_j,
  \quad
  a_{ij}\in\R.
\end{equation*}
実二次形式は自然に $\R^n$ 上の函数とみなすこともできる.

さらに, $i>j$ のとき $a_{ij}=a_{ji}$ とおき, 実対称行列 $A$ を %
$A = [a_{ij}]$ と定め, $x$ を縦ベクトル $\tp{[x_1\ \cdots\ x_n]}$ と
解釈すると,
\begin{equation*}
  Q(x) = \sum_{i,j=1}^n a_{ij} x_ix_j
  = \sum_{i,j=1}^n x_i a_{ij} x_j
  = \tp{x}Ax
  = \bra x,Ax\ket = \bra Ax,x\ket
\end{equation*}
と書くことができる.  これによって, 実対称行列 $A$ と実二次形式 $Q$ が一対一
に対応している.  実対称行列 $A$ に対応する二次形式を
\begin{equation*}
  Q_A(x) := A[x] := \tp{x}Ax
\end{equation*}
と書くことにする.  ここで $Q$ は quadratic の頭文字であり, 
$A[x]$ は Siegel の記号法である(佐武 \cite{satake} 158頁).

\medskip

実対称行列は実対称双一次形式の一つの表現だとみなすことができる.  
{\bf 実対称双一次形式 (real symmetric bilinear form)} とは
写像 $B:\R^n\times\R^n\to\R^n$ で
任意の $x,x_i,y,y_j\in\R^n$, $a_i,b_j\in\R$ に対して
以下を満たすもののことである:
\begin{itemize}
\item[(a)] $B(a_1x_1+a_2x_2,y)=a_1B(x_1,y)+a_2B(x_2,y)$, \\
  $B(x,b_1y_1+b_2y_2)=b_1B(x,y_1)+b_2B(x,y_2)$ \quad (双一次性);
\item[(b)] $B(y,x) = B(x,y)$ \quad (対称性).
\end{itemize}
実対称双一次形式 $B$ に対して対称行列 $A$ 
を $a_{ij}=B(e_i,e_j)$, $A=[a_{ij}]$ と定めることができる.
ここで $e_i$ は $\R^n$ の標準的な基底である.
このとき, $x,y\in\R^n$ の成分をそれぞれ $x_i,y_j$ と書くと,
\begin{equation*}
  B(x,y) = \sum_{i,j=1}^n x_i y_j B(e_i,e_j)
  = \sum_{i,j=1}^n x_i a_{ij} y_j
  = \tp{x}Ay
  = \bra x,Ay\ket = \bra Ax,y\ket.
\end{equation*}
これによって実対称行列と実対称双一次形式が一対一に対応する.

実対称行列 $A$ に対応する実双一次形式を $B_A$ と書くことにすると,
\begin{equation*}
  Q_A(x) = B_A(x,x) = \tp{x}Ax.
\end{equation*}
以上をまとめると, これによって実二次形式と実対称双一次形式は実対称行列との対
応を通して互いに一対一に対応していることがわかる.

実対称双一次形式 $B$ に対応する実二次形式 $Q$ は $B$ の
{\bf 極化形式 (polarization)} と呼ばれている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  実二次形式 $Q$ は $\R^n$ 上の実数値函数であり, 次を満たしている:
  \begin{itemize}
  \item[(a)] $Q(ax) = a^2 Q(x)$ \quad ($a\in\R$, $x\in\R^n$);
  \item[(b)] $B(x,y)=(Q(x+y)-Q(x)-Q(y))/2$ と置くと $B$ は
    実対称双一次形式になる.
  \end{itemize}
  逆に $Q$ がこの性質を持つ $\R^n$ 上の実数値函数であるとき,
  $a_{ij}=B(e_i,e_j)$, $A=[a_{ij}]$ と置くと $Q=Q_A$.
  \qed
\end{question}

\noindent
解説: $B(x,y)=(Q(x+y)-Q(x)-Q(y))/2$ 
は $Q(x+y) = Q(x) + 2B(x,y) + Q(y)$ と書き直せる.
この式は文字 $x,y$ に関する公式 $(x+y)^2 = x^2 + 2xy + y^2$ の
一般化になっている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実二次形式の分類}
\label{sec:classify-real-q-form}

可逆な線形変数変換で移り合う実二次形式は互いに同値であるという. 
すなわち, 実二次形式 $Q_1$ と $Q_2$ が互いに同値であるとは,
ある $n$ 次実正則行列 $P$ が存在して,
\begin{equation*}
  Q_1(Px) = Q_2(x)
\end{equation*}
が成立することである.  
たとえば, $Q_1(x_1,x_2) = x_1^2 - x_2^2$
と $Q_2(x_1,x_2) = x_1^2 - 4 x_1x_2 + 3 x_2^2$ は同値である.  なぜならば
\begin{equation*}
  Q_1(x_1-2x_2, x_2) = (x_1-2x_2)^2 - x_2^2 
  = x_1^2 - 4 x_1x_2 + 3 x_2^2 = Q_2(x_1,x_2).
\end{equation*}
線形な変数変換 $(x_1,x_2)\mapsto(x_1-2x_2, x_2)$ 可逆である.

\begin{question}
  実二次形式 $Q_1$ と $Q_2$ が同値であるとき $Q_1\sim Q_2$ と書くと,
  \begin{enumerate}
  \item $Q_1\sim Q_1$;
  \item $Q_1\sim Q_2$ $\implies$ $Q_2\sim Q_1$;
  \item $Q_1\sim Q_2$, $Q_2\sim Q_3$ $\implies$ $Q_1\sim Q_3$.
    \qed
  \end{enumerate}
\end{question}

\noindent
解説: この結果は実二次形式の同値性は同値関係の公理を満たしていることを意味し
ている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

さて, 2つの実二次形式が同値になるための必要十分条件は何だろうか.
この問題に対する第一の解答が次の定理である.

\begin{theorem}[Sylvester]
\label{theorem:sylvester}
  任意の実二次形式 $Q$ に対してある $p,q\in\Z_{\ge0}$ が存在して,
  $Q$ は次の二次形式 $Q_{p,q}$ と同値になる:
  \begin{equation*}
    Q_{p,q} = x_1^2 + \cdots + x_p^2 - x_{p+1}^2 - \cdots - x_{p+q}^2.
  \end{equation*}
  しかも, $(p,q)$ は $Q$ に対して一意的に定まり, 2つの二次形式が同値になる
  ための必要十分条件はそれぞれの $(p,q)$ が一致することである. \qed
\end{theorem}

この定理の $(p,q)$ を $Q$ の{\bf 符号数 (signature)} と呼び, 
$Q_{p,q}$ を $Q$ の標準形と呼ぶ.
$Q$ に対する符号数の一意性を{\bf Sylvester の慣性法則 (Sylvester's law of
inertia )} と呼ぶ.

\medskip
\noindent
注意: 文脈によっては $p-q$ を符号数 (signature) と呼ぶことも多いので注意せよ.
階数 $p+q$ とこの意味での符号数 $p-q$ の組は $(p,q)$ と同じだけの情報量を持
っている.

\medskip

上の\theoremref{theorem:sylvester}を複数の演習問題に分けて証明しよう.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:sylvester-1}
  $n$ 次実対称行列 $A$, $B$ に対応する実二次形式 $Q_A$, $Q_B$ が互いに同値に
  なるための必要十分条件はある $n$ 次実正則行列 $P$ で $\tp{P}AP=B$ 
  を満たすものが存在することである.  \qed
\end{question}

\noindent
ヒント: $Q_A(Px)=\tp{(Px)}APx=\tp{x}\tp{P}APx$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[直交変換による実二次形式の標準形]
\label{q:sylvester-2}
  $A$ は $n$ 次実対称行列であり, $\alpha_1,\dots,\alpha_n\in\R$ はその固有値
  の全体 (重複を含む) であるとする.  このとき, ある $n$ 次直交行列 $T$ が存
  在して,
  \begin{equation*}
    Q_A(Tx) = \alpha_1 x_1^2 + \cdots + \alpha_n x_n^2.
  \end{equation*}
  $\alpha_1,\dots,\alpha_p>0$, $\alpha_{p+1},\dots,\alpha_{p+q}<0$, 
  $\alpha_{p+q+1}=\dots=\alpha_n=0$ と仮定しても一般性が失われない.
  そのとき正則行列 $P$ を
  \begin{equation*}
    P = T
    \begin{bmatrix}
      \frac{1}{\sqrt{\alpha_1}} & & & & & & & & \bigzerou \\
                                & \ddots & & & & & & & \\
                                &        & \frac{1}{\sqrt{\alpha_p}} & & & & & & \\
                                &        &                           & \frac{1}{\sqrt{-\alpha_{p+1}}} & & & & & \\
                                &        &                           &                                & \ddots & & & & \\
                                &        &                           &                                &        & \frac{1}{\sqrt{-\alpha_{p+q}}} & & & \\
                                &        &                           &                                &        &                              & 1 & & \\
                                &        &                           &                                &        &                              &   & \ddots & \\
      \bigzerol                 &        &                           &                                &        &                              &   &        & 1 \\
    \end{bmatrix}
  \end{equation*}
  と定めると
  \begin{equation*}
    Q_A(Px) = 
    Q_{p,q}(x) = x_1^2 + \cdots + x_p^2 - x_{p+1}^2 - \cdots - x_{p+q}^2.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: すぐ上の問題 \qref{q:sylvester-1} を用いて, 
実対称行列の直交行列による対角化可能性 \qref{q:real-sym-diag-2} を
二次形式の言葉を用いて書き直しただけ.
\qed

\medskip
\noindent
解説: 問題 \qref{q:sylvester-2} の結果より, 
実二次形式 $Q$ の符号数 $(p,q)$ は $Q$ に対応する実対称行列 $A$ の正の固有値
の個数と負の固有値の個数の組に等しいことがわかる.  そこで実対称行列 $A$ の符
号数を対応する実二次形式の符号数 $(p,q)$ であると定義しておく.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Sylvester の慣性法則]
\label{q:sylvester-3}
  実二次形式 $Q$ の符号数 $(p,q)$ は $Q$ から一意に定まる. \qed
\end{question}

\noindent
ヒント: 二次形式 $Q_{p,q}$ を $\R^n$ 上の函数とみなし, 
$n$ 次の正則行列 $P$ が $Q_{p,q}(Px)=Q_{p',q'}(x)$ を満たしているとき,
$p=p'$, $q=q'$ が成立していることを示せば良い.

$Q_{p,q}(x)$ に対応する実対称行列 $A_{p,q}$ の rank は $p+q$ であり, 
$Q_{p,q}(Px)$ に対応する実対称行列 $\tp{P}AP$ の rank も $p+q$ な
ので $Q_{p,q}(Px)=Q_{p',q'}(x)$ より $p+q=p'+q'$ が導かれる.
よって, $p<p'$ と仮定して矛盾を導けば良い.

$y=Px$ の第 $i$ 成分を $y_i$ と書き, 
$x$ の成分 $x_1,\dots,x_n$ に関する連立一次方程式
\begin{equation*}
  y_i = \sum_{j=1}^n p_{ij} x_j = 0 \quad (i=1,\dots,p),
  \qquad
  x_i = 0 \quad (i=p'+1,\dots,n)
\end{equation*}
を考える.  ここで $p_{ij}$ は $P$ の $(i,j)$ 成分である. 
もしも $p<p'$ ならば方程式の個数 $p+(n-p')$ が $n$ より小さくなるので,
非自明な解 $x_1,\dots,x_n$ が存在する.

このとき, $y_{p+1},\cdots,y_n$ について $y=Px\ne0$ から導かれることと
$Q_{p,q}(y)=Q_{p',q'}(x)$ から導かれることが互いに矛盾することを示せ.
\qed

\commentout{
\medskip
\noindent
解: $x\ne 0$ で $P$ は正則行列なので $y=Px\ne 0$ であり,
上の仮定より $y_1=\cdots=y_p=0$ なので $y_{p+1},\cdots,y_n$ の
どれかは $0$ でない.
ところが $Q_{p,q}(Px)=Q_{p',q'}(x)$ に非自明な解を代入すると
\begin{equation*}
  - y_{p+1}^2 - \cdots - y_{p+q}^2 = x_1^2 + \cdots + x_{p'}^2.
\end{equation*}
となるので, $y_{p+1},\cdots,y_n$ がすべて $0$ になってしまう.
これは矛盾である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:sylvester-4}
  $\R^n$ 上の2つの実二次形式が同値になるための必要十分条件はそれぞれの符号
  数が一致することである.  
  \qed
\end{question}

\noindent
ヒント: $Q_1(P_1x)=Q_{p,q}(x)=Q_2(P_2x)$ ならば $Q_1(P_1P_2^{-1}x)=Q_w(x)$.
逆に $Q_1(Px)=Q_2(x)$ でかつ $Q_1(T_1x)=Q_{p,q}(x)$,
$Q_2(T_2x)=Q_{p',q'}(x)$ ならば $Q_{p,q}(T_2PT_1^{-1}x)=Q_{p'q'}(x)$ なので
Sylvester の慣性法則を用いることができる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

以上によって\theoremref{theorem:sylvester}の証明がすべて完了した.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$n$ 次元実 Euclid 空間の直交座標系}
\label{sec:orthogonal-coordinates}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $2$ 次の実対称行列 $A$ と $2$ 次行列 $P=[u\ v]$ を次のように定める:
  \begin{equation*}
    A = \frac{1}{2}
    \begin{bmatrix}
      11 & -3 \\
      -3 & 19 \\
    \end{bmatrix},
    \qquad
    P = [u\ v] =
    \frac{1}{\sqrt{10}}
    \begin{bmatrix}
      3 & -1 \\
      1 & 3  \\
    \end{bmatrix}.
  \end{equation*}
  このとき, $P^{-1}=\tp{P}$, $P^{-1}AP=\diag(5,10)$ 
  すなわち $Au=5u$, $Av=10v$ が成立する.
  $xy$ 平面の新たな直交座標系 $x',y'$ を
  \begin{equation*}
    \begin{bmatrix}
      x \\
      y \\
    \end{bmatrix}
    =
    P
    \begin{bmatrix}
      X \\
      Y \\
    \end{bmatrix} = x'u + y'v
  \end{equation*}
  と定める.  $x'$ 軸と $y'$ 軸を $xy$ 平面に図示せよ.
  行列 $A$ の定める $xy$ 平面からそれ自身への一次変換
  は $x'y'$ 座標ではどのように説明されるか?
  \qed
\end{question}

\noindent
ヒント: $x'$ 軸はベクトル $u$ の方向になる.  $A$ が定める一次変換
は $x'$ 座標を☆倍して ☆ 座標を☆倍する一次変換である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

さて, 以下は $n$ 次元の一般論である.

$n$ 次元実 Euclid 空間 $\R^n$ を考え, 
その点 $x$ を実縦ベクトル $\tp{[x_1\ \cdots\ x_n]}$ と同一視しておく.
点 $x\in\R^n$ と $x_1,\dots,x_n$ の関係は $\R^n$ の
縦ベクトル空間としての標準的な正規直交基底 $e_1,\dots,e_n$ を用いて,
\begin{equation*}
  x = x_1 e_1 + \cdots + x_n e_n
\end{equation*}
と書ける.  通常 Euclid 空間 $\R^n$ の座標はこの $x_1,\dots,x_n$ を考える. 
しかし, Euclid 空間の中に浮かぶ物体 (直線, 平面, 球面, etc.) 形を調べるとき
には他の直交座標系を使うこともできるし, 実際, 目的に応じて便利な座標系を
用いた方が良い.

標準的な正規直交基底 $e_1,\dots,e_n$ と
別の正規直交基底 $p_1,\dots,p_n$ を任意に取り,
新たな直交座標系 $y_1,\dots,y_n$ を
\begin{equation*}
  x = y_1 p_1 + \cdots + y_n p_n
\end{equation*}
によって定義することもできる.  
この式は, 直交行列 $P$ を $P=[p_1\ \cdots\ p_n]$ と定義することによって,
\begin{equation*}
  x = p_1 y_1 + \cdots + p_n y_n =
  [p_1\ \cdots\ p_n]
  \begin{bmatrix}
    y_1 \\
    \vdots \\
    y_n \\
  \end{bmatrix}
  = Py.
\end{equation*}
ここで $y = \tp{[y_1\ \cdots\ y_n]}$ である.
これを座標の直交変換と呼ぶことにする.

原点の位置を $a\in\R^n$ にずらして, 
新たな直交座標系 $z_1,\dots,z_n$ を
\begin{equation*}
  x = z_1 e_1 + \cdots + z_n e_n + a
\end{equation*}
によって定義することもできる. 
このとき $a = \tp{[a_1\ \cdots\ a_n]}$ とすると,
\begin{equation*}
  x_i = z_i + a_i \qquad (i=1,\dots,n).
\end{equation*}
座標 $z_1,\dots,z_n$ がすべて $0$ であるような $\R^n$ の点は $a$ になる.
これを座標の平行移動と呼ぶことにする.

座標の直交変換と平行移動を組み合わせて新たな直交座標系 $w_1,\dots,w_n$ を
\begin{equation*}
  x = w_1 p_1 + \cdots + w_n p_n + a
\end{equation*}
によって定義することもできる.  この式は
\begin{equation*}
  x = Pw + a = P(w + b).
\end{equation*}
と書ける. ここで $b=P^{-1}a=\tp{P}a$ である. 

以上では数式を用いて新たな直交座標系を作る方法を説明したが, 
直観的には次のように考えれば良い.  
(3次元 Euclid 空間の世界を思い浮かべながら読んで欲しい.)

当初 $n$ 次元 Euclid 空間には標準的な直交座標系 $x_1,\dots,x_n$ だけが
定義されている.  $x_1$ 軸から $x_n$ 軸は原点で互いに直交している.

上で定義した直交座標系 $y_1,\dots,y_n$ において, 各 $y_i$ 軸の方向
は $x_i$ 軸に等しいが, $y_i$ 軸たちは原点ではなく点 $a$ で交わっている.

上で定義した直交座標系 $z_1,\dots,z_n$ において, $z_i$ 軸たちは原点で
直交しているが, それらの向きは $x_i$ 軸たちとは全然異なっている.

上で定義した直交座標系 $w_1,\dots,w_n$ において, 
$w_i$ 軸たちは原点ではなく点 $a$ で交わっており, 
それらの向きは $x_i$ 軸たちとは全然異なっている.

第\secref{sec:quadric-hypersurface}では実二次函数および実二次超曲面を直交変
換と平行移動によって変数変換して調べる.

ここでは, 最も簡単な一次函数の場合をまず調べておこう. 

$n$ 次元実 Euclid 空間 $\R^n$ 上の一次函数とは
\begin{equation*}
  f(x) = \sum_{i=1}^n a_i x_i + b
\end{equation*}
の形の函数のことである.  ここで $a_i,b\in\R$ である. 
縦ベクトル $a\in\R^n$ を $a=\tp{[a_1\ \cdots\ a_n]}$ と定めると,
\begin{equation*}
  f(x) = \tp{a}x + b = \bra a,x\ket + b 
\end{equation*}
と書ける. もしも $a=0$ ならば
\begin{equation*}
  f(x) = b
  \tag{1}
\end{equation*}
となる. $a\ne 0$ ならば単位ベクトル $p_1=a/\norm{a}$ を含む $\R^n$ の
正規直交基底 $p_1,\dots,p_n$ を取れる.  
直交行列 $P$ を $P=[p_1\ \cdots\ p_n]$ と定める.  このとき, 
\begin{equation*}
  \tp{a}P 
  = \bigl[\bra a,p_1\ket\ \bra a,p_2\ket\ \cdots\ \bra a,p_n\ket\bigr] 
  = [\alpha\ 0\ \cdots\ 0].
\end{equation*}
ここで $\alpha=\norm{a}>0$ である. 
よって, $x$ に $Py$ を代入すると
\begin{equation*}
  g(y) := f(Py) = \tp{a}Py + b = \alpha y_1 + b = \alpha(y_1 + c).
\end{equation*}
ここで $c = b/\alpha$ である.
$y_1$ 軸はちょうどベクトル $a$ の報告を向いている.
よって, $a$ と $x$ の内積は $x$ の $y_1$ 軸への射影の $\alpha=\norm{a}$ 倍に
なる.  ($n=3$ の場合に関して図を描いでみよ.)
さらに, $y$ に $z - c e_1$ を代入すると
\begin{equation*}
  h(z) := g(z - c e_1) = \alpha(z_1 - c + c) = \alpha z_1.
  \tag{2}
\end{equation*}
よって $a\ne 0$ のとき直交座標をうまく取り直せば, $\R^n$ 上の任意の
一次函数は上の (2) の形に表わされることがわかった.

これはある意味当然である. なぜならば $a\ne 0$ の場合の一次函数のグラフは傾い
た平面の形になる.  その傾きの方向が単位ベクトル $p_1=a/\norm{a}$ で示され, 
その傾きの大きさは $\norm{a}$ になる.  よって, その一次函数が $0$ になる点を
原点に選び, 座標軸の1つが $p_1$ の方向を向いているような直交座標系を取ればそ
の一次函数は (2) のように表示されるのである.

数学を楽に理解するコツは抽象的だが論理的に厳密な議論と直観的にわかり易いが厳
密性が低い議論の両方を自由に行ったり来たりできるように努力することである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{実二次函数と実二次超曲面の分類}
\label{sec:quadric-hypersurface}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:6xx-4xy+9yy=20}
  $xy$ 平面上の曲線 $6x^2 - 4xy + 9y^2 = 20$ を図示せよ. \qed
\end{question}

\noindent
ヒント: 以下の手続きで曲線を描く.
\begin{enumerate}
\item 対称行列 $A =
  \begin{bmatrix}
    6 & -2 \\
    -2 & 9 \\
  \end{bmatrix}$ の固有値 $\alpha$, $\beta$ と
  対応する単位固有ベクトル $u$, $v$ を求める.
\item $P=[u\ v]$ と置くと $P$ は直交行列である.
\item $\tp{P}AP=\diag(\alpha,\beta)$ となる.
\item 新たな座標系 $(x',y')$ を $
  \begin{bmatrix}
    x \\
    y \\
  \end{bmatrix}
  =
  P
  \begin{bmatrix}
   x' \\
   y' \\
  \end{bmatrix} = x'u + y'v$
  と定める.  $xy$ 平面に $x'$ 軸と $y'$ 軸を描き込む. 
  $x'$ 軸と $y'$ 軸はそれぞれ $u$ と $v$ の方向を向いている.
\item 曲線の式は $\alpha{x'}^2 + \beta{y'}^2 = 20$ となる.
  この曲線を $x'y'$ 平面 $=$ $xy$ 平面に描き込む.
\end{enumerate}
ポイントは $ax^2 + 2bxy + cy^2$ の形の式を見掛けたら,  対称行列 $
\begin{bmatrix}
  a & b \\
  b & c \\
\end{bmatrix}$ を対角化する直交行列 $P$ を求めて, $P$ を用いて座標変換して, 
新たな座標で曲線の描くことである.
\qed

\commentout{
\medskip
\noindent
略解: $\displaystyle
P = [u\ v] =
\frac{1}{\sqrt{5}}
\begin{bmatrix}
  2 & -1 \\
  1 &  2 \\
\end{bmatrix}$, $\alpha=5$, $\beta=10$ となり, 
曲線の式は $x'y'$ 座標では $\displaystyle
\frac{{x'}^2}{4} + \frac{{y'}^2}{2} = 1$ の形になる. \qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  次の $(x,y)\in\R^2$ の二次函数 $z=f(x,y)$ のグラフの概型を描け:
  \begin{equation*}
    z = f(x,y) = \alpha x^2 + \beta y^2 + \gamma.
  \end{equation*}
  ただし, $(\alpha,\beta)$ の符号を $(+,+)$, $(+,-)$, $(-,-)$, $(+,0)$,
  $(-,0)$, $(0,0)$ の6通りに分類してグラフの曲面を描いてみよ.
  それぞれのグラフと $xy$ 平面 $z=0$ の交わりはどのような形になるか?
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  直交座標 $x,y,z$ を持つ $\R^3$ における次の二次曲面の概型を描け:
  \begin{enumerate}
  \item $x^2 + y^2 + z^2 = 1$,
  \item $x^2 + y^2 - z^2 = 1$,
  \item $x^2 + y^2 - z^2 = -1$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:quadric-sufaces}
  直交座標 $x,y,z$ を持つ $\R^3$ における次の二次曲面の概型を描け:
  \begin{equation*}
    \alpha x^2 + \beta y^2 + \gamma z^2 = \delta.
  \end{equation*}
  ただし, $\alpha\beta\gamma\delta\ne 0$ と仮定する.
  $(\alpha,\beta,\gamma,\delta)$ の符号
  を $(+,+,+,+)$, $(+,+,-,+)$, $(+,+,-,-)$
  の3通りに分類してそれぞれの場合に曲面の概型を描いてみよ.
  どうしてこの3通りだけを考えれば十分なのか説明せよ.
  後者の2つの場合と $\delta=0$ の場合の曲面を1つの図で描いてみよ.
  \qed
\end{question}

\noindent
ヒント: 長谷川の連載 \cite{hasegawa-rensai} の第15回 
(『数学セミナー』 2002年6月号) の78頁の図2.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

この節の目標は一般次元の場合に実二次超曲面を分類することである.

2次元平面上の非退化な実二次曲線は{\bf 楕円 (ellipse)} と
{\bf 双曲線 (hyperbola)} の2通りに分類される.
退化した場合として{\bf 放物線 (parabola)} が得られる.

3次元空間内の非退化な実二次曲面は問題 \qref{q:quadric-sufaces} で
グラフを描いた
{\bf 楕円面 (ellipsoid)}, 
{\bf 一葉双曲面 (hyperboloid of one sheet)}, 
{\bf 二葉双曲面 (hyperboloid of two sheets)}
の3通りに分類されてしまう.

これらの事実を $n$ 次元に一般化したい.

\medskip

$n$ 次元実 Euclid 空間 $\R^n$ 上の{\bf 二次函数 (quadratic function)}とは
\begin{equation*}
  f(x) := \sum_{i,j=1}^n a_{ij}x_ix_j + 2\sum_{i=1}^n b_ix_i + c
\end{equation*}
の形の函数のことである. ここで $a_{ij},b_i,c\in$ でかつ $a_{ij}=a_{ji}$.
実二次函数 $f(x)$ が定める $\R^n$ における
{\bf 二次超曲面 (quadric hypersurface, hypersurface of the second order)} 
とは方程式 $f(x)=0$ が定める $\R^n$ の部分集合のことである.

実二次函数 $f(x)$ は実対称行列 $A=[a_{ij}]$ と
実縦ベクトル $b=\tp{[b_1\ \cdots\ b_n]}$ を用いて,
\begin{equation*}
  f(x) = \tp{x}Ax + 2\tp{b}x + c = \bra x,Ax\ket + \bra b,x\ket + c
\end{equation*}
と表わすことができる.  最初の項の $\tp{x}Ax=\bra x,Ax\ket$ は
実対称行列 $A$ が定める実二次形式 $Q_A(x)$ に等しい.
よって, $A$ の固有値の全体を $\alpha_1,\dots,\alpha_n$ とすると, 
問題 \qref{q:sylvester-2} の前半の結果より, 
ある直交行列 $T$ が存在して
\begin{equation*}
  Q_A(Ty) = \tp{y}\tp{T}ATy = \alpha_1 y_1^2 + \cdots + \alpha_n y_n^2
\end{equation*}
となる. そして, $\tp{b}Ty=\tp{(\tp{T}b)}y$ であるから,
$b'=\tp{[b'_1\ \cdots\ b'_n]}=\tp{T}b=T^{-1}b$ と置けば,
\begin{equation*}
  g(y) := f(Ty) 
  = \sum_{i}^n \alpha_i y_i^2 + 2\sum_{i=1}^n b'_i y_i + c.
\tag{0}
\end{equation*}
これは $n$ 次元実 Euclid 空間 $\R^n$ の直交座標系を直交変換することによって,
二次函数の二次の項をすべて $\alpha_i y_i^2$ の形にできることを意味している.

$|A|\ne 0$ (これは $\alpha_i\ne 0$ ($i=1,\dots,n$) と同値) のとき,
二次函数 $f(x)$ と二次超曲面 $f(x)=0$ は{\bf 非退化 (non-degenerate)} 
であるという.  それ以外の場合には{\bf 退化している (degenerate)}という.

\medskip

次のステップは変数 $y_i$ を平行移動して表示をさらに簡単にすることである.  
これからやる計算は中学三年生または高校一年生のときに習う次の平方完成の
繰り返しに過ぎない.  $a\ne 0$ とすると,
\begin{equation*}
  ay^2 + 2by + c = a \left(y + \frac{b}{a}\right)^2 - \frac{b^2}{a} + c.
\end{equation*}
ここで $y = z - b/a$, $\gamma = - b^2/a + c$ と置くと, 
\begin{equation*}
  ay^2 + 2by + c = a z^2 + \gamma.
\end{equation*}
座標 $y_i$ の座標 $z_i$ への平行移動も同じように行なわれる.
このような計算についてはすでに皆よく理解しているはずなので上の (0) 式の
段階で大学で教えるべき議論の本質的な部分は終了していると考えられる. 

さて, 平方完成の計算を実行するために次のように仮定する:
\begin{align*}
  &
  \alpha_i>0 \quad (i=1,\dots,p), 
  \\ &
  \alpha_i<0 \quad (i=p+1,\dots,p+q),
  \\ &
  \alpha_i=0 \quad (i=p+q+1,\dots,n),
  \\ &
  b'_i\ne 0 \quad (i=p+q+1,\dots,p+q+s),
  \\ &
  b'_i=0 \quad (i=p+q+s+1,\dots,n).
\end{align*}
このとき,
\begin{align*}
  g(y) &
  = \sum_{i=1}^{p+q} (\alpha_i y_i^2 + 2b'_i x_i) 
  + \sum_{i=p+q+1}^{p+q+s} 2b'_i y_i
  + c
  \\ &
  = \sum_{i=1}^{p+q} \alpha_i \left[
      \left( y_i + \frac{b'_i}{\alpha_i} \right)^2 - \frac{{b'_i}^2}{\alpha_i}
    \right]
  + \sum_{i=p+q+1}^{p+q+s} 2b'_i y_i
  + c
  \\ &
  = \sum_{i=1}^{p+q} \alpha_i \left(y_i + \frac{b'_i}{\alpha_i}\right)^2
  + \sum_{i=p+q+1}^{p+q+s} 2b'_i y_i
  + \gamma.
\end{align*}
ここで,
\begin{equation*}
  \gamma = 
  - \sum_{i=1}^{p+q} \frac{{b'_i}^2}{\alpha_i} 
  + c.
\end{equation*}

\medskip
\noindent
$s=0$ の場合: 座標 $y_i$ を座標 $z_i$ に次のように平行移動する:
\begin{equation*}
  y_i =
  \begin{cases}
    z_i - b'_i/\alpha_i \quad & (i=1,\dots,p+q), \\
    z_i                 \quad & (i=p+q+1,\dots,n). \\
  \end{cases}
\end{equation*}
このとき, $g(y)$ を座標系 $z_1,\dots,z_n$ で見たものを $h(z)$ と書くと, 
\begin{equation*}
  h(z) = \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \gamma.
  \tag{1}
\end{equation*}
($s\le n-p-q$ なので, 
もしも $A$ が非退化 ($|A|\ne 0$) ならば $p+q=n$ なので $s=0$ となる
ことに注意せよ.)

\medskip
\noindent
$s>0$ の場合: 前節の終わりの結果より, $y_{p+q+1},\dots,y_{p+q+s}$ を直交変換
して平行移動すると,
\begin{equation*}
  \sum_{i=p+q+1}^{p+q+s} 2b'_i y_i + \gamma
  = \beta z_{p+q+1}
\end{equation*}
が成立するような直交座標 $z_{p+q+1},\dots,z_{p+q+s}$ が取れる.
ここで, 
\begin{equation*}
  \beta := 2\bigl({b'_{p+q+1}}^2+\cdots+{b'_{p+q+s}}^2\bigr)^{1/2} > 0.
\end{equation*}
残りの新座標を次のように定める:
\begin{equation*}
  y_i =
  \begin{cases}
    z_i - b'_i/\alpha_i \quad & (i=1,\dots,p+q), \\
    z_i                 \quad & (i=p+q+s+1,\dots,n). \\
  \end{cases}
\end{equation*}
これで新たな直交座標系 $z_1,\dots,z_n$ が定まった.
このとき, $g(y)$ を座標系 $z_1,\dots,z_n$ で見たものを $h(z)$ と書くと, 
\begin{equation*}
  h(z) = \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \beta z_{p+q+1}.
  \tag{2}
\end{equation*}

以上によって次の定理が証明された.

\begin{theorem}
\label{theorem:principal-axis}
  実二次函数 $f(x)$ は $x_1,\dots,x_n$ とは別の直交座標系 $z_1,\dots,z_n$ を
  適切に取ればその座標系において次の (1) または (2) のように表わされる:
  \begin{align*}
    &
    h(z) = \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \gamma,
    \tag{1}
    \\ &
    h(z) = \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \beta z_{p+q+1}.
  \tag{2}
  \end{align*}
  ここで $\alpha_i>0$ ($i=1,\dots,p$), $\alpha_i<0$ ($i=p+1,\dots,p+q$), 
  $\gamma\in\R$, $\beta>0$ である.
  \qed
\end{theorem}

\begin{cor}[実二次超曲面の主軸変換]
\label{cor:principal-axis}
  $n$ 次元実 Euclid 空間における任意の実二次超曲面は
  適当に直交座標系 $z_1,\dots,z_n$ を選べば次の (1) または (2) と表示される:
  \begin{align*}
    &
    \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \gamma = 0,
    \tag{1}
    \\ &
    \alpha_1 z_1^2 + \cdots + \alpha_{p+q} z_{p+q}^2 + \beta z_{p+q+1} = 0.
  \tag{2}
  \end{align*}
  ここで $\alpha_i>0$ ($i=1,\dots,p$), $\alpha_i<0$ ($i=p+1,\dots,p+q$), 
  $\gamma\in\R$, $\beta>0$ である.
  このとき, $z_1$ 軸から $z_{p+q}$ 軸までをこの実二次超曲面の
  {\bf 主軸 (principal axis)} と呼ぶ.
  \qed
\end{cor}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremref{theorem:principal-axis}によれば, 実二次函数 $f(x)$ に対して
ある直交行列 $P$ とあるベクトル $s\in\R^n$ をうまく取って $f(P(x+s))$ を
次の形にできる:
\begin{align*}
  &
  f(P(x+s)) 
  = \alpha_1 x_1^2 + \cdots + \alpha_{p+q} x_{p+q}^2 + \gamma,
  \tag{1}
  \\ &
  f(P(x+s)) 
  = \alpha_1 x_1^2 + \cdots + \alpha_{p+q} x_{p+q}^2 + \beta x_{p+q+1}.
  \tag{2}
\end{align*}
ここで $\alpha_i>0$ ($i=1,\dots,p$), $\alpha_i<0$ ($i=p+1,\dots,p+q$), 
$\gamma\in\R$, $\beta>0$ である.
\corref{cor:principal-axis}では
\begin{equation*}
  \{\, x_iPe_i + Pv \mid x_i \in \R \,\}
  \qquad
  (i=1,\dots,p+q)
\end{equation*}
を二次超曲面 $f(x)=0$ の主軸と呼ぶことにしたのであった.
二次曲面 $f(P(x+s))=0$ を二次超曲面を $f(x)=0$ の主軸変換と呼ぶ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:arq-1}
  主軸変換を求めることによって, $\R^3$ における次の実二次曲面が
  どのような曲面であるかを調べ, その概形の図を描け:
  \begin{equation*}
    f(v) =  5x^2 + 3y^2 + 3z^2 - 4xy + 4xz + 10yz - 24x + 48y + 12 = 0.
  \end{equation*}
  ここで $v=\tp{[x,y,z]}$ である. \qed
\end{question}

\noindent
ヒント: $f(v)$ は次のように表わされる:
\begin{equation*}
  f(v) = \tp{v}Av + 2\tp{b}v + c.
\end{equation*}
ここで
\begin{equation*}
  A =
  \left[ 
    \begin{array}{rrr}
       5 & -2 & 2 \\
      -2 &  3 & 5 \\
       2 &  5 & 3 \\
    \end{array}
  \right],
  \quad
  b =
  \left[ 
    \begin{array}{r}
      -12 \\
       24 \\
        0 \\
    \end{array}
  \right],
  \quad
  c = 12.
\end{equation*}
まず, 直交行列 $P$ で $\tp{P}AP$ が対角行列 $D=\diag(\alpha,\beta,\gamma)$ に
なるものを求める. そのとき $b'=\tp{[b_1',b_2',b_3']}=\tp{P}b$ と置くと,
\begin{equation*}
  f(Pv) 
  = \tp{v}Dv + 2\tp{b}Pv + c
  = \alpha x^2 + \beta y^2 + \gamma z^2 
  + 2b_1'x + 2b_2'y + 2b_3'z + c.
\end{equation*}
この問題では $\alpha,\beta,\gamma\ne 0$ となるので, 
これはさらに次のように変形される:
\begin{equation*}
  f(Pv) 
  = \alpha\left(x + \frac{b_1'}{\alpha}\right)^2
  + \beta \left(y + \frac{b_2'}{\beta} \right)^2
  + \gamma\left(z + \frac{b_3'}{\gamma}\right)^2
  + c'.
\end{equation*}
ここで
\begin{equation*}
  c' = c 
  - \frac{(b_1')^2}{\alpha} 
  - \frac{(b_2')^2}{\beta} 
  - \frac{(b_3')^2}{\gamma}.
\end{equation*}
よって $s = -\tp{[b_1'/\alpha, b_2'/\beta, b_3'/\gamma]}$ と置けば
\begin{equation*}
  f(P(v+s)) = \alpha x^2 + \beta y^2 + \gamma z^2 + c'.
\end{equation*}
ここまで計算できれば二次曲面 $f(P(v+s))=0$ のグラフを描くことができる.
ただし, $f(P(v+s))=0$ のグラフを描くときの $x$, $y$, $z$ 軸は
$P(v+s)$ と変換する前の座標における主軸の位置に描かなければいけない.
\qed

\commentout{
\medskip
\noindent
略解: $D=\diag(6,8,-3)$ と置き, 直交行列 $P$ を
\begin{equation*}
  P =
  \left[ 
    \begin{array}{rrr}
      -4 & 0 &  1 \\
       1 & 1 &  2 \\
      -1 & 1 & -2 
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccr}
      3\sqrt{2} & 0        & 0 \\
      0         & \sqrt{2} & 0 \\
      0         & 0        & 3
    \end{array}
  \right]^{-1}
\end{equation*}
と定めると, $\tp{P}AP=D$ である. このとき,
\begin{equation*}
  f(Pv) =  6x^2 + 8y^2 - 3z^2 + 24\sqrt{2}x + 24\sqrt{2}y + 24z + 12.
\end{equation*}
よって $s = - \tp{[2\sqrt{2}, 3\sqrt{2}/2, -4]}$ と置くと, 
\begin{equation*}
  f(P(v+s)) = 6x^2 + 8y^2 - 3z^2 - 24,
  \qquad
  Ps = \tp{[4, -7/2, 1/2]}.
\end{equation*}
さらに $f(P(v+s))=0$ は次と同値である:
\begin{equation*}
    \biggl(\frac{x}{2}\biggr)^2
  + \biggl(\frac{y}{\sqrt{3}}\biggr)^2
  - \biggl(\frac{z}{2\sqrt{2}}\biggr)^2
  = 1.
  \qed
\end{equation*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:arq-2}
  主軸変換を求めることによって, $\R^3$ における次の実二次曲面が
  どのような曲面であるかを調べ, その概形の図を描け:
  \begin{align*}
    f(v)
    &
    = 6x^2 + y^2 + 6z^2
    + 2xy + 8xz - 2yz 
    \\ &
    + (- 8 - 5\sqrt{6})x
    + (2 + 10\sqrt{6})y
    + (- 12 + 5\sqrt{6})z 
    - 26
    = 0.
  \end{align*}
  ここで $v=\tp{[x,y,z]}$ である. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:arq-1} と同様に計算すると $\gamma=0$ となってしまい,
\begin{equation*}
  f(Pv) 
  = \alpha x^2 + \beta y^2 
  + 2b_1'x + 2b_2'y + 2b_3'z
  + c
\end{equation*}
の形になる.  この問題の場合は $b_3'>0$ となる.
$s':=-\tp{[b_1'/\alpha,b_2'/\beta,0]}$ と置くと $f(P(v+s'))$ は次の形になる:
\begin{equation*}
  f(P(v+s')) = \alpha x^2 + \beta y^2 + 2b'_3z + c'.
\end{equation*}
よって $s=-\tp{[b_1'/\alpha,b_2'/\beta,c'/(2b'_3)]}$ と置くと,
\begin{equation*}
  f(P(v+s)) = \alpha x^2 + \beta y^2 + 2b'_3z.
  \qed
\end{equation*}

\commentout{
\medskip
\noindent
略解: $D=\diag(10,3,0)$ と置き, 対称行列 $A$ と直交行列 $P$ を
\begin{equation*}
  A =
  \left[ 
    \begin{array}{rrr}
      6 &  1 &  4 \\
      1 &  1 & -1 \\
      4 & -1 &  6 \\
    \end{array}
  \right],
  \quad
  P = 
  \left[ 
    \begin{array}{rrr}
      1 & -1 & -1 \\
      0 & -1 &  2 \\
      1 &  1 &  1
    \end{array}
  \right]
  \left[ 
    \begin{array}{ccc}
      \sqrt {2} & 0 & 0 \\
      0 & \sqrt {3} & 0 \\
      0 & 0 & \sqrt {6}
    \end{array}
  \right]^{-1}
\end{equation*}
と定めると, $\tp{P}AP=D$ が成立するので,
\begin{equation*}
  f(Pv) = 10x^2 + 3y^2 - 10\sqrt{2}x - 2\sqrt{3}y + 30z - 26.
\end{equation*}
$s'=-\tp{[1/\sqrt{2},1/\sqrt{3},0]}$ と置くと,
\begin{equation*}
  f(P(v+s')) = 10x^2 + 3y^2 + 30z - 32.
\end{equation*}
よって, $s = s' + \tp{[0,0,16/15]}$ と置くと,
\begin{equation*}
  f(P(v+s)) = 10x^2 + 3y^2 + 30z,
  \qquad
  Ps = \frac{\sqrt{6}}{90}\tp{[-1,2,1]}.
\end{equation*}
$f(P(v+s))=0$ と次は同値である:
\begin{equation*}
  z = 
  - \bigg(\frac{x}{\sqrt{3}}\bigg)^2 
  - \bigg(\frac{y}{\sqrt{10}}\bigg)^2.
  \qed
\end{equation*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{射影空間の中の二次超曲面}
\label{sec:projective-quadratic}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:quad-func-on-cell}
  $n$ 次元実 Euclid 空間上の実二次函数を次の形で表わすこともできる:
  \begin{equation*}
    f(x') = 
    [\tp{x'},1]
    \begin{bmatrix}
        A'   & b \\
      \tp{b} & c \\
    \end{bmatrix}
    \begin{bmatrix}
      x' \\
      1 \\
    \end{bmatrix}
    \qquad (x'\in\R^n).
  \end{equation*}
  ここで $A'$ は $n$ 次実対称行列であり, $b\in\R^n$, $c\in\R$ である.
  \qed
\end{question}

上の問題中の行列 $A =
\begin{bmatrix}
    A'   & b \\
  \tp{b} & c \\
\end{bmatrix}$ は任意の $n+1$ 次実対称行列に成り得る.  
よって $n$ 次元実 Euclid 空間上の実二次函数と $n+1$ 次の
実対称行列は一対一に対応している.  
上の問題のように二次函数を表示
すれば $\begin{bmatrix} x' \\ 1 \end{bmatrix}$ の形の $n+1$ 次元ベクトルを
考えるだけではなく, 任意の $n+1$ 次元ベクトル $x =
\begin{bmatrix} x' \\ x_{n+1} \end{bmatrix}\in\R^{n+1}$ を考える方が
理論的により自然であることが見えてくる.  この観察は非常に重要である.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

一般の場合に射影空間を定義するために $K$ は任意の体であるとする. 
$K^{n+1}\setminus\{0\}$ の同値関係 $\sim$ 次のように定める:
\begin{equation*}
  x \sim y \iff \text{ある $c\in K^\times$ で $cx=y$ となるものが存在する.}
\end{equation*}
ここで $x,y\in K^{n+1}\setminus\{0\}$ である.  
ベクトル $x$, $y$ の成分
を $x=\tp{[x_1,\dots,x_{n+1}]}$, $y=\tp{[y_1,\dots,y_{n+1}]}$ と書く.
$x\sim y$ が成立するとき, $x_i$ たちの比と $y_i$ たちの比が等しいと言い,
次のように書くことにする:
\begin{equation*}
  x_1:\cdots:x_{n+1} = y_1:\cdots:y_{n+1}
  \iff x \sim y.
\end{equation*}
このやり方で「比」の概念を定義すれば $x_i$ や $y_i$ のどれかが $0$ になって
も通用する「比」の概念が得られることに注意せよ.

$K^{n+1}\setminus\{0\}$ を同値関係 $\sim$ で割ってできる商空間を
{\bf $n$ 次元射影空間 ($n$-dimensional projective space)} と呼び, 
$\P^n(K)$ と表わす:
\begin{equation*}
  \P^n(K) := (K^{n+1}\setminus\{0\})/{\sim}.
\end{equation*}
特に $\P^1(K)$ は射影直線と呼ばれ, $\P^2(K)$ は射影平面と呼ばれる.

ベクトル $x=\tp{[x_1,\dots,x_{n+1}]}\in K^{n+1}\setminus\{0\}$ に
対応する射影空間の点 $[x]\in \P^n(K)$ を
\begin{equation*}
  [x] = [x_1:\dots:x_{n+1}]
\end{equation*}
と比の記号を用いて表わす.  任意の $x,y\in K^{n+1}\setminus\{0\}$ に対して,
\begin{equation*}
  [x] = [y] \iff x\sim y \iff x_1:\cdots:x_{n+1} = y_1:\cdots:y_{n+1}
\end{equation*}
であるから, 射影空間の点を比の記号を用いて表わすことは自然である.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[射影直線の胞体分割]
\label{q:cell-decomp-P^1}
  直線 $K$ と射影直線 $\P^1(K)$ の
  部分集合 $X_1:=\{\,[x_1:1]\mid x_1\in K\,\}$ 
  は対応 $x_1\leftrightarrow [x_1:1]$ によって同一視できる%
  \footnote{写像 $K\to X_1$, $x_1\mapsto[x_1:1]$ が全単射であることを示せ.}.
  $\P_1(K)$ の一点からなる部分集合 $X_0$ を $X_0=\{[1:0]\}$ と定める.
  このとき $\P^1(K)$ は直線 $X_1$ と一点 $X_0$ の交わりのない和に分解される:
  \begin{equation*}
    \P^1(K) = X_1 \sqcup X_0.
    \qed
  \end{equation*}
\end{question}

\noindent
解説: 直観的には, 射影直線のほとんどの部分は直線 $K$ で構成されており,
無限遠にさらにもう一点存在するという風に考える.
実際, $x_1\ne 0$ ならば $[x_1:1]=[1:x_1^{-1}]$ 
なので形式的に $x_1\to\infty$ とすれば $[x_1:1]\to[1:0]$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[射影平面の胞体分割]
\label{q:cell-decomp-P^2}
  射影平面 $\P^2(K)$ の部分集合 $X_2$, $X_1$, $X_0$ を次のように定める:
  \begin{equation*}
    X_2 = \{\, [x_1:x_2:1] \mid x_1,x_2\in K\,\},
    \quad
    X_1 = \{\, [x_1:1:0] \mid x_1\in K\,\},
    \quad
    X_0 = \{ [1:0:0] \}.
  \end{equation*}
  写像 $K^2\to X_2$, $\tp{[x_1,x_2]}\mapsto [x_1:x_2:1]$ 
  と $K\to X_1$, $x_1\mapsto [x_1:1:0]$ は全単射である.
  射影平面 $\P^2(K)$ は平面 $X_2$ と直線 $X_1$ と一点 $X_0$ の
  交わりのない和に分解される:
  \begin{equation*}
    \P^2(K) = X_2 \sqcup X_1 \sqcup X_0.
    \qed
  \end{equation*}
\end{question}

\noindent
解説: $X_1\sqcup X_0$ と射影直線 $\P^2(K)$ は自然に同一視できる.
直観的には, 射影平面のほとんどの部分は平面 $K^2$ で構成されており,
無限遠に射影直線 (地平線) が存在すると考える.
実際, $c\ne 0$ ならば $[x_1:x_2:1]=[c^{-1}x_1:x^{-1}x_2:c^{-1}]$ 
なので $x_1=cy_1$, $x_2=cy_2$ と置き, 
形式的に $c\to\infty$ とすれば $[x_1:x_2:1]\to[y_1:y_2:0]$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[射影空間の胞体分割]
\label{q:cell-decomp-P^n}
  射影空間 $\P^n(K)$ の部分集合 $X_n,X_{n-1},\dots,X_1,X_0$ を
  次のように定める: 
  \begin{align*}
    &
    X_n = 
    \{\, [x_1:\cdots:x_{n-1}:x_n:1] \mid x_1,\cdots,x_{n-1},x_n\in K\,\},
    \\ &
    X_{n-1} = 
    \{\, [x_1:\cdots:x_{n-1}:1:0] \mid x_1,\cdots,x_{n-1}\in K\,\},
    \\ &
    \quad \cdots\cdots\cdots
    \\ &
    X_1 = \{\, [x_1:1:0:\cdots:0] \mid x_1\in K\,\},
    \\ &
    X_0 = \{ [1:0:0:\cdots:0] \}.
  \end{align*}
  次の写像は全単射である:
  \begin{equation*}
    K^m\to X_m, 
    \quad
    \tp{[x_1,\cdots,x_m]}\mapsto [x_1:\cdots:x_m:1:0:\cdots:0].
  \end{equation*}
  射影空間 $\P^n(K)$ は $X_n,X_{n-1},\dots,X_1,X_0$ の
  交わりのない和に分解される:
  \begin{equation*}
    \P^2(K) = X_n\sqcup X_{n-1}\sqcup\cdots\sqcup X_1\sqcup X_0.
    \qed
  \end{equation*}
\end{question}

\noindent
解説: $X_{n-1}\sqcup\cdots\sqcup X_0$ と $n-1$ 次元
射影空間 $\P^{n-1}(K)$ は自然に同一視される.
直観的には, 射影平面のほとんどの部分は $n$ 次元アフィン空間 $K^n$ で
構成されており,  無限遠に $n-1$ 次元射影空間が存在すると考える.
$c\ne 0$ ならば $[x_1:\cdots:x_n:1]=[c^{-1}x_1:\cdots:x^{-1}x_n:c^{-1}]$ 
なので $x_i=cy_i$ と置き, 形式的に $c\to\infty$ と
すれば $[x_1:\cdots:x_n:1]\to[y_1:\cdots:y_n:0]$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

\begin{question}[射影変換とアフィン変換]
\label{q:proj-aff-transf}
  $T\in GL_{n+1}(K)$ と $x,y\in K^{n+1}\setminus\{0\}$ に対して, 
  $[x]=[y]$ ならば $[Tx]=[Ty]$ が成立する.
  よって $T\in GL_{n+1}(K)$ の $[x]\in\P^n(K)$ への
  作用を $T\cdot[x] := [Tx]$ と定めることができる. 
  これを射影空間 $\P^n(K)$ の{\bf 射影変換 (projective transformation)} と呼ぶ.

  $P\in GL_n(K)$ と $v\in K^n$ が定める $K^n$ の変換 $x'\mapsto Px'+v$ 
  を $K^n$ の{\bf アフィン変換 (affine transformation)} と呼ぶ.
  すなわち可逆な線形変換 $x'\mapsto Px'$ と平行移動 $x'\mapsto x'+v$ を組み
  合わせてできる変換をアフィン変換と呼ぶ.

  $x'=\tp{[x_1,\dots,x_n]}\in K^n$ に対して $\P^n(K)$ の点 $[x':1]$
  を $[x':1]:=[x_1:\cdots:x_n:1]$ と定めると,
  問題 \qref{q:cell-decomp-P^n} の結果に
  よって $\P^n(K)$ の部分集合 $X_n$ と $K^n$ は次のように同一視される:
  \begin{equation*}
    K^n \isom X_n=\{\,[x':1]\mid x'\in K^n\,\},
    \quad
    x' \leftrightarrow [x':1].
  \end{equation*}
  この同一視のもとで $P\in GL_n(K)$ と $v\in K^n$ に対応
  する $K^n$ のアフィン変換は次の $T\in GL_{n+1}(K)$ で表現される:
  \begin{equation*}
    T = 
    \begin{bmatrix}
      P & v \\
      0 & 1 \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント1: 次の公式が成立する:
\begin{equation*}
  \begin{bmatrix}
    P & v \\
    0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x' \\
    1 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    Px' + v \\
       1 \\
  \end{bmatrix}.
  \qed
\end{equation*}

\medskip
\noindent
ヒント2: $T=[t_{ij}]_{i,j=1}^{n+1}\in GL_{n+1}(K)$ 
と $x=\tp{[x_1,\dots,x_{n+1}]}\in K^{n+1}$ に対して, 
もしも $\sum_{j=1}^{n+1}t_{n+1,j}x_j\ne 0$ ならば
\begin{align*}
  T[x_1:\cdots:x_n:x_{n+1}]
  &= 
  \left[
    \sum_{j=1}^{n+1}t_{1j}x_j
    : \cdots :
    \sum_{j=1}^{n+1}t_{nj}x_j
    :
    \sum_{j=1}^{n+1}t_{n+1,j}x_j
  \right]
  \\ &
  =
  \left[
    \frac{\sum_{j=1}^{n+1}t_{1j}x_j}{\sum_{j=1}^{n+1}t_{n+1,j}x_j}
    : \cdots :
    \frac{\sum_{j=1}^{n+1}t_{nj}x_j}{\sum_{j=1}^{n+1}t_{n+1,j}x_j}
    : 1
  \right].
\end{align*}
この一般的な公式で $t_{ij}=p_{ij}$ ($i,j=1,\dots,n$), 
$t_{i,n+1}=v_i$ ($i=1,\dots,n$),
$t_{n+1,j}=0$ ($j=1,\dots,n$), 
$t_{n+1,n+1}=1$,
$x_{n+1}=1$ と置くと $\sum_{j=1}^{n+1}t_{n+1,j}x_j= 1\ne 0$ であるから,
\begin{equation*}
  T[x_1:\cdots:x_n:1]
  = 
  \left[
    \sum_{j=1}^n p_{1j}x_j + v_1
    : \cdots :
    \sum_{j=1}^n p_{nj}x_j + v_n
    :
    1
  \right].
  \qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

さてここで問題 \qref{q:quad-func-on-cell} の結果に戻ろう.
問題 \qref{q:quad-func-on-cell} の結果によれば $\R^n$ 上の
実二次函数 $f(x')$ は $n+1$ 次の実対称行列 $A$ によって次のように
表わされる:
\begin{equation*}
  f(x') = \tp{x}Ax =
  [\tp{x'},1]
  \begin{bmatrix}
    A'     & b \\
    \tp{b} & c \\
  \end{bmatrix}
  \begin{bmatrix}
    x' \\
    1 \\
  \end{bmatrix}
  \qquad
  (x = \tp{[x',1]}\in \R^{n+1},\ x'\in \R^n).
\end{equation*}
問題 \qref{q:proj-aff-transf} の結果より, $n$ 次の直交行列 $P$ 
と $n$ 次元ベクトル $v\in\R^n$ に対応するアフィン変換は
\begin{equation*}
  T = 
  \begin{bmatrix}
    P & v \\
    0 & 1 \\
  \end{bmatrix}
  \in GL_{n+1}(\R)
\end{equation*}
に対応する射影変換と同一視できる.  実二次函数の標準形 
(\theoremref{theorem:principal-axis}) もしくは実二次超曲面の主軸変換 
(\corref{cor:principal-axis}) に関する結果は
「上の特別な形の射影変換 $T$ による $A\mapsto \tp{T}AT$ という
変換で $n+1$ 次の実対称行列 $A$ の形をできるだけ簡単にせよ」という
問題に解答を与えていると考えられる.

それでは射影変換 $T$ に制限を付けずに実二次超曲面の分類を考えるとどうなるで
あろうか.  注意しなければいけないことは一般の射影変換は $\R^n$ と
同一視されている $X_n\subset\P^n(\R)$ を保つとは限らないことである.
有限の位置にあった点が射影変換で無限遠に移ることがありえる.

しかし, そこまで変換の自由度を広げるメリットは大きい.
なぜならばそうすることによって射影空間内の二次超曲面の分類
が二次形式の分類に帰着してしまうことになるからである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$0$ でない $n+1$ 次の実対称行列 $A$ に対して $\R^{n+1}$ 上の
二次函数 $f$ を次のように定める:
\begin{equation*}
  f(x) = \tp{x}Ax
  \qquad (x\in\R^{n+1}).
\end{equation*}
このとき $x,y\in\R^{n+1}\setminus\{0\}$ に対して, 
$[x]=[y]$ ならばある $c\in\R^\times$ が存在して $cx=y$ となるの
で $f(y)=f(cx)=c^2f(x)$ となり, $f(x)=0$ と $f(y)=0$ は同値になる.
$f$ の定める実射影空間 $\P^n(\R)$ における{\bf 二次超曲面} $V$ を
次のように定義する:
\begin{equation*}
  V := \{\,[x]\in\P^n(\R)\mid f(x)=0 \,\}.
\end{equation*}
射影変換で互いに移り合う二次超曲面は互いに同値であると言うことにする.
同値な実二次射影曲面の中からできるだけ簡単な表示を持つものを見付けるの
が問題である.

\begin{question}[実射影空間における実二次超曲面の分類]
  $n$ 次元実射影空間 $\P^n(\R)$ における実二次超曲面 $V$ は射影変換によって
  次の表示を持つ実二次超曲面に移る:
  \begin{equation*}
    x_1^2 + \cdots + x_p^2 = x_{p+1}^1+\cdots+x_{p+q}^2.
  \end{equation*}
  しかも $(p,q)$ は $p$ と $q$ の交換の違いを除いて $V$ から一意に定まる.
  \qed
\end{question}

\noindent
ヒント: これは\theoremref{theorem:sylvester}の言い換えに過ぎない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実射影平面上の実二次曲線の分類]
\label{q:proj-real-quadratic}
  実射影平面 $\P^2(\R)$ 上の実二次曲線 $V$ は次の3通りのどれかに同値である:
  \begin{align*}
    &
    x_1^2 + x_2^2 + x_3^2 = 0,
    \tag{1}
    \\ &
    x_1^2 + x_2^2 = x_3^2,
    \tag{2}
    \\ &
    x_1^2 + x_2^2 = 0,
    \tag{3}
    \\ &
    x_1^2 = x_2^2,
    \tag{4}
    \\ &
    x_1^2 = 0.
    \tag{5}
  \end{align*}
  それぞれの方程式が定める実射影平面の部分集合は以下のようになる:
  \begin{itemize}
  \item (1)が定める実射影平面の部分集合は空集合になる.
  \item (2)の曲線は実平面 $\R^2$ と
    同一視される $X_2=\{\,[x:y:1]\mid x,y\in\R\,\}$ に含まれ, 
    $x^2+y^2=1$ と表わされる.
  \item (3)が定める実射影平面の部分集合は $[0:0:1]$ の一点になる.
  \item (4)は $x_1\pm x_2$ のそれぞれを $x_1$, $x_2$ と置く変数変換
    によって $x_1x_2=0$ に変換される. その方程式が定める実射影平面の部分集合
    は二つの射影直線 $\{[0:x_2:x_3]\}$ ($y$ 軸) と $\{[x_1:0:x_3]\}$ ($x$ 軸) 
    の和集合になる.
  \item (5)の定める実射影平面の部分集合は射影直線 $\{[0:x_2:x_3]\}$ ($y$ 軸) 
    になる. ($x_1^2=0$ は重根を持つので二重の射影直線であると考えられる.)
    \qed
  \end{itemize}
\end{question}

\noindent
解説: 射影ではないただの実平面上の非退化な二次曲線は楕円, 放物線, 双曲線と
3通りに分類された. 上の問題の結果より, 正則な $3$ 次実対称行列の定める空集合
でない実射影平面上の実二次曲線は円周 $x^2+y^2=1$ と同値であることがわかる.
ただの平面から射影平面に移り, さらにアフィン変換を射影変換に拡張すれば
このように非退化な実二次曲線は本質的に一種類しか存在しないという簡明な結果が
得られるのである.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[実射影空間内の実二次曲面の分類]
  問題 \qref{q:proj-real-quadratic} と同様にして
  実射影空間内の実二次曲面を分類せよ. 
  \qed
\end{question}

\noindent
ヒント: 実射影平面内の実二次曲線の場合よりも3通り増えて8通りに分類される.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip
\noindent
参考: さて, 上においては実数体上の二次超曲面を扱って来た. 
複素数体のような代数閉体上の二次超曲面の分類はさらに易しくなる.
一般の体の場合も二次超曲面の分類は二次形式の分類に帰着する.
このように二次超曲面については非常によくわかっていると考えて良い.

それではその次に扱うべき対象は何であろうか?
それは射影平面上の三次曲線であろう.
そこで出会う数学的対象が{\bf 楕円曲線 (elliptic curve)} である.
楕円曲線とは
\begin{equation*}
  y^2 = x^3 + ax + b
\end{equation*}
の形の方程式で定義される平面三次曲線のことである. 
実は適切な設定のもとで射影平面上の三次曲線は
どれもこの形の曲線に同値であることを証明できる.  
上の方程式を平面三次曲線の{\bf Weierstrass の標準形}
もしくは{\bf Weierstrass 方程式}と呼ぶ.
複素楕円曲線は位相的にトーラスの形をしている.
楕円曲線に関しては多くの入門書が発行されている.
たとえばシルヴァーマン＆テイト \cite{ST}やキャッセルズ \cite{cassels} を見よ.
複素楕円曲線と表裏一体の楕円函数論に関しては竹内 \cite{takeuchi} 
や梅村 \cite{umemura} を見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{定符号性と半定符号性}

$\R^n$ 上の実二次形式 $Q$ が{\bf 正値半定符号 (positive semidefinite)} であ
るとは任意の $x\in\R^n$ に対して $Q(x)\ge 0$ が成立することである. 
そのとき $Q\ge 0$ と書く.
$Q$ が{\bf 正値定符号 (positive semidefinite)} であるとは正値半定符号で
かつ $Q(x)=0$ が成立するための必要十分条件が $x=0$ であることである.
そのとき, $Q>0$ と書く.
さらに, 不等号の向きを逆にすることによって, 
{\bf 負値半定符号 (negative semidefinite)} であることと
{\bf 負値定符号 (negativedefinite)} であることを定義する%
\footnote{「正値半定符号」や「正値定符号」のような言い方はあまり聞き慣れない
  ので演習の時間には「ポジティヴ・セマイデフィニト」「ポジティヴ・デフィニト」
  と言う場合が多いと思われる.}.
$Q$ に対応する実対称行列 $A$ にも同じ形容詞を適用する.
たとえば $A\ge 0$ であるための必要十分条件は $A$ の固有値がすべて $0$ 以上で
あることである.

\begin{question}
  $Q$ は $\R^n$ 上の実二次形式であり, $(p,q)$ はその符号数であるとする. 
  このとき, 
  \begin{enumerate}
  \item $Q$ が positive semidefinite $\iff$ $q=0$.
  \item $Q$ が negative semidefinite $\iff$ $p=0$.
  \item $Q$ が positive definite $\iff$ $(p,q)=(n,0)$.
  \item $Q$ が negative definite $\iff$ $(p,q)=(0,n)$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ は実対称行列とし, $P$ は実正則行列とし, 
  実対称行列 $B$ を $B=\tp{P}AP$ と定める.
  このとき, $A$ と $B$ の固有値の集合は一般には異なるが,
  正の固有値の個数と負の固有値の個数は互いに等しくなることを説明せよ.
  \qed
\end{question}

\noindent
ヒント: 正の固有値の個数と負の固有値の個数が互いに等しくなることは 
Sylvester の慣性法則と同値.  固有値の集合が異なる場合があること
は $P$ として単位行列でない対角行列を取ればわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$, $B$ は $n$ 次実対称行列であるとし, $a\in\R$ とする.
  このとき, 実二次形式の和とスカラー倍が
  \begin{equation*}
    (Q_A+Q_B)(x) = Q_A(x) + Q_B(x) = Q_{A+B}(x), \qquad
    (a Q_A)(x) = a(Q_A(x)) = Q_{aA}(x)
  \end{equation*}
  と定義される.  $n$ 次実対称行列全体の集合 $\Sym_n(\R)$ は $n(n+1)/2$ 次元
  の実ベクトル空間をなし, $\R^n$ 上の実二次形式全体の集合はそれに同型な実ベ
  クトル空間をなす. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$, $B$ は $n$ 次実対称行列であるとし, $a\in\R$ とする.
  \begin{enumerate}
  \item $A\ge0$, $B\ge 0$ $\implies$ $A+B\ge0$.
  \item $A>0$, $B\ge 0$ $\implies$ $A+B>0$.
  \item $A\ge0$, $a\ge 0$ $\implies$ $aA\ge 0$.
  \item $A>0$, $a> 0$ $\implies$ $aA> 0$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{小行列式に関する準備}
\label{sec:minor}

与えられた $n$ 次実対称行列 $A$ もしくはそれに対応する実二次形式 $Q_A$ の符
号数 $(p,q)$ を調べる方法を演習問題の形でまとめておく.
目標は問題 \qref{q:criterion-principal-minors}  の結果の証明の概略を与える
ことである. そのためには小行列式に関する幾つかの結果が必要になる. 

この節のアイデアは単純である. 行列式の余因子展開のような公式を行列を用いて書
き直せば行列の等式が色々得られるが, そられの等式の両辺の行列式を取れば余因子
に関する公式が色々得られる. これだけである.  
(問題 \qref{q:Jacobi-identity-1} のヒントを参照せよ.)

一般的な定義をするために $A$ は任意の $n$ 次正方行列であるとする.
以下, $\{1,\dots,n\}$ の $k$ 個の元を持つ部分集合 $I=\{i_1<\cdots<i_k\}$ に
対して, 
\begin{equation*}
  |I|=k, \qquad \ell(I)=(i_1-1)+\cdots+(i_k-k)
\end{equation*}
と置き, $I$ の補集合を $I^c$ と書くことにする.  
たとえば $n=5$, $I=\{1,4,5\}$ のとき $|I|=3$, $\ell(I)=4$, $I^c=\{2,3\}$. 

\begin{question}
  $I=\{i_1<\cdots<i_k\}$ の補集合を $I^c=\{j_1<\cdots<j_{n-k}\}$ と表わすと,
  \begin{equation*}
    \sgn\binom
    { 1\, \cdots \,k\;\,         k+1     \cdots \;\; n\;\;}
    { i_1  \cdots i_k\,   \;\;\;\;j_1\;\; \cdots  j_{n-k}  }
    = (-1)^{\ell(I)}.
  \end{equation*}
  ここで左辺は $(1,\cdots,n)$ を $(i_1,\dots,i_k,j_1,\dots,j_{n-k})$ に
  移す置換の signature である. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$\{1,\dots,n\}$ の $k$ 個の元を持つ
部分集合 $I=\{i_1<\cdots<i_k\}$, $J=\{j_1<\cdots<j_k\}$ に対して,
行列 $A$ に対して行列 $A_{IJ}$ を
\begin{equation*}
  A_{IJ} =
  \begin{bmatrix}
    a_{i_1j_1} & \cdots & a_{i_1j_k} \\
      \vdots   &        &   \vdots   \\
    a_{i_kj_1} & \cdots & a_{i_kj_k} \\
  \end{bmatrix}
\end{equation*}
と定義し, これの行列式を $(I,J)$ {\bf 小行列式 (minor)} と呼び,
\begin{equation*}
  a_{IJ} = |A_{IJ}| =
  \begin{vmatrix}
    a_{i_1j_1} & \cdots & a_{i_1j_k} \\
      \vdots   &        &   \vdots   \\
    a_{i_kj_1} & \cdots & a_{i_kj_k} \\
  \end{vmatrix}
\end{equation*}
と表わす.  $I=J$ のとき $a_{II}=|A_{II}|$ 
を $r$ 次の{\bf 主小行列式 (principal minor)} と呼び%
\footnote{``principal'' を「首座」と訳して「首座小行列式」と呼ぶ場合も
  ある.  高木 \cite{takagi1} では「首座小行列式」もしくは「首座行列式」と呼
  んでいる. 長谷川は連載 \cite{hasegawa-rensai} 第15回 (『数学セミナー』2002
  年6月号に掲載) で漢字を変えて「主座小行列式」と呼んでいる(78頁).}, 
$a_I$ と表わす.
$A_{II}$ も $A_I$ と書くことにする.

さらに, 行列 $A$ の $(I,J)$ {\bf 余因子 (cofactor)} $\tilde{a}_{IJ}$ を次の
ように定める: 
\begin{equation*}
  \tilde{a}_{IJ}
  = (-1)^{\ell(I)+\ell(J)} a_{I^cJ^c}
  = (-1)^{\ell(I)+\ell(J)} |A_{I^cJ^c}|.
\end{equation*}
$I=\{i\}$, $J=\{j\}$ のとき, $a_{IJ}=a_{ij}$ 
であり, $\tilde{a}_{ij}:=\tilde{a}_{IJ}$ はすでに習ったはず
の $(i,j)$ 余因子に一致している. 

各 $k$ に対して, $k$ 次の
小行列式 $a_{IJ}=|A_{IJ}|$ ($|I|=|J|=k$) の全体
で構成された正方行列を $A^{(k)}$ と表わし, $k$ 次の
余因子 $\tilde{a}_{IJ}=(-1)^{\ell(I)+\ell(J)} |A_{I^cJ^c}|$ ($|I|=|J|=k$) の
全体で構成された正方行列を $\Delta_k(A)$ と表わすことにする:
\begin{align*}
  &
  A^{(k)}
  = \bigl[ a_{IJ} \bigr]_{|I|=|J|=k}
  = \bigl[ |A_{IJ}| \bigr]_{|I|=|J|=k}, 
  \\ &
  \Delta_k(A) 
  = \bigl[ \tilde{a}_{IJ} \bigr]_{|I|=|J|=k}
  = \bigl[ (-1)^{\ell(I)+\ell(J)} |A_{I^cJ^c}| \bigr]_{|I|=|J|=k}.
\end{align*}
$A^{(k)}$, $\Delta_k(A)$ は共に $\binom{n}{k}$ 次の正方行列になる.
たとえば $A^{(1)}=A$, $\Delta_1(A)=[\tilde{a}_{ij}]_{i,j=1}^n$ である.
簡単のため $\Delta(A)=\Delta_1(A)$ と置く.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Laplace 展開]
\label{q:Laplace-expansion}
  $I$, $K$ は $\{1,\dots,n\}$ の部分集合で
  あり, $|I|=|K|=k$ を満たしていると仮定する. このとき,
  \begin{equation*}
      \sum_{|J|=k} a_{IJ} \tilde{a}_{KJ}
    = \sum_{|J|=k} \tilde{a}_{JI} a_{JK}
    = |A| \delta_{IK}.
  \end{equation*}
  ここで和は $|J|=k$ を満たす $\{1,\dots,n\}$ の部分集合 $J$ の全体を
  走る. その和は $\binom{n}{k}$ 個の項の和になる.  
  右辺の $\delta_{IK}$ は Kronecker's delta であり $I=K$ のときにのみ $1$ に
  なり, それ以外の場合には $0$ になる.  この結果を行列で書き直すと,
  \begin{equation*}
      A^{(k)}\,\tp{\Delta_k(A)}
    = \tp{\Delta_k(A)}\,A^{(k)}
    = |A| E.
  \end{equation*}
  ここで $E$ は $\binom{n}{k}$ 次の単位行列である.  \qed    
\end{question}

\medskip
\noindent
ヒント: 行列式の定義に戻れば証明できる. 
すでに習ったはずの $k=1$ の場合の Laplace 展開を繰り返し用いて
証明することもできる.
(高木 \cite{takagi1} 第8章第52節の250--255頁に詳しい説明がある.)
外積代数を用いた証明の方針が佐武 \cite{satake} 第V章第4節225頁の問6 (略解が
313頁にある) にある. (横沼 \cite{yokonuma} 92--96頁に詳しい説明がある.)
\qed

\medskip

$k>1$ の一般の Laplace 展開はこの節では使用しない.
$k=1$ の場合の結果を忘れている人は復習して欲しい.
次の問題の Jacobi の公式は後で使用される%
\footnote{Jacobi の公式の解説は佐武 \cite{satake} 第II章第5節例2 (66-67頁)
  にある.  高木 \cite{takagi1} 定理9.5 (295頁) の証明に登場する最初の式は
  Jacobi の公式の特別な場合である.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  次の等式が成立することを直接確かめよ:
  {\small
  \begin{align*}
    \begin{vmatrix}
      a_{11} & \cdots & a_{14} \\
      \vdots &        & \vdots \\
      a_{41} & \cdots & a_{44} \\
    \end{vmatrix}
    & =
    \begin{vmatrix}
      a_{11} & a_{12} \\
      a_{21} & a_{22} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{33} & a_{34} \\
      a_{43} & a_{44} \\
    \end{vmatrix}
    -
    \begin{vmatrix}
      a_{11} & a_{12} \\
      a_{31} & a_{32} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{23} & a_{24} \\
      a_{43} & a_{44} \\
    \end{vmatrix}
    +
    \begin{vmatrix}
      a_{11} & a_{12} \\
      a_{41} & a_{42} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{23} & a_{24} \\
      a_{33} & a_{34} \\
    \end{vmatrix}
    \\ &
    +
    \begin{vmatrix}
      a_{21} & a_{22} \\
      a_{31} & a_{32} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{13} & a_{14} \\
      a_{43} & a_{44} \\
    \end{vmatrix}
    -
    \begin{vmatrix}
      a_{21} & a_{22} \\
      a_{41} & a_{42} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{13} & a_{14} \\
      a_{33} & a_{34} \\
    \end{vmatrix}
    +
    \begin{vmatrix}
      a_{31} & a_{32} \\
      a_{41} & a_{42} \\
    \end{vmatrix}
    \begin{vmatrix}
      a_{13} & a_{14} \\
      a_{23} & a_{24} \\
    \end{vmatrix}.
    \qed
  \end{align*}
  }
\end{question}

\noindent
ヒント: $n=4$, $k=2$ の場合の Laplace 展開だが直接計算で確かめなければいけな
い.  左辺の行列式の第1列と第2列について余因子展開してそれが右辺に等しくなる
ことを確かめよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Jacobi の公式]
\label{q:Jacobi-identity-1}
  余因子と主小行列式に関して次が成立する:
  \begin{equation*}
    \begin{vmatrix}
      \tilde{a}_{k+1,k+1} & \cdots & \tilde{a}_{n,k+1} \\
      \vdots              &        & \vdots \\
      \tilde{a}_{k+1,n}   & \cdots & \tilde{a}_{n,n} \\
    \end{vmatrix}
    =
    \begin{vmatrix}
      a_{11} & \cdots & a_{1k} \\
      \vdots &        & \vdots \\
      a_{k1} & \cdots & a_{kk} \\
    \end{vmatrix}
    |A|
  \end{equation*}
  ここで $\tilde{a}_{ij}$ は $A$ の $(i,j)$ 余因子である.
  特に $k=n-2$ のとき, 
  \begin{equation*}
      \tilde{a}_{n-1,n-1} \tilde{a}_{n,n}
    - \tilde{a}_{n,n-1} \tilde{a}_{n-1,n}
    = 
    \begin{vmatrix}
      a_{11}    & \cdots & a_{1,n-2} \\
      \vdots    &        & \vdots \\
      a_{n-2,1} & \cdots & a_{n-2,n-2} \\
    \end{vmatrix}
    |A|^{n-k-1}.
  \qed
  \end{equation*}
\end{question}

\noindent
注意: $k=0$ のとき右辺に表われる空な行列式は $1$ に等しいと約束しておく. 

\medskip
\noindent
ヒント: $\sum_{\nu=1}^n a_{i\nu}\tilde{a}_{j\nu}=|A|\delta_{ij}$ より,
\begin{equation*}
  A
  \begin{bmatrix}
    1      &        & 0      & \tilde{a}_{k+1,1}   & \cdots & \tilde{a}_{n,1} \\
           & \ddots &        & \vdots              &        & \vdots \\
    0      &        & 1      & \tilde{a}_{k+1,k}   & \cdots & \tilde{a}_{n,k} \\
    0      & \cdots & 0      & \tilde{a}_{k+1,k+1} & \cdots & \tilde{a}_{n,k+1} \\
    \vdots &        & \vdots & \vdots              &        & \vdots \\
    0      & \cdots & 0      & \tilde{a}_{k+1,n}   & \cdots & \tilde{a}_{n,n} \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    a_{1,1}   & \cdots & a_{1,k}   &    0   & \cdots & 0 \\
    \vdots    &        & \vdots    & \vdots &        & \vdots \\
    a_{k,1}   & \cdots & a_{k,k}   &    0   & \cdots & 0 \\
    a_{k+1,1} & \cdots & a_{k+1,k} &   |A|  &        & 0 \\
    \vdots    &        & \vdots    &        & \ddots &   \\
    a_{n,1}   & \cdots & a_{n,k}   &    0   &        & |A| \\
  \end{bmatrix}
\end{equation*}
この等式の両辺の行列式を取る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  上の問題 \qref{q:Jacobi-identity-1} の結果は 
  Laplace 展開 \qref{q:Laplace-expansion} の最も簡単な場合 ($k=1$) の場合の
  結果から導かれた.  一般の Laplace 展開を用いて
  問題 \qref{q:Jacobi-identity-1} の結果を一般化せよ.  
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{主小行列式を用いた符号数の計算の仕方}

\begin{question}
\label{q:criterion-positive-0}
  $A$ は $n$ 次実対称行列であるとし, 
  $I$ は $\{1,\dots,n\}$ の空でない任意の部分集合であるとする.
  このとき, 
  \begin{enumerate}
  \item $A > 0   \implies a_I = |A_I| > 0$.
  \item $A \ge 0 \implies a_I = |A_I| \ge 0$.
  \end{enumerate}
  ここで $a_I=|A_I|$ は $I$ に対応する主小行列式である. \qed
\end{question}

\noindent
ヒント: $x_i=0$ ($i\notin I$) を満たす $x$ に対する $Q_A(x)$ の符号について
考えてみよ.  すると, $A_I=A_{II}$ がすべて positive (semi-)definite である
ことがわかる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:criterion-positive-1}
  $A$ は $n$ 次実対称行列であるとし, $I_k=\{1,\dots,k\}$ と置く.
  このとき, 
  \begin{equation*}
    A > 0 \iff a_{I_k} = |A_{I_k}| > 0 \quad(1\le k\le n).
  \end{equation*}
  ここで $a_{I_k}=|A_{I_k}|$ は $I_k$ に対応する主小行列式である. \qed
\end{question}

\noindent
ヒント: $\implies$ の向きは問題 \qref{q:criterion-positive-0} の特別な場合で
ある.  逆は $n$ に関する数学的帰納法で証明する.  
$n=1$ のとき逆が成立することは明らか.  
$n-1$ まで逆が成立していると仮定する. 
そのとき $A$ の左上にある $n-1$ 次正方行列 $A_{\{1,\dots,n-1\}}$ を $B$ と
書くと, $B>0$ が成立している. 特に $B$ は正則行列になるの
で, $A$ は次のように表わされる%
\footnote{二次形式に関する議論でこのテクニックは頻繁に利用される.}:
\begin{equation*}
  A =
  \begin{bmatrix}
    B      & a      \\
    \tp{a} & a_{nn} \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    E_{n-1}      & 0 \\
    \tp{a}B^{-1} & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    B & 0 \\
    0 & a_{nn} - \tp{a}B^{-1}a \\
  \end{bmatrix}
  \begin{bmatrix}
    E_{n-1} & B^{-1}a \\
      0     & 1 \\
  \end{bmatrix}.
\end{equation*}
この等式の行列式を取ると $|A|=|B|(a_{nn}-\tp{a}B^{-1}a)$.
$|A|=|A_{I_n}|>0$, $|B|>0$ より $a_{nn}-\tp{a}B^{-1}a>0$.
よって $
  \begin{bmatrix}
    B & 0 \\
    0 & a_{nn} - \tp{a}B^{-1}a \\
  \end{bmatrix}
  > 0
$ であるが, この行列に対応する二次形式と $A$ に対応する二次形式は同値
なので $A>0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:criterion-positive-2}
  問題 \qref{q:criterion-positive-1} の設定のもとで
  \begin{equation*}
    A \ge 0 \implies a_{I_k}=|A_{I_k}| \ge 0 \quad(1\le k\le n).
  \end{equation*}
  は成立するが, 逆は成立しない. \qed
\end{question}

\noindent
ヒント: $A=\diag(0,-1)$ は逆の反例になっている.  左上部分に $0$ が詰まった実
対称行列はすべて反例になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:takagi-theorem9.4}
  $A$ は $n$ 次対称行列であるとし, $r=\rank A$ と置く.
  このとき, $A$ の $r$ 次の主小行列式で $0$ でないものが存在する.
  さらに $A$ が実行列ならばそれらの主小行列式はすべて同じ符号を持つ.
  \qed
\end{question}

\noindent
ヒント: この結果は高木 \cite{takagi1} 第9章第61節の定理9.4 (293頁) にある.  
\qed

\medskip
\noindent
略解: 
$r = \rank A$ ならばある $I=\{i_1,\dots,i_r\}$ と $J=\{j_1,\dots,j_r\}$ 
で $I$, $J$ に対応する $r$ 次の
小行列式 $|A_{IJ}| = \det [a_{i_\mu i_\nu}]_{\mu,\nu=1}^r$ が $0$ にならない
ものが存在する%
\footnote{すでに習ったと思うが, 復習したい人は佐武 \cite{satake} 第III章
  定理2 (90頁) と106頁の説明を参照せよ.}.  
$A$ の中の $n$ 本の列ベクトルの全体を $a_1,\dots,a_n$ と書く.  
$a_1,\dots,a_n$ の張る $r$ 次元のベクトル空間を $V$ と書く.
このとき, $a_{j_1},\dots,a_{j_r}$ は $V$ の基底になり, 
$A$ が対称なので $a_{i_1},\dots,a_{i_r}$ も $V$ の基底になる.  
よって, $r$ 次の正則行列 $C$ 
で $[a_{i_1}\ \dots\ a_{i_r}]C = [a_{j_1}\ \dots\ a_{j_r}]$ を
みたすものが存在する. この等式の両辺の行列の第 $i_1,\dots,i_r$ 行の部分を
抜き出すと $A_{II}C=A_{IJ}$ となる. 
この両辺の行列式を取ると $|A_{II}||C(I,J)|=|A_{IJ}|$ 
であり, $|A_{IJ}|\ne 0$ なので $|A_{II}|\ne 0$ である.
これで前半の証明が終わった.

後半を証明するために, $|A_{II}|\ne 0$, $|A_{JJ}|\ne 0$ と仮定する.
このとき, 上と同様にして, $r$ 次の正則行列 $C$ 
で $[a_{i_1}\ \dots\ a_{i_r}]C = [a_{j_1}\ \dots\ a_{j_r}]$ を
みたすものが存在することがわかる.  
この等式の両辺の行列の第 $i_1,\dots,i_r$ 行の部分を
抜き出すと $A_{II}C=A_{IJ}$ となり, 第 $j_1,\dots,j_r$ 行の部分を
抜き出すと $A_{JI}C=A_{JJ}$ となる. 
$A$ は対称なので $|A_{JI}|=|A_{IJ}|$ と
なるから $|A_{II}||C|^2 = |A_{JJ}|$ である.
よって $|A_{II}|$ と $|A_{JJ}|$ の符号は等しい.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:takagi-theorem9.4} によれば, 
  $A$ が $n$ 次対称行列であり, $r=\rank A$ ならば $A$ の $r$ 次の主小行列式
  で $0$ でないものが存在するのであった.
  しかし, $r-1$ 次の主小行列式はすべて $0$ になってしまう場合があることを示
  せ.
  \qed
\end{question}

\noindent
ヒント: 右上から左下への対角線上の成分のみが $0$ でない対称行列を考えてみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:n=rank}
  $A$ は $n$ 次対称行列とし, $r=\rank A$, $I=\{i_1<\cdots<i_r\}$, 
  $|A_I|\ne 0$ であると仮定する.  $n$ 次対称行列 $A'$ を
  \begin{equation*}
    A' =
    \begin{bmatrix}
      A_I & 0 \\
      0   & 0 \\
    \end{bmatrix}
  \end{equation*}
  と定めると, $Q_A$ と $Q_{A'}$ は同値になる. \qed
\end{question}

\noindent
解説: この問題の結果と上の問題 \qref{q:takagi-theorem9.4} の結果を
合わせれば rank が $r$ の二次形式の性質は $n=r$ の場合の二次形式の性質を調べ
る問題に帰着できることがわかる.

\medskip
\noindent
ヒント: $I=\{1,\dots,r\}$ と仮定して一般性は失われない. 
このとき, $A_I^{-1}$ が存在することより,
\begin{equation*}
  A = 
  \begin{bmatrix}
    A_I    & B \\
    \tp{B} & C \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    E_r            & 0 \\
    \tp{B}A_I^{-1} & E_{n-r} \\
  \end{bmatrix}
  \begin{bmatrix}
    A_I & 0 \\
    0   & C - \tp{B}A_I^{-1}B \\
  \end{bmatrix}
  \begin{bmatrix}
    E_r & A_I^{-1}B \\
    0   & E_{n-r} \\
  \end{bmatrix}
\end{equation*}
もしも $X := C - \tp{B}A_I^{-1}B\ne 0$ 
ならば $\rank A = \rank A_I + \rank X > r$ となってしまうので矛盾する.
よって $X = 0$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Jacobi-identity-2}
  $A$ は $n$ 次実対称行列であり, 
  $|A_{IJ}|$ は $A$ の $n-1$ 次の principal ではない%
  \footnote{$I\ne J$ であるということ}任意の小行列式であり,
  $|A_{KK}|$ は $A_{IJ}$ の小行列式になっているよう
  な $A$ の唯一の $n-2$ 次主小行列式であるとする ($K=I\cap J$).
  このとき, $|A_{II}|=0$ ならば $|A_{KK}||A|\le 0$ である.
  \qed
\end{question}

\noindent
ヒント: Jacobi の公式 \qref{q:Jacobi-identity-1} の $k=n-2$ の場合より, 
任意の $n$ 次正方行列 $A$ に対して,
\begin{equation*}
  |A_{II}||A_{JJ}| - |A_{IJ}||A_{JI}| = |A_{KK}||A|.
  \tag{$*$}
\end{equation*}
$A$ が実対称なので $|A_{JI}|=|A_{IJ}|$ であり, 
$|A_{II}|=0$ ならば $|A_{KK}||A|=-|A_{IJ}|^2\le 0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Jacobi-identity-3}
  $n$ 次対称行列 $A$ の $n-1$ 次と $n-2$ 次の主小行列式が
  すべて $0$ ならば任意の $n-1$ 次小行列式も $0$ になる. 
  よって, $|A|\ne 0$ ならば $A$ の $n-1$ 次と $n-2$ 次の主小行列式の中
  には $0$ でないものが存在する.
  \qed
\end{question}

\noindent
ヒント: Jacobi の公式 \qref{q:Jacobi-identity-1} の $k=n-2$ の場合を書き直す
ことによって得られた上の公式 ($*$) を使う.  
$A$ が対称行列ならば $|A_{JI}|=|A_{IJ}|$ であるから,
$A$ の $n-1$ 次と $n-2$ 次の主小行列式が
すべて $0$ ならば $|A_{II}|=|A_{JJ}|=|A_{KK}|=0$ 
なので ($*$) より $|A_{JI}|=|A_{IJ}|=0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:takagi-theorem9.5}
  $A$ は $n$ 次対称行列であるとし, $r = \rank A$ と置く. 
  このとき, $\{1,\dots,n\}$ の部分集合の列
  \begin{equation*}
    I_r\supset I_{r-1}\supset\cdots\supset I_1\supset I_0=\emptyset,
    \qquad |I_\nu|=\nu
  \end{equation*}
  で以下の条件を満たすものが存在する:
  \begin{enumerate}
  \item[(a)] $|A_{I_r}|\ne 0$
  \item[(b)] 対応する主小行列式の列
    \begin{equation*}
      0\ne|A_{I_r}|,\; |A_{I_{r-1}}|,\; \cdots,\; |A_{I_1}|,\; |A_{I_0}|=1
    \end{equation*}
    の中の隣り合う $|A_{I_{\nu+1}}|$ と $|A_{I_\nu}|$ は同時に $0$ にならない.
  \item[(c)] $|A_{I_\nu}|=0$ ならば $A_{I_{\nu+1}}$ の $\nu$ 次
    の主小行列式はすべて $0$ である.
  \end{enumerate}
  さらに $A$ が実行列で $|A_{I_\nu}|=0$ ならば 
  その両隣の $|A_{I_{\nu-1}}|$ と $|A_{I_{\nu+1}}|$ は反対の符号を持つ.
  \qed
\end{question}

\noindent
ヒント: この結果は高木 \cite{takagi1} 第9章第61節の定理9.5 (295頁) にある.  
問題 \qref{q:Jacobi-identity-2} の結果より, 前半が証明されれば実行列の場合に
関する後半も証明される.  
前半の証明.  問題 \qref{q:takagi-theorem9.4} の結果より, 
ある $I_r\subset\{1,\dots,n\}$ で $|I_r|=r$ かつ $|A_{I_r}|\ne 0$ をみたすも
のが存在する. 列 $I_r\supset\dots\supset I_k$ 
で $|I_\nu|=\nu$ ($k=k,k+1,\dots,r$) かつ $|A_{I_k}|\ne 0$ をみたすものが選
ばれたと仮定する. ($k=r$ のときこの仮定はすでに成立している.)
問題 \qref{q:Jacobi-identity-3} の結果を対称行列 $A_{I_k}$ に適用
すれば, $A_{I_k}$ の $k-1$ 次と $k-2$ 次の主小行列式の中に $0$ でないものが
存在する. $A_{I_k}$ の $k-1$ 次の主小行列式の中に $0$ でないものが存在する
場合にはその主小行列式が $|A_{I_{k-1}}|$ に等しくなるように $I_{k-1}$ を選ぶ.
もしも $A_{I_k}$ の $k-1$ 次主小行列式のすべてが $0$ なら
ば $0$ でならない $k-2$ 次小行列式の1つに $|A_{I_{k-2}}|$ が等しくなるよう
に $I_{k-2}$ を選び, $I_k\supset I_{k-1}\supset I_{k-2}$ かつ $|I_{k-1}=k-1$ 
をみたすような $I_{k-1}$ を任意に取る.
このような手続きで順次選ばれた $I_r\supset\cdots\supset I_1$ は前半の主張の
条件をみたしている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

\begin{question}
\label{q:takagi-theorem9.5-example}
  問題 \qref{q:takagi-theorem9.5} の主小行列式の列を
  次の対称行列に対して1つずつ構成せよ:
  \begin{equation*}
    (1)\quad
    A = 
    \begin{bmatrix}
              a &   &   &   & \bigzerou \\
                & 0 &   &   & \\
                &   & b &   & \\
                &   &   & 0 & \\
      \bigzerol &   &   &   & c \\
    \end{bmatrix},
    \qquad
    (2)
    B =
    \begin{bmatrix}
      \bigzerou &   &   &   & a \\
                &   &   & b & \\
                &   & c &   & \\
                & b &   &   & \\
              a &   &   &   & \bigzerol \\
    \end{bmatrix}
  \end{equation*}
  ここで, $a,b,c\in\R$, $abc\ne 0$. 
  \qed
\end{question}

\commentout{
\noindent
略解: $A$ については
\begin{equation*}
  |A_{I_3}|=|\diag(a,b,c)|=abc, \quad
  |A_{I_2}|=|\diag(a,b)|=bc, \quad
  |A_{I_1}|=|\diag(a)|=a.
\end{equation*}
$B$ については
\begin{equation*}
  |A_{I_5}|=|B|=a^2b^2c, \quad
  |A_{I_4}|=0, \quad
  |A_{I_3}|=-b^2c \quad
  |A_{I_2}|=0, \quad
  |A_{I_1}|=c.
\qed
\end{equation*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

次の結果は主小行列の情報から実二次形式の符号を決定する方法を与えている.
(佐武 \cite{satake} 164頁では結論だけが紹介されており,
高木 \cite{takagi1} 301--303頁では詳しく解説されている.)

\begin{question}
\label{q:criterion-principal-minors}
  $A$ は $n$ 次実対称行列とし, 
  対応する実二次形式 $Q_A$ の符号数は $(p,q)$ であるとする.
  問題 \qref{q:takagi-theorem9.5} の主小行列式の列を取る ($r=p+q$):
  \begin{equation*}
    0\ne|A_{I_r}|,\; |A_{I_{r-1}}|,\; \cdots,\; |A_{I_1}|,\; |A_{I_0}|=1.
  \end{equation*}
  この列における符号変化の個数が $q$ に等しい.
  \qed
\end{question}

\noindent
ヒント: $I_\nu=\{1,\dots,\nu\}$ と仮定しても一般性が失われない.
以下, 簡単のため $A_\nu = A_{I_\nu}$ と置く.
問題 \qref{q:n=rank} より $n=r$ の場合に帰着する.
それを $n$ に関する数学的帰納法で証明する.
\qed

\medskip
\noindent
略解: 
$|A_{n-1}|\ne 0$ の場合. $A_{n-1}^{-1}$ が存在するので,
\begin{equation*}
  A_n = 
  A =
  \begin{bmatrix}
    A_{n-1} & a      \\
    \tp{a}  & a_{nn} \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    E_{n-1}            & 0 \\
    \tp{a}A_{n-1}^{-1} & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    A_{n-1} & 0 \\
    0       & \alpha \\
  \end{bmatrix}
  \begin{bmatrix}
    E_{n-1} & A_{n-1}^{-1}a \\
      0     & 1 \\
  \end{bmatrix}.
\end{equation*}
ここで $\alpha = a_{nn} - \tp{a}A_{n-1}^{-1}a$.  
行列式を取れば $\alpha = |A_n|/|A_{n-1}|$ であり,
$A_{n-1}$ の符号数を $(p',q')$ とすると,
$\alpha>0$ のとき 
($n$ 次から $n-1$ 次で主小行列の符号が変化しないとき) $q=q'$ となり,
$\alpha<0$ のとき 
($n$ 次から $n-1$ 次で主小行列の符号が変化するとき) $q=q'+1$ となる.

$|A_{n-1}|=0$ の場合.  この場合は $|A_{n-2}|\ne 0$ なので,
\begin{equation*}
  A_n = 
  A =
  \begin{bmatrix}
    A_{n-2} & B \\
    \tp{B}  & C \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    E_{n-2}            & 0 \\
    \tp{B}A_{n-2}^{-1} & E_2 \\
  \end{bmatrix}
  \begin{bmatrix}
    A_{n-2} & 0 \\
    0       & D \\
  \end{bmatrix}
  \begin{bmatrix}
    E_{n-2} & A_{n-1}^{-1}B \\
      0     & E_2 \\
  \end{bmatrix}.
\end{equation*}
ここで $D = C - \tp{B}A_{n-2}^{-1}B$.
行列式を取ることによって, $|D|=|A_n|/|A_{n-2}|$ であることがわかる.
$|A_n|$ と $|A_{n-2}|$ の符号は異なるので $|D|<0$ である.
よって, $D$ 符号数は $(1,-1)$ である.
したがって, $A_{n-2}$ の符号数を $(p',q')$ とすると $q=q'+1$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{逆の二次形式}

以下の問題における逆の二次形式の定義は高木 \cite{takagi1} 第9章第64節305--306
頁の問題1にしたがった.  (佐武 \cite{satake} 第IV章第4節164頁の問4とその解答
(304頁)にも同様の説明がある.)

\begin{question}[逆の二次形式]
\label{q:inv-q-form-1}
  $A=[a_{ij}]$ は $n$ 次実対称行列であるとする. 
  実二次形式 $Q_A$ の{\bf 逆の二次形式 (reciprocal quadratic form)} $R_A$ を
  次のように定める:
  \begin{equation*}
    R_A(x) = -
    \begin{vmatrix}
      a_{11} & \cdots & a_{1n} &  x_1   \\
      \vdots &        & \vdots & \vdots \\
      a_{n1} & \cdots & a_{nn} &  x_n   \\
       x_1   & \cdots &  x_n   &   0    \\
    \end{vmatrix}
    = -
    \begin{vmatrix}
        0    &  x_1   & \cdots &  x_n   \\
       x_1   & a_{11} & \cdots & a_{1n} \\
      \vdots & \vdots &        & \vdots \\
       x_n   & a_{n1} & \cdots & a_{nn} \\
    \end{vmatrix}.
  \end{equation*}
  $A$ の $(i,i)$ 余因子を $\tilde{a}_{ij}$ と書き, 
  対称行列 $\Delta(A)$ を $\Delta(A)=\bigl[\tilde{a}_{ij}\bigr]$ と定める.  
  このとき $R_A = Q_{\Delta(A)}$.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:inv-q-form-2}
  $A$ は $n$ 次実対称行列であり, その符号数は $(p,q)$ であるとする.
  $R_A$ は $Q_A$ の逆の二次形式であるとする. このとき, 以下が成立する:
  \begin{enumerate}
  \item $|A|>0$ ならば $R_A$ の符号数は $(p,q)$ である.
  \item $|A|<0$ ならば $R_A$ の符号数は $(q,p)$ である.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $|A|\ne 0$ ならば $\Delta(A)=\tp{\Delta(A)}=|A|A^{-1}$ なので, 
問題 \qref{q:inv-q-form-1} より $R_A = |A| Q_{A^{-1}}$. 
\qed

\medskip
\noindent
参考: 問題 \qref{q:criterion-positive-1} のヒントの方法を
使えば $R_A = |A| Q_{A^{-1}}$ を問題 \qref{q:inv-q-form-1} を
使わずに直接証明することもできる.  実際, $A$ が正則行列ならば
\begin{equation*}
  \begin{bmatrix}
    A      & x \\
    \tp{x} & 0 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    E            & 0 \\
    \tp{x}A^{-1} & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    A & 0 \\
    0 & -\tp{x}A^{-1}x \\
  \end{bmatrix}
  \begin{bmatrix}
    E & A^{-1}x \\
    0 & 1 \\
  \end{bmatrix}.
\end{equation*}
なのでこの両辺の行列式を取って $-1$ 倍すれば良い. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:inv-q-form-3}
  $A$ は $n$ 次実対称行列であり,  $R_A$ は $Q_A$ の逆の二次形式であるとする.
  このとき, $n$ 次正則行列 $P$ に
  対して $R_A\bigl(\tp{(P^{-1})}x\bigr) 
  = |P|^{-2} R_{\tp{P}AP}(x)$.
  \qed
\end{question}

\noindent
ヒント: 次の等式を証明して両辺の行列式を取る:
\begin{equation*}
  \begin{bmatrix}
    A            & \tp{(P^{-1})}x \\
    \tp{x}P^{-1} & 0 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    \tp{(P^{-1})} & 0 \\
      0           & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    \tp{P}AP & x \\
     \tp{x}  & 0 \\
  \end{bmatrix}
  \begin{bmatrix}
    P^{-1} & 0 \\
       0   & 1 \\
  \end{bmatrix}.
  \qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:inv-q-form-4}
  $A$ は $n$ 次実対称行列であり, その符号数は $(p,q)$ であるとする.
  $R_A$ は $Q_A$ の逆の二次形式であるとする. このとき, 以下が成立する:
  \begin{enumerate}
  \item $\rank A = n-1$ かつ $q$ が偶数ならば $R_A$ の符号数は $(1,0)$.
  \item $\rank A = n-1$ かつ $q$ が奇数ならば $R_A$ の符号数は $(0,1)$.
  \item $\rank A < n-1$ ならば $R_A=0$.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: ある $n$ 次直交行列 $P$ が存在
して $\tp{P}AP = \diag(\alpha_1,\dots,\alpha_n)$ となる. 
$i$ 番目を除いた残りの $\alpha_j$ たちの積を $a_i$ と書くことにする.
このとき, 問題 \qref{q:inv-q-form-3} と \qref{q:inv-q-form-1} と $P$ が直交
行列であるから $|P|^2=1$ であることを用いると,
\begin{equation*}
  R_A\bigl(\tp{(P^{-1})}x\bigr)
  = |P|^{-2} R_{\tp{P}AP}(x)
  = a_1 x_1^2 + \cdots + a_n x_n^2.
\end{equation*}
よって, もしも $\alpha_n=0$ 
ならば $R_A\bigl(\tp{(P^{-1})}x\bigr) = a_n x_n^2$ となる.
$\rank A = n-k$ ならばちょうど $k$ 個の $\alpha_i$ が $0$ になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{直交行列}
\label{sec:orthogonal}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{直交群と特殊直交群の定義}
\label{sec:def-O(n)-SO(n)}

$n$ 次直交行列とは $n$ 次実正則行列 $A$ で $A^{-1}=\tp{A}$ を満たしている
もののことである.  次の問題の結果は今後自由に使われる.

\begin{question}
\label{q:orthogonal-matrices}
  $A$ の中の列ベクトルの全体を $a_1,\dots,a_n\in\R^n$ と表わす
  ($A=[a_1\ \cdots\ a_n]$).  
  $\R^n$ の標準的な正規直交基底を $e_1,\dots,e_n$ とすると $a_j=Ae_j$ である.
  以下の条件は互いに同値である:
  \begin{itemize}
  \item[(a)] $A$ は直交行列である.
  \item[(b)] $\tp{A}$ は直交行列である.
  \item[(c)] $a_1,\dots,a_n$ は $\R^n$ の正規直交基底である.
  \item[(d)] $A$ の定める一次変換は $\R^n$ の任意の正規直交基底を
    正規直交基底に移す.
  \item[(e)] 任意の $x,y\in\R^n$ に対して $\bra Ax,Ay\ket=\bra x,y\ket$.
  \item[(f)] 任意の $x\in\R^n$ に対して $\norm{Ax}=\norm{x}$.
    \qed
  \end{itemize}
\end{question}
直交行列の定める一次変換を直交変換と呼ぶ.  

直交変換は正規直交基底を正規直交基底に移すような一次変換である.
直交変換はベクトルの長さ (ノルム) を保つような一次変換である.
直観的にそのような一次変換にはどのようなものがあるだろうか?
次のような一次変換は直交変換になるはずである:
\begin{itemize}
\item 正規直交基底を連続的に回転した結果を与える一次変換,
\item ある(超)平面に関する{\bf 鏡映 (reflection)}.
\end{itemize}
たとえば $xy$ 平面における $y$ 軸の向きを反転する一次変換は $x$ 軸に関する鏡
映(変換)である.  $xyz$ 空間における $z$ 軸の向きを反転する一次変換は $xy$ 平
面に関する鏡映変換である.  $xy$ 平面に鏡があるときその鏡を見ている人はあた
かも鏡の中に自分自身が存在するように見えているはずである(ただし $z$ 軸の向き
は逆になっている).  そのような様子を数学的に表現したのが鏡映変換である.  
(正確な定義は\secref{sec:reflection}で行なう.)  

実は連続的な回転と鏡映の積で直交変換の全体は尽きている.  この事実を証明する
ことはこの節全体の目標の1つである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$n$ 次直交行列全体のなす集合を $O(n)$ と書き,
行列式が $1$ であるような $n$ 次直交行列全体のなす集合を $SO(n)$ と書くこと
にする:
\begin{equation*}
  O(n)=\{\, A\in M_n(\R) \mid \tp{A}A=A\tp{A}=E \,\},
  \quad
  SO(n)=\{\, A\in O(n) \mid \det A = 1 \,\}.
\end{equation*}

集合 $G$ と
写像 $\cdot:G\times G\to G$, $(a,b)\mapsto ab$ と
元 $e\in G$ と
写像 $(\ )^{-1}:G\to G$, $a\mapsto a^{-1}$ の
四つ組 $\bigr(G,\cdot,e,(\ )^{-1}\bigl)$ が{\bf 群 (group)} であるとは
以下が成立していることである:
\begin{itemize}
\item {\bf 結合法則}\quad $(ab)c=a(bc)$ \quad ($a,b,c\in G$);
\item {\bf 単位元}\quad $ea=ae=a$ \quad ($a\in G$);
\item {\bf 逆元}\quad $a^{-1}a=aa^{-1}=e$ \quad ($a\in G$).
\end{itemize}
しかし実際には, 群の演算 $ab$, 単位元 $e$, 逆元 $a^{-1}$ の定め方は詳しく説
明せずに, 「$G$ は群である」と言う場合が多い.  そのような説明を見た読者は群
の演算, 単位元, 逆元の定め方を明確に定義した上で上の3つの条件が成立している
ことをチェックしなければいけない.

\begin{question}
  $O(n)$ と $SO(n)$ は行列の積に関して群をなす. \qed
\end{question}

\noindent
ヒント: 群の演算は行列の積で定める. 
ただしそのとき, $A,B\in O(n)$ ならば $AB\in O(n)$ であること
と $A,B\in SO(n)$ ならば $AB\in SO(n)$ であることを証明しなければいけない.
単位元は単位行列 $E$ と定める.
ただしそのとき, $E\in SO(n)\subset O(n)$ を証明しなければいけない.
逆元は逆行列によって定める.
ただしそのとき, $A\in O(n)$ ならば $A^{-1}$ が存在して $A^{-1}\in O(n)$ であ
ることと $A\in SO(n)$ ならば $A^{-1}$ が存在して $A^{-1}\in SO(n)$ であるこ
とを証明しなければいけない.
群の3つの公理が成立していることは, 行列の積が結合法則を満たしていることなど
からほとんど明らかである.
\qed

\medskip

$O(n)$ を $n$ 次の{\bf 直交群 (orthogonal group)} と呼び,
$SO(n)$ を $n$ 次の{\bf 特殊直交群 (special orthogonal group)} と呼ぶ.
直観的には $SO(n)$ は $n$ 次元 Euclid 空間に作用する連続的な回転の全体のなす
群であり, $O(n)$ はさらに鏡映も含んでいる.  この事実の厳密な証明は後の方の問
題を解けば得られる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:O(n)=SO(n)cupSO(n)S}
  $\det O(n) = \{\pm 1\}$ かつ $\det SO(n) = \{1\}$ である%
  \footnote{行列の集合 $\cG$ に対し
    て $\det\cG:=\{\,\det A\mid A\in\cG\,\}$.
    一般に写像 $f:X\to Y$ に対して $f(X)=\{\,f(x)\mid x\in X\,\}$.}.
  さらに $\det S = -1$ を満たす任意の $S\in O(n)$ を取るとき,
  \begin{equation*}
    O(n) = SO(n) \cup SO(n)S = SO(n) \cup S\,SO(n).
  \end{equation*}
  ここで和集合は交わりのない和集合 (disjoint union) である%
  \footnote{$SO(2)\cap SO(2)S = SO(n) \cap S\,SO(n) = \emptyset$ 
    であるということ.}.
  すなわち, $O(n)$ の元は $SO(n)$ の元であるか $SO(n)$ の元に $S$ をかけたも
  の (左からかけても右からかけてもよい) のどちらか片方になる. 
  \qed
\end{question}

\noindent
ヒント: $A\in O(n)$ のとき $\tp{A}A=E$ なのでその両辺の行列式を
取ると $(\det A)^2 = 1$ である. よって $\det A = \pm 1$.
$E, \diag(1,\dots,1,-1)\in O(n)$ であり, 
それぞれの行列式を取ると $1, -1$ になる.
$S\in O(n)$, $\det S = -1$ と仮定する.
$A\in O(n)$ が $\det A = -1$ を満たしているとき $B=S^{-1}A$, $C=AS^{-1}$ と
置くと $\det B = \det C = 1$.
\qed

\medskip

以上の問題の結果より, $O(n)$ の任意の元は $SO(n)$ の元と行列式が $-1$ の直交
行列の積 (積の順序はどちらでも良い) で表わせることがわかった.  
しかも行列式が $-1$ の直交行列の簡単な例として $\diag(1,\dots,1,-1)$ が取れ
る.  よって $SO(n)$ がどういう集合であるかがよくわかれば $O(n)$ がどういう集
合であるかもよくわかるということになる.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{2次直交行列の世界}
\label{sec:O(2)}

まず $n=2$ の場合に直交行列の世界がどういう様子をしているかを調べてみよう.
この場合はすべての結果を直接的な計算によって容易に得ることができる.

\begin{question}
  $SO(2)$ と $O(2)$ は以下のように表示できることを示せ:
  \begin{align*}
    SO(2) &= 
    \left\{\,\left.
      \begin{bmatrix}
        \cos\theta & -\sin\theta \\
        \sin\theta &  \cos\theta \\
      \end{bmatrix}
    \,\right|\, \theta\in\R \,\right\},
    \\
    O(2) &= 
    \left\{\,\left.
      \begin{bmatrix}
        \cos\theta & -\sin\theta \\
        \sin\theta &  \cos\theta \\
      \end{bmatrix}
    \,\right|\, \theta\in\R \,\right\}
    \cup
    \left\{\,\left.
      \begin{bmatrix}
        \cos\theta &  \sin\theta \\
        \sin\theta & -\cos\theta \\
      \end{bmatrix}
    \,\right|\, \theta\in\R \,\right\}.
  \end{align*}
  後者の結果を次のように書くこともできる:
  \begin{equation*}
    O(2) = SO(2) \cup SO(2)
    \begin{bmatrix}
      1 &  0 \\
      0 & -1 \\
    \end{bmatrix}.
  \end{equation*}
  この和は交わりのない和 (disjoint union) であることを直接証明せよ. \qed
\end{question}

\noindent
ヒント: どうやっても何とかなる. たとえば $2$ 次実行列 $A$ の成分を $a,b,c,d$ 
と置いて $\tp{A}A=E$ という条件を適当に整理するという直接的な方法で証明する
こともできる.  問題 \qref{q:orthogonal-matrices} より $O(2)$ の元は $\R^2$ 
の正規直交基底全体の集合と同一視できることを使っても良い.  
$\R^2$ の正規直交基底は $xy$ 平面上の単位ベクトル $p$ とそれに直交する単位ベ
クトル $q$ の組である. $p$ は $p=\tp{[\cos\theta\ \sin\theta]}$ と表わせる.
この $p$ に直交する単位ベクトルは $q=\pm\tp{[-\sin\theta\ \cos\theta]}$ の2
つである.  図を描いてみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\theta\in\R$ に対して行列 $
  \begin{bmatrix}
    \cos\theta & -\sin\theta \\
    \sin\theta &  \cos\theta \\
  \end{bmatrix}
  $ が定める $xy$ 平面の一次変換は時計の反対回りに角度 $\theta$ の回転になっ
  ていることを図を描いて説明せよ. 
  さらに行列 $
  \begin{bmatrix}
    1 &  0 \\
    0 & -1 \\
  \end{bmatrix}
  $ が定める $xy$ 平面の一次変換は $y$ 軸の向きを反転する鏡映で
  あることを図を描いて説明せよ.  \qed
\end{question}

\noindent
解説: 実は一般の $n$ 次元の場合も本質的にこの2つの変換ですべての直交変換を表
示することができる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  単位ベクトル $p=\tp{[\cos\phi\ \sin\phi]}$ ($\theta\in\R$) に
  垂直な(原点を通る)直線に関する鏡映変換 $S_p$ を
  \begin{equation*}
    S_p(x) = x - 2\bra p,x\ket p   \qquad (x\in\R^2)
  \end{equation*}
  と定める.  このとき $S_p$ の行列表示は次のようになる:
  \begin{equation*}
    S_p = 
    \begin{bmatrix}
      -\cos 2\phi & -\sin 2\phi \\
      -\sin 2\phi &  \cos 2\phi \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      \cos 2\phi & -\sin 2\phi \\
      \sin 2\phi &  \cos 2\phi \\
    \end{bmatrix}
    \begin{bmatrix}
      -1 & 0 \\
       0 & 1 \\
    \end{bmatrix}.
  \end{equation*}
  よって $p$ に関する鏡映変換 $S_p$ は $x$ 軸の向きを反転する鏡映変換をして
  から左回りに角度 $2\phi$ だけ回転する直交変換に等しい.
  \qed
\end{question}

\noindent
ヒント: $S_p(x)=x - p\tp{p}x = (E-p\tp{p})x$ より $S_p=E-p\tp{p}$ である.
あとは三角函数の倍角の公式を使って整理すれば良い.  図を描いて結論が直観的に
も明らかであることを確かめてみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[二面体群]
\label{q:dihedral-1}
  $n\in\Z_{\ge 3}$ とする.  $xy$ 平面上の $n$ 個の点
  \begin{equation*}
    P_k=\left(\cos\frac{2\pi k}{n},\;\sin\frac{2\pi k}{n}\right)
    \qquad
    (k=0,1,\dots,n-1)
  \end{equation*}
  を次々に線分で結んでできる図形を正 $n$ 角形と呼ぶ.
  正 $n$ 角形をそれ自身の上に移す直交変換全体の集合 $D_n$ は
  次のように表示される:
  \begin{equation*}
    D_n = \{E,R,R^2,\dots,R^{n-1},A,RA,R^2A,\dots,R^{n-1}A\}.
  \end{equation*}
  ここで,
  \begin{equation*}
    R =
    \begin{bmatrix}
      \cos\frac{2\pi}{n} & -\sin\frac{2\pi}{n} \\
      \sin\frac{2\pi}{n} &  \cos\frac{2\pi}{n} \\
    \end{bmatrix}, 
    \quad
    A =
    \begin{bmatrix}
      1 &  0 \\
      0 & -1 \\
    \end{bmatrix}.
  \end{equation*}
  $D_n$ は群をなし, {\bf 二面体群 (dihedral group)} と呼ばれている. \qed
\end{question}

\noindent
ヒント: $P_0$ を $P_k$ に移す直交変換は2通りある.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:dihedral-2}
  問題 \qref{q:dihedral-1} の二面体群 $D_n$ を考える.
  $A,B\in D_n$ を次のように定める:
  \begin{equation*}
    A =
    \begin{bmatrix}
      1 &  0 \\
      0 & -1 \\
    \end{bmatrix},
    \quad
    B =
    \begin{bmatrix}
        \cos\frac{2\pi}{n} & -\sin\frac{2\pi}{n} \\
      - \sin\frac{2\pi}{n} & -\cos\frac{2\pi}{n} \\
    \end{bmatrix}, 
    \quad
  \end{equation*}
  このとき以下が成立する:
  \begin{enumerate}
  \item $A$ は $P_1$ を $P_{n-1}$ に移すような鏡映であり, 
    $B$ は $P_0$ を $P_{n-1}$ に移すような鏡映である.
  \item $D_n=\{\, (AB)^k,\, (AB)^kA \mid k = 0,1,\dots,n-1 \,\}$.
  \item $A^2=B^2=E$ かつ $(AB)^n=E$.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $AB=R$.  わかり難い場合は $n=5,6$ の場合に図を描いてみよ.
\qed

\medskip
\noindent
参考: $A$, $B$ は二面体群 $D_n$ の生成元であり, 
$A^2=B^2=E$, $(AB)^n=E$ は二面体群 $D_n$ の基本関係式である. 
すなわち, 二面体群 $D_n$ の元は $A$, $B$ だけを用いて表わすことが
でき, $A^2=B^2=E$, $(AB)^n=E$ だけから二面体群 $D_n$ の元たちが満たし
ている全ての関係式を導くことができる.  

$n$ 次対称群 $S_n$ も二面体群の場合と類似の基本関係式を持つ生成元を持つ.
生成元: $s_i = (i,i+1)$ ($i=1,\dots,n-1$). 
基本関係式: $s_i^2=1$, $(s_i s_{i+1})^3=1$, $(s_is_j)^2=1$ ($|i-j|\ge2$).
実は $S_n$ の生成元 $s_i$ も鏡映によって表現可能である.
問題 \qref{q:W(A_l)} を見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{3次直交行列の世界}
\label{sec:O(3)}

$\theta\in\R$ に対して行列式が $1$ の $3$ 次
直交行列 $R(\theta), S(\theta), T(\theta) \in SO(3)$ を次のように定める:
{\small
\begin{equation*}
  R(\theta) =
  \begin{bmatrix}
    \cos\theta & -\sin\theta & 0 \\
    \sin\theta &  \cos\theta & 0 \\
    0          &  0          & 1 \\
  \end{bmatrix},
  \ %
  S(\theta) =
  \begin{bmatrix}
     \cos\theta & 0 & \sin\theta \\
     0          & 1 & 0          \\
    -\sin\theta & 0 & \cos\theta \\
  \end{bmatrix},
  \ %
  T(\theta) =
  \begin{bmatrix}
    1 & 0          &  0          \\
    0 & \cos\theta & -\sin\theta \\
    0 & \sin\theta &  \cos\theta \\
  \end{bmatrix}.
\end{equation*}
}$R(\theta)$, $S(\theta)$, $T(\theta)$ は
それぞれ $xy$, $zx$, $yz$ 平面の角度 $\theta$ の回転を表現している.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:SO(3)=RST}
  $SO(3)$ が以下のように表示されることを示せ:
  \begin{equation*}
    SO(3) = 
    \{\, R(\theta)S(\phi)T(\psi) 
    \mid 0\le\theta<2\pi,\ -\pi/2\le\phi\le\pi/2,\ 0\le\psi<2\pi \,\}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $e_1,e_2,e_3$ を回転することによって $\R^3$ の正規直交基底を構成する
ことを考える.  まず $xy$ 平面を角度 $0\le\theta<2\pi$ 回転させ
て $(e_1,e_2,e_3)$ を次の正規直交基底 $(e'_1,e'_2,e'_3)$ に移す:
\begin{equation*}
  (e'_1,e'_2,e'_3) =
  (\cos\theta\,e_1+\sin\theta\,e_2,\;
  -\sin\theta\,e_1+\cos\theta\,e_2,\;
  e_3).
\end{equation*}
この回転によって $x,y,z$ 軸は $x',y',z'$ 軸に移るとする.  
次に $z'x'$ 平面を角度 $-\pi/2\le\phi\le\pi/2$ 回転させ
て $(e'_1,e'_2,e'_3)$ を次の正規直交基底 $(e''_1,e''_2,e''_3)$ に移す:
\begin{equation*}
  (e''_1,e''_2,e''_3) =
  (\cos\phi\,e'_1-\sin\phi\,e'_3,\;
  e'_2,\;
  \sin\phi\,e'_1+\cos\phi\,e'_2).
\end{equation*}
この回転によって $x',y',z'$ 軸は $x'',y'',z''$ 軸に移るとする.  
以上の操作によって $e''_1$ を任意の単位ベクトルに移せる.
最後に $y''z''$ 平面を角度 $0\le\psi<2\pi$ 回転させ
て $(e''_1,e''_2,e''_3)$ を次の正規直交基底 $(p_1,p_2,p_3)$ に移す:
\begin{equation*}
  (p_1,p_2,p_3) =
  (e''_1,\;
   \cos\psi\,e''_2+\sin\psi\,e''_3,\;
  -\sin\psi\,e''_2+\cos\psi\,e''_3).
\end{equation*}
$p_1=e''_1$ と直交するベクトル全体は $e''_2,e''_3$ で張られる平面に一致して
いるので, $p_2$ を $p_1$ に垂直な任意の単位ベクトルに移すことができる. 
$p_1,p_2$ に直交する単位ベクトルは $\pm p_3$ のどちらかに等しい.
以上によって任意の $3$ 次直交行列
は $P=[p_1\ p_2\ p_3]$ または $P'=[p_1\ p_2\ -p_3]$ の形をしていることがわ
かった.  上の操作を行列で書くと,
\begin{equation*}
  [e'_1\ e'_2\ e'_3] = [e_1\ e_2\ e_3] R(\theta), \quad
  [e''_1\ e''_2\ e''_3] = [e'_1\ e'_2\ e'_3] S(\phi), \quad
  [p_1\ p_2\ p_3] = [e''_1\ e''_2\ e''_3] T(\psi).
\end{equation*}
よって $P = R(\theta)S(\phi)T(\psi)$ である. 
これより $\det P=1$ であり, $\det P'=-1$ であることがわかる.
したがって任意の $SO(3)$ の元はこの $P$ の形で表わされる.
以上の議論を図を描いて説明せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euler 角]
\label{q:Euler-angle}
  $SO(3)$ が以下のように表示されることを示せ:
  \begin{equation*}
    SO(3) = 
    \{\, R(\varphi)S(\theta)R(\psi) 
    \mid 0\le\varphi<2\pi,\ 0\le\theta\le\pi,\ 0\le\psi<2\pi \,\}.
  \end{equation*}
  $\varphi$, $\theta$, $\psi$ を{\bf Euler 角 (Euler's angle)} と呼ぶ%
  \footnote{Euler 角は剛体の運動を記述するときによく使われる.}.
  \qed
\end{question}

\noindent
ヒント: $e_1,e_2,e_3$ を回転することによって $\R^3$ の正規直交基底を構成する
ことを考える.  まず $xy$ 平面を角度 $0\le\varphi<2\pi$ 回転させ
て $(e_1,e_2,e_3)$ を次の正規直交基底 $(e'_1,e'_2,e'_3)$ に移す:
\begin{equation*}
  (e'_1,e'_2,e'_3) =
  (\cos\varphi\,e_1+\sin\varphi\,e_2,\;
  -\sin\varphi\,e_1+\cos\varphi\,e_2,\;
  e_3).
\end{equation*}
この回転によって $x,y,z$ 軸は $x',y',z'$ 軸に移るとする.  
次に $z'x'$ 平面を角度 $0\le\theta\le\pi$ 回転させ
て $(e'_1,e'_2,e'_3)$ を次の正規直交基底 $(e''_1,e''_2,e''_3)$ に移す:
\begin{equation*}
  (e''_1,e''_2,e''_3) =
  (\cos\theta\,e'_1-\sin\theta\,e'_3,\;
  e'_2,\;
  \sin\theta\,e'_1+\cos\theta\,e'_2).
\end{equation*}
この回転によって $x',y',z'$ 軸は $x'',y'',z''$ 軸に移るとする.  
以上の操作によって $e''_3$ を任意の単位ベクトルに移せる.
最後に $x''y''$ 平面を角度 $0\le\psi<2\pi$ 回転させ
て $(e''_1,e''_2,e''_3)$ を次の正規直交基底 $(p_1,p_2,p_3)$ に移す:
\begin{equation*}
  (p_1,p_2,p_3) =
  (\cos\psi\,e''_1+\sin\psi\,e''_2,\;
  -\sin\psi\,e''_1+\cos\psi\,e''_2,\;
  e''_3).
\end{equation*}
$p_3=e''_3$ と直交するベクトル全体は $e''_1,e''_2$ で張られる平面に一致して
いるので, $p_2$ を $p_3$ に垂直な任意の単位ベクトルに移すことができる. 
$p_2,p_3$ に直交する単位ベクトルは $\pm p_1$ のどちらかに等しい.
以上によって任意の $3$ 次直交行列
は $P=[p_1\ p_2\ p_3]$ または $P'=[-p_1\ p_2\ p_3]$ の形をしていることがわ
かった.  上の操作を行列で書くと,
\begin{equation*}
  [e'_1\ e'_2\ e'_3] = [e_1\ e_2\ e_3] R(\varphi), \quad
  [e''_1\ e''_2\ e''_3] = [e'_1\ e'_2\ e'_3] S(\theta), \quad
  [p_1\ p_2\ p_3] = [e''_1\ e''_2\ e''_3] R(\psi).
\end{equation*}
よって $P = R(\varphi)S(\theta)R(\psi)$ である. 
これより $\det P=1$ であり, $\det P'=-1$ であることがわかる.
したがって任意の $SO(3)$ の元はこの $P$ の形で表わされる.
以上の議論を図を描いて説明せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $g(\varphi,\theta,\psi)=R(\varphi)S(\theta)R(\psi)$ と置く
  と $g(\varphi,\theta,\psi)^{-1}=g(\pi-\psi,\theta,\pi-\varphi)$. 
  \qed
\end{question}

\noindent
ヒント: 山内・杉浦 \cite{renzokugunron} 第II章第2節問3(50頁)の解答(191頁).
$A=R(\pi)=\diag(-1,-1,1)$ と置くと $A^2=E$, $AS(-\theta)A=S(\theta)$ である.
よって,
\begin{equation*}
  g(\varphi,\theta,\psi)^{-1}
  = R(-\psi)S(-\theta)R(-\varphi)
  = \text{☆☆☆}
  = R(-\psi+\pi)S(\theta)R(\pi-\varphi).
\qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

問題 \qref{q:SO(3)=RST} もしくは Euler 角 \qref{q:Euler-angle} の結果によっ
て $SO(3)$ の任意の2点が $SO(3)$ 内の連続的な曲線で結べることがわかる.
($(\theta,\phi,\psi)$ もしくは Euler 角を連続的に動かせばよい.) 
この事実を「$SO(3)$ は弧状連結 (arcwise connected) である」という.

これに対して $O(3)$ は弧状連結ではない. 
なぜならば $E,S=\diag(1,1,-1)\in O(3)$ の2点を結ぶ $O(3)$ 内の連続的な曲線が
存在するならば, $\det E=1$, $\det S=-1$ なので中間値の定理よりその連続的な
曲線上のどこかで行列式が $0$ になってしまうからである%
\footnote{同様の議論で $GL_n(\R)$ も弧状連結でないことを示せる.}.

問題 \qref{q:O(n)=SO(n)cupSO(n)S} の結果より $O(3)$ は2つの弧状連結
成分 $SO(3)$ と $SO(3)\diag(1,1,-1)$ に分かれていることがわかる%
\footnote{$GL_n(\R)$ も行列式の正負による分類によって2つの弧状連結成分に分か
  れていることを示せる.  ヒント: 岩沢分解によって $O(n)$ の場合に帰着する.
  $O(n)$ の場合の結果は\secref{sec:O(n)}で扱う.}.

ベクトルの並べ方が異なる基底は異なるとみなすことにすれば $\R^3$ の正規直交基
底 $(p_1,p_2,p_3)$ の全体は $P=[p_1\ p_2\ p_3]$ の行列式が $\pm 1$ のどちら
になるかによって分類される.  上で説明した実は, $P$ の行列式が同じになる正規
直交基底どうしは連続的な変形によって移り合い, $P$ の行列式が互いに異なる2つ
の正規直交基底は連続的な変形によって決して移り合わないことを意味している.

通常 $P$ の行列式が $1$ になるような正規直交基底は{\bf 右手系}と
呼ばれ, $-1$ になるような正規直交基底は{\bf 左手系}と呼ばれている.
上の議論によって, 右手系と左手系は連続的な変形によって互いに移り合わない.
通常図を描く場合には右手の人指し指, 中指, 親指の指す方向
のそれぞれを $x$, $y$, $z$ 軸の方向とみなす.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Hamilton の四元数の世界}
\label{sec:quaternion}

$3$ 次元実 Euclid 空間の連続的回転の世界 $SO(3)$ を完全に理解するため
には{\bf 四元数 (quaternion)} の世界を導入しなければいけない%
\footnote{一般の $SO(n)$ の場合は {\bf Clifford 代数 (Clifford algebra)} を
  導入する必要がある.  物理的に Clifford 代数は Fermion の代数である.}.
2次元平面の回転が複素数を用いれば $e^{i\theta}$ の形で表現できたこと
と同じように3次元空間の回転を四元数を用いて表現することができる.

Hamilton の四元数体 $\bH$ を以下のように定義する.  まず $\R$ 上のベクトル空間
として $\bH$ を $1,i,j,k$ を基底に持つ $\R$ 上のベクトル空間と定義する:
\begin{equation*}
  \bH = \R 1 \oplus \R i \oplus \R j \oplus \R k.
\end{equation*}
すなわち $\bH$ の任意の元 $u$ は 
\begin{equation*}
  u = a 1 + b i + c j + d k, \qquad a,b,c,d\in\R
\end{equation*}
の形で一意に表わされる.  $\R$ 上の
双線形写像 $\bH\times\bH\to\bH$, $(u,v)\mapsto uv$ を次
の条件によって定める:
\begin{align*}
  &
  11=1, \quad
  1i=i1=i, \quad
  1j=j1=j, \quad
  1k=k1=k, \quad
  \\ &
  ii=jj=kk=-1, \quad
  ij=-ji=k, \quad
  jk=-kj=i, \quad
  ki=-ik=j.
\end{align*}
$a\in\R$ と $a1\in\bH$ を同一視し,
$a+bi\in\C$ ($a,b\in\R$) と $a1+bi\in\bH$ を同一視する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  四元数体 $\bH$ の任意の元は $z+jw$ ($z,w\in\C$) と一意的に表わされ,
  $zj=j\cc{z}$ ($z\in\C$) が成立している.  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $u\in\bH$ が $u^2=-1$ を満たすための
  必要十分条件は $u$ が $u=bi+cj+dk$ ($b,c,d\in\R$, $b^2+c^2+d^2=1$) と表わ
  されることである. 
  そのとき $\{\,x+yu\mid x,y\in\R\,\}$ は複素数体のコピーとみなせる.
  \qed
\end{question}

\noindent
解説: $\C$ の $\bH$ への埋め込み方の全体の集合は
2次元球面 $S^2=\{\,(b,c,d)\in\R^3\mid b^2+c^2+d^2=1\,\}$ と同一視できる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

四元数 $u = a + bi + cj + dk\in\bH$ ($a,b,c,d\in\R$) に対して,
その共役元 $u^*$ を
\begin{equation*}
  u^* = a - bi - cj - dk
\end{equation*}
と定め, $u$ の実部 $\Repart u$ を次のように定める:
\begin{equation*}
  \Repart u = a.
\end{equation*}
$\bH$ に $\R$ 上の内積 $\bra\ ,\ \ket$ を次のように定める:
\begin{equation*}
  \bra u,v\ket := \Repart(u^*v) = aa' + bb' + cc' + dd'.
\end{equation*}
ここで $u=a+bi+cj+dk$, $v=a'+b'i+c'j+d'k$ ($a,b,c,d,a',b',c',d'\in\R$).
この内積に関する $u$ のノルム (絶対値) を $|u|$ と書く:
\begin{equation*}
  |u| = \bra u,u\ket^{1/2} = (a^2 + b^2 + c^2 + d^2)^{1/2}
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:quaternion-1}
  以下を示せ:
  \begin{enumerate}
  \item $1,i,j,k$ は $\bH$ の $\R$ 上の正規直交基底である.
  \item 任意の $u,v\in\bH$ に対して $(uv)^*=v^*u^*$.
  \item 任意の $u,v\in\bH$ に対して $\Repart(uv)=\Repart(vu)$.
  \item 任意の $u\in\bH$ に対して $u^*u=uu^*=|u|^2$.
  \item 任意の $u,v\in\bH$ に対して $|uv|=|u||v|$.
  \item {\bf (結合法則)}\quad 任意の $u,v,w\in\bH$ に対して $(uv)w=u(vw)$.
  \item {\bf (非零元の逆元)}\quad $0$ でない任意の $u\in\bH$ に
    対してある $v\in\bH$ で $vu=uv=1$ を満たすものが一意に存在する.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 結合法則の証明は $u,v,w$ が $1,i,j,k$ の場合に帰着する.
逆元の一意性: $vu=1$, $uw=1$ のとき $v=v1=v(uw)=(vu)w=1w=w$.
逆元の存在: $v = u^*/|u|^2$ と置けば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  四元数を用いて次の公式を証明せよ:
  \begin{align*}
    &
    (x_1^2+x_2^2+x_3^2+x_4^2)(y_1^2+y_2^2+y_3^2+y_4^2)
    \\ &
    = (x_1y_1+x_2y_2+x_3y_3+x_4y_4)^2
    + (x_1y_2-x_2y_1-x_3y_4+x_4y_3)^2
    \\ &
    + (x_1y_3-x_3y_1-x_4y_2+x_2y_4)^2
    + (x_1y_4-x_4y_1-x_2y_3+x_3y_2)^2.
    \qed
  \end{align*}
\end{question}

\noindent
ヒント: $u=x_1+x_2i+x_3j+x_4k$, $v=y_1+y_2i+y_3j+y_4k$ のとき,
\begin{equation*}
  |u|^2|v|^2=(x_1^2+x_2^2+x_3^2+x_4^2)(y_1^2+y_2^2+y_3^2+y_4^2)
\end{equation*}
であり, $z_1,z_2,z_3,z_4\in\R$ を $u^*v=z_1+z_2i+z_3j+z_4k$ と
定めると, 
\begin{equation*}
  |u^*v|^2 = z_1^2 + z_2^2 + z_3^2 + z_4^2.
\end{equation*}
そして問題 \qref{q:quaternion-1} の結果より $|u|^2|v|^2=|u^*v|^2$ である.
\qed

\medskip
\noindent
参考: この公式は「任意の正の整数は4つの整数の平方の和になる」という Lagrange 
の定理を証明するときに用いられる.  $1=1^2+0^2+0^2+0^2$, $2=1^2+1^2+0^2+0^2$ 
と上の公式より Lagrange の定理の証明は
「任意の奇素数は4つの整数の平方の和になる」ことを示すことに帰着する.
Lagrange の証明についてはたとえばヒンチン \cite{khinchin} 第3章第5節
(132--135頁)を見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[四元数体の複素行列表現]
\label{q:H-subset-M2(C)}
  行列 $I,J,K$ を次のように定める:
  \begin{equation*}
    I =
    \begin{bmatrix}
      i &  0 \\
      0 & -i \\
    \end{bmatrix},
    \quad
    J =
    \begin{bmatrix}
      0 & -1 \\
      1 & 0  \\
    \end{bmatrix},
    \quad
    K =
    \begin{bmatrix}
       0 & -i \\
      -i & 0 \\
    \end{bmatrix}.
  \end{equation*}
  $u\in\bH$ に対して $\phi(u)\in M_2(\C)$ を次のように定
  める:
  \begin{equation*}
    \phi(u) := 
    aE + bI + J(cE + dI) =
    \begin{bmatrix}
      z & -\cc{w} \\
      w &  \cc{z} \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $u=z+jw\in\bH$, $z=a+bi,\;w=c+di\in\C$, $a,b,c,d\in\R$ である.
  ($\phi(1)=E$, $\phi(i)=i$, $\phi(j)=J$, $\phi(k)=K$ で
  あることに注意せよ.) このとき, 
  \begin{enumerate}
  \item $\phi(au)=a\phi(u)$ \quad($a\in\R$, $u\in\bH$);
  \item $\phi(u+v)=\phi(u)+\phi(v)$ \quad($u,v\in\bH$);
  \item $\phi(uv)=\phi(u)\phi(v)$ \quad($u,v\in\bH$);
  \item $\phi(1)=E$ \quad($u,v\in\bH$);
  \item $\phi(u^*)=\phi(u)^*$ \quad($u\in\bH$);
  \item $\Repart u = \frac{1}{2}\trace\phi(u)$ \quad($u\in\bH$);
  \item $\bra u,v\ket=\frac{1}{2}\trace\bigr(\phi(u)^*\phi(v)\bigl)$ 
    \quad($u,v\in\bH$);
  \item $|u|^2=\det\phi(u)$ \quad($u\in\bH$).
  \end{enumerate}
  以上のの結果より, $1\leftrightarrow E$, $i\leftrightarrow I$, 
  $j\leftrightarrow J$, $k\leftrightarrow K$ という同一視によって, 
  四元数体 $\bH$ と上の形の $2$ 次複素正方行列の全体の集合は同一視できる
  ことがわかった.
  \qed
\end{question}

\noindent
ヒント: $\phi(uv)=\phi(u)\phi(v)$ の証明は $u,v$ が $i,j,k$ の場合に帰着する. 
まず $I^2=J^2=-E$, $IJ=-JI=K$ を示せ.
それらより $K^2=-E$, $JK=-KJ=I$, $KI=-IK=J$ が導かれる.
\qed

\medskip
\noindent
注意: \qref{q:Pauli-spin-matrices} で定義した Pauli のスピン行列は四元数の行
列表現と関係している.  $I,J,K$ は符号と並び方の違い除いて Pauli のスピン行列
の $i$ 倍に一致している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

四元数 $u\in\bH$ で $|u|=1$ を満たすもの全体の
集合を $U(1,\bH)$ と表わす%
\footnote{この記号法は $U(1)=\{\,z\in\C\mid |z|=1 \,\}$ の四元数の場合への拡
  張である.  より一般には
  \begin{equation*}
    U(n) = \{\, A\in M_n(\C) \mid A^*A=AA^*=E \,\},
    \quad
    U(n,\bH) = \{\, A\in M_n(\bH) \mid A^*A=AA^*=E \,\}.
  \end{equation*}
  実は $U(n,\bH)$ は{\bf ユニタリー・シンプレクティック群 
  (unitary symplectic group)} $Sp(n)=U(2n)\cap Sp_n(\C)$ に同型である.
  複素シンプレクティック群 $Sp_n(\C)$ は次のように定義される:
  \begin{equation*}
    Sp_n(\C) = \{\, A\in M_{2n}(\C) \mid \tp{A}J_n A = J_n \,\}.
  \end{equation*}
  ここで $J_n$ は対角線に問題 \qref{q:H-subset-M2(C)} で
  定義した $J$ を $n$ 個並べてできる $2n$ 次の正方行列である.
  特に $Sp_1(\C)=SL_2(\C)=\{\,A\in M_2(\C)\mid \det A = 1\,\}$ な
  ので $Sp(1)=SU(2)$ である. 
  $U(n,\bH)$ から $Sp(n)$ への同型写像
  は $A\in U(n,\bH)$ に対して $A$ の各成分の四元数を
  問題 \qref{q:H-subset-M2(C)} の $\phi$ によって $2$ 次複素正方行列
  に置換することによって得られる $2n$ 次複素正方行列 $\phi(A)$ を対応させる
  ことによって得られる.
  問題 \qref{q:U(1,H)=SU(2)} はこの結果の特別な場合である.}:
\begin{equation*}
  U(1,\bH) := \{\, u\in\bH \mid |u|=1 \,\}
  = \{\, u\in\bH \mid u^*u = uu^* = 1 \,\}.
\end{equation*}
$2$ 次複素正則行列 $A$ で $A^{-1}=A^*$ かつ $\det A=1$ を満たすもの全体の
集合を $SU(2)$ と表わす:
\begin{equation*}
  SU(2) := \{\, A\in M_2(\C) \mid A^*A=AA^*=E,\ \det A = 1 \,\}.
\end{equation*}

\begin{question}
\label{q:U(1,H)=SU(2)}
  $U(1,\bH)$ は四元数の積に関して群をなし,
  $SU(2)$ は行列の積に関して群をなすことを示せ. 
  $SU(2)$ は $2$ 次の{\bf 特殊ユニタリー群 (special unitary group)} と
  呼ばれている.  
  問題 \qref{q:H-subset-M2(C)} の同一視を通して, 
  $SU(2)$ と
  集合 $U(1,\bH)$ を同一視できることを示せ.  すなわち,
  \begin{align*}
    SU(2) &= 
    \left\{\,\left.
      \begin{bmatrix}
        z & -\cc{w} \\
        w &  \cc{z} \\
      \end{bmatrix}
    \,\right|\,
      z,w\in\C,\; |z|^2+|w|^2=1
    \,\right\}
    \\
    &=
    \left\{\,\left.
      \begin{bmatrix}
        a+bi & -c+di \\
        c+di &  a-bi \\
      \end{bmatrix}
    \,\right|\,
      a,b,c,d\in\R,\; a^2+b^2+c^2+d^2=1
    \,\right\}
  \end{align*}
  であることを示せ.  \qed
\end{question}

\noindent
ヒント: $2\times 2$ 行列の話なので真面目に計算するだけ.
\qed

\medskip
\noindent
解説: $S^3=\{\,(a,b,c,d)\in\R^4\mid a^2+b^2+c^2+d^2=1\,\}$ は $3$ 次元球面と
呼ばれている.  $4$ 次元 Euclid 空間に表面が $3$ 次元に球面が浮かんでいる様子
を想像しなければいけない.  $3$ 次元 Euclid 空間に浮かぶ表面が $2$ 次元の通常
の球面 $S^2$ は $2$ 次元球面と呼ばれている.  上の問題の結果は $SU(2)$ が位相
的に $3$ 次元球面 $S^3$ と同相であることを意味している%
\footnote{同相という言葉を知らなくても気にする必要はない. 直観的には
  2つの空間のあいだに連続的に一対一対応を構成できるとき, 
  2つの空間は互いに{\bf 同相 (homeomorphic)} であると言う.}.  %
前節で $SO(3)$ は Euler 角などによって $3$ 次元の空間であることは大体わかっ
ている.  $SO(3)$ がどういう形をしているかは $SU(2)$ と $SO(3)$ を関係付ける
ことによって調べることができる.  それを実行するのが目標である.
\qed

\bigskip
\noindent
{\Large まとめ: $SU(2)=U(1,\bH)=S^3$ という同一視が可能である.}
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

四元数体の元の指数函数が自然に定義される:
\begin{equation*}
  e^u = \sum_{n=0}^\infty \frac{u^n}{n!}
  \qquad (u\in\bH).
\end{equation*}
複素数の場合と同様に $\theta\in\R$ に対して次の公式が成立している:
\begin{equation*}
  e^{i\theta} = \cos\theta + i\sin\theta, \quad
  e^{j\theta} = \cos\theta + j\sin\theta, \quad
  e^{k\theta} = \cos\theta + k\sin\theta.
\end{equation*}

\begin{question}
\label{q:U(1,H)-Euler-angle}
  $U(1,\bH)$ は次のように表わされる:
  \begin{equation*}
    U(1,\bH) =
    \bigl\{\, e^{k\varphi}e^{j\theta}e^{k\psi}
    \bigm| \varphi,\theta,\psi\in\R \,\bigr\}.
    \qed
  \end{equation*}
\end{question}

\noindent
注意: Euler 角 \qref{q:Euler-angle} との類似性に注意せよ.
\qed

\medskip
\noindent
ヒント: $kj=-jk$ より
\begin{align*}
  e^{k\varphi}e^{j\theta}e^{k\psi}
  &= \cos\theta e^{k(\varphi+\psi)} + \sin\theta j e^{k(\varphi-\psi)}
  \\
  &= \cos\theta\cos(\varphi+\psi) + k\cos\theta\sin(\varphi+\psi)
  \\
  &+ j\sin\theta\cos(\varphi-\psi) + i\sin\theta\sin(\varphi-\psi).
\qed
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$\R i+\R j+\R k$ の正規直交基底 $(i,j,k)$ 
と $\R^3$ の標準的な正規直交基底 $(e_1,e_2,e_3)$ 
を同一視することによって, $\R i+\R j+\R k=\R^3$ と同一視する.

\begin{question}
\label{q:rho:U(1,H)toSO(3)}
  任意の $g\in U(1,\bH)$ に対して $\R i+\R j+\R k=\R^3$ の
  直交変換 $\rho(g)$ を
  \begin{equation*}
    \rho(g)x := gxg^{-1} \qquad (x\in\R i+\R j+\R k=\R^3)
  \end{equation*}
  と定めることができ, 次が成立している:
  \begin{equation*}
    \rho(gh)=\rho(g)\rho(h) \quad (g,h\in U(1,\bH)),
    \qquad
    \rho(1)=\id_{\R^3}.
  \end{equation*}
  ここで $\id_{\R^3}$ は $\R i+\R j+\R k=\R^3$ の恒等写像である%
  \footnote{集合 $X$ の{\bf 恒等写像 (identity map)} $\id_X$ 
    とは $\id_X(x)=x$ ($x\in X$) で定義される写像のことである.
    恒等写像は何も動かさない.}.
  $g=e^{i\theta},e^{j\theta},e^{k\theta}$ ($\theta\in\R$) に対して, 
  基底 $(i,j,k)=(e_1,e_2,e_3)$ に関する $\rho(g)$ の行列表示は次のようになる:
  \begin{equation*}
    \rho(e^{i\theta}) = T(2\theta), \quad
    \rho(e^{j\theta}) = S(2\theta), \quad
    \rho(e^{k\theta}) = R(2\theta).
  \end{equation*}
  ここで $R(\theta),S(\theta),T(\theta)$ は\secref{sec:O(3)}の最初に定義した
  回転行列である.  よって, $\varphi,\theta,\psi\in\R$ に対して
  \begin{equation*}
    \rho(e^{k\varphi})\rho(e^{j\theta})\rho(e^{k\psi})
    = R(2\varphi)S(2\theta)R(2\psi).
  \end{equation*}
  したがって, 問題\qref{q:U(1,H)-Euler-angle}と問題\qref{q:Euler-angle}より,
  $\rho$ は $U(1,\bH)$ から $SO(3)$ への全射であることがわかる.
  \qed
\end{question}

\noindent
ヒント: $g\in U(1,\bH)$ に対して $g^*=g^{-1}$ なので
\begin{equation*}
  \bra \rho(g)x,\rho(g)y\ket 
  = \Repart\bigl((gxg^*)^*gyg^*\bigr)
  = \Repart\bigl(gx^*g^*gyg^*\bigr)
  = \Repart(x^*y)
  = \bra x,y\ket.
\end{equation*}
$ik=-ki$ であるから,
\begin{equation*}
  \rho(e^{k\theta})i
  = e^{k\theta}i e^{-k\theta}
  = e^{2k\theta}i
  = i\cos2\theta + j\sin2\theta.
\qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

上の問題を見ると, 四元数の世界における角度 $\theta$ の回転に
対応する3次元空間の回転は倍の角度 $2\theta$ の回転になっている.
このことから想像されるように $\rho:U(1,\bH)\to SO(3)$ は $2:1$ 写像に
なっている.  すなわち $SO(3)$ の1点は $U(1,\bH)$ の2点と対応している.
次の問題を見よ.

\begin{question}
  問題 \qref{q:rho:U(1,H)toSO(3)} の $\rho:U(1,\bH)\to SO(3)$ を考える.
  このとき $g,h\in U(1,\bH)$ に対して $\rho(g)=\rho(h)$ が成立するための必要
  十分条件は $g=\pm h$ が成立することである. 
  \qed
\end{question}

\noindent
ヒント: 十分性はほとんど明らか. 必要性は以下のように証明する.
$x = gh^{-1}$ と置くことによって $\rho(x)=\id$ ならば $x=\pm 1$ であることを示
せば良いことがわかる.  $\rho(x)=\id$ ならば特に $xix^{-1}=i$ かつ $xjx^{-1}=j$ 
である. $xix^{-1}=i$ より $x\in\C$ かつ $|x|=1$ であることが
わかり, さらに $xjx^{-1}=j$ より $x=\pm1$ であることがわかる.
\qed

\medskip
\noindent
解説: 3次元球面上の原点を中心として点対称の位置にある2点をすべて同一視してで
きる空間を3次元実射影空間と呼び, $\P^3(\R)$ と書くことにする:
\begin{equation*}
  \P^3(\R) = S^3/{\sim}, \qquad  x \sim \pm x.
\end{equation*}
$U(1,\bH)=SU(2)$ は自然に3次元球面 $S^3$ と同一視できるのであった.
$\pm g\in U(1,\bH)$ に対応する3次元球面上の2つの点は原点を中心として
点対称の位置にある.  
よって上の問題は $3$ 次元実射影空間 $\P^3(\R)$ と $SO(3)$ が同一視できること
を意味している%
\footnote{この辺の説明はわかり難いかもしれないので, 直接質問してくれれば図を
  描いてより詳しく説明する.  重要なのは $SU(2)=U(1,\bH)$ や $SO(3)$ のような
  回転全体の空間の「形」が完全にわかってしまうことである.
  $\P^3(\R)$ がどういう世界なのかよく理解できない人は2次元球面から実射影平面
  を構成することが直観的にどういうことなのかについて考えてみよ.}
\qed

\bigskip
\noindent
{\Large まとめ: $SO(3)=\P^3(\R)$ と同一視できる.}
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

すでに大活躍した $\R i+\R j+\R k$ を $\lie{u}(1,\bH)$ と書くことにする:
\begin{equation*}
  \lie{u}(1,\bH) = \R i+\R j+\R k.
\end{equation*}
$\lie{u}(1,\bH)$ は $\R^3$ と同一視されるだけではなく,
そこに有用な構造 (Lie 群 $U(1,\bH)$ のLie 代数の構造) を入れることができる.

\begin{question}
  以下を示せ:
  \begin{enumerate}
  \item 任意の $u,v\in\lie{u}(1,\bH)$ に対して $[u,v]\in \lie{u}(1,\bH)$ で
    ある%
    \footnote{$[u,v]=uv-vu$ (交換子)である. $\lie{u}(1,\bH)$ が交換子につい
      て閉じているということはそれが Lie 代数であることを意味している.}. 
  \item 任意の $u\in\lie{u}(1,\bH)$ に対して $e^u\in U(1,\bH)$ である%
    \footnote{$U(1,\bH)$ の実多様体としての次元は $3$ に等し
      く, $\lie{u}(1,\bH)$ の実ベクトル空間としての次元も $3$ に等しいので,
      「$u\in\lie{u}(1,\bH)$ ならば $e^u\in U(1,\bH)$」は $\lie{u}(1,\bH)$ 
      が $U(1,\bH)$ の Lie 代数であることを意味している.}.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $[i,j]=2k$, $[j,k]=2i$, $[k,i]=2j$ である. 
$u\in\lie{u}(1,\bH)$ のとき $u^*=-u$ なので $(e^u)^*=e^{-u}=(e^u)^{-1}$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

上の問題に対応する複素行列における結果は次のようになる.

\begin{question}
  実ベクトル空間 $\lie{su}(2)$ を次のように定義する:
  \begin{equation*}
    \lie{su}(2) = \{\, A\in M_2(\C)\mid A^*=-A,\ \trace A = 0\,\}.
  \end{equation*}
  このとき以下が成立する:
  \begin{enumerate}
  \item $\lie{su}(2)=\R I + \R J + \R K$.
  \item 任意の $A,B\in\lie{su}(2)$ に対して $[A,B]\in\lie{su}(2)$ である%
    \footnote{$[A,B]=AB-BA$ (交換子)である.}.
  \item 任意の $A\in\lie{su}(2)$ に対して $e^A\in SU(2)$.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 任意の正方行列 $A$, $B$ に対して $\trace[A,B]=0$ である.
$A^*=-A$, $B^*=-B$ のとき $[A,B]^*=[B^*,A^*]=[B,A]=-[A,B]$ となる.
$A^*=-A$ のとき $(e^A)^* = e^{-A}=(e^A)^{-1}$ となる.
$\trace A=0$ ならば $\det e^A = 1$ となることの証明には次の問題の結果を使う.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A$ が $n$ 次複素正方行列ならば $\det e^A = e^{\trace A}$. \qed
\end{question}

\noindent
ヒント1: 問題\qref{q:triangularizable}より, ある複素正則行列 $P$ が
存在して $P^{-1}AP$ は上三角行列になり, $P^{-1}AP$ の
対角成分には $A$ の固有値 $\alpha_1,\dots,\alpha_n$ が並ぶ.
このとき, $e^{P^{-1}AP}$ の対角成分には $e^{\alpha_1},\dots,e^{\alpha_n}$ が
並ぶ.  よって $\det e^A = \det e^{P^{-1}AP} = e^{\alpha_1+\cdots+\alpha_n}
= e^{\trace P^{-1}AP} = e^{\trace A}$. 
\qed

\medskip
\noindent
ヒント2: $f(t)=\det e^{At}$ と置くと $f(0)=1$ であり, 
次の問題の結果より
\begin{equation*}
  \frac{f'(t)}{f(t)} 
  = \trace\left(e^{-At}\od{t}e^{At}\right) 
  = \trace(e^{-At}e^{At}A) 
  = \trace A.
\end{equation*}
よって $f(t)=e^{t\trace A}$ である. $t=1$ と置けば示すべき結論が得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ddet}
  $\det X$ を $X=[x_{ij}]_{i,j=1}^n$ の成分 $x_{ij}$ の多項式であるとみなす.
  このとき,
  \begin{equation*}
    \frac{d\det X}{\det X} = \trace(X^{-1}\,dX).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 行列式 $\det X$ と $X$ の $(i,j)$ 余因子 $\tilde{x}_{ij}$ の定義より, 
\begin{equation*}
  \pdfrac{\det X}{x_{ij}} = \tilde{x}_{ij}.
\end{equation*}
よって, $\Delta(X)=[\tilde{x}_{ij}]$, $dX=[dx_{ij}]$ と置くと,
\begin{equation*}
  d\det X = \sum_{i,j=1}^n \tilde{x}_{ij}\,dx_{ij}
  = \trace(\tp{\Delta(X)}\,dX)
  = \det X \cdot \trace(X^{-1}\,dX).
\end{equation*}
より詳しい解説が佐武 \cite{satake} 第II章第3節(84--85頁)にある.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$SU(2)$ と $SO(3)$ の関係の入門的な詳しい解説が
山内・杉浦 \cite{renzokugunron} の第II章第2節41--50頁にあるので興味のある方
は参照されたり.  横田 \cite{gun-iso} の30頁の例53, 例54も参照せよ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$n$ 次直交行列の世界}
\label{sec:O(n)}

$n$ 次の正方行列で $(i,j)$ 成分のみが $1$ で他の成分がすべて $0$ であるよう
なものを $E_{ij}$ と書き, $(i,j)$ {\bf 行列単位 (matrix unit)} と呼ぶ.

$\theta\in\R$ と $i\ne j$ に対して $n$ 次の直交行列 $R_{ij}(\theta)$ を次の
ように定める:
\begin{equation*}
  R_{ij}(\theta) 
  = (E_{ii}+E_{jj})\cos\theta
  + (E_{ji}-E_{ij})\sin\theta
  + \sum_{k\ne i,j} E_{kk}.
\end{equation*}
たとえば $n=3$ のとき\secref{sec:O(3)}の記号にしたがえば %
$R_{12}(\theta)=R(\theta)$,
$R_{31}(\theta)=S(\theta)$,
$R_{23}(\theta)=T(\theta)$ である.  

\begin{question}
  $R_{ji}(\theta)=R_{ij}(-\theta)=R_{ij}(\theta)^{-1}$. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:SO(n)=R...R}
  $SO(n)$ は次のように表わされる:
  \begin{equation*}
    SO(n) =
    \Bigl\{\, 
      \prod_{i<j}R_{ij}(\theta_{ij})
    \Bigm|
      \theta_{ij}\in\R\ (i<j)
    \,\Bigr\}.
  \end{equation*}
  ここで $r_{ij}=R_{ij}(\theta_{ij})$ たちの積の順序は辞書式に
  左から $r_{12}r_{13}\cdots r_{1n}r_{23}\cdots r_{2n}\cdots r_{n-1,n}$ と並
  んでいると仮定する. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:SO(3)=RST} のヒントを $n$ 次元に拡張すれば良い.
厳密には $n$ に関する帰納法で証明すれば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:pre-SO(n)-connected}
  $A\in O(n)$ であるとし, $A$ の固有値 $-1$ の重複度を $q$ と書くことにする.
  (もしも $A$ が $-1$ を固有値に持たなければ $q=0$.)
  このとき, $A\in SO(n)$ であるための必要十分条件は $q$ が奇数であることであ
  る. \qed
\end{question}

\noindent
ヒント: \secref{sec:normal-matrix}の問題 \qref{q:orthogonal} の結果を使う.
そのとき $
\begin{bmatrix}
  -1 &  0 \\
   0 & -1 \\
\end{bmatrix}
=
\begin{bmatrix}
  \cos\pi & -\sin\pi \\
  \sin\pi &  \cos\pi \\
\end{bmatrix}$ に注意せよ. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:SO(n)-connected}
  $SO(n)$ は弧状連結である%
  \footnote{$SO(n)$ の単位元 $E$ と任意の元 $A$ を結ぶ $SO(n)$ 内の連続的な
    曲線が存在することを示せ.}.
  \qed
\end{question}

\noindent
ヒント1: 問題 \qref{q:SO(n)=R...R} の結果を使う.  
$SO(n)$ の任意の元 $A$ を $R_{ij}(\theta_{ij}$ たちの積で表示しておく. 
$R_{ij}(t\theta_{ij})$ たちの積は $t$ に関して連続であり $t=0$ のとき
単位行列になり $t=1$ のとき $A$ になる.
\qed

\medskip
\noindent
ヒント2: \secref{sec:normal-matrix}の問題 \qref{q:orthogonal} の結果を使う.
問題 \qref{q:pre-SO(n)-connected} のヒントも参照せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

\secref{sec:normal-matrix}の問題 \qref{q:orthogonal} の結果に解説を追加して
おきたい.  そのためにその内容を全文再掲しておこう.
問題 \qref{q:orthogonal} の結果:
\begin{quote}
\begin{small}
  直交行列 $A$ に対してある直交行列 $Q$ で $Q^{-1}AQ$ が次の形になるものが
  存在する:
  \begin{equation*}
    Q^{-1}AQ =
    \begin{bmatrix}
      E_{r_1} &          &               &              &        & & \\
              & -E_{r_2} &               &              &        & & \\
              &          &  \cos\theta_1 & \sin\theta_1 &        & & \\
              &          & -\sin\theta_1 & \cos\theta_1 &        & & \\
              &          &               &              & \ddots & & \\
              &          &               &              &        &  \cos\theta_s & \sin\theta_s \\
              &          &               &              &        & -\sin\theta_s & \cos\theta_s \\
    \end{bmatrix}.
  \end{equation*}
  ここで, $r_1+r_2+2s=n$ かつ $\theta_k\in\R$ であり, $E_r$ は $r$ 次の単位
  行列である. 
  \qed
\end{small}
\end{quote}
この結果は次のような幾何学的意味を持っている.  
いつものように直交行列 $Q$ の中の列ベクトルを $q_1,\dots,q_n$ と書いておく.
正規直交基底 $q_1,\dots,q_n$ が定める $\R^n$ の
直交座標系を $y_1,\dots,y_n$ と書くことにする.
座標系 $y_i$ で見れば直交変換 $A$ は次のように見える:
\begin{itemize}
\item $A$ の作用は $y_1,\dots,y_{r_1}$ を何も変えない.
\item $A$ の作用は $y_{r_1+1},\dots,y_{r_1+r_2}$ を $-1$ 倍する.
\item $A$ の作用は $y_{r_1+r_2+2k-1}y_{r_1+r_2+2k}$ 平面を
  右回りに角度 $\theta_k$ だけ回転する($k=1,\dots,s$).
\end{itemize}
問題 \qref{q:orthogonal} の結果は任意の直交変換に対してこのような便利な直交
座標系を選ぶことができることを意味している.  線形代数の基本は便利な基底を選
んでその基底を用いて線形写像を調べることである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  任意の $A\in SO(3)$ はある軸の回りをある角度だけ回転させる直交変換を表現し
  ている. \qed
\end{question}

\noindent
解説: この問題の結果はまさに $SO(3)$ の元は回転を表現していることを意味して
いる.
\qed

\medskip
\noindent
ヒント: 問題 \qref{q:orthogonal} の結果より, 
任意の $A\in SO(3)$ に対してある直交行列 $Q$ と実数 $\theta$ で
\begin{equation*}
  Q^{-1}AQ = 
  \begin{bmatrix}
    1 & 0          & 0 \\
    0 & \cos\theta & -\sin\theta \\
    0 & \sin\theta &  \cos\theta \\
  \end{bmatrix}
\end{equation*}
を満たすものが存在することがわかる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $O(n)$ は弧状連結でない%
  \footnote{$E$ と $\diag(-1,1,\dots,1)$ を $O(n)$ 内の連続的な曲線で結ぶこ
    とができないことを示せ.}. 
  同様に $GL_n(\R)$ も弧状連結でない. \qed
\end{question}

\noindent
ヒント: $E,S=\diag(-1,1,\dots,1)\in O(n)$ である.
もしも連続写像 $C:[0,1]\to O(n)$ で $C(0)=E$, $C(1)=S$ を満たすものが存在し
たとすれば, $\det C(0)=1$ でかつ $\det C(1)=-1$ なので, 
中間値の定理より, ある $t\in[0,1]$ が存在して $\det C(t)=0$ となる.
しかし, $C(t)$ は正則行列なのでそうはならない. よって矛盾.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{鏡映変換}
\label{sec:reflection}

任意に $0$ でないベクトル $a\in\R^n$ を取る.  
$a$ に垂直な超平面 $H_a$ が次のように定義される:
\begin{equation*}
  H_a = \{\, x\in\R^n \mid \bra a,x\ket = 0 \,\}.
\end{equation*}
超平面 $H_a$ に関する{\bf 鏡映 (reflection)} $S_a:\R^n\to\R^n$ が次のように
定義される%
\footnote{$a^\vee$ という記号法は {\bf ルート系 (root system)} の理論における
  標準的な記号法である. ルート系に関しては谷崎 \cite{tanisaki} などの Lie 代
  数の教科書を参照せよ.}: 
\begin{equation*}
  S_a(x) = x - \bra a^\vee, x \ket a,
  \qquad a^\vee := \frac{2a}{\norm{a}^2} = \frac{2a}{\bra a, a\ket}.
\end{equation*}

\begin{question}
  この $S_a$ が実際に「鏡映」と呼ぶべき変換になっていることを図を描いて直観
  的に説明せよ.  \qed
\end{question}

\noindent
ヒント: 単位ベクトル $p$ を $p=a/\norm{a}$ と定めると
\begin{equation*}
  S_a(x) = S_p(x) = x - 2\bra p,x\ket p
  \qquad (x\in\R^n).
\end{equation*}
$\bra p,x\ket$ はベクトル $x$ の直線 $\{\,tp\mid t\in\R\,\}$ への射影の長さ
の $\pm1$ 倍に一致している.
\qed
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  鏡映 $S_a$ は線形変換であり, 
  任意の $x,y\in\R^n$ に対して $\bra S_a(x),S_a(y)\ket = \bra x,y\ket$. 
  すなわち鏡映変換 $S_a$ は直交変換である.  \qed
\end{question}

\noindent
ヒント: 上の $S_a(x) = S_p(x) =  x - 2\bra p,x\ket p$ という表示を利用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  単位ベクトル $p$ を $p=\tp{[p_1\ \cdots\ p_n]} := a/\norm{a}$ と定める.  
  このとき, 鏡映変換 $S_a$ の行列表示は次のようになることを示せ:
  \begin{equation*}
    S_a = 
    E - 2p\tp{p} =
    \left[
    \begin{array}{rrrcr}
      1 - 2p_1p_1 &   - 2p_1p_2 &   - 2p_1p_3 & \cdots &   - 2p_1p_n \\
        - 2p_2p_1 & 1 - 2p_2p_2 &   - 2p_2p_3 & \cdots &   - 2p_2p_n \\
        - 2p_3p_1 &   - 2p_3p_2 & 1 - 2p_3p_3 & \cdots &   - 2p_3p_n \\
        \vdots    &   \vdots    &   \vdots    & \ddots &   \vdots    \\
        - 2p_np_1 &   - 2p_np_2 &   - 2p_np_3 & \cdots & 1 - 2p_np_n \\
    \end{array}
    \right].
  \end{equation*}
  これが直交行列であることを直接的計算で確かめてみよ. \qed
\end{question}

\noindent
ヒント: 行列表示がこうなることを示すために
は $(E-2p\tp{p})x = x-2\bra p,x\ket p$ を示せば良いが, ほとんど明らかである.
(もしくは, $S_p$ の行列表示が上の行列になっていることは $S_p(e_j)$ が
上の行列の第 $j$ 列ベクトルに一致していることを確かめても良い.)
直交行列であることは $\tp{(E-2p\tp{p})}(E-2p\tp{p})=E$ を示せば良い
が, $1=\norm{p}^2=\tp{p}p$ であるから簡単である.  
次の問題も参照せよ. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $n$ 次実対称行列 $A$ が $A^2=A$ を満たして
  いるならば $E - 2A$ は直交行列である. \qed
\end{question}

\noindent
参考: $A^2=A$ を満たしている行列の固有値は $1$ または $0$ である. 
よって, $A^2=A$ を満たしている $n$ 次実対称行列 $A$ に対して, 
ある直交行列 $P$ が存在して $P^{-1}AP=\diag(1,\dots,1,0,\dots,0)$ となる.
$1$ の個数を $k$ とし, $P$ の第 $j$ 列ベクトルを $p_j$ と書くことにする
と, $A$ は $p_1,\dots,p_k$ で張られる部分ベクトル空間への直交射影の行列表現
になっていることがわかる. 
このとき $P^{-1}(E-2A)P=\diag(-1,\dots,-1,1,\dots,1)$ で
あり, $\det(E-2A)=(-1)^k$ ($k$ は $A$ の固有値 $1$ の重複度) が成立する.
(この事実を用いて上の問題の結果を証明できるが, 
そんなことをしなくても直接的に証明可能であるのでそうして欲しい.)
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $0$ でない任意のベクトル $a\in\R^n$ に対して, 
  ある直交行列 $P$ が存在して
  \begin{equation*}
    P^{-1} S_a P = 
    \begin{bmatrix}
      E_{n-1} &  0 \\
         0    & -1 \\
    \end{bmatrix}.
  \end{equation*}
  特に $\det S_a = -1$ である.  \qed
\end{question}

\noindent
ヒント: $p_n = a/\norm{a}$ を含む $\R^n$ の正規直交基底 $p_1,\dots,p_n$ を任
意に取ると, $S_a(p_i)=p_i$ ($i=1,\dots,n-1$), $S_a(p_n)=-p_n$ となる.
そのとき $P=[p_1\ \cdots\ p_n]$ と置くと $S_aP=P\diag(1,\dots,1,-1)$. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:W(A_l)}
  $\alpha_i = e_i - e_{i+1} \in\R^n$ ($i=1,\dots,n-1$) と置く.
  このとき $\alpha_i^\vee = 2\alpha/\bra a,a\ket = \alpha_i$ であり,
  \begin{equation*}
    [a_{ij}]_{i,j=1}^{n-1} :=
    [\bra \alpha_i^\vee,\alpha_j\ket]_{i,j=1}^{n-1} = 
    \begin{bmatrix}
       2 & -1 &        & & \bigzerou \\
      -1 &  2 &   -1   &        &    \\
         & -1 &    2   & \ddots &    \\
         &    & \ddots & \ddots & -1 \\
      \bigzerol & &    &   -1   &  2 \\
    \end{bmatrix}.
  \end{equation*}
  この行列を $A_{n-1}$ 型の Cartan 行列と呼ぶ.  
  $S_i = S_{\alpha_i}$ ($i=1,\dots,n-1$) と置く.
  このとき,
  \begin{equation*}
    S_i(\alpha_j) = \alpha_j - \alpha_i a_{ij} 
    \qquad (i,j=1,\dots,n-1).
  \end{equation*}
  よって $\alpha_1,\dots,\alpha_{n-1}$ で張られる格子%
  \footnote{$\alpha_1,\dots,\alpha_{n-1}$ で
    張られる{\bf 格子 (lattice)} とは
    \begin{equation*}
      \Z\alpha_1 + \cdots + \Z\alpha_{n-1}
      = \{\, k_1\alpha_1 + \cdots + k_{n-1}\alpha_{n-1} 
        \mid k_1,\dots,k_{n-1}\in\Z \,\}
    \end{equation*}
    という集合のことである. この集合は和と差で閉じている.
    この格子は $A_{n-1}$ 方の root 格子と呼ばれている.
    (各 $\alpha_i$ は単純 root と呼ばれている.)}
  は $S_i$ の作用で閉じている.  さらに次も成立している:
  \begin{align*}
    &
    S_i^2 = E \qquad (i=1,\dots,n-1),
    \\ &
    S_iS_{i+1}S_i = S_{i+1}S_iS_{i+1} \qquad (i=1,\dots,n-2),
    \\ &
    S_iS_j = S_jS_i \qquad (|i-j|\ge 2).
    \qed
  \end{align*}
\end{question}

\noindent
ヒント: ベクトル $x$ の第 $i$ 成分を $x_i$ と
書くと, $S_i$ の $x$ への作用は $x_i$ 成分と $x_{i+1}$ 成分の交換に
なっている.  よって $i$ と $i+1$ を交換する互換を $s_i=(i,i+1)$ と
書けば, 鏡映 $S_i$ たちは $s_i$ たちと同じ関係式を満たしている.
\qed

\medskip
\noindent
解説: 実は上の問題の結果は置換群を鏡映によって忠実に表現できることを意味して
いる.  しかも $\det S_i=-1$ なので, 
置換群の元 $\sigma=s_{i_1}\cdots s_{i_l}$ に
対して対応する置換行列を $S_{\sigma} = S_{i_1}\cdots S_{i_l}$ と
定めると $\det S_{\sigma} = \sgn\sigma$ が成立している.
すなわち置換群の元の signature は対応する置換行列の行列式に一致している.
\qed

\medskip
\noindent
参考: 隣り合わせの数の交換の繰り返しで数の並びを自由に変えることができる
ので, $n$ 次の置換群 $S_n$ は $s_i=(i,i+1)$ ($i=1,\dots,n-1$) から生成
される%
\footnote{$S_n$ の任意の元は有限個の $s_i$ たちの積で表わされる.}.  
実はこの事実は阿弥陀籤 (あみだくじ) によって任意の置換を作り出せること
と同値である.  あみだくじによる抽選は, 縦線を上から下に進み, 横線があれば
その先の隣りの縦線に移るという操作によって行なわれる.
あみだくじの中の $i$ 番目の縦線と $i+1$ 番目の縦線のあいだの
横線はまさに $s_i$ の役目を果たしているのである.
あみだくじが定める置換の signature はあみだくじの横線の個数が偶数
ならば $1$ で奇数ならば $-1$ である.

実は目で見易くするためには横線部分をバッテンに描き直した方が良い.
さらにバッテンを線が上下に交差しているように描き直せば{\bf 組紐 (braid)} の
世界が出現する.  
(この意味がよくわからない人は質問してくれれば詳しく説明する.)
左上から右下への線と右上から左下への線の交差の上下はどれも同じ (たとえば前者
が常に上で後者が常に下) であるとして, $s_is_{i+1}s_i=s_{i+1}s_is_{i+1}$ に対
応する図を描いてみよ.  左辺と右辺はひもを連続的にずらすことによって互いに移
り合うことがわかる.  
この関係式は組紐において最も重要かつ基本的な関係式である.  

この意味で $s_is_{i+1}s_i=s_{i+1}s_is_{i+1}$ という関係式
を{\bf 組紐関係式 (braid relation)} と呼ぶことがある. 
この関係式は数理物理学における解ける模型 (可解模型) と書く関係しているので, 
画期的な仕事をした2人の物理学者の名を取って {\bf Yang-Baxter 関係式}と呼ぶ
こともある.

「くみひも」や「あみだくじ」のような日常生活に登場するもの
は実は数学的にも基本的でかつ重要な対象なのである.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{体上の1変数多項式環における Euclid の互除法}
\label{sec:Euclidean-algorithm-K[x]}

実は Jordan 標準形の理論は本質的に体上の1変数多項式環の理論である.
すでに Cayley-Hamilton の定理%
\footnote{Hamilton-Cayley の定理と呼んでいる文献も多い.}
の有用さから行列の理論では多項式が重要な役目を果たしていることが
なんとなく想像できるだろう. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{体について}
\label{sec:field}

\bigskip
{\Large この辺で少し気分を変えて, $K$ は任意の{\bf 体 (field)} であると
  し, $K$ 係数の多項式や $K$ 上のベクトル空間について考えることにする%
  \footnote{
    $K$ の元を成分に持つ $(m,n)$ 型行列全体の集合を $M_{m,n}(K)$ と書くこと
    にする.  特に $n$ 次正方行列全体の集合を $M_n(K)=M_{n,n}(K)$ と表わす.
    さらに正則行列 $A\in M_n(K)$ 全体の集合を $GL_n(K)$ と表わす.
    $n$ 個の $K$ の元が縦に並べた縦ベクトル全体の集合を $K^n$ と書くことにす
    る.  $K^n=M_{n,1}(K)$ とみなせる.  よって $A\in M_n(K)$ と $v\in K^n$ の
    積 $Av\in K^n$ が定義され, $A$ は $K$ 上のベクトル空間 $K^n$ の一次変換
    を定める.  すべて $K=\R,\C$ の場合と同様であると考えて良い.}.}
\bigskip

ここでは体の定義について詳しく説明しない.
体の定義を知らない人は $K$ は実数体 $\R$ または $\C$ であると考えて良い.
たとえば $K^n$ と書いてあれば $\R^n$ または $\C^n$ であると解釈して良い.
そうしたい人は以下を読まずに先に進んで良い%
\footnote{もちろん筆者は読んで欲しいと思いながら書いている.}.

しかし, 基礎的な体の例として $\R$や $\C$ 以外にどのようなものがあるかについ
て少しだけ説明しておく.  新たな抽象概念を学ぶときには, 
その概念に合致する基礎的かつ重要な例には
具体的にどのようなものがあるかを調べておく必要がある%
\footnote{代数学が何を研究する分野であるかを知るためには
  シャファレヴィッチ \cite{shafarevich} がおすすめである.}.

有理数体 $\Q$ も基礎的でかつ重要な体である.  
$\Q$, $\R$, $\C$ のような体では1つ以上の $1$ の和 $1+\cdots+1$ が $0$ に
なることはない.  
そのような体は{\bf 標数 $0$ (of characteristic $0$)} であるという. 
$\Q$, $\R$, $\C$ は標数 $0$ の体である.

体 $K$ が{\bf 正標数 (of positive characteristic)} であるとは $K$ の中の
1つ以上の $1$ の和 $1+\cdots+1$ のどれかが $0$ になることである.
$0$ になる $1+\cdots+1$ の最小の長さを
その体の {\bf 標数 (characteristic)} と呼ぶ.
正標数の体の標数は素数 $2,3,5,7,11,\ldots$ のどれかになることが知られている.

各素数 $p$ に対して集合 
\begin{equation*}
  \F_p=\{0,1,\dots,p-1\}
\end{equation*}
に足し算と掛け算の $p$ で割った余りによって定義することによって
自然に体の構造を入れることができる.  
たとえば, $4$ を $3$ で割った余りは $1$ なの
で, $\F_3=\{0,1,2\}$ において $2+2=2\cdot2=1$ である.
$\F_p$ の標数は $p$ になる($p$ 個の $1$ の和を $p$ で割った余りは $0$).
$\F_p$ のように有限個の元で構成される体を{\bf 有限体 (finite field)} と呼ぶ.
有限体も重要な基礎な体である.

実数全体の集合 $\R$ は有理数全体の集合 $\Q$ を絶対値に関して完備化することに
よって構成される.  実は通常の絶対値ではなく, 各素数 $p$ に対して $p$ を因子
としてたくさん含んでいればいるほど $0$ に近付くような絶対値 (付値と呼ばれる) 
に関して $\Q$ を完備化することによって, $p$ 進体 $\Q_p$ を構成することができ
る.  集合として $\Q_p$ は次のように表示できる:
\begin{equation*}
  \Q_p = 
  \{\, a_n p^n + a_{n+1}p^{n+1} + a_{n+2} p^{n+2} + \cdots
  \mid n\in\Z,\ a_i=0,1,\dots,p-1 \,\}.
\end{equation*}
実数体 $\R$ には無限個の仲間 $\Q_2,\Q_3,\Q_5,\Q_7,\Q_{11},\ldots$ が存在する.
実は20世紀の数学の発展によってこれらは非常に仲が良いことが知られている.

$\C$ は $\R$ に $i=\sqrt{-1}$ を付け加えることによって構成される. 
これと同じ構成を $\Q$ に対して適用すると Gauss 体 $\Q(i)$ が得られる.
他にも $\Q(\sqrt{2})$ のような体を考えることもできる.

体 $K$ が{\bf 代数閉体 (algebraically closed field)} であると
は $K$ 係数の任意の代数方程式 $x^n+a_1x^{n-1}+\cdots+a_n=0$ 
($n\ge 1$, $a_i\in K$) の根が $K$ の中に存在することである.

代数学の基本定理の主張は「複素数体 $\C$ は代数閉体である」である.
この演習ではこの結果を自由に用いて良い.

有理数係数のある代数方程式 $x^n+a_1x^{n-1}+\cdots+a_n=0$ 
($n\ge 1$, $a_i\in\Q$) の根になっているような
複素数を{\bf 代数的数 (algebraic number)} と呼び, 
そうでない複素数を{\bf 超越数 (transcendental nuber)} と呼ぶ.
たとえば $\sqrt{2}$ は無理数だが代数的数であり, 
$e=2.718281828\cdots$ や $\pi=3.141592653\cdots$ は超越数である.

代数的数全体の集合 $\closure\Q$ は代数閉体になることを示せる%
\footnote{この結果は後で体の理論を習ったときに証明されることになる.}.
$\closure\Q$ を $\Q$ の{\bf 代数閉包 (algebraic closure)}と呼ぶ.

実は任意の体 $K$ に対してその代数閉包 $\closure{K}$ が存在する. 
すなわち $K$ を含むある代数閉体 $\closure{K}$ が存在して, 
その任意の元は $K$ 係数のある代数方程式の根になっている.
この結果は後で体の理論を習ったときに証明される.
この演習ではこの結果を証明抜きで自由に使って良い.

たとえば有限体 $\F_p$ の代数閉包 $\closure\F_p$ は $\F_p$ に $1$ の巾根を
すべて付け加えることによって構成可能である.  
任意の $e=1,2,3,\dots$ に対して $\closure\F_p$ は部分体で元の
個数が $q=p^e$ 個であるものが唯一存在する.  それを $\F_q$ と書き, 
位数 $q$ の有限体と呼ぶ. 

大体において以上に登場したような体が基礎的であり, 
他の体はそれらから出発して様々な手続きによって構成される.  

\bigskip
{\Large まとめ: よく登場する基礎的な体には, 
  実数体 $\R$, 複素数体 $\C$ の他に
  有理数体 $\Q$, $p$ 進体 $\Q_p$, 有理数体の代数閉包 $\closure\Q$, 
  有限体 $\F_q$, 有限体の代数閉包 $\closure\F_p$ などが存在する.}
\bigskip

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  任意の $\alpha\in\C$ に対して $\Q$ と $\alpha$ を含む $\C$ の最小の部分体
  を $\Q(\alpha)$ と書くことにする. 
  $m$ は平方数でない整数であるとし, $\alpha=\sqrt{m}$ と置く. 
  このとき $\Q(\alpha)$ は $1$ と $\alpha$ を基底に持つ $\Q$ 上のベクトル空
  間になっている. そして, $\alpha$ の積はそのベクトル空間に $\Q$ 上の一次変
  換を定める.  基底 $(1,\alpha)$ に関するその一次変換の行列表示は $
  \begin{bmatrix}
    0 & m \\
    1 & 0 \\
  \end{bmatrix}$ になる. \qed
\end{question}

\noindent
ヒント: $\Q(\alpha)$ は $\Q$ と $\alpha$ を含み四則演算で閉じている. 
特に $\Q+\Q\alpha\subset\Q(\alpha)$ である. ところが $\Q+\Q\alpha$ も
四則演算で閉じているので体をなす. 
よって $\Q(\alpha)$ の最小性より $\Q+\Q\alpha=\Q(\alpha)$ である.
$\alpha$ は有理数でないので $1$ と $\alpha$ は $\Q$ 上一次独立である.
$\alpha\cdot 1=0\cdot1+1\cdot\alpha$
でかつ $\alpha\cdot\alpha=m\cdot1+0\cdot\alpha$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

有限体上の理論では「点の個数を数える」問題が重要である%
\footnote{岩波数学辞典などで「Weil 予想」について調べてみよ.
  驚くべきことに有限体上の幾何において「点の個数を数える」ことは
  実数を用いた通常の幾何における「トポロジーを調べる」ことに対応している.
  驚くべきことに有限体上の幾何のような離散的な世界においても
  トポロジーの直観が適用可能なのである.}.

\begin{question}
\label{q:GL_n(F_q)}
  $GL_n(\F_q)=\{\,A\in M_n(\F_q)\mid\det A\ne0\,\}$ の元の個数は幾つか?
  \qed
\end{question}

\noindent
ヒント: $GL_n(\F_q)$ は $\F_q^n$ の基底 $(v_1,\dots,v_n)$ 全体の集合と
同一視できる. $v_1$ として $\F_q^n$ の任意の $0$ でない任意のベクトルを取れ
るので, $v_1$ の取り方は $q^n-1$ 通りある.  $v_1$ が与えられたとき, $v_2$ と
して $v_1$ で張られる $1$ 次元の部分空間に含まれない任意のベクトルが取れ
るので, $v_2$ の取り方は $q^n-q$ 通りある.  $v_1,v_2$ が与えられた
とき, $v_3$ として $v_1,v_2$ で張られる $2$ 次元の部分空間に含まれない任意の
ベクトルが取れるので, $v_3$ の取り方は $q^n-q^2$ 通りある. $\cdots\cdots$
\qed

\commentout{
\medskip
\noindent
解: $(q^n-1)(q^n-q)\cdots(q^n-q^{n-1})=q^{n^2}\prod_{i=1}^n(1-q^{-i})$. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Euclid の互除法}
\label{sec:Euclidean-algorithm}

この節では $K$ は任意の体であるとする.
「任意の体」という言葉を使うのが怖い人
は $K=\R\ \text{または}\ \C$ であると考えて良い.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$f=f(\lambda)$ が {\bf $K$ を係数に持つ $\lambda$ に関する多項式
(polynomial in $\lambda$ with coefficients in $K$)} 
であるとは $f$ が次のような式であることである%
\footnote{少々ラフな説明の仕方だがこれで意味はわかるだろう.}:
\begin{equation*}
  f(\lambda) 
  = a_n \lambda^n + a_{n-1} \lambda^{n-1} + \cdots + a_1 \lambda + a_0,
  \quad
  a_i\in K.
\end{equation*}
この $f$ が $a_n\ne 0$ を満たしているとき, $f$ の{\bf 次数 (degree)} は $n$ 
であると言い, $\deg f = n$ と置く.  
ただし $f=0$ の場合は例外的に $\deg f = -\infty$ と定める.
$K$ を係数に持つ多項式は {\bf $K$ 上の多項式 (polynomial over $K$)} と呼ばれ
る場合もある.

$K$ を係数の持つ $\lambda$ に関する多項式全体の集合は $K[\lambda]$ と表わさ
れる.  $K[\lambda]$ の2つの元には自然に和と差と積が定義される%
\footnote{これもラフな説明だが大学入学前の数学の勉強ですでにどういう意味なの
  か知っているはずである.}.  
$K[\lambda]$ に和と差と積の構造を入れたものは 
{\bf $K$ 上の $\lambda$ に関する多項式環 
(polynomial ring in $\lambda$ over $K$)} と呼ばれている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

多項式環 $K[\lambda]$ の最重要な性質は割り算によって商と余りを計算できること
である\footnote{そのような割り算が可能な環は Euclid 整域 (Euclidean domain) 
  と呼ばれている.  有理整数環 $\Z$ も Euclid 整域である. 
  Euclid 整域は単項イデアル整域 (principal ideal domain) の典型的な例になっ
  ている.  これらの事実は環論の初歩として後で習うことになる.  
  しかし, 環論の初歩において大学入学以前に習った整数や多項式の世界が極めて基
  本的かつ重要な役割を果たすことである.  後で体の Galois 理論について習うと
  きにも1変数多項式環に関する基本的な結果が基本的かつ重要な役割を果たす.}. 

\begin{question}
  任意の $f,g\in K[\lambda]$ に対して $g\ne 0$ ならば
  ある $q,r\in K[\lambda]$ で次を満たすものが一意に存在する:
  \begin{equation*}
    f = qg + r, \qquad \deg r < \deg g.
  \end{equation*}
  $q$ を {\bf $f$ を $g$ で割った商 (quotient of $f$ divided by $g$)} と呼び, 
  $r$ を {\bf $f$ を $g$ で割った余り (remainder of $f$ divided by $g$)} と
  呼ぶ.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$h\in K[\lambda]$ が $f_1,\dots,f_n\in K[\lambda]$ の
{\bf 最大公約元 (greatest common divisor, g.c.d.)} である
とは $h$ が $f_1,\dots,f_n$ の公約元でかつ $h$ が $f_1,\dots,f_n$ の任意の公
約元で割り切れることである.

\begin{question}
  $f_1,\dots,f_n\in K[\lambda]$ の最大公約元が
  存在するならば $0$ でない $K$ の元による定数倍を除いて一意に定まる. 
  \qed
\end{question}

\noindent
ヒント1: 
$g,h\in K[\lambda]$ はともに $0$ でない $f_1,\dots,f_n\in K[\lambda]$ の最大
公約元であると仮定する. もしも $\deg g < \deg h$ ならば $g$ が $h$ で割り切
れることがないので矛盾する. よって $\deg g = \deg h$ である.  $h$ は $g$ で
割り切れるのである $a\in K$ ($a\ne 0$) が存在して $h=ag$ となる.
\qed

\medskip
\noindent
ヒント2: $0$ でない $K[\lambda]$ の元で逆数が $K[\lambda]$ の中に含まれるも
のは $0$ でない $K$ の元に限るという事実を使う.  
$f_i$ がすべて $0$ ならば $0$ が最大公約元になる.
$f_i$ の中に $0$ でないものが存在すると仮定する.
そのとき $0$ は $f_i$ たちの公約元にならない.
$g,h\in K[\lambda]$ はともに $f_1,\dots,f_n\in K[\lambda]$ の
最大公約元であると仮定する. $g\ne 0$, $h\ne 0$ である.
ある $a,b\in K[\lambda]$ が存在して $h=ag$, $g=bh$ である. 
よって $h=ag=abh$ であるから $ab=1$ である. 
したがって $a,b\in K$ かつ $a\ne 0$, $b\ne 0$ である.
\qed

\medskip
\noindent
解説: ヒント1は多項式の次数の概念を用いているが簡単でわかり易い.
ヒント2は一般の環 (より正確には整域) に適用できる議論である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

割り算ができる環では最大公約元を{\bf Euclid の互除法 (Euclidean algorithm)} 
で求めることができる.

\begin{question}[Euclid の互除法]
\label{q:Euclidean-algorithm-1}
  $f,g\in K[\lambda]$, $g\ne 0$ に対して, 
  $f_k$ ($k=0,1,2,\dots$) を以下の手続きによって定めることができる:
  \begin{itemize}
  \item $f_0=f$, $f_1=g$ と定める.
  \item もしも $f_k\ne 0$ ならば $q_k, f_{k+1}\in K[\lambda]$ を次の条件に
    よって定める:
    \begin{equation*}
      f_{k-1} = q_k f_k + f_{k+1}, \qquad \deg f_{k+1} < \deg f_k.
    \end{equation*}
  \item もしも $f_{k+1}=0$ すなわち $f_{k-1}=q_kf_k$ ならば手続きを終了する.
  \end{itemize}
  $\deg f_k$ は単調に減少するのでこの手続きは必ず有限ステップで終了する.
  $f_{k-1}=q_kf_k$ のとき $f_k$ は $f$, $g$ の最大公約元になっている.
  \qed
\end{question}

\noindent
ヒント: 上の手続きの結果以下のような計算の列が得られる:
\begin{alignat*}{2}
  & f_0 = f, & & \\
  & f_1 = g \ne 0, & & \\
  & f_0 = q_1f_1 + f_2, & \qquad & \deg f_2 < \deg f_1, \\
  & f_1 = q_2f_2 + f_3, & \qquad & \deg f_3 < \deg f_2, \\
  & \qquad \cdots\cdots & \qquad & \qquad\cdots\cdots \\
  & f_{k-2} = q_{k-1}f_{k-1} + f_k, & \qquad & \deg f_k < \deg f_{k-1}, \\
  & f_{k-1} = q_kf_k. & & \\
\end{alignat*}
これを下から逆順に眺め直すと $f_k$ は $f_{k-1},f_{k-2},\dots,f_1,f_0$ 
すべての約元%
\footnote{「約数」「約元」は英語では共に ``divisor'' である.}
になっていることがわかる.  
もしも $h\in K[\lambda]$ が $f_0$, $f_1$ の公約元ならば
各ステップの等式を $f_j = f_{j-2} - q_{k-1}f_{k-1}$ と書き直して
上から順に見て行けば $h$ は $f_0,f_1,\dots,f_{k-1},f_k$ すべての約元
になっていることもわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Euclidean-algorithm-example}
  $K=\R$ の
  とき $f(\lambda)=\lambda^4+\lambda^3+2\lambda^2+\lambda+1$,
  $g(\lambda)=\lambda^3-1$ の最大公約元を 
  Euclid の互除法と素因子分解の両方の方法で求めて
  それらが定数倍を除いて一致していることを確かめよ.
  \qed
\end{question}

\commentout{
\medskip
\noindent
略解: $f(\lambda)=(\lambda^2+1)(\lambda^2+\lambda+1)$, 
$g(\lambda)=(\lambda-1)(\lambda^2+\lambda+1)$ であるから,
$f$, $g$ の最大元は $h(\lambda)=\lambda^2+\lambda+1$ である.
一方, $f_0=f$, $f_1=g$, $f_2(\lambda)=2\lambda^2+2\lambda+2$ であり, 
$f_1(\lambda)=(\frac{1}{2}\lambda-\frac{1}{2})f_2(\lambda)$ である
から, $f_2$ は $f_0$, $f_1$ の最大公約元である.
$f_2=2h$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:E-a-1}
  $f,g\in\Q[x]$ を $f(x)=x^4 - 2x^2 + 1$, $g(x)=x^3 - 1$ と定める.
  素因子分解と Euclid の互除法 \qref{q:Euclidean-algorithm-1} の2つの方法
  で $f$ と $g$ の最大公約多項式を求め, $0$ でない有理数倍を除いて一致して
  いることを確かめよ.
  \qed
\end{question}

\commentout{
\noindent
略解: $f(x)=(x-1)^2(x+1)^2$, $g(x)=(x-1)(x^2+x+1)$ である
から, $f$ と $g$ の最大公約多項式は $x-1$ である.  
Euclid の互除法で計算すると $f_2(x)=-2x^2+x+1$,
$f_3(x)=\frac{3}{4}x-\frac{3}{4}$, $f_4(x)=0$ となり, 
最大公約多項式は $f_3(x)=\frac{3}{4}(x-1)$ であることがわかる.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:E-a-2}
  $f,g\in\Q[x]$ を $f(x) = (x+2)^2(x^2+x-1)(x^2+1)$,
  $g(x) = (x-2)(x^2-2)(x^2+1)$ と定める.
  このとき $f$ と $g$ の最大公約多項式が $x^2+1$ である.
  Euclid の互除法 \qref{q:Euclidean-algorithm-1} で $f$ と $g$ の
  最大公約多項式を計算すると, 出て来る数字がどんどん大きくなってしまい, 
  手計算がかなり大変になることを確かめよ.
  コンピューターを用いて計算しても構わない. 
  その場合はコンピューターをどのように使ったかについても説明すること.
  \qed
\end{question}

\noindent
ヒント: 計算結果は次のようになる. 虫食いを埋めよ:
\begin{align*}
  &
  f_0(x) = f(x) = x^6+5x^5+\text{\fbox{\tiny ア}}x^4+5x^3+3x^2-4,
  \\ &
  f_1(x) = g(x) = x^5-\text{\fbox{\tiny イ}}x^4-x^3+2x^2-2x+4,
  \\ &
  f_2(x) = 23x^4+10x^3-\text{\fbox{\tiny ウ}}x^2+10x-32,
  \qquad
  q_1(x) = x+7,
  \\ &
  f_3(x)
  =\frac{238}{\text{\fbox{\tiny エ}}}x^3+\frac{324}{\text{\fbox{\tiny エ}}}x^2
  +\frac{\text{\fbox{\tiny カ}}}{529}x  +\frac{\text{\fbox{\tiny キ}}}{529},
  \qquad
  q_2(x) = \frac{1}{23}x - \frac{56}{529},
  \\ &
  f_4(x) = - \frac{42320}{14161}x^2 - \frac{42320}{14161},
  \qquad
  q_3(x) = \frac{23}{119}x - \frac{2536}{14161},
  \\ &
  f_5(x) = 0,
  \qquad
  q_4(x) = - \frac{1685159}{11193640}x - \frac{1147041}{5596820}.
\qed
\end{align*}

\commentout{
\medskip
\noindent
略解: $f_0=f$, $f_1=g$ と置き, $f_{k-1}$ を $f_k$ で割った余りを $f_{k+1}$ 
とし, 商を $q_k$ とする計算の結果は次のようになる:
\begin{align*}
  &
  f_0(x) = f(x) = x^6+5x^5+8x^4+5x^3+3x^2-4,
  \\ &
  f_1(x) = g(x) = x^5-2x^4-x^3+2x^2-2x+4,
  \\ &
  f_2(x) = 23x^4+10x^3-9x^2+10x-32,
  \qquad
  q_1(x) = x+7,
  \\ &
  f_3(x)
  =\frac{238}{529}x^3+\frac{324}{529}x^2
  +\frac{238}{529}x  +\frac{324}{529},
  \qquad
  q_2(x) = \frac{1}{23}x - \frac{56}{529},
  \\ &
  f_4(x) = - \frac{42320}{14161}x^2 - \frac{42320}{14161},
  \qquad
  q_3(x) = \frac{23}{119}x - \frac{2536}{14161},
  \\ &
  f_5(x) = 0,
  \qquad
  q_4(x) = - \frac{1685159}{11193640}x - \frac{1147041}{5596820}.
\end{align*}
$f_4$ が $f$, $g$ の最大公約多項式である. \qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  2つの整数 $m,n\in\Z$ の最大公約数も Euclid の互除法で計算できることを示せ.
  \qed 
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Euclidean-algorithm-2}
  2つの多項式 $f,g\in K[\lambda]$ の最大公約元を $d\in K[\lambda]$ とすると,
  ある多項式 $a,b\in K[\lambda]$ で $d = af + bg$ を満たすものが存在する. 
  \qed
\end{question}

\noindent
ヒント1: Euclid の互除法を使う.  Euclid の互除法のステップを上から順番に
見て行き, $d=f_k=af_0+bf_1=af+bg$ という式が得られることを示す.
\qed

\medskip
\noindent
ヒント2: まず, $I=K[\lambda]f+K[\lambda]g
=\{\,af+bg\mid a,b\in K[\lambda]\,\}$ と置き%
\footnote{$I$ を $f$, $g$ から生成される $K[\lambda]$ のイデアル (ideal) と
  呼び $(f,g)$ のように表わす.  このヒントの議論は実質的に $K[\lambda]$ が
  単 項イデアル整域であることの証明と
  単項イデアル整域において $(f,g)=(h)$, $h=\gcd(f,g)$ であることの証明を
  含んでいる.},
$I$ に含まれる $0$ でない多項式の中で次数が最小のものを $h$ と
すると $I=K[\lambda]h=\{\,ch\mid c\in K[\lambda]\,\}$ であることを示す.
これより $h$ が $f$, $g$ の最大公約元であることが導かれる.
任意に $p\in I$ を取り $p$ を $h$ で割った余り $r$ を考えると, 
$r\in I$ かつ $\deg r<\deg h$ なので $h$ の次数の最小性より $r=0$ である.
すなわち $I$ の任意の元は $h$ で割り切れる. 
よって $I=K[\lambda]h$ であり, 特に $f$, $g$ は $h$ で割り切れる.
一方 $h\in I$ より $h=af+bh$ ($a,b\in K[\lambda]$) と書けるの
で, $h$ は $f$, $g$ の任意の公約元で割り切れる.
よって $h$ は $f$, $g$ の最大公約元である.
\qed

\medskip
\noindent
解説: 上の2つのヒントはどちらも重要である.  ヒント1の方法はアルゴリズムを与
えているが, ヒント2の方法はそうではない.  しかし, ヒント2の方法はアルゴリズ
ムを直接扱う複雑さがないので一般的な議論に適している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:U(K[z]/(g))} 
  2つの多項式 $f,g\in K[\lambda]$ が互いに素%
  \footnote{最大公約元が $1$ であるということ.}
  であるならば, 任意の $b\in K[\lambda]$ に対して
  ある $a\in K[\lambda]$ で $\deg a<\deg g$ かつ $af\equiv b\mod{g}$ を満た
  すものが一意に存在する%
  \footnote{$f\equiv g\mod{h}$ は $f$ を $h$ で割った余りと $g$ を $h$ で割
    った余りが等しいという意味である.}.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:Euclidean-algorithm-2} の結果より, 
ある $p,q\in K[\lambda]$ で $1=pf+qg$ を満たすものが存在する.
よって $b=bpf+bqg\equiv bpf \mod{g}$ である.
よって $a$ を $bq$ を $g$ で割った余りとすれば存在が示される.
一意性は以下のようにして示される.
ある $p\in K[\lambda]$ で $pf\equiv 1\mod{g}$ を満たすものが存在する.
よって $a,c\in K[\lambda]$ が $af\equiv cf\equiv b\mod{g}$ を満たしている
ならば $p$ をかけて $a\equiv c\pod{g}$ である.  
よって $a$, $c$ の次数がともに $g$ の次数より小さいならば $a=c$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Eucledean-algorith-2-Z}
  2つの整数 $m,n\in\Z$ の最大公約数を $d\in\Z$ とすると,
  ある整数 $a,b\in\Z$ で $d = am + bn$ を満たすものが存在する. 
\end{question}

\noindent
ヒント: 問題 \qref{q:Euclidean-algorithm-2} とほとんど同じ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:U(Z/mZ)} 
  2つの整数 $m,n\in\Z_{>0}$ が互いに素%
  \footnote{最大公約数が $1$ であるということ.}
  であるならば, 任意の整数 $b\in\Z$ に対して
  ある $a\in\Z$ で $0\le a<n$ かつ $am\equiv b\mod{n}$ を満たすものが
  一意に存在する.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:Eucledean-algorith-2-Z} の結果を使う. 
問題 \qref{q:U(K[z]/(g))} とほとんど同じ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

{\Large 次の問題の結果はよく使われる.

\begin{question}
\label{q:Euclidean-algorithm-3}
  $f_1,\dots,f_n\in K[\lambda]$ の最大公約元を $d\in K[\lambda]$ とすると,
  ある $a_1,\dots,a_n\in K[\lambda]$ 
  で $d=a_1f_1+\cdots+a_nf_n$ を満たすものが存在する. \qed
\end{question}
}

\noindent
ヒント1: $n$ に関する帰納法.  $n=1$ の場合は明らか. 
$f_1,\dots,f_{n-1}$ の最大公約元 $g$ と $f_n$ の最大公約元 $h$ 
は $f_1,\dots,f_{n-1},f_n$ の最大公約元である. 
実際, $h$ は $f_1,\dots,f_{n-1},f_n$ の公約元であり, 
$f_1,\dots,f_{n-1},f_n$ の任意の公約元で $h$ は割り切れる.  帰納法の仮定
より $g$ は $g=b_1f_1+\cdots+b_{n-1}f_{n-1}$ ($b_i\in K[\lambda]$) と表わさ
れる. 問題 \qref{q:Euclidean-algorithm-2} より $h$ は $h=c_1g+c_2f_n$ 
($c_i\in K[\lambda]$) と表わされる.  よって, $a_i=c_1b_i$ ($i=1,\dots,n-1$), 
$a_n=c_2$ と置けば $h = a_1f_1+\cdots+a_nf_n$ が成立する.
\qed

\medskip
\noindent
ヒント2: まず, $I=\sum_{i=1}^n K[\lambda]f_i$ と置き, $I$ に含まれる $0$ で
ない多項式の中で次数が最小のものを $h$ とすると $I=K[\lambda]h$ が成立するこ
とを示す.  このとき $h$ は $f_i$ たちの最大公約元であることが示される.
問題 \qref{q:Euclidean-algorithm-2} のヒント2とまったく同様の議論を繰り返せ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Euclidean-algorithm-3-Z}
  $m_1,\dots,m_N\in\Z$ の最大公約数を $d\in\Z$ とすると,
  ある $a_1,\dots,a_N\in K[\lambda]$ 
  で $d=a_1m_1+\cdots+a_Nm_N$ を満たすものが存在する. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Lagrange の補間公式}
\label{sec:Lagrange-interpolation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-0}
  $f,g\in K[\lambda]$ はともに次数が $n-1$ 以下であるとする.
  このとき互いに異なる $n$ 個の $\alpha_1,\dots,\alpha_n\in K$ に
  ついて $f(\alpha_i)=g(\alpha_i)$ ($i=1,\dots,n$) が成立している
  ならば $f=g$ である. 
  \qed
\end{question}

\noindent
ヒント1: $h=a_0+a_1\lambda+a_2\lambda^2+\dots+a_{n-1}\lambda^{n-1}=f-g$ と置
いて $h=0$ を示せば良い.  $h(\alpha_i)=0$ ($i=1,\dots,n$) は剰余定理より, 
$h$ が $\lambda-\alpha_i$ ($i=1,\dots,n$) のすべてで割り切れることと同値であ
る.  よって $h$ は $(\lambda-\alpha_1)\cdots(\lambda-\alpha_n)$ で割り切れる.
そのとき $h$ の次数は $n-1$ 以下だと仮定したので $h=0$ である.
\qed

\medskip
\noindent
ヒント2: $h(\alpha_i)=0$ ($i=1,\dots,n$) は次と同値である:
\begin{equation*}
  \begin{bmatrix}
    1      & \alpha_1 & \alpha_1^2 & \cdots & \alpha_1^{n-1} \\
    1      & \alpha_2 & \alpha_2^2 & \cdots & \alpha_2^{n-1} \\
    1      & \alpha_3 & \alpha_3^2 & \cdots & \alpha_3^{n-1} \\
    \vdots & \vdots   & \vdots     & \cdots & \vdots         \\
    1      & \alpha_n & \alpha_n^2 & \cdots & \alpha_n^{n-1} \\
  \end{bmatrix}
  \begin{bmatrix}
    a_0 \\ a_1 \\ a_2 \\ \vdots \\ a_{n-1} \\
  \end{bmatrix}
  = 0.
\end{equation*}
左辺の $n$ 次正方行列の行列式は Vandermonde の公式
\begin{equation*}
  \begin{vmatrix}
    1      & \alpha_1 & \alpha_1^2 & \cdots & \alpha_1^{n-1} \\
    1      & \alpha_2 & \alpha_2^2 & \cdots & \alpha_2^{n-1} \\
    1      & \alpha_3 & \alpha_3^2 & \cdots & \alpha_3^{n-1} \\
    \vdots & \vdots   & \vdots     & \cdots & \vdots         \\
    1      & \alpha_n & \alpha_n^2 & \cdots & \alpha_n^{n-1} \\
  \end{vmatrix}
  =
  \prod_{1\le i < j \le n} (\alpha_j - \alpha_i).
\end{equation*}
より $0$ ではない.
よって $a_0=a_1=a_2=\cdots=a_n=0$ すなわち $h=0$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $p_1,\dots,p_r$ は互いに異なる $N$ 個の素数で
  あるとし, $N=p_1\cdots p_r$ と置く.  
  $m,n\in\Z$ はともに $0$ 以上 $N$ 未満の整数であるとする. 
  このとき $m\equiv n\mod{p_i}$ ($i=1,\dots,r$) ならば $m=n$ である. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-1}
  $\alpha_1,\dots,\alpha_n\in K$ は互いに異なると
  仮定し, $f\in K[\lambda]$ を
  \begin{equation*}
    f(\lambda)=(\lambda-\alpha_1)\cdots(\lambda-\alpha_n)
  \end{equation*}
  と定める.
  このとき, $f(\lambda)/(\lambda-\alpha_i)\in K[\lambda]$ ($i=1,\dots,n$) 
  は定数以外に共通の因子を持たないので, $1$ はそれらの最大公約元である. 
  次の公式が成立している:
  \begin{equation*}
    \sum_{i=1}^n 
    \frac{1}{f'(\alpha_i)}\frac{f(\lambda)}{\lambda-\alpha_i}
    = 1
    \qquad
    \left(
      \text{すなわち}\quad
      \frac{1}{f(\lambda)}
      = \sum_{i=1}^n 
      \frac{1}{f'(\alpha_i)}\frac{1}{\lambda-\alpha_i}
    \right).
  \end{equation*}
  たとえば, 互いに異なる $\alpha,\beta,\gamma\in K$ に対して,
  \begin{align*}
    &
    \frac{(\lambda-\beta)(\lambda-\gamma)}{(\alpha-\beta)(\alpha-\gamma)} +
    \frac{(\lambda-\alpha)(\lambda-\gamma)}{(\beta-\alpha)(\beta-\gamma)} +
    \frac{(\lambda-\alpha)(\lambda-\beta)}{(\gamma-\alpha)(\gamma-\beta)} 
    = 1,
    \\ &
    \frac{1}{(\lambda-\alpha)(\lambda-\beta)(\lambda-\gamma)}
    \\ &
    =
    \frac{1}{(\alpha-\beta)(\alpha-\gamma)}
    \frac{1}{\lambda-\alpha} +
    \frac{1}{(\beta-\alpha)(\beta-\gamma)}
    \frac{1}{\lambda-\beta} +
    \frac{1}{(\gamma-\alpha)(\gamma-\beta)}
    \frac{1}{\lambda-\gamma}.
    \qed
  \end{align*}
\end{question}

\noindent
ヒント: 
$\phi_i(\lambda)=f(\lambda)/[f'(\alpha_i)(\lambda-\alpha_i)]\in K[\lambda]$ 
と置くと, $\phi_i(\alpha_i)=1$ かつ $j\ne i$ のとき $\phi_i(\alpha_j)=0$.
あとは $p(\alpha_i)=1$ ($i=1,\dots,n$) を満たす次数が $n-1$ 以下の多項式
が $1$ に限ることを示すために問題 \qref{q:Lagrange-interpolation-0} を使う.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Lagrange の補間公式]
\label{q:Lagrange-interpolation-2}
  $\alpha_1,\dots,\alpha_n\in K$ は互いに異なると
  仮定し, $f\in K[\lambda]$ を
  \begin{equation*}
    f(\lambda)=(\lambda-\alpha_1)\cdots(\lambda-\alpha_n)
  \end{equation*}
  と定める. このとき, 任意の $b_1,\dots,b_n\in K$ に対して多項式
  \begin{equation*}
    p(\lambda) = 
    \sum_{i=1}^n 
    \frac{b_i}{f'(\alpha_i)}
    \frac{f(\lambda)}{\lambda-\alpha_i}
  \end{equation*}
  は $p(\alpha_i)=b_i$ ($i=1,\dots,n$) を満たしている次数が $n-1$ 以下の唯一
  の多項式である.
  この結果は {\bf Lagrange の補間公式 (Lagrange's interpolation formula)} と
  呼ばれている.   
  たとえば, 互いに異なる $\alpha,\beta,\gamma\in K$ と
  任意の $a,b,c\in K$ に対して,
  \begin{equation*}
    p(\lambda)=
    a \frac{(\lambda-\beta)(\lambda-\gamma)}{(\alpha-\beta)(\alpha-\gamma)} +
    b \frac{(\lambda-\alpha)(\lambda-\gamma)}{(\beta-\alpha)(\beta-\gamma)} +
    c \frac{(\lambda-\alpha)(\lambda-\beta)}{(\gamma-\alpha)(\gamma-\beta)} 
  \end{equation*}
  は $p(\alpha)=a$, $p(\beta)=b$, $p(\gamma)=c$ を満たす次数が $3$ 以下の
  唯一の多項式である. 
  \qed
\end{question}

\noindent
ヒント: 唯一性の証明には問題 \qref{q:Lagrange-interpolation-0} の結果を使う.
問題 \qref{q:Lagrange-interpolation-1} のヒントを見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-3}
  体 $K$ の標数は $0$ であると仮定する%
  \footnote{「標数 $0$ の体」という言葉を知らない人は $K=\C$ と仮定して良い.}.
  $\alpha\in K$ と $n\in\Z_{>0}$ を任意に取る.
  このとき, 多項式 $f\in K[\lambda]$ が
  \begin{equation*}
    f^{(\nu)}(\alpha) = 0
    \quad (\nu=0,1,\dots,n-1)
  \end{equation*}
  を満たすための必要十分条件は $f$ が $(\lambda-\alpha)^n$ で割り切れること
  である. 
  \qed
\end{question}

\noindent
ヒント: 十分性は $(\lambda-\alpha)^n g(\lambda)$ を微分してみればすぐにわか
る\footnote{$k>0$ のとき $f$ が $(\lambda-\alpha)^k$ で割り切れる
ならば $f'$ は $(\lambda-\alpha)^{k-1}$ で割り切れる.}. 
必要性は $n$ に関する帰納法で以下のようにして示される.
$n=1$ の場合は剰余定理より成立する. $n>1$ で $n-1$ まで成立しているなら
ば $f(\lambda)=(\lambda-\alpha)^{n-1}g(\lambda)$ ($g\in K[\lambda]$) と書け
る.  その両辺を $n-1$ 回微分して $\lambda$ に $\alpha$ を
代入すると $0=f^{(n-1)}(\alpha)=(n-1)!g(\alpha)$ となる.
$K$ の標数は $0$ なので $K$ の中で $(n-1)!\ne 0$ なので $g(\alpha)=0$ が成立
する.  そのとき剰余定理より $g$ は $\lambda-\alpha$ で割り切れる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ の標数が正であるとき, ある $f\in K[\lambda]$ で $f\ne 0$ かつ $f'=0$ 
  となるものが存在する. \qed
\end{question}

\noindent
ヒント: $f(\lambda)=g(\lambda)^p$.  さらに詳しい解説を読みたければ体論につい
て解説してある任意の代数学の教科書における分離多項式の解説を参照せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Leibnitz の公式]
\label{q:Leibnitz-formula}
  必要なだけ微分可能な函数 $f$, $g$ に対して,
  \begin{equation*}
    (fg)^{(\nu)} = \sum_{k=0}^\nu \binom{\nu}{k} f^{(k)}g^{(\nu-k)}
    \qquad (\nu=0,1,2,\ldots).
  \end{equation*}
  ここで $f^{(k)}$ は $f$ の $k$ 階の導函数である. \qed
\end{question}

\noindent
ヒント1: $\nu$ に関する帰納法.  二項係数
\begin{equation*}
  \binom{\nu}{k} = \frac{\nu(\nu-1)\cdots(\nu-k+1)}{k!}
\end{equation*}
は次の漸化式を満たしている{\bf (Pascal の三角形)}:
\begin{equation*}
  \binom{\nu}{k}+\binom{\nu}{k+1} = \binom{\nu+1}{k+1}.
\qed
\end{equation*}

\medskip
\noindent
ヒント2: 以下のように二項定理を用いて帰納法に頼らずに直接証明することもでき
る:
\begin{align*}
  (fg)^{(\nu)}(x) 
  &
  = \left.\left(\pd{x}+\pd{y}\right)^\nu f(x)g(y)\right|_{y=x}
  = \sum_{k=0}^\nu \binom{\nu}{k} 
    \left.\left(\pd{x}\right)^k \left(\pd{y}\right)^{\nu-k}
    f(x)g(y)\right|_{y=x}
  \\ &
  = \sum_{k=0}^\nu \binom{\nu}{k} \left.f^{(k)}(x)g^{(\nu-k)}(y)\right|_{y=x}
  = \sum_{k=0}^\nu \binom{\nu}{k} f^{(k)}(x)g^{(\nu-k)}(x).
\qed
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-4}
  体 $K$ の標数は $0$ であると仮定する%
  \footnote{「標数 $0$ の体」という言葉を知らない人は $K=\C$ と仮定して良い.}.
  互いに異なる $\alpha_1,\dots,\alpha_s\in K$ 
  と $n_1,\dots,n_s\in\Z_{>0}$ を任意に取り, $n=n_1+\cdots+n_s$ と置く.
  このとき, 任意の  $b_{i,\nu}\in K$  ($i=1,\dots,s$, $\nu=0,1,\dots,n_i-1$) 
  に対して, ある多項式 $p\in K[\lambda]$ で次数が $n-1$ 以下でかつ
  \begin{equation*}
    p^{(\nu)}(\alpha_i) = b_{i,\nu}
    \qquad (i=1,\dots,s,\; \nu=0,1,\dots,n_i-1)
  \end{equation*}
  を満たすものが唯一存在する.   ここで $p^{(\nu)}$ は $p$ の $\nu$ 階の導函
  数である.  \qed
\end{question}

\noindent
ヒント1: $f(\lambda)=(\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}$ 
と置く.  唯一性は「すべての $b_{i,\nu}$ が $0$ ならば条件を
満たす $p$ が $0$ になる」ことに帰着する.  
すべての $b_{i,\nu}$ が $0$ ならば問題 \qref{q:Lagrange-interpolation-3} 
の結果より, $p$ は $(\lambda-\alpha_i)^{n_i}$ ($i=1,\dots,s$) のすべてで割り
切れる.  よって $p$ は $f$ で割り切れる.
$p$ の次数は $n-1$ 以下であると仮定したので $p=0$ でなければいけない.
存在は以下のように示される.  $K$ は標数 $0$ なので $b_i\in K[\lambda]$ を次
のように定めることができる:
\begin{equation*}
  b_i(\lambda) =
  b_{i,0} + b_{i,1}(\lambda-\alpha_i) 
  + \frac{1}{2!}b_{i,2}(\lambda-\alpha_i)^2 +
  \cdots + \frac{1}{(n_i-1)!}b_{i,n_i-1}(\lambda-\alpha_i)^{n_i-1}.
\end{equation*}
この $b_i$ は $b_i^{(\nu)}(\alpha_i)=b_{i,\nu}$ を満たしている.
よって $p$ の満たすべき等式は
\begin{equation*}
  p(\lambda) \equiv b_i(\lambda) \mod{(\lambda-\alpha_i)^{n_i}}
  \qquad (i=1,\dots,s)
\end{equation*}
と同値である%
\footnote{$b_{i,\nu}$ たちから $b_i(\lambda)$ を構成するためだけ
  に $K$ の標数が $0$ であるという仮定を使った.  
  最初から $b_i(\lambda)$ を与えて問題を定式化し直せば標数 $0$ という仮定は
  必要でなくなる.  正標数の世界では $n!$ で自由に割ることができなくなるので
  微分を用いた議論が色々うまく行かなくなる.}.  
$f_i(\lambda)=f(\lambda)/(\lambda-\alpha_i)^{n_i}$ と置く.
$f_i$ と $(\lambda-\alpha_i)^{n_i}$ は互いに素なので
問題 \qref{q:U(K[z]/(g))} の結果より, 
ある $a_i\in K[\lambda]$ が存在
して $a_if_i\equiv b_i\mod{(\lambda-\alpha_i)^{n_i}}$ となる.
このとき, $p=a_1f_1+\cdots+a_sf_s$ は上の満たすべき条件を満たしている.  
$p$ の次数が $n$ 以上ならば $f$ で割った余りを改めて $p$ とすれば良い.
\qed

\medskip
\noindent
ヒント2: $a_if_i\equiv b_i\mod{(\lambda-\alpha_i)^{n_i}}$ を
満たす多項式 $a_i$ の具体形を以下のように計算することができる.
$\lambda=\alpha_i$ で正則な $\lambda$ の
有理式 $b_i(\lambda)/f_i(\lambda)$ の $\lambda-\alpha_i$ に
関する巾級数展開を次のように書いておく:
\begin{equation*}
  \frac{b_i(\lambda)}{f_i(\lambda)} =
  a_{i,0}+a_{i,1}(\lambda-\alpha_i)+\cdots
  +a_{i,\nu}(\lambda-\alpha_i)^{\nu} + \cdots.
\end{equation*}
ここで, 
\begin{equation*}
  a_{i,\nu} = 
  \frac{1}{\nu !}
  \left[
    \odfrac{^\nu}{\lambda^\nu}
    \frac{b_i(\lambda)}{f_i(\lambda)}
  \right]_{\lambda=\alpha_i}
  \qquad (\nu=0,1,2,\ldots).
\end{equation*}
多項式 $a_i(\lambda)$ を上の展開における最初の $n_i$ 項の和と定める:
\begin{equation*}
  a_i(\lambda) = 
  a_{i,0}+a_{i,1}(\lambda-\alpha_i)+\cdots
  +a_{i,n_i-1}(\lambda-\alpha_i)^{n_i-1}
  \qquad (i=1,\dots,s).
\end{equation*}
この $a_i(\lambda)$ は $
a_i(\lambda)f_i(\lambda) \equiv b_i(\lambda)
\mod (\lambda-\alpha_i)^{n_i}
$ を満たしている. しかも
このとき $p=a_1f_1+\cdots+a_sf_s$ の次数は $n=n_1+\cdots+n_s$ 未満である.
\qed

\medskip
\noindent
解説: ヒント2の方法を使えば $a_{i,\nu}$ たちが $\alpha_i$ と$b_{i,\nu}$ たち
の $\Q$ 上の有理式で表わせることもわかる($b_{i,\nu}$ については線形).  
特に $n_i$ がすべて $1$ の場合の具体的な公式が Lagrange の
補間公式 \qref{q:Lagrange-interpolation-2} である.  
ヒント2の方法によって得られる結果は Lagrange の補間公式の一般化になっており,
{\bf Lagrange-Sylvester の補間公式}と呼ばれている. 
\qed

\begin{theorem}[Lagrange-Sylvester の補間公式]
\label{theorem:Lagrange-Sylvester}
  $K$ は標数 $0$ の体であるとする.
  互いに異なる $\alpha_1,\dots,\alpha_s\in K$ 
  と $n_1,\dots,n_s\in\Z_{>0}$ を任意に取り, $f\in K[\lambda]$ を
  \begin{equation*}
    f(\lambda) = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}
  \end{equation*}
  と定め, $n=\deg f =n_1+\cdots+n_s$ と置く.
  各 $i=1,\dots,s$ に対して
  次数が $n_i$ 未満の多項式 $b_i\in K[\lambda]$ を任意に取る.
  このとき, 次数が $n$ 未満の多項式 $p\in K[\lambda]$ で
  \begin{equation*}
    p^{(\nu)}(\alpha_i) = b_i^{(\nu)}(\alpha_i)
    \qquad (i=1,\dots,s,\; \nu=0,1,\dots,n_i-1)
  \end{equation*}
  を満たすものが唯一存在する. しかも $p$ は次の表示を持つ:
  \begin{equation*}
    p(\lambda) = 
    \sum_{i=1}^s 
    \sum_{\nu=0}^{n_i-1}
    \frac{1}{\nu !}
    \left[
      \odfrac{^\nu}{\lambda^\nu}
      \frac{b_i(\lambda)}{f_i(\lambda)}
    \right]_{\lambda=\alpha_i}
    \frac{f(\lambda)}{(\lambda-\alpha_i)^{n_i-\nu}}.
    \qed
  \end{equation*}
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-4-Z}
  $N\in \Z_{>0}$ とし, その素因数分解を $N=p_1^{n_1}\cdots p_s^{n_s}$ と表わ
  す.  ここで $p_i$ は互いに異なす素数であり, $n_i\in\Z_{>0}$ である.
  このとき, 任意の $b_{i,\nu}\in\{0,1,\dots,p_i-1\}$ 
  ($i=1,\dots,s$, $\nu=0,1,\dots,n_i-1$) に対して,
  ある $m\in\Z$ で $0$ 以上 $N$ 未満でかつ
  \begin{equation*}
    m \equiv 
    b_{i,0} + b_{i,1} p_i + b_{i,2} p_i^2 + \cdots + b_{i,n_i-1} p_i^{n_i-1}
    \mod{p_i^{n_i}}
  \end{equation*}
  を満たすものが唯一存在する. \qed
\end{question}

\noindent
ヒント: $b_i=b_{i,0} + b_{i,1} p_i + b_{i,2} p_i^2 + \cdots + b_{i,n_i-1}
p_i^{n_i-1}$ と置くと $b_i$ は $0$ 以上 $p_i^{n_i}$ 未満である%
\footnote{実は $b_{i,\nu}$ を持ち出したのは
  問題 \qref{q:Lagrange-interpolation-4} との類似を見易くするためにそう
  しただけであり, 本質的な意味はない. $b_i$ さえあれば十分である.}.  %
$N_i=N/p_i^{n_i}$ と置くと $N_i$ たちの最大公約数は $1$ なので
問題 \qref{q:Euclidean-algorithm-3-Z} の結果より, 
任意の整数 $m$ は $m = a_1 N_1 + \cdots + a_s N_s$ ($a_i \in \Z$) 
と表わされる%
\footnote{問題 \qref{q:Euclidean-algorithm-3-Z} の結果より, ある $c_i\in\Z$ 
  が存在して $1 = c_1 N_1 + \cdots + c_s N_s$ となる. これの両辺に $m$ をか
  ければ良い.}.
$m$ が $m \equiv a_i N_i \equiv b_i \mod{p_i^{n_i}}$ ($i=1,\dots,s$) を満た
していれば $m$ を $N$ で割った余り($0$ 以上 $N$ 未満の整数に取る)も同じ条件
を満たしている.   
よって $m$ がその条件を満たすように $a_i$ たちを取れることを示せば良い.
しかし, $N_i$ と $p_i^{n_i}$ は互いに素なので
問題 \qref{q:U(Z/mZ)} の結果より $a_iN_i\equiv b_i \mod{p_i^{n_i}}$ を
満たす $a_i\in\{0,1,\dots,p_i^{n_i}-1\}$ が一意に存在する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Lagrange-interpolation-5}
  互いに異なる $\alpha,\gamma\in K$ に対して
  $\lambda-\gamma$ と $(\lambda-\alpha)^2$ は互いに共通
  因子を持たないので, $1$ はそれらの最大公約元である. 
  次が成立する:
  \begin{align*}
    &
     \frac{\lambda-\gamma}{\alpha-\gamma}
    -\frac{(\lambda-\alpha)(\lambda-\gamma)}{(\alpha-\gamma)^2}
    +\frac{(\lambda-\alpha)^2}{(\gamma-\alpha)^2}
    = 1,
    \\ &
    \frac{1}{(\lambda-\alpha)^2(\lambda-\gamma)}
    =
     \frac{1}{\alpha-\gamma}
     \frac{1}{(\lambda-\alpha)^2}
    -\frac{1}{(\alpha-\gamma)^2}
     \frac{1}{\lambda-\alpha}
    +\frac{1}{(\gamma-\alpha)^2}
     \frac{1}{\lambda-\gamma}.
  \end{align*}
  この公式が問題 \qref{q:Lagrange-interpolation-1} の終わりの2つの
  公式から $\beta\to\alpha$ の極限で得られることを示せ%
  \footnote{この場合の極限は純代数的に扱うこともできるが,
    $K=\R,\C$ と考えて問題を解いても良い.}.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{1変数有理函数の部分分数展開}
\label{sec:partial-fraction}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\bf 体 $K$ 上の $\lambda$ に関する有理函数 (rational function in $\lambda$
over $K$)} とは $K$ 上の $\lambda$ に関する多項式の分数式(有理式)のことである. 
それら全体の集合を $K(\lambda)$ と表わす:
\begin{equation*}
  K(\lambda) = \{\, g/f \mid f,g\in K,\ f\ne 0 \,\}.
\end{equation*}
$K(\lambda)$ は体をなすので体 $K$ 上の $\lambda$ に関する有理函数体と呼ばれ
ている%
\footnote{有理函数は有理数に似ており, $\sqrt{\lambda^2+1}$ のような無理函数
  (代数函数の一種) は $\sqrt{2}$ のような無理数 (代数的数の一種) に似て
  おり, $\log\lambda$ のような超越函数は $\pi$ のような超越数に似ている.  
  このように函数の世界と数の世界のあいだには類似関係がある.  このような見方
  は非常に基本的でありかつ重要である.  なぜならばこのような見方をすれば函数
  の世界と数の世界のどちらか片方で開発された方法や直観がもう一方にも適用でき
  るかもしれないという考え方ができるようになるからである.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:partial-fraction-1}
  $K(\lambda)$ の部分集合 $\{1,\lambda,\lambda^2,\ldots\}$ 
  と $\left\{\frac{1}{\lambda-\alpha}, \frac{1}{(\lambda-\alpha)^2}, 
    \frac{1}{(\lambda-\alpha)^3},\ldots\right\}$ ($\alpha\in K$) たちの和集合
  は $K$ 上一次独立である. \qed
\end{question}

\noindent
ヒント: $\lambda^i$ ($i=0,1,2,\dots$), 
$(\lambda-\alpha)^{-j}$ ($\alpha\in K$, $j=1,2,3,\dots$) たち
の $K$ 上での一次結合 $f$ が $0$ ならば一次結合の係数も $0$ であることを示せ
ば良い.  もしも一次結合の中に $0$ でない $a_j(\lambda-\alpha)^{-j}$ のような
項が含まれているならばそのような最大の $j$ を
取って, $(\lambda-\alpha)^jf(\lambda)$ の $\lambda$ に $\alpha$ を
代入すれば $a_j=0$ となって矛盾する.  よって $f=0$ は $\lambda^i$
($i=0,1,2,\dots$) の一次結合でなければいけない.  しかしその一次結合の中
に $0$ でない係数が存在すれば $0$ でない多項式ができてしまうので矛盾する. 
よって一次結合の係数はすべて $0$ でなければいけない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[有理函数の部分分数展開]
\label{q:partial-fraction-2}
  次数が $n\ge0$ のモニックな%
  \footnote{最高次の係数が $1$ であるという意味.}多項式 $f\in K[\lambda]$ 
  と $m\ge n$ に対して, $K$ 上の $m$ 次元ベクトル空間 $V$ を次のように定める:
  \begin{equation*}
    V = \{\, g/f \in K(\lambda) \mid g\in K[\lambda],\ \deg g < m\,\}.
  \end{equation*}
  $f$ は次のように一次式の積に分解されると仮定する%
  \footnote{$K=\C$ もしくはより一般に $K$ が代数閉体であればこの仮定が成立し
    ている.}:
  \begin{equation*}
    f(\lambda) = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}.
  \end{equation*}
  ここで $\alpha_i$ は $f$ の相異なる根であり, $n=n_1+\cdots+n_s$ である.
  このとき $V$ は次の集合 $B$ を基底に持つ: 
  \begin{equation*}
    B = 
    \{1,\lambda,\dots,\lambda^{m-n-1}\}
    \cup
    \bigcup_{i=1}^s
    \left\{
      \frac{1}{\lambda-\alpha_i},
      \frac{1}{(\lambda-\alpha_i)^2},
      \cdots,
      \frac{1}{(\lambda-\alpha_i)^{n_i}}.
    \right\}
  \end{equation*}
  したがって任意の有理式 $h\in K(\lambda)$ は次の形で一意的に表わされる:
  \begin{equation*}
    h(\lambda)
    = q(\lambda) 
    + \sum_{i=1}^s
    \left[
      \frac{a_{i,1}}{\lambda-\alpha_i} +
      \frac{a_{i,2}}{(\lambda-\alpha_i)^2} + \cdots +
      \frac{a_{i,n_i}}{(\lambda-\alpha_i)^{n_i}}
    \right].
  \end{equation*}
  ここで $q\in K[\lambda]$ でかつ $a_{i,\nu}\in K$ であり,
  $\alpha_1,\dots,\alpha_s\in K$ は互いに異なる.
  さらに $q$ は $h$ の分子を $h$ の分母で割った余りになる.
  \qed
\end{question}

\noindent
ヒント: $B$ は $V$ の部分集合である.
$B$ の元の個数は $m$ に等しい.
問題 \qref{q:partial-fraction-1} より $B$ の張る $K$ 上の
ベクトル空間の次元は $V$ の次元の $m$ に等しい.
これらの事実から $B$ が $V$ の基底になることがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[有理数の部分分数展開]
\label{q:partial-fraction-2-Z}
  任意の有理数 $h\in\Q$ は次の形で一意的に表わされる:
  \begin{equation*}
    h
    = q
    + \sum_{i=1}^s
    \left[
      \frac{a_{i,1}}{p_i} +
      \frac{a_{i,2}}{p_i^2} + \cdots +
      \frac{a_{i,n_i}}{p_i^{n_i}}
    \right].
  \end{equation*}
  ここで $q\in\Z$ でかつ $a_{i,\nu}\in \{0,1,\dots,p_i-1\}$ であり, 
  $p_1,\dots,p_s\in K$ は互いに異なる素数である.
  \qed  
\end{question}

\noindent
ヒント: 有理数 $h$ は $h=g/f$, $g\in\Z$, $f=p_1^{n_1}\cdots p_s^{n_s}$ と表
わすことができる.  $f_i=f/p_i^{n_i}$ と置くと, $f_i$ と $p_i^{n_i}$ は互
いに素であるから, 
問題 \qref{q:U(Z/mZ)} の結果より $a_if_i\equiv g \mod{p_i^{n_i}}$ を
満たす $a_i\in\{0,1,\dots,p_i^{n_i}-1\}$ が一意に存在する.
$0$ 以上 $p_i^{n_i}$ 未満の整数 $a_i$ は
\begin{equation*}
  a_i 
  = a_{i,1}p_i^{n_i-1} + a_{i,2}p_i^{n_i-2} 
  + \cdots + a_{i,n_i-1}p_i + a_{i,n_i},
  \quad
  a_{i,\nu}\in\{0,1,\dots,p_i-1\}
\end{equation*}
と一意に表示できる%
\footnote{これを $a_i$ の $p_i$ 進展開と呼ぶ. 
  $a_i$ を $p_i$ で割った余りが $a_{i,n_i}$ になり,
  その商をさらに $p_i$ で割った余りが $a_{i,n_i-1}$ になる.
  以下同様に $a_{i,\nu}$ を求めて行けば $p_i$ 進展開表示の存在が示される.}. 
$c=a_1f_1+\cdots+a_sf_s$ と置くと $c\equiv g \mod{f}$ である.
よって $g=qf+c$ ($q\in\Z$) と書ける.  
この両辺を $f$ で割れば部分分数展開表示の存在が示される.
部分分数展開表示の一意性については自分で考えてみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  有理函数の部分分数展開 \qref{q:partial-fraction-2} を
  用いて Lagrange の補間公式 \qref{q:Lagrange-interpolation-2} を証明せよ. 
  \qed
\end{question}

\noindent
ヒント: Lagrange の補間公式の設定は
問題 \qref{q:partial-fraction-2} の $s=n$, $n_1=\cdots=n_s=1$, $m=n$ の場合
の設定に等しい.  よって次数が $n-1$ 次以下の任意の $p\in K[\lambda]$ に対し
て $p/f$ は次の形で一意的に表わされる:
\begin{equation*}
  \frac{p(\lambda)}{f(\lambda)}
  = \frac{a_1}{\lambda-\alpha_1}+\cdots+\frac{a_n}{\lambda-\alpha_n},
  \qquad
  a_i\in K.
\end{equation*}
両辺に $f(\lambda)$ をかけて $\lambda=\alpha_i$ と置けば
\begin{equation*}
  p(\alpha_i) = a_i f_i(\alpha_i) = a_i f'(\alpha_i).
\end{equation*}
ここで $f_i(\lambda)=f(\lambda)/(\lambda-\alpha_i)$ である. 
よって $a_i=p(\alpha_i)/f'(\alpha_i)$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ が代数閉体であるとき%
  \footnote{「代数閉体」という言葉が怖い人は $K=\C$ と仮定してよい.},
  有理函数の部分分数展開 \qref{q:partial-fraction-2} を用いて,
  よく使われる問題 \qref{q:Euclidean-algorithm-3} の結果を証明せよ.
  \qed
\end{question}

\noindent
ヒント: $K$ は代数閉体であると仮定したので各 $f_i$ は一次式の積に分解される.
$f_i$ たちを最大公約元 $d$ で同時に割っておくこと
にすれば $d=1$ の場合だけを考えれば良いことがわかる.
$f_i$ たちの最小公倍元 $f$ に対して, $1/f$ を部分分数展開して, 
その両辺に $f$ をかければ $1$ を $f_i$ たちの多項式倍の和で表わす式が
得られる.
\qed

\bigskip

以上によって, $K$ が代数閉体のとき, 
よく使われる問題 \qref{q:Euclidean-algorithm-3} の
結果について少なくとも3通りの証明が存在することがわかった:
\begin{itemize}
\item Euclid の互除法を使う方法
  (問題 \qref{q:Euclidean-algorithm-3} のヒント1),
\item 単項イデアルの考え方を使う方法
  (問題 \qref{q:Euclidean-algorithm-3} のヒント2),
\item 部分分数展開を使う方法
  ($K$ が代数閉体の場合, 上の問題のヒント).
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{一般固有空間分解と Jordan 標準形}
\label{sec:Jordan-nilpotent}

この節では佐武 \cite{satake} の方針にしたがって Jordan 標準形の存在の証明の
解説を演習問題の羅列によって行なうことにする%
\footnote{Jordan 標準形の存在の証明には少なくとも3通りの方法がある. 

  1つ目は行列の Jordan 分解 (互いに可換な半単純行列と巾零行列の和への分解)
  と巾零行列の標準形の存在を直接証明するという方法である.  
  この1つ目の方法は佐武 \cite{satake} 第IV章や杉浦 \cite{sugiura} 第1章など
  で解説されている. 

  2つ目は行列の有理標準形を経由する方法である.
  有理標準形とは問題 \qref{q:minimal-polyn-10} で定義されている
  コンパニオン行列 $C_1,\dots,C_t$ を対角線に並べた形に行列で
  もとの行列と相似でかつ $p_{C_1}\mid\cdots\mid p_{C_t}$ を満たすもの
  のことである.  もとの行列から四則演算のみを用いて有理標準形は計算される.
  この2つ目の方法は韓・伊理 \cite{kan-iri} の第3.2節で解説されている.

  3つ目は単因子論を使う方法である.  単因子論は本質的に1変数多項式環上の有限
  生成加群の構造論に同値なので, この方法は環と加群の理論の応用であるとみなせ
  る.  この3つ目の方法の解説は堀田 \cite{10wa} の第3章と第4章が良い.
  堀田 \cite{gun-kagun} も参照せよ.

  3つのどれも数学的に重要である.
  しかし本質的に2つ目の方法と3つ目の方法は同類だとみなすことができる.
  }.
その方針は以下の通りである:
\begin{enumerate}
\item まず正方行列の Jordan 分解 (互いに可換な半単純行列と巾零行列の和への分
  解) の存在を証明する.
\item それと同時に一般固有分解が証明される.  
  よって Jordan 標準形を求める問題は巾零行列の標準形を求める問題に帰着される.
\item 巾零行列の標準形の存在を証明する.
\item Jordan 標準形の一意性を証明する.
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

次の計算問題が解けるようになることを第一の目標にせよ.  計算ができるようにな
ったら Jordan 標準形の存在と一意性の証明の理解に挑戦せよ.

\begin{question}
\label{q:Jordan-normal-form-example}
  以下の実正方行列 $A_i$ の Jordan 標準形 $J_i$ と $P_i^{-1}A_iP_i=J_i$ 
  を満たす正則行列 $P_i$ の例と最小多項式 $\varphi_i(\lambda)$ を求めよ:
  {\small
  \begin{align*}
    &
    A_1 =
    \begin{bmatrix}
      -25 &   6 &  -7 &  21 \\
        9 &  -2 &   2 &  -5 \\
       21 &  -4 &   4 & -17 \\
      -23 &   6 &  -7 &  19 \\
    \end{bmatrix},
    \quad
    A_2 =
    \begin{bmatrix}
      -17 &  12 &   0 & -12 \\
        0 &   7 &  -8 & -24 \\
      -72 &  36 &  17 &   0 \\
       24 & -10 &  -8 &  -7 \\
    \end{bmatrix},
    \quad
    A_3 =
    \begin{bmatrix}
      12 &  -8 &  11 &   3 \\
       9 &  -8 &   9 &   0 \\
      -5 &   2 &  -4 &  -3 \\
      -8 &   5 &  -8 &  -2 \\
    \end{bmatrix},
    \\[\medskipamount] &
    A_4 =
    \begin{bmatrix}
       -4 &  -6 &   5 &   5 \\
       -4 &   7 &  -9 & -11 \\
      -24 &  -9 &   1 &  -3 \\
       16 &  12 &  -7 &  -6 \\
    \end{bmatrix},
    \quad
    A_5 =
    \begin{bmatrix}
      -5 &  8 & -6 &  4 \\
      -3 &  5 & -5 &  4 \\
      -2 &  4 & -5 &  4 \\
      -1 &  2 & -2 &  1 \\
    \end{bmatrix},
    \quad
    A_6 =
    \begin{bmatrix}
      -12 &   2 &  -3 &   9 \\
       22 &  -5 &   6 & -18 \\
       22 &  -4 &   5 & -18 \\
      -11 &   2 &  -3 &   8 \\
    \end{bmatrix}.
  \end{align*}
  }Jordan 標準形と最小多項式の定義についてはそれぞれ
  \secref{sec:Jordan-normal-form}と\secref{sec:minimal-polynomial}を参照せよ. 
  \qed
\end{question}

\noindent
ヒント: 固有値がすべて整数になるように問題を作ってある. 
がんばって計算しましょう. 
\qed

\commentout{
\medskip
\noindent
略解: 以下のように $J_i$, $P_i$ を定めると $P_i^{-1}A_iP_i=J_i$ である:
{\small
\begin{alignat*}{3}
  &
  J_1 =
  \begin{bmatrix}
    -2 &  1 &  0 &  0 \\
     0 & -2 &  1 &  0 \\
     0 &  0 & -2 &  0 \\
     0 &  0 &  0 &  2 \\
  \end{bmatrix},
  & \quad &
  J_2 =
  \begin{bmatrix}
    -1 &  0 &  0 &  0 \\
     0 & -1 &  0 &  0 \\
     0 &  0 &  1 &  0 \\
     0 &  0 &  0 &  1 \\
  \end{bmatrix},
  & \quad &
  J_3 =
  \begin{bmatrix}
    -2 &  1 &  0 &  0 \\
     0 & -2 &  0 &  0 \\
     0 &  0 &  1 &  0 \\
     0 &  0 &  0 &  1 \\
  \end{bmatrix},
  \\ &
  P_1 =
  \begin{bmatrix}
     1 &  0 &  0 &  1 \\
    -2 & -1 &  0 &  1 \\
    -2 & -1 & -3 &  0 \\
     1 &  0 & -1 &  1 \\
  \end{bmatrix},
  & \quad &
  P_2 =
  \begin{bmatrix}
     3 &  0 &  4 &  2 \\
     6 & -1 &  4 &  4 \\
     0 &  2 &  9 &  0 \\
     2 & -1 & -2 &  1 \\
  \end{bmatrix},
  & \quad &
  P_3 =
  \begin{bmatrix}
     1 &  2 &  1 &  2 \\
     0 &  3 &  1 &  1 \\
    -1 &  0 &  0 & -1 \\
    -1 & -1 & -1 & -1 \\
  \end{bmatrix},
\end{alignat*}
\begin{alignat*}{3}
  &
  J_4 =
  \begin{bmatrix}
    -2 &  1 &  0 &  0 \\
     0 & -2 &  0 &  0 \\
     0 &  0 &  1 &  1 \\
     0 &  0 &  0 &  1 \\
  \end{bmatrix},
  & \quad &
  J_5 =
  \begin{bmatrix}
    -1 &  1 &  0 &  0 \\
     0 & -1 &  0 &  0 \\
     0 &  0 & -1 &  1 \\
     0 &  0 &  0 & -1 \\
  \end{bmatrix},
  & \quad &
  J_6 =
  \begin{bmatrix}
    -1 &  1 &  0 &  0 \\
     0 & -1 &  0 &  0 \\
     0 &  0 & -1 &  0 \\
     0 &  0 &  0 & -1 \\
  \end{bmatrix},
  \\ &
  P_4 =
  \begin{bmatrix}
    -1 &  0 & -2 & -1 \\
     2 &  1 &  5 &  2 \\
     0 &  2 &  3 &  0 \\
     2 & -1 &  1 &  1 \\
  \end{bmatrix},
  & \quad &
  P_5 =
  \begin{bmatrix}
    4 & 3 & 2 & 1 \\
    3 & 3 & 2 & 1 \\
    2 & 2 & 2 & 1 \\
    1 & 1 & 1 & 1 \\
  \end{bmatrix},
  & \quad &
  P_6 =
  \begin{bmatrix}
     1 &  0 &  1 &  1 \\
    -2 & -1 &  1 &  1 \\
    -2 & -1 & -3 &  0 \\
     1 &  0 &  0 &  1 \\
  \end{bmatrix}.
\end{alignat*}
}$A_i$ の最小多項式を $\varphi_i(\lambda)$ と書くと,
{\small
\begin{alignat*}{3}
  &
  \varphi_1(\lambda) = (\lambda+2)^3(\lambda-2),
  & \quad &
  \varphi_2(\lambda) = (\lambda+1)(\lambda-1),
  & \quad &
  \varphi_3(\lambda) = (\lambda+2)^2(\lambda-1),
  \\ &
  \varphi_4(\lambda) = (\lambda+2)^2(\lambda-1)^2,
  & \quad &
  \varphi_5(\lambda) = (\lambda+1)^2,
  & \quad &
  \varphi_6(\lambda) = (\lambda+1)^2,
\end{alignat*}
}$A_5$ と $A_6$ の最小多項式は等しいのに Jordan 標準形は異なることに注意せよ.
そのようなことは3次行列では起こり得ない. 3次以下の行列では最小多項式だけで 
Jordan 標準形がわかってしまう.
\qed
}

% P_i^{-1} A_i P_i = J_i

% A_1 =
% 
%   -25    6   -7   21
%     9   -2    2   -5
%    21   -4    4  -17
%   -23    6   -7   19
% 
% J_1 =
% 
%   -2   1   0   0
%    0  -2   1   0
%    0   0  -2   0
%    0   0   0   2
% 
% P_1 =
% 
%    1   0   0   1
%   -2  -1   0   1
%   -2  -1  -3   0
%    1   0  -1   1

% A_2 =
% 
%   -17   12    0  -12
%     0    7   -8  -24
%   -72   36   17    0
%    24  -10   -8   -7
% 
% J_2 =
% 
%   -1   0   0   0
%    0  -1   0   0
%    0   0   1   0
%    0   0   0   1
% 
% P_2 =
% 
%    3   0   4   2
%    6  -1   4   4
%    0   2   9   0
%    2  -1  -2   1

% A_3 =
% 
%    12   -8   11    3
%     9   -8    9    0
%    -5    2   -4   -3
%    -8    5   -8   -2
% 
% J_3 =
% 
%   -2   1   0   0
%    0  -2   0   0
%    0   0   1   0
%    0   0   0   1
% 
% P_3 =
% 
%    1   2   1   2
%    0   3   1   1
%   -1   0   0  -1
%   -1  -1  -1  -1

% A_4 =
% 
%    -4   -6    5    5
%    -4    7   -9  -11
%   -24   -9    1   -3
%    16   12   -7   -6
% 
% J_4 =
% 
%   -2   1   0   0
%    0  -2   0   0
%    0   0   1   1
%    0   0   0   1
% 
% P_4 =
% 
%   -1   0  -2  -1
%    2   1   5   2
%    0   2   3   0
%    2  -1   1   1

% A_5 =
% 
%   -5   8  -6   4
%   -3   5  -5   4
%   -2   4  -5   4
%   -1   2  -2   1
% 
% J_5 =
% 
%   -1   1   0   0
%    0  -1   0   0
%    0   0  -1   1
%    0   0   0  -1
% 
% P_5 =
% 
%   4  3  2  1
%   3  3  2  1
%   2  2  2  1
%   1  1  1  1

% A_6 =
% 
%   -12    2   -3    9
%    22   -5    6  -18
%    22   -4    5  -18
%   -11    2   -3    8
% 
% J_6 =
% 
%   -1   1   0   0
%    0  -1   0   0
%    0   0  -1   0
%    0   0   0  -1
% 
% P_6 =
% 
%    1   0   1   1
%   -2  -1   1   1
%   -2  -1  -3   0
%    1   0   0   1

\medskip
\noindent
計算問題の作り方: 上のような問題を作るのときには, まず正則行列 $P$ を色々
作る.  Jordan 標準形 $J$ を任意に用意して $A=PJP^{-1}$ を計算して「$A$ の 
Jordan 標準形を求めよ」とすれば計算問題のいっちょあがりである. 
問題は逆行列の計算が易しい $P$ を系統的に生成することである.  
逆行列の分母には $\det P$ が登場する.  だから $A$ を整数だけで構成された
行列にしたければ分母の $\det P$ が $1$ であることが望ましい.  
その場合は逆行列の計算も易しくなる.  

行列式が $1$ の $n$ 次正方行列全体の集合 $SL_n(K)$ は群をなし, 
その任意の元は $E+a E_{ij}$ ($a\in K$, $i\ne j$) の形の行列を有限個かけ合わ
せたもので表わせる.  ($E_{ij}$ は $(i,j)$ 成分だけが $1$ で
他の成分が $0$ であるような正方行列であり, 行列単位と呼ばれている.)
成分を整数に制限した $SL_n(\Z)$ の場合も
その任意の元は $E+n E_{ij}$ ($n\in K$, $i\ne j$) の形の行列を有限個かけ合わ
せたもので表わせる.  
この事実を使えば整数を成分に持つ行列式が $1$ の行列を系統的に生成できる.
実は $SL_n(\Z)$ の任意の元は $E\pm E_{i,i+1}$, $E\pm E_{i+1,i}$ の有限個の積
で表示できる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{巾零行列と半単純行列}
\label{sec:nilpotent-semisimple}

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

正方行列 $A\in M_n(K)$ に対して%
\footnote{$M_n(K)$ は体 $K$ の元を成分に持つ $n$ 次正方行列全体の集合で
ある.} $A$ 巾零であることと半単純であることを次のように定める:
\begin{itemize}
\item $A$ が{\bf 巾零 (nilpotent)} $\iff$ ある正の整数 $k$ が存在して $A^k=0$.
\item $A$ が{\bf 半単純 (semisimple)} $\iff$ $A$ は対角化可能.
\end{itemize}
ここで $A$ が{\bf 対角化可能 (diagonalizable)} であるとは
ある正則行列 $P$ で $P^{-1}AP$ が対角行列になるものが存在することである.
対角成分が $(\alpha_1,\dots,\alpha_n)$ であるような
対角行列を $\diag(\alpha_1,\dots,\alpha_n)$ と表わすことにする.

2つの正方行列 $A,B\in M_n(K)$ が可換, 同時対角化可能, 同時三角化可能であるこ
とを以下のように定義する:
\begin{itemize}
\item $A$ と $B$ が可換 $\iff$ $AB=BA$.
\item $A$ と $B$ は同時対角化可能 $\iff$ ある正則行列 $P$ で $P^{-1}AP$ 
  と $P^{-1}BP$ がともに対角行列になるようなものが存在する.
\item $A$ と $B$ は同時三角化可能 $\iff$ ある正則行列 $P$ で $P^{-1}AP$ 
  と $P^{-1}BP$ がともに上三角行列になるようなものが存在する.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $P\in GL_n(K)$ のとき\footnote{$GL_n(K)$ は $K$ の元を成分に持つ $n$ 次正
  則行列全体の集合である.}以下が成立する:
  \begin{enumerate}
  \item $A\in M_n(K)$ が巾零ならば $PAP^{-1}$ も巾零である.
  \item $A\in M_n(K)$ が半単純ならば $PAP^{-1}$ も半単純である.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  以下を示せ:
  \begin{enumerate}
  \item 上三角行列が巾零であるための必要十分条件は対角成分がすべて $0$ にな
    ることである.
  \item 対角行列は半単純である.
  \item 上三角行列でも下三角行列でもない $2$ 次複素巾零行列が存在する.
  \item 対角行列でない $2$ 次複素半単純行列が存在する.
  \item 巾零でも半単純でも上三角でもない $2$ 次複素正方行列が存在する.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ss-cap-nil=0}
  $A\in M_n(K)$ が巾零でかつ半単純ならば $A=0$ である.
  \qed
\end{question}

\noindent
ヒント: 巾零ならば固有値は $0$ だけである.  よって $A$ を対角化すると $0$ に
なる.  そのような $A$ は $0$ だけである.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:nilpotent:[B,C;0,D]}
  $m+n$ 次正方行列 $A$ 
  を $m$ 次正方行列 $B$ と $n$ 次正方行列 $C$ と $(m,n)$ 型行列 $D$ を
  用いて $
    A =
    \begin{bmatrix}
      B & D \\
      0 & C \\
    \end{bmatrix}
  $ と定めると, $A$ が巾零であることと $B$ と $C$ の両方が巾零であることは
  同値である.  
  \qed
\end{question}

\noindent
ヒント: $A^n$ は $
\begin{bmatrix}
  B^n & *   \\
    0 & C^n \\
\end{bmatrix}$ の形になり, $
\begin{bmatrix}
  0 & * \\
  0 & 0 \\
\end{bmatrix}$ の形の行列は巾零になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:semisimple:[B,0;0,C]}
  $m+n$ 次正方行列 $A$ を $m$ 次正方行列 $B$ と $n$ 次正方行列 $C$ を
  用いて $
    A =
    \begin{bmatrix}
      B & 0 \\
      0 & C \\
    \end{bmatrix}
  $ と定めると, $A$ が半単純であることと $B$ と $C$ の両方が半単純であること
  は同値である. 
  \qed
\end{question}

\noindent
ヒント: $B$ と $C$ が半単純ならば $m$ 次正方行列 $Q$ と $n$ 次正方行列 $R$ 
が存在して $Q^{-1}BQ$ と $R^{-1}CR$ はともに対角行列になるので, $Q$ と $R$ 
を対角線に並べてできる行列を $P$ とすれば $P$ は $A$ を対角化する.  
逆を示すために $A$ は半単純であると仮定し, $m+n$ 次正方行列 $P$ で対角化され
ていると仮定する. 
そのとき $P$ の中の列ベクトルを $p_1,\dots,p_{m+n}$ は $A$ の固有ベクトルに
なる.  各 $p_i$ を $p_i = 
\begin{bmatrix}
  u_i \\
  v_i \\
\end{bmatrix}$ ($u_i\in K^m$, $v_i\in K^n$) と表わすと $u_i$ は $B$ の固有ベ
クトルになり, $v_i$ は $C$ の固有ベクトルになる. 
適当に $u_{i_1},\dots,u_{i_m}$ を選ぶとそれらは $K^m$ の基底をなし,
適当に $v_{j_1},\dots,v_{j_n}$ を選ぶとそれらは $K^n$ の基底をなす%
\footnote{$K^{m+n}$ の任意のベクトルは $p_i$ たちの一次結合になっているので,
  $K^m$, $K^n$ の任意のベクトルはそれぞれ $u_i$ たち, $v_j$ たちの一次結合に
  なっている.  よって $u_i$ たちから $K^m$ の基底を選び, 
  $v_j$ たちから $K^n$ の基底を選ぶことができる.}.
このとき $Q=[u_{i_1}\ \cdots\ u_{i_m}]$, $R=[v_{j_1}\ \cdots\ v_{j_n}]$ と置
けば,  $Q$ は $B$ を対角化し, $R$ は $C$ を対角化する. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:B-commutes-semisimple-A}
  $\alpha_1,\dots,\alpha_s\in K$ は互いに異なり, 
  $n=n_1+\cdots+n_s$, $n_i>0$ であるとする.  $n$ 次対角行列 $A$ を
  \begin{equation*}
    A =
    \begin{bmatrix}
      \alpha_1 E_{n_1} &                  &        & \bigzerou \\
                       & \alpha_2 E_{n_2} &        & \\
                       &                  & \ddots & \\
      \bigzerol        &                  &        & \alpha_s E_{n_s} \\
    \end{bmatrix}
  \end{equation*}
  と定める. このとき, $n$ 次正方行列 $B$ が $A$ と可換であるための必要十分条
  件は $B$ が次の形をしていることである:
  \begin{equation*}
    B = 
    \begin{bmatrix}
      B_1       &     &        & \bigzerou \\
                & B_2 &        & \\
                &     & \ddots & \\
      \bigzerol &     &        & B_s \\
    \end{bmatrix}.
  \end{equation*}
  ここで $B_i$ は $n_i$ 次正方行列である. \qed
\end{question}

\noindent
ヒント: 任意の $n$ 次正方行列 $B$ は $(n_i,n_j)$ 型正方行列 $B_{ij}$ を用いて
\begin{equation*}
  B =
  \begin{bmatrix}
    B_{11} & B_{12} & \cdots & B_{1n} \\
    B_{21} & B_{22} & \cdots & B_{2n} \\
    \vdots & \vdots &        & \vdots \\
    B_{n1} & B_{n2} & \cdots & B_{nn} \\
  \end{bmatrix}
\end{equation*}
と表わされる.  $AB$ と $BA$ を計算して比較してみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$\alpha\in K$ に対して $n$ 次正方行列 $J_n(\alpha)$ を次のように定める: 
\begin{equation*}
  J_n(\alpha) = \alpha E_n + J_n(0) =
  \begin{bmatrix}
    \alpha &    1   &        &        & \bigzerou \\
           & \alpha &    1   &        & \\
           &        & \alpha & \ddots & \\
           &        &        & \ddots & 1 \\
    \bigzerol &     &        &        & \alpha \\
  \end{bmatrix},
  \qquad
  J_n(0) =
  \begin{bmatrix}
    0 & 1 &   &        & \bigzerou \\
      & 0 & 1 &        & \\
      &   & 0 & \ddots & \\
      &   &   & \ddots & 1 \\
    \bigzerol &  &  &  & 0 \\
  \end{bmatrix}.
\end{equation*}
  
\begin{question}
\label{q:A-commutes-J_n(alpha)}
  $A\in M_n(K)$ が $J_n(\alpha)$ と可換であるための
  必要十分条件は $A$ が次の形をしていることである.
  \begin{equation*}
    A = \sum_{k=0}^{n-1} a_k J_n(0)^k = 
    \begin{bmatrix}
      a_0 & a_1 & a_2 & \cdots & a_{n-1} \\
          & a_0 & a_1 & \ddots & \vdots \\
          &     & a_0 & \ddots & a_2 \\
          &     &     & \ddots & a_1 \\
      \bigzerol &  &  &        & a_0 \\
    \end{bmatrix},
    \qquad
    a_i\in K.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $\alpha E_n$ は任意の $n$ 次正方行列と可換なので $J_n(0)$ と
可換な行列がどのような行列であるかを調べれば良い.
\qed

\medskip
\noindent
参考: $J_n(\alpha)$ と可換な行列全体のなす空間の次元は $n$ である.
対角成分に互いに異なる $n$ 個の数が並んでいる任意の $n$ 次対角行列 $A$ に対
して, $A$ と可換な行列全体と対角行列全体は一致するので, $A$ と可換な行列全体
のなす空間の次元は $n$ になる.  
実は「任意に $n$ 次正方行列 $A$ を与えたとき, $A$ と可換な行列全体のなす空間
の次元は $n$ 以上になる」ことを証明できる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:nilpotent:A+B}
  $A,B\in M_n(K)$ が可換でかつともに巾零ならば $A+B$ も巾零になる.
  \qed
\end{question}

\noindent
ヒント:  $A$ と $B$ が可換ならば $(A+B)^k$ の展開に二項定理を適用できる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[同時対角化]
\label{q:semisimple:A+B}
  $A,B\in M_n(K)$ が可換でかつともに半単純ならば $A$ と $B$ は同時対角化可能
  であり, $A+B$ も半単純になる.
  \qed
\end{question}

\noindent
ヒント: $A$ と $B$ が同時対角化可能ならば $A+B$ も対角化可能であることはすぐ
にわかる. $A$, $B$ が可換でかつともに半単純ならば同時対角化可能であることは
問題 \qref{q:semisimple:[B,0;0,C]} と問題 \qref{q:B-commutes-semisimple-A} 
を用いて証明される. 
$A$ は半単純なのである正則行列 $P$ で $P^{-1}AP$ が
問題 \qref{q:B-commutes-semisimple-A} の $A$ の形の対角行列になるものが存在
する. そのとき $P^{-1}AP$ と可換な $P^{-1}BP$ は
問題 \qref{q:B-commutes-semisimple-A} の $B$ の形をしている.  
問題 \qref{q:semisimple:[B,0;0,C]} より, $P^{-1}BP$ の対角線に並ぶ
各ブロック $B_i$ も半単純になるのである正則行列 $Q_i$ で対角化される. 
$Q_i$ たちを対角線に並べてできる行列を $Q$ とする.
このとき $PQ$ は $A$ と $B$ を同時対角化する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:doji-taikakuka}
  次の行列 $A$, $B$ を同時対角化せよ:
  \begin{equation*}
    A =
    \begin{bmatrix}
      -4 & 15 & -9 \\
      -1 &  4 & -3 \\
      -1 &  5 & -4 \\
    \end{bmatrix},
    \quad
    B =
    \begin{bmatrix}
      1 & -15 & 9 \\
      1 &  -7 & 3 \\
      1 &  -5 & 1 \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: まずどちらか片方をある正則行列 $Q$ で対角化する. 
すると $Q^{-1}AQ$, $Q^{-1}BQ$ の少なくとも片方は対角行列になっている.  
運が良ければ両方同時に対角化されてい
るが, 運が悪い場合には片方の対角線に $(2,2)$ 型のブロックが表われる.  それを
対角化すれば問題 \qref{q:semisimple:A+B} のヒントの方法で同時対角化が終了す
る.
\qed

\commentout{
\medskip
\noindent
略解: 行列 $P$ を次のように定める:
\begin{equation*}
  P :=
  \begin{bmatrix}
    1 & 2 & 3 \\
    2 & 1 & 1 \\
    3 & 1 & 1 \\
  \end{bmatrix},
  \quad
  P^{-1} = 
  \begin{bmatrix}
     0 & -1 &  1 \\
    -1 &  8 & -5 \\
     1 & -5 &  3 \\
  \end{bmatrix}.
\end{equation*}
このとき $P^{-1}AP=\diag(-1,-1,-2)$, $P^{-1}BP=\diag(-2,-2,-1)$.
\qed
}

% A =
% 
%    -4   15   -9
%    -1    4   -3
%    -1    5   -4
% 
% B =
% 
%     1  -15    9
%     1   -7    3
%     1   -5    1
% 
% P =
% 
%   1  2  3
%   2  1  1
%   3  1  1
% 
% invP =
% 
%     0   -1    1
%    -1    8   -5
%     1   -5    3
% 
% diagA =
% 
%   -1   0   0
%    0  -1   0
%    0   0  -2
% 
% diagB =
% 
%   -2   0   0
%    0  -2   0
%    0   0  -1

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[同時三角化]
\label{q:triangulizable:A,B}
  $A,B\in M_n(K)$ が可換ならば $A$ と $B$ は同時三角化可能である.
  \qed
\end{question}

\noindent
ヒント: $n$ に関する帰納法. 
$K$ は代数閉体だと仮定したので, 特性多項式 $p_A(\lambda)=|\lambda E - A|$ の
根 $\alpha$ が $K$ の中に存在する.  
$\alpha$ に対応する $A$ の固有空間の基底を $v_1,\dots,v_k$ とし,
それを $K^n$ 全体の基底 $v_1,\dots,v_k,v_{k+1},\dots,v_n$ に拡張する.
$\alpha$ に対応する $A$ の固有空間のベクトル $v$ に
対して $ABv=BAv=\alpha Bv$ なので $Bv$ も $\alpha$ に対応する $A$ の固有空間
に含まれる.  すなわち $B$ の作用で $\alpha$ に対応する $A$ の固有空間は保た
れる.  よって $Bq_1,\dots,Bq_k$ は $q_1,\dots,q_k$ の一次結合になる. 
したがって, $V=[v_1\ \cdots\ v_n]$ と置くと,
\begin{equation*}
  V^{-1}AV=
  \begin{bmatrix}
    \alpha E_k & *   \\
      0        & A'' \\
  \end{bmatrix},
  \quad
  V^{-1}BV=
  \begin{bmatrix}
    B' & *   \\
    0  & B'' \\
  \end{bmatrix}.
\end{equation*}
ここで $B'$ は $k$ 次の正方行列であり, $A''$, $B''$ は $n-k$ 次の正方行列で
ある.  しかも, $A$ と $B$ が可換であることより $A''$ と $B''$ も可換であるこ
とが導かれる.  よって帰納法の仮定より, 
ある $k$ 次正則行列 $Q$ と $n-k$ 次正則行列 $R$ が
存在して $Q^{-1}B'Q$, $R^{-1}A''R$, $R^{-1}B''R$ はすべて上三角行列になる.
このとき, $P$ を
\begin{equation*}
  P = V
  \begin{bmatrix}
    Q & * \\
    0 & R \\
  \end{bmatrix}
\end{equation*}
と定めれば $P$ によって $A$ と $B$ は同時に上三角化される.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

Jordan 標準形の理論にできるだけ早く進みたい人は
ここから\secref{sec:Jordan-decomposition}にジャンプして構わない.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{抽象ベクトル空間について}
\label{sec:abstract-vector-space}

$K$ は任意の体とする.  「任意の体」という言葉が怖い人は $K=\R$ または $\C$ 
と考えて良い.

今までこの演習では主として縦ベクトルのベクトル空間とそれに作用するの行列を扱
って来た.  次の subsection では一般の抽象ベクトル空間とそれに作用する一次変
換を扱う%
\footnote{代数的な一般論を展開するときには数字が並んでいる縦ベクトルや行列
を扱うよりも抽象ベクトル空間や一次変換を扱う方が都合が良い.}.  
この subsection は次の subsection への助走である%
\footnote{したがって説明は完壁ではない.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

一般に $V$ が体 $K$ 上の{\bf ベクトル空間 (vector space over $K$)} 
もしくは{\bf 線形空間 (linear space)} であると
は $V$ は集合であり, 
加法 $+:V\times V\to V$ 
と零元 $0\in V$ 
と加法に関する逆元 $-:V\to V$ 
と $K$ の元による $V$ の元のスカラー倍 $\cdot:K\times V\to V$ が
定めらえていて, 以下のベクトル空間の公理が満たされていることである%
\footnote{一般に $K$ が体ではなく{\bf 環 (ring)}の場合は同じ公理系を
  満たす $V$ は $K$ 上の{\bf 加群 (module over $K$)} 
  もしくは {\bf $K$ 加群 ($K$-module)} と呼ばれる.  
  加群の方がベクトル空間よりも一般的な述語である.  
  体 $K$ 上の加群は体 $K$ 上のベクトル空間に等しい.  
  なお一般の環に $K$ という記号を割り振ることは少ない.
  英語の ring の頭文字を取って $R$ と書いたり, 
  フランス語の anneau の頭文字を取って $A$ と書くことが多い.
  体に $F$ や $K$ という記号が割り振られることが多いのは,
  英語で体を field と呼び, ドイツ語では K\"orper と呼ぶからである.}:
\begin{enumerate}
\item $V$ は加法に関して可換群をなす. すなわち $u,v,w\in V$ に対して,
  \begin{enumerate}
  \item $(u + v) + w = u + (v + w)$;
  \item $0 + u = u + 0 = u$;
  \item $(-u) + u = u + (-u) = 0$;
  \item $u + v = v + u$.
  \end{enumerate}
\item スカラー倍 $\cdot:K\times V\to V$ は結合的かつ{\bf 双加法的 
  (bi-additive)} であり, $1$ の積は恒等写像になる.
  すなわち $a,b\in K$, $u,v\in V$ に対して,
  \begin{enumerate}
  \item $(ab)u = a(bu)$;
  \item $a(u + v) = au + bv$;
  \item $(a + b)u = au + bu$;
  \item $1u=u$.
  \end{enumerate}
\end{enumerate}
$U$ と $V$ が体 $K$ 上のベクトル空間であるとき, 
写像 $f:U\to V$ が{\bf 線形写像もしくは一次写像 (linear mapping)} で
あるとは $a\in K$, $u,u'\in U$ に対して以下の条件を満たしていることである%
\footnote{線形写像の定義は幾何的には次のように説明される.  
  加法性 $f(u+u')=f(u)+f(u')$ は $U$ の中の4点 $0, u, u+u' u', 0$ を
  順次線分で結んでできる平行四辺形
  が $f$ によって $V$ の中の4点 $0, f(u), f(u)+f(u'), f(u'), 0$ を
  順次線分で結んでできる平行四辺形に移されることを意味している.
  スカラー倍との可換性 $f(au)=af(u)$ は $U$ の中の直線 $\{au\}_{a\in K}$ 
  が $f$ によって $\{af(u)\}_{a\in K}$ に自然に移されることを意味している.
  線形写像は真っ直なものや平らなものを真っ直なものと平らなものに移す.
  色々図を描いて線形写像がどのような写像なのかを直観的に理解するように
  努力せよ.}:
\begin{enumerate}
\item 加法性\quad $f(u+u')=f(u)+f(u')$;
\item スカラー倍との可換性\quad $f(au)=af(u)$.
\end{enumerate}
$V$ からそれ自身への線形写像は $V$ の{\bf 線形変換もしくは一次変換 (linear
transformation)} と呼ばれる.
線形写像 $f$ の逆写像 $f^{-1}$ が存在するならば $f^{-1}$ も線形写像になる.
逆写像を持つような線形写像を{\bf 線形同型写像 (linear isomorphism)} と呼ぶ.
単に{\bf 同型写像 (isomorphism)} と呼ぶことも多い. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$K$ 上のベクトル空間 $V$ の部分集合 $\{v_i\}_{i\in I}$ が $V$ の基底である
とは任意の $v\in V$ が $v=\sum_{i\in I} a_i v_i$ ($a_i\in K$, 有限個を
除いて $a_i=0$) と一意に表わされることである%
\footnote{この定理が成立する環は体だけである.  体以外の環上の加群では基底が
  取れるとは限らないので状況がずっと複雑になる.  体上のベクトル空間の理論が
  それほど難しくないのは基底が取れるからである.}.  
体上のベクトル空間の理論の出発点になる定理は「任意の体 $K$ 上の
任意のベクトル空間 $V$ は基底 $\{v_i\}_{i\in I}$ を持ち, $I$ の濃度は基底の
取り方によらず $V$ のみによって一意に決まる」という結果である.
$V$ の基底の濃度が有限であるとき $V$ は{\bf 有限次元 (finite dimensional)} 
であると言い, 基底の取り方によらずに決まる基底の元の個数を $V$ の次元と
呼び, $\dim V$ もしくは $\dim_K V$ と表わす.  
基底の濃度が無限であるとき $V$ は{\bf 無限次元 (infinite dimensional)} であ
ると言う.  しかし無限次元のベクトル空間の場合は位相を入れて基底の概念を一般
化しておかないと不便な場合の方が多い. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

以上のように抽象的な定義だけを説明しても何をやりたいのかよくわからないだろう.
そこで以下では典型的な例について説明する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}[行列]
  $K^n$ は体 $K$ 上の $n$ 次元ベクトル空間である.
  我々は $K^n$ を縦ベクトルの空間とみなしてきたのであった.
  行列の空間 $M_n(K)$ も $K$ 上のベクトル空間であり, その次元は $n^2$ である.
  任意の正方行列 $A\in M_n(K)$ は縦ベクトルとの積によって $K^n$ の一次変換を
  定めるのであった.  しかも, $K^n$ の一次変換は正方行列と一対一に対応してい
  るのであった.  
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}[微分作用素]
  実直線上の任意有限回微分可能な複素数値函数全体の
  集合 $C^\infty(\R)$ は自然に $\C$ 上の無限次元ベクトル空間をなす.  
  $f\in C^\infty(\R)$ に対してその導函数 $f'\in C^\infty(\R)$ を対応させる
  写像を $\d$ と書くことにする. 
  このとき $\d$ は $C^\infty(\R)$ の一次変換である.
  任意有限回微分可能な函数 $a\in C^\infty(\R)$ が任意に与えられた
  とき $f\in C^\infty(\R)$ に函数 $a$ と $f$ の積 $af\in C^\infty(\R)$ を対応
  させる写像を乗じられる函数と同じ記号で $a$ と書くことにする. 
  このとき $a$ は $C^\infty(\R)$ の一次変換である.
  $\d$ や $a$ のように函数の空間に作用する一次変換は
  {\bf 作用素もしくは演算子 (operator)} と呼ばれることが多い.
  次の形の作用素は{\bf 常微分作用素 (ordinary differential operator)} と
  呼ばれている:
  \begin{equation*}
    L = a_N \d^N + a_{N-1} \d^{N-1} + \cdots + a_2 \d^2 + a_1 \d + a_0,
    \qquad
    a_i \in C^\infty(\R).
  \end{equation*}
  変数の個数を増やして {\bf 偏微分作用素 (partial differential operator)} も
  同様に定義される. 
  微分作用素の積 (写像の合成) を $\circ$ と書くことにすると%
  \footnote{面倒なので $\circ$ を書かない場合の方が多い.},
  \begin{align*}
    &
    (\d\circ a - a\circ\d)f
    = \d(af) - a(\d f)
    = a'f + af' - af'
    = a'f,
    \\ &
    \therefore\ \d\circ a - a\circ\d = a'
  \end{align*}
  となり, $\d$ と函数倍 $a$ は作用素として一般に非可換になる%
  \footnote{特別に可換になる場合には数学的に非常に面白いことが起こっている場
    合が多い.  互いに可換な微分作用素を構成するという問題は重要である. 
    互いに可換な常微分作用素の組に関しては代数曲面の理論との関係付けることに
    よってかなりよくわかっている.  偏微分作用素の場合に関しては量子可積分系
    との関係から見て, まだたくさんの面白そうな問題が残っている.}.  
  可換になるのは $a$ が定数である場合だけである.
  2つの行列が一般に非可換になるのと同じように2つの微分作用素も一般に非可換に
  なる.  微分作用素は線形写像の重要な例である.
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}[積分作用素]
  閉区間 $[0,1]$ 上の連続な複素数値函数全体の
  集合 $C([0,1])$ は自然に $\C$ 上の無限次元ベクトル空間をなす.  
  閉区間の直積 $[0,1]\times[0,1]$ 常の複素数値連続函数 $K(x,y)$ を任意に取り,
  写像 $T_K:C([0,1])\to C([0,1])$ を次のように定める:
  \begin{equation*}
    (T_K f)(x) = \int_0^1 K(x,y)f(y)\,dy
    \qquad (f\in C([0,1])).
  \end{equation*}
  このとき $T_K$ は $C([0,1])$ の一次変換である.
  $T_K$ は{\bf 核函数 (kernel function)} $K(x,y)$ に対応する
  {\bf 積分作用素 (integral operator)} と呼ばれる.
  積分作用素も線形写像の重要な例である.
  $n$ 次正方行列 $K=[k_{ij}]$ と縦ベクトル $f=\tp{[f_1\ \cdots\ f_n]}$ の
  積 $Kf$ の第 $i$ 成分を $(Tf)_i$ と書くと, 行列の積の定義より
  \begin{equation*}
    (Kf)_i = \sum_{i=1}^n k_{ij}f_j
    \qquad (f=\tp{[f_1\ \cdots\ f_n]}\in K^n).
  \end{equation*}
  この式と上の積分作用素の定義を比較すれば積分作用素は行列の積の定義における有
  限和を積分に置き換えることによって定義されていることがわかる.

  実際には存在しないが, もしも
  \begin{equation*}
    f(x) = \int_0^1 \delta(y-x)f(y)\,dx
  \end{equation*}
  を満たす函数 $\delta(y-x)$ が存在すればそれを核函数に持つ積分作用素
  は恒等写像になる.  $\delta(y-x)$ は函数としては存在しないが, 
  測度 (measure) もしくくは超函数 (distribution) としては存在する%
  \footnote{$\delta(y-x)$ は実際には (写像の意味での) 函数ではないのに 
    (Dirac の){\bf デルタ函数 (delta function)} と呼ばれている.  
    直観的に $\delta(y-x)$ は $y=x$ に無限に近い領域の外で $0$ に
    なり, $y=x$ に無限に近い領域では無限大の値を
    取り, $y$ に関して積分すると $1$ になるような``函数''である.
    Dirac のデルタ函数は Kronecker のデルタの連続版である.
    Kronecker デルタを成分に持つような行列が単位行列になるのと同じように,
    Dirac のデルタ函数を核函数に持つ積分作用素は恒等写像になる.

    超函数 (distribution) は
    問題 \qref{q:rapidly-decreasing-Cinfty-function} で定義されている
    急減少 $C^\infty$ 函数の空間 $\cS(\R)$ に適切な位相を入れたものの
    {\bf 位相的双対空間 (topological dual space)} の元として定義される.  
    函数空間の位相的双対空間の概念を用いれば函数の概念を手軽にかつ大幅に拡張
    できる. 

    函数概念の一般化の仕方にはこの双対空間を用いる Schwartz の方法の
    他に実領域を複素領域に膨らませることによって複素正則函数の実領域における 
    代数的境界値として超函数 {\bf (hyperfunction)} を定義する佐藤幹夫の方法
    がある.
    実軸は複素上半平面と複素下半平面に挟まれている.
    複素上半平面上の正則函数 $F_+(z)$ と複素下半平面上の正則函数 $F_-(z)$ 
    を任意に与えたとき, $f(x) = F_+(x+0i) - F_-(x-0i)$ によって実軸上の佐藤
    の超函数が定義される.  たとえば Dirac のデルタ函数は次のように定義される:
    \begin{equation*}
      \delta(x) 
      = -\frac{1}{2\pi i} 
      \left(
        \frac{1}{x + 0i} - \frac{1}{x - 0i}
      \right).
    \end{equation*}
    これが $\int_{-\infty}^\infty \delta(x)f(x)\,dx = f(0)$ を
    満たしていることは Cauchy の積分公式を形式的に適用すれば確かめられる.
    すなわち複素函数論における Cauchy の積分公式を佐藤超函数の視点から眺めな
    おすと Dirac のデルタ函数が満たすべき公式に見えてしまうのである.
    1変数複素函数論を十分に習得すると1変数の佐藤超函数論を大きな困難抜きに理
    解できるようになる. 
    多変数の場合には多変数複素函数論が必要になるのでずっと難しい.
    
    なお, 核函数として超函数も許すことにすると微分作用素も積分作用素の形で
    表わすことができる. たとえば函数 $a(x)$ をかける作用素と $x$ で微分する
    作用素は
    \begin{equation*}
      \int_{-\infty}^\infty \delta(y-x)a(y)f(y)\,dy = a(x)f(x),
      \qquad
      -\int_{-\infty}^\infty \delta'(y-x)f(y)\,dy = f'(x).
    \end{equation*}
    と表現される.  後者の公式は形式的に部分積分すれば得られる.  
    これらの公式は超函数論によって厳密な数学として正当化可能である.}.
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[急減少 $C^\infty$ 函数の空間]
\label{q:rapidly-decreasing-Cinfty-function}
  $\R$ 上の複素数値函数 $f$ が{\bf 急減少 $C^\infty$ 函数 (rapidly
  decreasing $C^\infty$-function)} であるとは $f$ が $C^\infty$ 
  (任意有限回微分可能) でかつ任意の $m,n=0,1,2,\ldots$ に対して
  \begin{equation*}
    \lim_{x\to\pm\infty} x^m f^{(n)}(x) = 0
  \end{equation*}
  が成立することである.  $\R$ 上の急減少 $C^\infty$ 函数全体のなす無限次元複
  素ベクトル空間を $\cS(\R)$ と表わす.  このとき以下が成立する:
  \begin{enumerate}
  \item $\cS(\R)$ には内積を次のように入れることができる%
    \footnote{内積の公理を満たしていることを示せ.}:
    \begin{equation*}
      \bra f,g\ket = \int_{-\infty}^\infty \cc{f(x)}g(x)\,dx
      \qquad
      \bigl(f,g\in\cS(\R)\bigr).
    \end{equation*}
    (ヒント: 任意の $f,g\in\cS(\R)$ に対して $|x|$ を十分大きく
    すれば $\left|\cc{f(x)}g(x)\right|\le |x|^{-2}$ となる.)
  \item 線形写像 $\d:\cS(\R)\to\cS(\R)$ を $(\d f)(x) = f'(x)$ と
    定めることができる.
  \item 任意の多項式 $a\in\C[x]$ に対して, 
    線形写像 $a:\cS(\R)\to\cS(\R)$ を $(af)(x)=a(x)f(x)$ と
    定めることができる.
  \item 多項式 $a_0,\dots,a_N\in\C[x]$ に対して,
    線形写像 $P=\sum_{n=0}^N a_n \d^n:\cS(\R)\to\cS(\R)$ を
    次のように定めることができる: 
    \begin{equation*}
      Pf = \sum_{n=0}^N a_n f^{(n)}
      \qquad (f\in\cS(\R)).
    \end{equation*}
  \end{enumerate}
  このような $P$ は{\bf 多項式係数の常微分作用素 (ordinary differential
  operator with polynomial coefficients)} と呼ばれている. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

無限次元のベクトル空間の典型的な例は適当な条件を満たす函数全体の空間である.
我々は $V=K^n$ のような有限次元ベクトル空間における直観の多くをある種の函数
全体のなす無限次元ベクトル空間にも適用できる.  有限次元のベクトル空間に関す
る理解は無限次元の場合にも役に立つ.  特に微分作用素や積分作用素に行列に関し
て学んだ考え方や直観を適用することは生産的である%
\footnote{もちろん無限次元の場合には有限次元の場合にはない難しさがある.
  しかしそもそもその困難が無限次元特有の問題であることを認識するためには
  有限次元の場合に関する知識が不可欠である.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$V$ が体 $K$ 上のベクトル空間であるとき, 
$V$ の部分集合 $W$ が加法とスカラー倍で閉じていれば $W$ も自然に体 $K$ 上の
ベクトル空間とみなせる.  そのとき $W$ は $V$ の{\bf ベクトル部分空間 
(vector subspace)} もしくは{\bf 線形部分空間 (linear subspace)} と呼ばれる.
単に{\bf 部分空間 (subspace)} と呼ばれることも多い.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}
  実直線上の複素数値函数全体の集合を $V$ と書くと $V$ は自然に $\C$ 上
  の無限次元ベクトル空間をなす.  
  実直線上の複素数値連続函数全体の集合 $W=C(\R)$ は $V$ の線形部分空間であり,
  実直線上の複素数値連続微分可能函数全体の集合 $U=C^1(\R)$ は $W=C(\R)$ の線形
  部分空間である%
  \footnote{$\R$ 上の複素数値函数は $\R$ の各点ごとに複素数が対応しているので
    連続無限個の複素数の組だとみなすことができる.  しかし実際にはすべての函数
    をまとめて考えると意味のある議論はできないので, 連続性や微分可能性を仮定し
    たりするので単に無限個の数字が並んでいるだけとはみなせなくなる.}.
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  以上に登場した例のどれか1つを詳細に解説してみよ. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $V$ は複素ベクトル空間であり, $H$ と $A$ は $V$ の一次変換で
  あり, ある $\alpha\in\C$ について $[H,A]=\alpha A$ を満たしているとする%
  \footnote{$[H,A]=HA - AH$ である.}.
  このとき $v\in V$ が $H$ の固有値 $\beta$ に属する固有ベクトルで
  かつ $Av\ne 0$ ならば $Av$ は $H$ の固有値 $\alpha+\beta$ に属する
  固有ベクトルになる. \qed
\end{question}

\noindent
ヒント: $[H,A]=\alpha A$ は $HA = A(\alpha+H)$ と書き直される.
よって $Hv=\beta v$ ならば $HAv = A(\alpha+H)v = (\alpha+\beta)Av$.
\qed

\medskip
\noindent
参考: 固有ベクトル (もしくは函数空間に作用する作用素の固有函数) を
具体的に求めるために上の問題の方法は非常によく使われる.
その典型例は量子調和振動子 \qref{q:quantum-harmonic-oscillator} の場合である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$U$, $V$ は体 $K$ 上のベクトル空間であるとし, $f:U\to V$ は線形写像であると
する.  このとき $f$ の{\bf 核 (kernel)} $\Ker f$ 
と{\bf 像 (image)} $\Image f$ が次のように定義される%
\footnote{実はさらに{\bf 余核 (cokernel)} $\Coker f$ 
  と{\bf 余像 (coimage)} $\Coimage f$ が次のように定義される:
  \begin{equation*}
    \Coker f = V/\Image f,
    \qquad 
    \Coimage f = U/\Ker f.
  \end{equation*}
  準同型定理とは「自然な同型 $\Coimage f \isomto \Image f$ が存在する」とい
  う結果のことである.}:
\begin{equation*}
  \Ker f = f^{-1}(0) = \{\, u\in U \mid f(u) = 0 \,\},
  \qquad
  \Image f = f(U) = \{\, f(u) \mid u \in U \,\}.
\end{equation*}
$\Ker f$, $\Image f$ はそれぞれ $U$, $V$  の部分空間をなす%
\footnote{$\Ker f$ を求める問題は $f(u)=0$ の形の一次方程式を解くことに対応
  しており, $\Image f$ を求める問題は $u$ に関する一次方程式 $f(u)=v$ が解を
  持つような $v$ の全体を求めることに対応している.  これらの二種類の一次
  方程式の理論は線形写像の核と像の理論に集約されることになる.}.

\begin{question}
\label{q:Ker-Image-1}
  上の設定のもとでさらに $U$ が有限次元ならば
  \begin{equation*}
    \dim U - \dim\Ker f = \dim\Image f.
    \qed
  \end{equation*}
\end{question}

\noindent
結論の直観的な説明%
\footnote{論理的な説明と直観的な説明の両方が重要である.  論理と直観は数学を
  やる上でどちらも不可欠である.}: %
$n=\dim U$ と置く.
線形写像 $f$ は $n$ 次元ベクトル空間 $U$ 
を $k$ 次元分の方向を潰して $V$ の中に移すとする.
そのとき $f$ による $U$ の像の次元は $k$ 次元潰れた分だけ下がって $n-k$ 
になる. これが上の問題の結論の直観的意味である.  上の問題の結論を書き直した
\begin{equation*}
    \dim U - \dim\Image f = \dim\Ker f.
\end{equation*}
という式の直観的意味は次のように説明される.  
線形写像 $f$ は $n$ 次元ベクトル空間 $U$ を $V$ の中の $l$ 次元の部分空間う
つすとする.  $n$ 次元が $l$ 次元に移されるためには $n-l$ 次元分の方向をつ
ぶしてうつさなければいけない.  たとえば直方体を長方形にうつすためにはある1つ
の方向について潰さなければいけない.  直方体を線分にうつすためには2つの方向に
ついて潰さなければいけない.  その潰す方向の本数が $f$ の核 $\Ker f$ の次元な
のである.

\medskip
\noindent
ヒント1: $k = \dim\Ker f$ と置く.  $\Ker f$ の基底 $u_1,\dots,u_k$ を取り, 
それに $u_{k+1},\dots,u_n$ を付け加えて $U$ 全体の基底を構成できる.
そのとき $v_i=f(u_{k+i})$ と置くと $v_1,\dots,v_{n-k}$ は $\Image f$ の基底
をなす. 
\qed

\medskip
\noindent
ヒント2: 準同型定理 $U/\Ker f \isomto \Image f$ 
より $\dim\Image f = \dim(U/\Ker f) = \dim U - \dim\Ker f$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Ker-Image-2}
  $V_i$ は体 $K$ 上の有限次元ベクトル空間であるとし, 
  次の線形写像の列を考える:
  \begin{equation*}
  \begin{CD}
    V_1 @>f_1>> V_2 @>f_2>> \cdots @>f_{s-1}>> V_s @>f_s>> V_{s+1}.
  \end{CD}
  \end{equation*}
  この列を $f_1$ から $f_i$ まで合成してできる $V_1$ から $V_k$ への線形写像
  を $f_i\circ\cdots\circ f_1$ ($i=0$ のときは $\id_{V_1}$) と書くことにする.
  このとき
  \begin{equation*}
    \sum_{i=1}^s \dim(\Ker f_i \cap \Image(f_{i-1}\circ\cdots\circ f_1))
    = \dim\Ker(f_s\circ\cdots\circ f_1).
  \end{equation*}
  よって,
  \begin{equation*}
    \sum_{i=1}^s \dim\Ker f_i
    \ge \dim\Ker(f_s\circ\cdots\circ f_1).
    \qed
  \end{equation*}
\end{question}

\noindent
結論の直観的な説明: 線形写像 $f_1,\dots,f_s$ によって $n$ 次元
ベクトル空間 $V_1$ を順次潰してより小さな次元のベクトル空間に
うつすことを考える.  
最終的に潰れる次元 $\dim\Ker(f_s\circ\cdots\circ f_1)$ は
各ステップで潰れる
次元 $\dim(\Ker f_i \cap \Image(f_{i-1}\circ\cdots\circ f_1))$ の総和になる.
$\Image(f_{i-1}\circ\cdots\circ f_1)$ は $f_{i-1}\circ\cdots\circ f_1$ でつ
ぶした結果の像であり, $\Ker f_i$ は $f_i$ が $V_i$ 全体をどれだけ潰すかを意
味している. $f_i$ は $\Image(f_{i-1}\circ\cdots\circ f_1)$ 
を $\Ker f_i \cap \Image(f_{i-1}\circ\cdots\circ f_1)$ の分だけ潰す.

\medskip
\noindent
ヒント: $g_i=f_i\circ\cdots\circ f_1$ ($g_0=\id_{V_1}$) と置く.
問題 \qref{q:Ker-Image-1} の結論
を $\dim U - \dim\Image f = \dim\Ker f$ と変形
して, $f_i$ の $\Image g_{i-1}$ への
制限 $f_i|_{\Image g_{i-1}}
:\Image g_{i-1}\to V_{i+1}$ に適用すると
\begin{equation*}
  \dim\Image g_{i-1} - \dim\Image g_{i-1}
  = \dim(\Ker f_i\cap\Image g_{i-1})
\end{equation*}
となることがわかる.  
この等式を $i=1,\dots,s$ について足し上げる
と, $\Image g_0 = \dim V_1$, $g_s=f_s\circ\cdots\circ f_1$ なので
\begin{equation*}
    \sum_{i=1}^s \dim(\Ker f_i \cap \Image g_{i-1}) 
    = \dim V_1 - \dim\Image(f_s\circ\cdots\circ f_1)
    = \dim\Ker(f_s\circ\cdots\circ f_1).
\end{equation*}
$\dim\Ker f_i\ge\dim(\Ker f_i \cap \Image g_{i-1})$ なので
ただちに次が導かれる:
\begin{equation*}
  \sum_{i=1}^s \dim\Ker f_i
  \ge \dim V_1 - \dim\Image(f_s\circ\cdots\circ f_1).
\qed
\end{equation*}

\medskip
\noindent
注意: $A\in M_{m,n}(K)$ のとき $A$ が定める線形写像 $A:K^n\to K^m$ に
ついて次が成立している:
\begin{equation*}
   \rank A = \dim\Image A, \qquad  n - \rank A = \dim\Ker A.
\end{equation*}
この演習の一部に登場した $n - \rank A$ という式
は $\dim\Ker A$ を意味している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{固有空間分解}
\label{sec:eigenspace-decomp}

$K$ は任意の体とする.  「任意の体」という言葉が怖い人は $K=\R$ または $\C$ 
と考えて良い.

$K$ 上のベクトル空間 $V$ がその部分空間 $V_1,\dots,V_s$ の直和で
あるとは任意の $v\in V$ が
\begin{equation*}
  v = v_1 + \cdots + v_s,
  \qquad
  v_i\in V_i
\end{equation*}
と一意的に表わされることである%
\footnote{$V_i$ たちの中に $\{0\}$ が混じっていてもこの定義は意味を持ってい
  る.  $V_i=\{0\}$ ならば $V_i$ のベクトルとして $0$ 以外に選びようがないの
  でそのような $V_i$ を除いて考えても直和全体には影響しないが, $V_i=\{0\}$ 
  の場合も含めておく方が良い.}.  %
このとき次のように書く:
\begin{equation*}
  V = \bigoplus_{i=1}^s V_i
    = V_1\oplus\cdots\oplus V_s 
    = V_1\dotplus\cdots\dotplus V_s.
\end{equation*}
$K$ 上のベクトル空間 $V$ と $V$ の一次変換 $A:V\to V$ と $\alpha\in K$ に
対して, $V$ の部分空間 $V_\alpha=V(A;\alpha)$ を次のように定義する:
\begin{equation*}
  V_\alpha = V(A;\alpha) = \{\, v\in V \mid Av = \alpha v \,\}.
\end{equation*}
$V$ が $A$ の固有空間の直和に分解するとは
\begin{equation*}
  V = \bigoplus_{\alpha\in K} V_\alpha = \bigoplus_{\alpha\in K} V(A;\alpha)
\end{equation*}
が成立すること, すなわち任意の $v\in V$ が
\begin{equation*}
  v = \sum_{\alpha\in K} v_\alpha, 
  \quad
  (\text{$v_\alpha\in V_\alpha$ であり, 
    有限個の $\alpha\in K$ を除き $v_\alpha=0$})
\end{equation*}
と一意に表わされることである.
$V_\alpha=V(A;\alpha)\ne 0$ のとき $V(A;\alpha)$ は $A$ の{\bf 固有空間} と
呼ばれ, $V(A;\alpha)$ に含まれる $0$ でないベクトル
を $A$ の{\bf 固有値} $\alpha$ に対応する{\bf 固有ベクトル}と呼ぶ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:xdx+ydy}
  $K$ 上の2変数多項式全体の空間 $V=K[x,y]$ は $A=x\d/\d x+y\d/\d y$ の固有空
  間の直和に分解する. \qed
\end{question}

\noindent
ヒント: $x^my^n$ ($m,n\in\Z_{\ge0}$) は $V=K[x,y]$ の基底である.
\qed

\commentout{
\medskip
\noindent
注意: $K$ の標数が $0$ ならば $x\d/\d x+y\d/\d y$ の
固有値全体の集合は $\Z_{\ge0}$ になり, 
固有空間はすべて有限次元になる.
$K$ の標数が $p>0$ ならば $x\d/\d x+y\d/\d y$ の
固有値全体の集合は $\F_p=\{0,1,2,\dots,p-1\}$ になり, 
同時固有空間はすべて無限次元になる. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\R$ 上の任意有限回微分可能な複素数値函数全体のなす複素ベクトル
  空間を $C^\infty(\R)$ と表わし, 
  その部分空間 $C^\infty(S^1)$ を次のように定義する: 
  \begin{equation*}
    C^\infty(S^1) 
    = \{\, f\in C^\infty(\R) \mid f(x+2\pi) = f(x)\ (x\in\R) \,\}.
  \end{equation*}
  $C^\infty(S^1)$ には内積 $\bra\ ,\ \ket$ を次のように定めることができる%
  \footnote{内積の公理を満たしていることをチェックせよ.}:
  \begin{equation*}
    \bra f,g\ket = \frac{1}{2\pi}\int_0^{2\pi} \cc{f(x)}g(x)\,dx
    \qquad \bigl(f,g,\in C^\infty(S^1)\bigr)
  \end{equation*}
  $\d = d/dx$ と $\Delta= -\d^2$ は $C^\infty(S^1)$ からそれ自身への複素線形
  写像であり, 
  \begin{equation*}
    \bra f,\Delta g\ket = \bra \Delta f, g\ket = \bra \d f, \d g\ket,
    \qquad \bra f,\Delta f\ket = \norm{\d f}^2 \ge 0
  \end{equation*}
  を満たしている($\Delta$ の半正値 Hermite 性).  
  $C^\infty(S^1)$ に作用する作用素 $\Delta$ の固有値と固有函数を
  すべて求めよ.  
  \qed
\end{question}

\noindent
ヒント: $f,g\in C^\infty(S^1)$ に対して
部分積分の公式 $\int_0^{2\pi} f(x)g'(x)\,dx = - \int_0^{2\pi} f'(x)g(x)\,dx$ 
が成立していることを使えば $\Delta$ の半正値 Hermite 性を示せる.
$\Delta$ の半正値 Hermite 性より $\Delta$ の固有値は $0$ 以上の実数になる.
固有値の集合は函数 $u$ に関する
微分方程式 $-u''=\lambda u$ が $C^\infty(S^1)$ の中
に解を持つような $\lambda\ge 0$ の全体に一致し, 
固有函数はそのときの $0$ でない解に一致する%
\footnote{微分方程式論をまだ未習の場合には次の事実を認めて使って良い:
  $-u''=p^2 u$ ($p\in\C$) の $C^\infty(\R)$ における解全体の集合は $2$ 次元
  のベクトル空間をなす.  
  $p\ne 0$ のとき解空間の基底として $e^{ipx}$ と $e^{-ipx}$ が取れ, 
  $p=0$ のとき解空間の基底として $1,x$ が取れる.}.
まず微分方程式 $-u''=\lambda u$ を解き, その解が周期 $2\pi$ を持つ場合を抽出
せよ.
\qed

\commentout{
\medskip
\noindent
略解: 固有値全体の集合は $\{n^2\}_{n\in\Z}=\{0,1,4,9,\ldots\}$ である.
固有値 $0$ に属する固有函数は $1$ の定数倍であり,
$n\ne 0$ のとき固有値 $n^2$ に属する固有函数は $e^{\pm nix}$ の
一次結合になる.  
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:eigenspace-decomp-pre}
  $V$ は $K$ 上のベクトル空間であるとし, $A$ は $V$ の一次変換であるとする.
  $\alpha_1,\dots,\alpha_s\in K$ は $A$ の相異なる固有値
  であり\footnote{相異なる固有値の{\bf 全体}でなくてもよい.}, %
  $\alpha_i$ に対応する固有空間を $V_i$ と書くことにする. 
  このとき, $v_i\in V_i$ かつ $v_1+\cdots+v_s = 0$ 
  ならば $v_1=\cdots=v_s=0$ である. 
  特に $\dim V_1+\cdots+\dim V_s \le \dim V$ である.
  \qed
\end{question}

\noindent
ヒント: $v_1+\cdots+v_s=0$ の両辺に $E,A,A^2,\dots,A^{s-1}$ を
作用させた結果を行列で書くと, 
\begin{equation*}
  \begin{bmatrix}
    1              & 1              & \cdots & 1 \\
    \alpha_1       & \alpha_2       & \cdots & \alpha_s \\
    \vdots         & \vdots         &        & \vdots \\
    \alpha_1^{s-1} & \alpha_2^{s-1} & \cdots & \alpha_s^{s-1} \\
  \end{bmatrix}
  \begin{bmatrix}
    v_1 \\ v_2 \\ \vdots \\ v_s \\
  \end{bmatrix}
  = 0
\end{equation*}
左辺の正方行列の行列式は Vandermonde の公式より $0$ でない.
よって $v_1=\cdots=v_s=0$ である.
このことから $V_i$ の基底の $i=1,\dots,s$ に関する和集合は
一次独立になることが示される. 
よって $\dim V_1+\cdots+\dim V_s \le \dim V$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:eigenspace-decomp}
  $A\in M_n(K)$ を $V=K^n$ の一次変換とみなすとき, $A$ が対角化可能であるこ
  とと $V$ が $A$ の固有空間の直和に分解することは同値である.
  \qed
\end{question}

\noindent
ヒント: $A$ が対角化可能であるならばある正則行列 $P$ で $P^{-1}AP$ が
対角行列になるものが存在する.  そのとき $P$ の中の列ベクトル $p_1,\dots,p_n$ 
は $A$ の固有ベクトルだけで構成された $K^n$ の基底になっている.
固有値 $\alpha_i$ に属する固有ベクトルになっている $p_j$ の
全体を $p_{i,1},\dots,p_{i,n_i}$ と書き, 
これらで張られる $K^n$ の部分空間を $V_i$ と書くことにする.
このとき $V_1\oplus\cdots\oplus V_s=V=K^n$ であり, $V_i=V(A;\alpha_i)$ である%
\footnote{$V_i\subset V(A;\alpha_i)$ であることはすぐにわかる.
  $v\in K^n$ を $v=v_1+\cdots+v_s$, $v_i\in V_i$ と表わしておくと,
  $Av=\alpha_iv$ となるための必要十分条件は $j\ne i$ に対して $v_j=0$ となる
  ことであることがわかる.}.
よって $V(A;\alpha_1)\oplus\cdots\oplus V(A;\alpha_s)=V$ である.
逆にこの条件が成立しているならば $V(A;\alpha_i)$ の基底たち
の $i=1,\dots,s$ に関する和集合を $p_1,\dots,p_n$ と
書き, $P=[p_1\ \cdots\ p_n]$ と置くと, $P^{-1}AP$ は対角行列になる.
\qed

\medskip
\noindent
解説: 行列の性質を行列の成分の操作だけによって理解しようとするのは苦しい.
行列の性質を行列の成分にさわらずにとらえておくと理論の展開が易しくなる場合が
多い.  行列の半単純性を対角化可能性ではなく, 固有空間分解可能性によってとら
えておくと便利な場合が多い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ 上のベクトル空間 $V$ はその一次変換 $A$ の固有空間の直和に分解している
  と仮定する:
  \begin{equation*}
    V = \bigoplus_{\alpha\in K} V_\alpha,
    \qquad
    V_\alpha = V(A;\alpha) = \{\,v\in V\mid Av=\alpha v\,\}.
  \end{equation*}
  すなわち任意の $v\in V$ は 
  \begin{equation*}
    v = \sum_{\alpha\in K} v_\alpha, 
    \quad
    (\text{$v_\alpha\in V_\alpha$ であり, 
      有限個の $\alpha\in K$ を除き $v_\alpha=0$})
  \end{equation*}
  と一意に表わされると仮定する.  $v\in V$ に対して $v_\alpha\in V_\alpha$ を
  対応させる $V$ からそれ自身への写像を $P_\alpha$ と書き, 
  それを $V$ から $V_\alpha$ への{\bf 射影 (projection)} と呼ぶ.
  任意の $v\in V$ に対して $P_\alpha v\ne 0$ となる $\alpha\in K$ は高々有限
  個しか存在しない. さらに次が成立している:
  \begin{equation*}
    V_\alpha = \Image P_\alpha,
    \qquad
    P_\alpha P_{\beta} = \delta_{\alpha,\beta} P_\alpha,
    \qquad
    \sum_{\alpha\in K} P_\alpha = \id_V,
    \qquad
    A = \sum_{\alpha\in K} \alpha P_\alpha.
  \end{equation*}
  ここで $\sum_{\alpha\in K} P_\alpha$ 
  や $\sum_{\alpha\in K} \alpha P_\alpha$ は一般には無限和になってしまうが,
  $P_\alpha v$ は高々有限個の $\alpha$ の除いて $0$ になると仮定してあるので 
  線形写像として well-defined であることに注意せよ. 
  \qed
\end{question}

\noindent
ヒント: 定義を用いて計算するだけで良い.  
たとえば $\id_V v = v = \sum v_\alpha = \sum P_\alpha v$ 
より $\sum P_\alpha = \id_V$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $V$ は体 $K$ 上の任意のベクトル空間であり, 
  各 $\alpha\in K$ に対して線形写像 $P_\alpha:V\to V$ が与えられており,
  任意の $v\in V$ に対して $P_\alpha v\ne 0$ となる $\alpha\in K$ は高々有限
  個しか存在せず, 
  \begin{equation*}
    P_\alpha P_{\beta} = \delta_{\alpha,\beta} P_\alpha,
    \qquad
    \sum_{\alpha\in K} P_\alpha = \id_V
  \end{equation*}
  が成立していると仮定する.  このとき, $V$ の一次変換 $A$ を
  \begin{equation*}
    A = \sum_{\alpha\in K} \alpha P_\alpha
  \end{equation*}
  と定めると, $V$ は $A$ の固有空間 $\Image P_\alpha$ の直和に分解される. \qed
\end{question}

\noindent
ヒント: $\sum P_\alpha = \id_V$ 
より $v = \sum P_\alpha v$ であるから, 
任意の $v\in V$ は $v = \sum v_\alpha$ ($v_\alpha\in\Image P_\alpha$ は有限
個を除いて $0$) と表わされる. 
$P_\alpha P_{\beta} = \delta_{\alpha,\beta} P_\alpha$ 
より, $\sum v_\beta = 0$ ($v_\beta\in\Image P_\beta$ は有限個を除いて $0$) 
のとき, $0 = P_\alpha\sum v_\beta = v_\alpha$ である.  これより表示の一意性
が出るので $V = \bigoplus\Image P_\alpha$ である. 
$V(A;\alpha)=\Image P_\alpha$ となることもすぐにわかる.
\qed

\medskip
\noindent
解説: 以上の2つ問題によって $K$ 上のベクトル空間 $V$ がその一次変換 $A$ の固
有空間の直和に分解されるための必要十分条件は
ある線形写像 $P_\alpha:V\to V$ ($\alpha\in K$) で
任意の $v\in V$ に対して $P_\alpha v\ne 0$ となる $\alpha\in K$ は高々有限
個しか存在せず, 
\begin{equation*}
  P_\alpha P_{\beta} = \delta_{\alpha,\beta} P_\alpha,
  \qquad
  \sum_{\alpha\in K} P_\alpha = \id_V
\end{equation*}
を満たしているものが存在し, これらによって $A$ が
\begin{equation*}
  A = \sum_{\alpha\in K} \alpha P_\alpha
\end{equation*}
と表示できることであることがわかった.  
このとき $V(A;\alpha)=\Image P_\alpha$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$V$ は $K$ 上の任意のベクトル空間であるとし, $A$, $B$ は $V$ の一次変換であ
るとする.  $V$ の部分空間 $V_{\alpha,\beta} = V(A,B;\alpha,\beta)$ を次
のように定める: 
\begin{equation*}
  V_{\alpha,\beta} = V(A,B;\alpha,\beta) =
  \{\, v\in V \mid Av=\alpha v,\ Bv=\beta v \,\}.
\end{equation*}
$V_{\alpha,\beta}=V(A,B;\alpha,\beta)\ne 0$ の
とき $V_{\alpha,\beta}=V(A,B;\alpha,\beta)$ 
は $(A,B)$ の{\bf 同時固有空間} と呼ばれ, 
$V_{\alpha,\beta}=V(A,B;\alpha,\beta)$ に
含まれる $0$ でないベクトルを $(A,B)$ の{\bf 同時固有値}%
\footnote{「同時固有値」という用語はあまり標準的ではない.
  その代わりによく使われるのが「ウェイト (weight)」という用語である.
  $V_{\alpha,\beta}$ に含まれるベクトルをウェイト $(\alpha,\beta)$ を持つベ
  クトルと呼び, $V_{\alpha,\beta}$ をウェイト $(\alpha,\beta)$ のウェイト空
  間と呼ぶことにする場合が多い.} %
$(\alpha,\beta)$ を持つ{\bf 同時固有ベクトル}と呼ぶ.

$V$ が $A,B$ の同時固有空間の直和に分解するとは
\begin{equation*}
  V
  = \bigoplus_{\alpha,\beta\in K} V_{\alpha,\beta}
  = \bigoplus_{\alpha,\beta\in K} V(A,B;\alpha,\beta)
\end{equation*}
が成立すること, すなわち任意の $v\in V$ が
\begin{equation*}
    v = \sum_{\alpha,\beta\in K} v_{\alpha,\beta}
    \quad
    (\text{$v_{\alpha\,\beta} \in V_{\alpha,\beta}$ であり, 
      有限個の $(\alpha,\beta)\in K^2$ を除き $v_{\alpha,\beta}=0$})
\end{equation*}
と一意に表わされることである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ 上の2変数多項式全体の空間 $V=K[x,y]$ 
  は $A=x\d/\d x$ と $B=y\d/\d y$ の同時固有空間の直和に分解する. \qed
\end{question}

\noindent
ヒント: $x^my^n$ ($m,n\in\Z_{\ge0}$) は $V=K[x,y]$ の基底である.
\qed

\commentout{
\medskip
\noindent
注意: $K$ の標数が $0$ ならば $x\d/\d x$ と $y\d/\d y$ の
同時固有値全体の集合は $\Z_{\ge0}\times\Z_{\ge0}$ になり, 
同時固有空間はすべて $1$ 次元になる.
$K$ の標数が $p>0$ ならば $x\d/\d x$ と $y\d/\d y$ の
同時固有値全体の集合は $\F_p\times\F_p$ になり, 
同時固有空間はすべて無限次元になる. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:diag-iff-eigendecomp:A,B}
  $A,B\in M_n(K)$ を $V=K^n$ の一次変換とみなすとき,
  $A,B$ が同時対角化可能であること
  と $V$ が $A,B$ の同時固有空間の直和に分解することは同値である.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:eigenspace-decomp} と同様の議論で良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[同時固有空間分解]
\label{q:eigen-decomp:A,B}
  $A,B$ は $K$ 上のベクトル空間 $V$ の互いに可換な一次変換であり, 
  $V$ が $A$, $B$ それぞれの固有空間の直和に分解するならば,
  $V$ は $A,B$ の同時固有空間の直和に分解する.
  \qed
\end{question}

\noindent
解説: $V=K^n$ ならば同時対角化可能性と同時固有空間分解可能性が同値である
こと \qref{q:diag-iff-eigendecomp:A,B} を使えば
問題 \qref{q:semisimple:A+B} の結果からこの問題の結論が直ちに導かれる.
しかし, それでは無限次元の $V$ の場合の証明にはならない.
行列の成分を操作する「対角化」の概念を用いずに, 
「固有空間分解」のような行列の成分に一切触らずに定義できる概念だけで
証明を閉じておくことも重要である.  
\qed

\medskip
\noindent
ヒント: 仮定より $V=
\bigoplus_{\alpha\in K}V(A;\alpha)=\bigoplus_{\beta\in K}V(B;\beta)$ で
かつ $AB=BA$ である. 
定義より $V(A,B;\alpha,\beta)=V(A;\alpha)\cap V(B;\beta)$ である.

任意の $v\in V$ が有限個の $v_{\alpha,\beta}\in V(\alpha,\beta)$ の有限和で
一意に表わされることを示さなければいけない.

まず表示の一意性を証明しよう. $v_{\alpha,\beta},w_{\alpha,\beta}\in 
V(\alpha,\beta)$ は有限個を除いて $0$ であり,  $v=
\sum_{\alpha,\beta} v_{\alpha,\beta}=
\sum_{\alpha,\beta} w_{\alpha,\beta}$ を満たしていると仮定する.
このとき $u_{\alpha,\beta}=
v_{\alpha,\beta}-w_{\alpha,\beta}\in V(\alpha_i,\beta)$ 
は $\sum_{\alpha,\beta}u_{\alpha,\beta}=0$ を満たしている.  
表示の一意性を示すためには $u_{\alpha,\beta}=0$ を示せば良い.
$u_\alpha:=\sum_\beta u_{\alpha,\beta}$ 
と置くと $u_\alpha\in V(A;\alpha)$ かつ $\sum_\alpha u_\alpha=0$ で
あるから $V=\bigoplus_{\alpha\in K}V(A;\alpha)$ より $u_\alpha=0$ である.
さらに $u_{\alpha,\beta}\in V(B;\beta)$ 
と $V=\bigoplus_{\beta\in K} V(B;\beta)$ より $u_{\alpha,\beta}=0$ が導かれる.
(ここまでは $A$ と $B$ の可換性を使っていない.)

次に表示の存在を証明しよう. 
$V=\bigoplus_{\alpha\in K}V(A;\alpha)$ より任意の $v\in V$ 
は $v=\sum_\alpha v_\alpha$ ($v_\alpha\in V(A;\alpha)$ は有限個を除いて $0$) 
と表わせる.   $V=\bigoplus_{\beta\in K}V(B;\beta)$ より各 $v_\alpha$ 
は $v_\alpha=\sum_\beta v_{\alpha,\beta}$ 
($v_{\alpha,\beta}\in V(B;\beta)$ は有限個を除いて $0$) と表わせる.
このとき 
\begin{equation*}
  \sum_\beta A v_{\alpha,\beta} 
  = A v_\alpha 
  = \alpha v_\alpha
  = \sum_\alpha \alpha v_{\alpha,\beta}, 
  \qquad
  \alpha v_{\alpha,\beta} \in V(B;\beta)
\end{equation*}
であり, $A,B$ の可換性より
\begin{equation*}
  B A v_{\alpha,\beta} 
  = A B v_{\alpha,\beta} 
  = A \beta v_{\alpha,\beta} 
  = \beta A v_{\alpha,\beta}
\end{equation*}
より $A v_{\alpha,\beta}\in V(B;\beta)$ である. 
$V=\bigoplus_{\beta\in K}V(B;\beta)$ 
より $A v_{\alpha,\beta}=\alpha v_{\alpha,\beta}$ 
すなわち $v_{\alpha,\beta}\in V(A;\alpha)$ である.
以上によって $v_{\alpha,\beta}\in V(A;\alpha)\cap V(B;\beta)
=V(A,B;\alpha,\beta)$ であることがわかった.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:semipositive-A-and-A^k}
  複素ベクトル空間 $V$ の半単純一次変換について以下が成立する:
  \begin{enumerate}
  \item $A$ はすべての固有値が非負の実数であるような $V$ の半単純一次変換で
    あり, $k=1,2,3,\ldots$ であるとする.
    このとき $A$ の固有値 $\alpha$ に対応する固有空間 $V(A,\alpha)$ 
    と $A^k$ の固有値 $\alpha^k$ に対応する固有空間 $V(A^k,\alpha^k)$ は等しい.
    よって $V$ の $A$ に関する固有空間分解
    と $A^k$ に関する固有空間分解は一致する.
  \item $A$, $B$ はともにすべての固有値が非負の実数であるような $V$ の半単純
    一次変換であるとし, $k=1,2,3,\ldots$ であるとする. 
    このとき $A^k=B^k$ ならば $A=B$ である%
    \footnote{この結果は「2つの非負の実数 $a$, $b$ が $a^k=b^k$ を満たしている
      ならば $a=b$ である」という事実の行列の場合への拡張になっている.}.
  \item $A$ はすべての固有値が非負の実数であるような $V$ の半単純一次変換で
    あるとし, $k=1,2,3,\ldots$ であるとする.
    このとき $V$ の一次変換 $B$ と $A$ が可換であることと $B$ と $A^k$ と
    可換であることは同値である.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 1. $V(A,\alpha)\subset V(A^k,\alpha^k)$ は常に成立する.
$A$ はすべての固有値が非負の実数であるような半単純一次変換
なので $V=\bigoplus_{\alpha\ge 0}V(A,\alpha)$ である.
$\alpha,\beta\ge0$ のとき $\alpha\ne\beta$ ならば $\alpha^k\ne\beta^k$ 
なので $V(A^k,\alpha^k)\cap V(A^k,\beta^k)=\{0\}$ である.
これより $\alpha\ge 0$ に対して $V(A,\alpha)=V(A^k,\alpha^k)$ で
あることがわかる.

2. 上の結果より $A$ と $A^k$ に関する固有空間分解は等しく, $B$ と $B^k$ に関
する固有空間分解は等しい.  $A^k=B^k$ より $A$ と $B$ の固有値の集合は
等しく, $A$ と $B$ に関する固有空間分解が等しいことがわかる.
よって $A=B$ である.

3. 半単純一次変換 $A$ と任意の一次変換 $B$ が可換であるための必要十分条件
は $A$ の固有空間を $B$ が保つことである.  仮定より $A$ と $A^k$ に関する
固有空間分解は等しいので $B$ と $A$ が可換であることと $B$ と $A^k$ が可換で
あることは同値である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[極分解]
  $A$ は $n$ 次の複素正方行列であるとする.
  このとき固有値のすべてが非負の実数であるような Hermite 行列 $H$ と
  ユニタリー行列 $U$ で $A=HU$ を満たすものが存在する.
  これを $A$ の{\bf 極分解 (polar decomposition)} と呼ぶ.
  $H$ は常に一意的であり, もしも $A$ が可逆ならば $U$ も一意的である.
  そして $A$ が正規行列であることと $H$ と $U$ が可換であることは同値である.
  \qed
\end{question}

\noindent
解説: この問題は「任意の複素数 $z$ は $z=re^{i\theta}$ ($r\in\R_{\ge0}$,
$\theta\in\R$ と表わされ, $r$ は常に一意的であり, 
$z\ne 0$ ならば $e^{i\theta}$ も一意的である」という結果の行列への拡張である.
\qed

\medskip
\noindent
ヒント: 問題 \qref{q:complex-PAQ} の結果より, あるユニタリー行列 $P$, $Q$ 
で $D=P^*AQ$ が対角成分が非負の実数であるような対角行列になるものが存在する.
よって $H=PDP^*$, $U=PQ^*$ と置けば $A=HU$ かつ $H$ は固有値がすべて
非負の Hermite 行列であり, $U$ はユニタリー行列である.
これで極分解の存在が示された.
$A=H_1U_1=H_2U_2$ を $A$ の2つの極分解とすると $AA^*=H_1^2=H_2^2$ が成立する.
よって問題 \qref{q:semipositive-A-and-A^k} の結果より $H_1=H_2$ となる.
これで $H$ の一意性が示された.
もしも $A$ が可逆ならば $H_1=H_2$ も可逆になる.
そのとき $U_1=H_1^{-1}H_2U_2=U_2$ である.
これで可逆な $A$ に対する $U$ の一意性も示された.
$H$ と $U$ が可換であれば $A^*A=U^{-1}H^2U=U^{-1}UH^2=H^2=AA^*$ なので $A$ 
は正規行列になる.  逆に $A$ が正規行列であれば $U^{-1}H^2U=A^*A=AA^*=H^2$ で
あるから $H^2$ と $U$ は可換である. 
よって問題 \qref{q:semipositive-A-and-A^k} の結果より $H$ と $U$ は可換にな
る. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{最小多項式}
\label{sec:minimal-polynomial}

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

$A\in M_n(K)$ に対して, 多項式の集合 $I_A$ を次のように定める%
\footnote{$I$ はイデアル (ideal) の頭文字を取った.  標準的な記法ではない.
  ここだけの記法である.}:
\begin{equation*}
  I_A = \{\, f\in K[\lambda] \mid f(A) = 0 \,\}.
\end{equation*}
このとき $I_A$ は和と任意の多項式倍で閉じている.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-1}
  $I_A\ne 0$. \qed
\end{question}

\noindent
ヒント1: Cayley-Hamilton の定理.
\qed

\noindent
ヒント2: 任意の $f\in K[\lambda]$ に対して $f(A)=0$ ならば $f=0$ と仮定して
矛盾を導こう.  もしもそうならば $E,A,A^2,A^3,\ldots$ は一次独立になる.
よって $n^2$ 次元の $M_n(K)$ が $E,A,A^2,A^3,\ldots$ で張られる無限次元の部
分空間を含むことになって矛盾する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[最小多項式の定義]
\label{q:minimal-polyn-2}
  $I_A$ に含まれる $0$ でない多項式の中で次数が最小でかつモニック%
  \footnote{最高次の係数が $1$ であるという意味.}なものが一意に存在する.
  その多項式を $A$ の{\bf 最小多項式 (minimal polynomial)} と呼び,
  $\varphi_A(\lambda)$ と書くことにする.
  \qed
\end{question}

\noindent
ヒント: 存在は上の問題より.  $f,g\in I_A$ はともに条件を満たしているとする.
このとき $f$ を $g$ で割った商を $q$ と書き, 余りを $r$ と書く.
もしも $q\ne 1$ ならば $f$ または $g$ がモニックでなくなるので $q=1$ である.
もしも $r\ne 0$ ならば $r(A)=0$ より $f,g$ の次数の最小性に矛盾する
ので $r=0$ である.  よって $f=g$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-3}
  $A$ の最小多項式を $\varphi_A$ と書くと $I_A = K[\lambda]\varphi_A$ である.
  すなわち $A$ を代入して $0$ になる任意の多項式は最小多項式の多項式倍で表わ
  される.  特に $A$ の特性多項式は $A$ の最小多項式で割り切れる.
  \qed
\end{question}

\noindent
ヒント: $g\in I_A$ を最小多項式 $\varphi_A$ で割った余りを $r$ とする
と, $r(A)=0$ となるので $\varphi_A$ の次数の最小性より $r=0$ でなければいけ
ない.  よって $g$ は $\varphi_A$ で割り切れる. 
$A$ の特性多項式 $p_A$ は Cayley-Hamilton の定理
より $I_A$ の元なので最小多項式で割り切れる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-4}
  $A\in M_n(K)$ と $P\in GL_n(K)$ に
  対して $A$ と $PAP^{-1}$ の最小多項式は等しい. \qed
\end{question}

\noindent
ヒント: $f\in K[\lambda]$ に対して $f(PAP^{-1})=Pf(A)P^{-1}$ で
あるから $f(A)=0 \iff f(PAP^{-1})=0$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-8}
  $m$ 次正方行列 $B$ と $n$ 次正方行列 $C$ を
  用いて $m+n$ 次正方行列 $A$ を $A =
  \begin{bmatrix}
    B & 0 \\
    0 & C \\
  \end{bmatrix}$ と定める.  
  このとき $A$ の最小多項式 $\varphi_A$ 
  は $B$ の最小多項式 $\varphi_B$ と $C$ の最小多項式 $\varphi_C$ 
  の最小公倍多項式になる.
  \qed
\end{question}

\noindent
ヒント: 最小公倍多項式の定義より, $\varphi_A$ が $\varphi_B$, $\varphi_C$ で
割り切れることと, $f\in K[\lambda]$ が $\varphi_B$, $\varphi_C$ で割り切れる
ならば $f$ は $\varphi_A$ でも割り切れることを示せば良い.
$0=\varphi_A(A)= 
\begin{bmatrix}
  \varphi_A(B) & 0 \\
  0 & \varphi_A(C) \\
\end{bmatrix}$ より $\varphi_A(B)=0$ かつ $\varphi_A(C)=0$.  
よって $\varphi_A$ は $\varphi_B$, $\varphi_C$ で割り切れる.
$f$ が $\varphi_B$, $\varphi_C$ で割り切れるならば $f(B)=0$, $f(C)=0$ 
となるので $f(A) = 0$ となる.  よって $f$ は $\varphi_A$ で割り切れる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-7}
  $A\in M_n(K)$ のとき, 
  $A$ の最小多項式 $\varphi_A$ の $n$ 乗は $A$ の特性多項式 $p_A$ で割り切れる.
  \qed
\end{question}

\noindent
注意: この問題の結果を \qref{q:minimal-polyn-3} の $p_A$ が $\varphi_A$ で割り
切れるという結果を合わせると, $p_A$ と $\varphi_A$ の根が重複度を除き一致して
いることもわかる.
\qed

\medskip
\noindent
ヒント: 
行列係数の多項式に関する剰余定理 \qref{q:matrix-remainder-theorem}
を $\varphi_A(\lambda)E$ に適用すると, ある行列係数多項式 $G(\lambda)$ が存在
して $\varphi_A(\lambda)E = (\lambda E - A)G(\lambda)$ となる.
この等式の両辺の行列式を
取ると $\varphi_A(\lambda)^n=p_A(\lambda)\det G(\lambda)$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-9}
  $\alpha,\beta,\gamma\in K$ は互いに異なると仮定し,
  $x,y,z\in K$ に対して行列 $A,B,C,D$ を次のように定める:
  \begin{equation*}
    A = 
    \begin{bmatrix}
      \alpha & x     & z \\
      0      & \beta & y \\
      0      & 0     & \gamma \\
    \end{bmatrix},
    \quad
    B = 
    \begin{bmatrix}
      \alpha & x      & z \\
      0      & \alpha & y \\
      0      & 0      & \gamma \\
    \end{bmatrix},
    \quad
    C = 
    \begin{bmatrix}
      \alpha & x      & z \\
      0      & \alpha & y \\
      0      & 0      & \alpha \\
    \end{bmatrix},
    \quad
    D =
    \begin{bmatrix}
      0  & 1  & 0 \\
      0  & 0  & 1 \\
      -z & -y & -x \\
    \end{bmatrix}.
  \end{equation*}
  このとき以下が成立する:
  \begin{enumerate}
  \item $A$ の最小多項式は  
    常に $(\lambda-\alpha)(\lambda-\beta)(\lambda-\gamma)$ になる.
  \item $B$ の最小多項式は $(\lambda-\alpha)(\lambda-\gamma)$ 
    または $(\lambda-\alpha)^2(\lambda-\gamma)$ になる.
    そして前者になるための必要十分条件は $x=0$ である.
  \item $C$ の最小多項式は $\lambda-\alpha$ または $(\lambda-\alpha)^2$
    または $(\lambda-\alpha)^3$ のどれかになる.
    そして $(\lambda-\alpha)^2$ になるための必要十分条件%
    \footnote{他の場合は簡単である.}は $xy=0$ である.
  \item $D$ の最小多項式は常に $\lambda^3+x\lambda^2+y\lambda+z$ になる. 
    \\(ヒント: $D$ の特性多項式
    は $p_D(\lambda)=\lambda^3+x\lambda^2+y\lambda+z$ である.
    $K$ は代数閉体だと仮定してあるので, 特性多項式
    は $p_D(\lambda)=(\lambda-a)(\lambda-b)(\lambda-c)$ ($a,b,c\in K$) 
    と一次式の積に分解する.  $(D-aE)(D-bE)$ の一番右上の成分は $1$ になる.)
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-5}
  $\alpha_1,\dots,\alpha_s\in K$ は互いに異なり, 
  $n=n_1+\cdots+n_s$, $n_i>0$ であるとする.  $n$ 次対角行列 $A$ を
  \begin{equation*}
    A =
    \begin{bmatrix}
      \alpha_1 E_{n_1} &                  &        & \bigzerou \\
                       & \alpha_2 E_{n_2} &        & \\
                       &                  & \ddots & \\
      \bigzerol        &                  &        & \alpha_s E_{n_s} \\
    \end{bmatrix}
  \end{equation*}
  と定める.  このとき $A$ の最小多項式
  は $\varphi(\lambda)=(\lambda-\alpha_1)\cdots(\lambda-\alpha_s)$ である.
  \qed
\end{question}

\noindent
ヒント: $\varphi(A)=0$ であることがすぐにわかる.  
$\varphi(A)$ を割り切る次数が $s$ 未満の任意の多項式を $f$ と
すると $f(A)\ne 0$ となることもすぐに確かめられる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-6}
  次の $n$ 次正方行列の最小多項式を求めよ:
  \begin{equation*}
    J_n(\alpha) = \alpha E_n + J_m(0) =
    \begin{bmatrix}
      \alpha &    1   &        &        & \bigzerou \\
             & \alpha &    1   &        & \\
             &        & \alpha & \ddots & \\
             &        &        & \ddots & 1 \\
      \bigzerol &     &        &        & \alpha \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $A=J_n(\alpha)$ の特性多項式は $p_A(\lambda)=(\lambda-\alpha)^n$ と
なる.  実☆☆れ☆そ☆まま☆小☆項☆☆☆る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[コンパニオン行列]
\label{q:minimal-polyn-10}
  次の形の $n$ 次正方行列のを {\bf コンパニオン行列 (同伴行列, 
  companion matrix)} と呼ぶ:
  \begin{equation*}
    C(a_0,\dots,a_{n-1}) =
    \begin{bmatrix}
      0         &    1     &        &      & \bigzerou \\
                &    0     & \ddots &      & \\
                &          & \ddots &  1   & \\
      \bigzerol &          &        &  0   &  1 \\
      -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
    \end{bmatrix}.
  \end{equation*}
  コンパニオン行列 $C(a_0,\dots,a_{n-1})$ の特性多項式は
  \begin{equation*}
    p_{C(a_0,\dots,a_{n-1})}(\lambda)
    = \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-2}
    + \cdots + a_{n-2}\lambda + a_{n-1}
  \end{equation*}
  となり, 最小多項式は特性多項式に等しい.
  \qed
\end{question}

\noindent
ヒント: 行列式 $|\lambda E - C(a_0,\dots,a_{n-1})|$ を第1列について
余因子展開することによって帰納的に特性多項式を計算できる:
{\small
\begin{equation*}
  \begin{vmatrix}
    \lambda &   -1    &        &         & \bigzerou \\
            & \lambda & \ddots &         & \\
            &         & \ddots &    -1   & \\
    \bigzerol &       &        & \lambda & -1 \\
    a_{n-1} & a_{n-2} & \cdots & a_1     & \lambda-a_0 \\
  \end{vmatrix}
  =
  \lambda
  \begin{vmatrix}
    \lambda & -1     &         & \bigzerou \\
            & \ddots & \ddots  & \\
    \bigzerol &      & \lambda & -1 \\
    a_{n-2} & \cdots & a_1     & \lambda-a_0 \\
  \end{vmatrix}
  + (-1)^n a_n
  \begin{vmatrix}
    -1      &        &         & \bigzerou \\
    \lambda & -1     &         & \\
            & \ddots & \ddots  & \\
    \bigzerol &      & \lambda & -1 \\
  \end{vmatrix}.
\end{equation*}
}よって $p_n(\lambda) = p_{C(a_0,\dots,a_{n-1})}(\lambda)$ と
置くと $p_n(\lambda) = \lambda p_{n-1}(\lambda) + a_{n-1}$ である.
最小多項式については次の問題を見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-11}
  次の形の $n$ 次正方行列の最小多項式は特性多項式に等しくなる:
  \begin{equation*}
    A =
    \begin{bmatrix}
      *         & 1      &        & \bigzerou \\
      \vdots    & \ddots & \ddots & \\
      \vdots    &        & \ddots & 1 \\
      \bigstarl & \cdots & \cdots & * \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $A$ の形の行列を $n-1$ 個かけると一番右上の $(1,n)$ 成分
は $1$ になる.  より一般に $A$ の形の行列を $k$ 個かけると次の形になる:
\begin{equation*}
  \begin{bmatrix}
    b_{11}    & \cdots & b_{1,k} & 1      &        & \bigzerou \\
    *         & \ddots &         & \ddots & \ddots & \\
    \vdots    & \ddots & \ddots  &        & \ddots & 1 \\
    \vdots    &        & \ddots  & \ddots &        & b_{n-k+1,n} \\
    \vdots    &        &         & \ddots & \ddots & \vdots \\
    \bigstarl & \cdots & \cdots  & \cdots & *      & b_{nn} \\
  \end{bmatrix}.
\end{equation*}
よって $A$ の特性多項式の根を $\alpha_1,\dots,\alpha_n$ 
と書くと $k<n$ のとき $(A-\alpha_1E)\cdots(A-\alpha_kE)\ne 0$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:minimal-polyn-12}
  問題 \qref{q:minimal-polyn-11} の行列 $A$ に対して,
  対角成分が $1$ の下三角行列 $U$ と $a_1,\dots,a_n\in K$ 
  で $U^{-1}AU = C(a_0,\dots,a_{n-1})$ を満たすものが一意に存在する.
  ここで $C(a_0,\dots,a_{n-1})$ は問題 \qref{q:minimal-polyn-10} で
  定義したコンパニオン行列である. 
  \qed
\end{question}

\noindent
ヒント1: $A$, $U$ の成分に記号を割り振り, 
$U$ と $a_i$ に関する方程式 $AU=UC(a_0,\dots,a_{n-1})$ が一意に解けることを
確かめれば良い.  たとえば $n=3$ のとき,
\begin{align*}
  &
  \begin{bmatrix}
    a_{11} & 1      & 0 \\
    a_{21} & a_{22} & 1 \\
    a_{31} & a_{32} & a_{33} \\
  \end{bmatrix}
  \begin{bmatrix}
    1      & 0      & 0 \\
    u_{21} & 1      & 0 \\
    u_{31} & u_{32} & 1 \\
  \end{bmatrix}
  = 
  \begin{bmatrix}
    a_{11}+u_{21}                    & 1                   & 0 \\
    a_{21}+a_{22}u_{21}+u_{31}       & a_{22}+u_{32}       & 1 \\
    a_{31}+a_{32}u_{21}+a_{33}u_{31} & a_{32}+a_{33}u_{32} & a_{33} \\
  \end{bmatrix},
  \\ &
  \begin{bmatrix}
    1      & 0      & 0 \\
    u_{21} & 1      & 0 \\
    u_{31} & u_{32} & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    0    & 1    & 0 \\
    0    & 0    & 1 \\
    -a_2 & -a_1 & -a_0 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    0    & 1          & 0 \\
    0    & u_{21}     & 1 \\
    -a_3 & u_{31}-a_2 & u_{32}-a_1 \\
  \end{bmatrix}.
\end{align*}
よって $u_{ij}$ と $a_0,a_1,a_2$ に関する方程式 $AU=UC(a_0,a_1,a_2)$ 
は $u_{21}=-a_{11}$, 
$u_{31}=-a_{21}-a_{22}u_{21}$, 
$a_2 = -a_{31}-a_{32}u_{21}-a_{33}u_{31}$, 
$u_{32}=u_{21}-a_{22}$, 
$a_1=u_{31}-a_{32}-a_{33}u_{32}$,
$a_0=u_{32}-a_{33}$ と一意に解ける.
\qed

\medskip
\noindent
ヒント2: 対角成分の1つ右上の成分だけが $1$ で他の成分が $0$ で
あるような $n$ 次正方行列を $\Lambda$ と表わす.
各 $k=0,1,2,\dots$ に対して $(k+1,1),(k+2,2),\dots,(n,n-k)$ 以外の成分が
すべて $0$ であるような下三角行列全体の空間を $V_k$ と書くことにする.
$k\ge n$ の場合は $V_n=0$ と約束しておく.
このとき問題の行列 $A$ は $A=\Lambda+A_0+\cdots+A_{n-1}$, $A_k\in V_k$ と一
意に表わされ, 対角成分がすべて $1$ であるような下三角行列 $U$ 
は $U=E+U_1+\cdots+U_{n-1}$, $U_k\in V_k$ と一意に表わされる.
$(i,j)$ 行列単位を $E_{ij}$ と書き%
\footnote{$(i,j)$ 成分だけが $1$ で他の成分がすべて $0$ である
  正方行列を $(i,j)$ 行列単位と呼び, $E_{ij}$ と書く.}, 
$C_k = -a_kE_{n,n-k}$ と置くと $C_k\in V_k$ であり,
コンパニオン行列 $C=C(a_0,\dots,a_{n-1})$ 
は $C = \Lambda+C_0+\cdots+C_{n-1}$ と表わされる.
このとき $AU=UC$ は $U_k$, $C_k$ に関する次の連立方程式と同値である:
\begin{align*}
  &
  [\Lambda, U_1] - C_0 
  = - A_0,
  \\ &
  [\Lambda, U_2] - C_1 
  = - A_0U_1 - A_1 + U_1C_0,
  \\ &
  [\Lambda, U_3] - C_2 
  = - A_0U_2 - A_1U_1 - A_2 + U_1C_1 + U_2C_0,
  \\ &
  \qquad\qquad\cdots\cdots
  \\ &
  [\Lambda, U_{n-1}] - C_{n-2} 
  = - A_0U_{n-2} - \cdots - A_{n-3}U_1 - A_{n-2} 
  + U_1C_{n-3} + \cdots + U_{n-3}C_0,
  \\ &
  [\Lambda, U_n] - C_{n-1}
  = - A_0U_{n-1} - \cdots - A_{n-2}U_1 - A_{n-1} 
  + U_1C_{n-2} + \cdots + U_{n-2}C_0.
\end{align*}
ここで $U_n=0$ である. 
任意の $Z_k\in V_k$ は $[\Lambda, X_{k+1}] + Y_k$ 
($X_{k+1}\in V_{k+1}$, $Y_k \in K E_{n,n-k}$) と
一意に表わされることを示せる.  
よって上の連立方程式は上から順に一意に解ける.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[最小多項式による半単純性の判定法]
\label{q:minimal-polyn-semisimple}
  $A\in M_n(K)$ が半単純であるための必要十分条件
  は $A$ の最小多項式が重根を持たないことである.
  特に $A$ の特性多項式が重根を持たなければ $A$ は半単純である.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:minimal-polyn-4}, \qref{q:minimal-polyn-5} より
半単純なら最小多項式が重根を持たないことがわかる.
最小多項式 $\varphi_A(\lambda)$ が重根を持たないと仮定する. 
すなわち $\varphi_A(\lambda)=(\lambda-\alpha_1)\cdots(\lambda-\alpha_s)$ と
一次式の積に分解され $\alpha_i$ は互いに異なると仮定する. このとき
\begin{equation*}
  \varphi_A(A)=(A-\alpha_1E)\cdots(A-\alpha_sE)=0
\end{equation*}
であるから, 問題 \qref{q:Ker-Image-2} の結果より
\begin{equation*}
  \sum_{i=1}^s \dim\Ker(A - \alpha_iE) \ge \dim\Ker\varphi(A) = n.
\end{equation*}
$A$ の固有値 $\alpha_i$ に対応する固有空間は $\Ker(A - \alpha_iE)$ 
に等しい.  問題 \qref{q:eigenspace-decomp-pre} の結果より逆向きの不等式が
成立しているので等号が成立する. 
よって $A$ の固有ベクトルだけで構成された $K^n$ の基底 $p_1,\dots,p_n$ が
存在する.  このとき $P=[p_1\ \dots\ p_n]$ は $A$ を対角化する. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[最小多項式の有理的計算法]
  $A\in M_n(K)$ とし, $A$ の最小多項式を $\varphi_A(\lambda)$ と書き,
  特性多項式を $p_A(\lambda)=\det(\lambda E - A)$ と書くことにする.
  $\lambda E - A$ のすべての $(i,j)$ 余因子のモニックな最大公約多項式
  を $d(\lambda)$ と書くと $\varphi_A(\lambda)=p_A(\lambda)/d(\lambda)$ である.
  \qed
\end{question}

\noindent
解説: 行列式の定義より特性多項式と余因子は四則演算だけで計算でき, 
最大公約多項式も Euclid の互除法より四則演算で計算できるので,
正方行列の最小多項式は四則演算だけで計算できることがわかる.
よって代数閉体 $K$ の任意の部分体 $L$ に対して $A\in M_n(L)$ の
最小多項式は $L$ 係数の多項式として四則演算だけで計算できる.
\qed

\medskip
\noindent
ヒント: $\lambda E - A$ の $(i,j)$ 余因子を $f_{ij}(\lambda)$ と
書き, $F(\lambda) = [f_{ij}(\lambda)]$ と置く.  
$d(\lambda)$ は $f_{ij}(\lambda)$ たちの最大公約多項式である
から, ある行列係数多項式 $G(\lambda)$ でその成分の最大公約多項式が $1$ 
で $F(\lambda) = d(\lambda)G(\lambda)$ を満たすものが存在する. 
余因子展開の公式より,
\begin{equation*}
  d(\lambda)\tp{G(\lambda)}(\lambda E - A)
  = \tp{F(\lambda)}(\lambda E - A)
  = p_A(\lambda) E.
\end{equation*}
よって特性多項式 $p_A(\lambda)$ は $d(\lambda)$ で割り切れる.
$f=p_A/d\in K[\lambda]$ と置く
と $\tp{G(\lambda)}(\lambda E - A) = f(\lambda)E$ である.
このとき行列係数多項式の剰余定理 \qref{q:matrix-remainder-theorem} 
より $f(A)=0$ となる.  よって $f(\lambda)$ は最小多項式 $\varphi_A(\lambda)$ 
で割り切れる.  $g=f/\varphi_A\in K[\lambda]$ と置く.
$\varphi_A(\lambda)E$ に行列係数多項式の
剰余定理 \qref{q:matrix-remainder-theorem} を適用するとある行列係数
多項式 $H(\lambda)$ で $\varphi_A(\lambda)E=H(\lambda)(\lambda E - A)$ を満たす
ものが存在する.  この等式の両辺に $g=f/\varphi_A$ をかけ
て左辺に $\tp{G(\lambda)}(\lambda E - A) = f(\lambda)E$ を適用する
と $\tp{G(\lambda)}(\lambda E - A)=g(\lambda)H(\lambda)(\lambda E - A)$ とな
る.  この等式の両辺に右から $\tp{F(\lambda)}$ をかけて $p_A(\lambda)$ で割る
と $\tp{G(\lambda)} = g(\lambda)H(\lambda)$ となる.  ところが $G(\lambda)$ 
の成分たちの最大公約多項式は $1$ なので $g$ は定数でなければいけない.
ところが $g=f/\varphi_A=p_A/(\varphi_A d)$ より $g$ の最高次の係数は $1$ でな
ければいけない. したがって $g=1$ である.  これで $f=\varphi_A$ が示された.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Jordan 分解と一般固有空間分解}
\label{sec:Jordan-decomposition}

行列の Jordan 標準形の話に戻ろう. 

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

\begin{theorem}[Jordan 分解]
  任意の行列 $A\in M_n(K)$ に対して
  半単純行列 $S\in M_n(K)$ と巾零行列 $N\in M_n(K)$ の組
  で $A=S+N$ かつ $SN = NS$ を満たすものが一意に存在する. 
  しかも各 $A$ ごとにある多項式 $g\in K[\lambda]$ 
  で $S = g(A)$, $N = A - g(A)$ を満たすものが存在する.  
  上のような $A=S+N$ を行列 $A$ の{\bf Jordan 分解 (Jordan decomposition)} と
  呼ぶ.  (あとで説明する乗法的 Jordan 分解との区別を強調したい場合は
  {\bf 加法的 Jordan 分解 (additive Jordan decomposition)} と呼ぶ.)
  $S$, $N$ はそれぞれ $A$ の{\bf 半単純部分 (semisimple part)}, 
  {\bf 巾零部分 (nilpotent part)} と呼ばれている.
  \qed  
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

Jordan 分解の証明では\secref{sec:Euclidean-algorithm-K[x]}で特に詳しく説
明した問題 \qref{q:Euclidean-algorithm-3} の結果が決定的に重要な役目を果たす.
その結果をここに再掲しておこう:
\begin{quote}
  $f_1,\dots,f_n\in K[\lambda]$ の最大公約元を $d\in K[\lambda]$ とすると,
  ある $a_1,\dots,a_n\in K[\lambda]$ 
  で $d=a_1f_1+\cdots+a_nf_n$ を満たすものが存在する. \qed
\end{quote}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Jordan 分解の存在]
\label{q:Jordan-decomp-1}
  $A\in M_n(K)$ の Jordan 分解が存在して,
  $A$ の半単純部分と巾零部分が $A$ の多項式で表わされることを
  以下の方針で証明せよ:
  \begin{enumerate}
  \item ある $0$ でないモニックな多項式 $f\in K[\lambda]$ で $f(A)=0$ となる
    ものが存在する.  (ヒント: Cayley-Hamilton の定理もしくは最小多項式の存在.)
  \item $K$ は代数閉体だと仮定してあったので $f$ は一次式の積に分解する:
    \begin{equation*}
      f(\lambda) = (\lambda-\alpha_1)^{m_1}\cdots(\lambda-\alpha_s)^{m_s}.
    \end{equation*}
    ここで $\alpha_1,\dots,\alpha_s\in K$ は互いに異なり, $m_i$ は正の整数で
    ある.  $f_i(\lambda)=f(\lambda)/(\lambda-\alpha_i)^{m_i}$ と置く
    と $f_1,\dots,f_s$ の最大公約多項式は $1$ になる.
    よって問題 \qref{q:Euclidean-algorithm-3} の結果より, 
    ある $a_1,\dots,a_s\in K[\lambda]$ が存在
    して $a_1 f_1 + \cdots + a_s f_s = 1$ となる.
  \item $p_i = a_i f_i$ と置き, $P_i = p_i(A)$ と置くと
    \begin{equation*}
      P_i P_j = \delta_{ij} P_i, 
      \qquad
      P_1 + \cdots + P_s = E.
    \end{equation*}
    (ヒント: $p_1+\cdots+p_s=1$ なので $P_1+\cdots+P_s=E$ である.
    $i\ne j$ のとき $f_if_j$ は $f$ で割り切れるので $f_i(A)f_j(A)=0$.
    よって $P_iP_j=0$ ($i\ne j$).  $P_i=EP_i=(P_1+\cdots+P_s)P_i=P_i^2$.)
  \item $K^n$ の部分空間 $V_i$ 
    を $V_i=\Image P_i = \{\, P_i x \mid x \in K^n \,\}$ と定めると,
    任意の $v\in K^n$ は $v = v_1 + \cdots + v_s$, $v_i\in V_i$ と
    一意に表わされる. 
    (ヒント: 表示の存在は $P_1 + \cdots + P_s = E$ より.
    表示の一意性は $P_i P_j = \delta_{ij} P_i$ より.)
  \item $S = \alpha_1 P_1 + \cdots + \alpha_s P_s$, $N=A-S$ と
    置くと $S$, $N$ は $A$ の多項式になるので, $SN=NS$ である.
  \item $S$ は半単純である.
    (ヒント: $V_i$ たちの基底の和集合を $u_1,\dots,u_n$ と
    書くと $U=[u_1\ \cdots\ u_n]$ は $S$ を対角化する.)
  \item $N$ は巾零である.
    (ヒント: $v_i\in V_i$ に対して $Nv_i = (A - \alpha_iE)v_i$ である.
    $P_i=p_i(A)$ と $A$ は可換なので $Nv_i\in V_i$ である.
    $(\lambda-\alpha_i)^{m_i}p_i(\lambda)=a_i(\lambda)f(\lambda)$ な
    ので $N^{m_i}v_i = (A - \alpha_iE)^{m_i}v_i 
    = a_i(A)f(A)v_i = 0$.
    一般の $v\in V$ は $v=v_1+\cdots+v_s$, $v_i\in V_i$ と
    表わされるので $m = \max\{m_1,\dots,m_s\}$ と置くと $N^mv=0$.)
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Jordan 分解の一意性]
\label{q:Jordan-decomp-2}
  Jordan 分解の一意性を証明せよ. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:Jordan-decomp-1} より $A$ の 
Jordan 分解 $A=S+N$ で $S$, $N$ が $A$ の多項式になるものが存在する.
もう1つの Jordan 分解 $A=S'+N'$ が与えられたとき $S'=S$, $N'=N$ となることを
示せば良い.  $A=S+N=S'+N'$ より $S-S'=N'-N$ である.
Jordan 分解の定義から $S'$ と $N'$ は互いに可換である
ので $A$ とも可換である.  $S$, $N$ は $A$ の多項式なの
で $S'$, $N'$ は $S$, $N$ とも可換である.
よって, 問題 \qref{q:semisimple:A+B} より $S-S'$ も半単純になり,
問題 \qref{q:nilpotent:A+B} より $N'-N$ も巾零になる.
したがって, 問題 \qref{q:ss-cap-nil=0} より $S-S'=N'-N=0$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Jordan-decomp-4}
  $A,B\in M_n(K)$ であるとし $A$ の Jordan 分解を $A=S+N$ ($S$ は半単純, 
  $N$ は巾零) と書いておく.  このとき $A$ と $B$ が可換であるための必要十分
  条件は $B$ が $S$ および $N$ と可換になることである.
  \qed
\end{question}

\noindent
ヒント: $A=S+N$ より $B$ が $S$ および $N$ と可換ならば $A$ とも可換である.
$S$ と $N$ は $A$ の多項式で書けるので,  $B$ が $A$ と可換ならば $S$ お
よび $N$ とも可換である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[一般固有空間分解]
\label{q:generalized-eigenspace}
  $K^n$ は $A$ の一般固有空間
  \begin{equation*}
    W_A(\alpha_i) 
    = \{\, v\in K^n \mid (A-\alpha_i E)^k v = 0\ (\exists k \ge 0)\,\}
    \qquad (i=1,\dots,s)
  \end{equation*}
  の直和に分解される.  ここで $\alpha_1,\dots,\alpha_s$ は $A$ の相異なる固
  有値の全体である.  
  すなわち任意の $v\in V$ は $v=v_1+\cdots+v_s$, $v_i\in W_A(\alpha_i)$ の形
  で一意に表わされる. 
  \qed
\end{question}

\noindent
ヒント:  問題 \qref{q:Jordan-decomp-1} の記号のもと
で $V_i=W_A(\alpha_i)$ が成立することを示せば良い%
\footnote{問題 \qref{q:Jordan-decomp-1} の $f$ は $A$ の固有値以外の根を持た
  ないものが取れる. たとえば $A$ の特性多項式や最小多項式が取れる.
  よって $\alpha_i$ は $A$ の固有値であると考えて良い.}.
$V_i\subset W_A(\alpha_i)$ 
は $(\lambda-\alpha_i)^{m_i}p_i(\lambda)=a_i(\lambda)f(\lambda)$ 
より $(A - \alpha_i E)^{m_i}V_i = a_i(A)f(A)V = 0$ となることより出る.
$V_i\supset W_A(\alpha_i)$ の方は次のように示される.
$(A-\alpha_iE)^kv=0$ と仮定する.
もしも $p_i$ が $\lambda-\alpha_i$ で割り切れる
ならば $p_1+\cdots+p_s=1$ も $\lambda-\alpha_i$ で割り切れるので矛盾する.
よって $p_i(\lambda)$ は $(\lambda-\alpha_i)^k$ と共通因子を持たない.
したがってある多項式 $a,b\in K[\lambda]$ が
存在して $a(\lambda)p_i(\lambda)+b(\lambda)(\lambda-\alpha_i)^k=1$ とな
る.  これの $\lambda$ に $A$ を代入して $v$ に作用させる
と $P_ia(A)v = v$ となる.  よって $v\in P_iK^n=V_i$ である.)
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Jordan 標準形の一歩手前]
\label{q:Jordan-decomp-3}
  正方行列 $A \in M_n(K)$ の Jordan 分解を $A=S+N$ ($S$ は半単純, $N$ は巾零) 
  と書くことにする.  このとき, ある正則行列 $P\in GL_n(K)$ が
  存在して $P^{-1}AP$, $P^{-1}SP$, $P^{-1}NP$ は以下のような形になる:
  {\small
  \begin{align*}
    P^{-1}AP &=
    \begin{bmatrix}
      \alpha_1  & *        & \cdots & \bigstaru & & & & & & \bigzerou \\
                & \alpha_1 & \ddots & \vdots    & & & & & & \\
                &          & \ddots & *         & & & & & & \\
      \bigzerol &          &        & \alpha_1  & & & & & & \\
                & & & & \ddots & & & & \\
                & & & & & \ddots & & & \\
                & & & & & & \alpha_s  & *        & \cdots & \bigstaru \\
                & & & & & &           & \alpha_s & \ddots & \vdots \\
                & & & & & &           &          & \ddots & * \\
      \bigzerol & & & & & & \bigzerol &          &        & \alpha_s \\
    \end{bmatrix},
    \\
    P^{-1}SP &=
    \begin{bmatrix}
      \alpha_1  &          &        &           & & & & & & \bigzerou \\
                & \alpha_1 &        &           & & & & & & \\
                &          & \ddots &           & & & & & & \\
                &          &        & \alpha_1  & & & & & & \\
                & & & & \ddots & & & & \\
                & & & & & \ddots & & & \\
                & & & & & & \alpha_s  &          &        & \\
                & & & & & &           & \alpha_s &        & \\
                & & & & & &           &          & \ddots & \\
      \bigzerol & & & & & &           &          &        & \alpha_s \\
    \end{bmatrix},
    \\
    P^{-1}NP &=
    \begin{bmatrix}
      0         & *        & \cdots & \bigstaru & & & & & & \bigzerou \\
                & 0        & \ddots & \vdots    & & & & & & \\
                &          & \ddots & *         & & & & & & \\
      \bigzerol &          &        & 0         & & & & & & \\
                & & & & \ddots & & & & \\
                & & & & & \ddots & & & \\
                & & & & & & 0         & *        & \cdots & \bigstaru \\
                & & & & & &           & 0        & \ddots & \vdots \\
                & & & & & &           &          & \ddots & * \\
      \bigzerol & & & & & & \bigzerol &          &        & 0 \\
    \end{bmatrix}.
  \end{align*}
  }ここで, $\alpha_1,\dots,\alpha_s$ は $A$ の相異なる固有値の全体で
  あり,  $\alpha_i$ の重複度を $n_i$ と書くと, $P^{-1}AP$ と $P^{-1}SP$ 
  の対角線には各 $\alpha_i$ が $n_i$ 個ずつ並んでおり,
  $P^{-1}AP$ と $P^{-1}NP$ の対角線には $n_i$ 次の上三角行列が並んでいる.

  特に $A$ と $S$ の特性多項式, トレース, 行列式は等しい.
  \qed
\end{question}

\noindent
ヒント: $S$ は半単純なのである正則行列 $Q$ が存在して $Q^{-1}SQ$ は上の形に
なる.  このとき $Q^{-1}NQ$ は $Q^{-1}SQ$ と可換なので
問題 \qref{q:B-commutes-semisimple-A} の結果より次の形になる:
\begin{equation*}
  Q^{-1}NQ = 
  \begin{bmatrix}
    N_1       &        & \bigzerou \\
              & \ddots & \\
    \bigzerol &        & N_s \\
  \end{bmatrix}.
\end{equation*}
ここで $N_i$ は $n_i$ 次の正方行列である.  
$N$ は巾零なので問題 \qref{q:nilpotent:[B,C;0,D]} の結果より $N_i$ たちも巾
零になる.  問題 \qref{q:triangularizable} もしく
は(その一般化である問題 \qref{q:triangulizable:A,B}) より各 $N_i$ に
対してある $n_i$ 次正則行列 $R_i$ が存在して $R_i^{-1}N_iR_i$ は上三角行列に
なる.  $N_i$ は巾零なので $R_i^{-1}N_iR_i$ の対角成分はすべて $0$ でなければ
いけない.  $R_1,\dots,R_s$ を対角線に並べてできる正則行列を $R$ と
書き, $P=QR$ と置く.
このとき $R$ は $Q^{-1}SQ$ と可換なの
で $P^{-1}SP=R^{-1}Q^{-1}SQR = Q^{-1}SQ$ で
あり, $P^{-1}NP=R^{-1}Q^{-1}NQR$ は対角線に $R_i^{-1}N_iR_i$ が並んでいる行
列になる.  よって $P^{-1}SP$ と $P^{-1}NP$ は上に示された形になっている.
そのとき $P^{-1}AP=P^{-1}SP+P^{-1}NP$ も上に示された形になっている.
このとき, $p_A(\lambda)=p_{P^{-1}AP}(\lambda)=p_{P^{-1}SP}(\lambda)
=p_S(\lambda)$ である.  トレースと行列式についても同様である%
\footnote{トレースが特性多項式の $\lambda^{n-1}$ の係数の $-1$ 倍に等しく,
  行列式が特性多項式の定数項の $(-1)^n$ 倍に等しいという結果を使っても良いし,
  トレースは重複を含めた固有値の和に等しく, 行列式は重複を含めた固有値の積に
  等しいという結果を使っても良い.}.
\qed

\medskip
\noindent
解説: 上のヒントは Jordan 分解可能性さえ認めてしまえば, Jordan 標準形の一歩
手前の結果を容易に導けることも示している.  
ただし, Jordan 分解の他に次のような結果も必要になるのだが:
「対角行列と可換な行列がどのような形になるか」
\qref{q:B-commutes-semisimple-A},
「対角線に正方ブロックが並んだ行列が巾零でならば各ブロックも巾零である」
\qref{q:nilpotent:[B,C;0,D]},
「任意の正方行列は相似変換で上三角行列に変換できる」
\qref{q:triangularizable}.
これらの結果は直接的な計算や行列のサイズに関する帰納法で容易に証明可能である.

Jordan 標準形の理論は「途中で使われた結果は後の方で示された結果を認めれば容
易に示されてしまう」という性質を持っている.  だから結論を暗記するためには
後の方で証明されるより強い結果を覚えるようにして, 
その強い結果を認めれば途中で使われた中間的な結果が容易に導かれることをチェッ
クしておけば良い%
\footnote{たとえば Jordan 標準形の一歩手前の結果を認めて Cayley-Hamilton の
  定理を証明してみよ.}.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A\in M_n(K)$ の半単純部分を $S$ と書く.
  $A$ と $S$ の最小多項式が等しくならない場合があることを示せ.
  \qed
\end{question}

\noindent
ヒント: 例を1つ以上示せば良い.  
対角部分が $\alpha E$ であるような上三角行列でそのような例を探してみよ.
(そのとき $S=0$ となる.)
問題 \qref{q:minimal-polyn-9} も参考にせよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

正方行列 $A\in M_n(K)$ が{\bf 巾単 (unipotent)} である
とは $A-E$ が巾零 (nilpotent) になることである.
すなわち $A$ が $A=E+N$ ($N$ は巾零) と表わされるとき $A$ は巾単であるという.

\begin{question}
  巾単行列は正則行列である. \qed
\end{question}

\noindent
ヒント: 等比級数の和の公式 $1/(1+x) = 1 - x + x^2 - x^3 + \cdots$ 
を $A=E+N$, $N^r=0$ に適用せよ.  
$B = E - N + N^2 - N^3 + \cdots + (-1)^rN^r$ (有限和) と
置くと $AB = BA = E$ となる.
\qed

\medskip
\noindent
解説: 行列や作用素の等比級数は{\bf Neumann 級数 (Neumann series)} と
呼ばれている. もしも Neumann 級数 $\sum_{k=0}^\infty (-N)^k$ が
収束すればそれは $E+N$ の逆行列になっている.  
$N$ が巾零ならば Neumann 級数は有限和になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}[乗法的 Jordan 分解]
\label{theorem:mult-Jordan-decomp}
  任意の正則行列 $A\in GL_n(K)$ に対して
  半単純正則行列 $S\in GL_n(K)$ と巾単行列 $U\in GL_n(K)$ の組
  で $A=SU$ かつ $SU = US$ を満たすものが一意に存在する. 
  これを正則行列 $A$ の
  {\bf 乗法的 Jordan 分解 (multiplicative Jordan decomposition)} 
  もしくは{\bf Chevalley 分解 (Chevalley decomposition)} と呼ぶ.
  このとき $S$, $U$ はそれぞれ $A$ の{\bf 半単純部分 (semisimple part)}, 
  {\bf 巾単部分 (unipotent part)} と呼ばれている.
  乗法的 Jordan 分解における半単純部分と加法的 Jordan 分解における半単純部分
  は等しいので, それらを区別する必要はない.
  \qed  
\end{theorem}

\begin{question}
  以下の方針で乗法的 Jordan 分解の存在と一意性を証明せよ.
  \begin{enumerate}
  \item $A$ の Jordan 分解を $A = S + N$ ($S$ は半単純, $N$ は巾零) と書く.
    Jordan 標準形の一歩手前 \qref{q:Jordan-decomp-3} の結果
    より $0\ne\det A=\det S$ である.  よって $S$ も正則行列である.
  \item $U=S^{-1}A=E+S^{-1}N$ と置く. 
    $S$ と $N$ は可換なので $S^{-1}$ と $N$ は可換になり,
    $S^{-1}N$ は巾零になる. よって $U$ は巾単行列である.
  \item $S$ と $S^{-1}N$ は可換なので $U$ と $S$ も可換である. 
    これで乗法的 Jordan 分解の存在が示された.
  \item 逆に $A=SU$ ($S$ は半単純, $U$ は巾単) が乗法的 Jordan 分解
    であるとき, $N=A-S=S(U-E)$ と置くと $A=S+N$ は加法的 Jordan 分解で
    ある.  よって乗法的 Jordan 分解の一意性は加法的 Jordan 分解の一意性に
    帰着する.
    \\(ヒント: $A=SU=S'U'$ ($S,S'$ は半単純, $U,U'$ は巾単) は2種類の
    乗法的 Jordan 分解であるとし, $N=A-S$, $N'=A-S'$ と置く.
    このとき $A=S+N=S'+N'$ は2種類の加法的 Jordan 分解である.
    加法的 Jordan 分解の一意性より $S=S'$, $N=N'$ である.
    このとき $U=S^{-1}A={S'}^{-1}A=U'$ である.)
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{巾零行列の標準形と Jordan 標準形}
\label{sec:Jordan-normal-form}

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

\medskip

任意に正方行列 $A\in M_n(K)$ を取り, 
$A$ の相異なる固有値の全体を $\alpha_1,\dots,\alpha_s$ と書き,
各 $\alpha_i$ の重複度を $n_i$ と書くことにする.

Jordan 標準形の一歩手前 \qref{q:Jordan-decomp-3} の結果によれば, 
ある正則行列 $P\in GL_n(K)$ が存在して $P^{-1}AP$ が対角線には $n_i$ 次の
上三角行列のブロックが並んだ形になり, 
各々のブロックの対角線には $\alpha_i$ が $n_i$ 個並んでいる.
しかし,  $*$ で表示されている非対角線部分の形をどれだけ単純化できるかという
問題はまだ残っている.  以下ではその問題を解くことにしよう.

その問題を解くためは $P^{-1}AP$ の対角線に並んだ各ブロックごとに解けば良い
ので, 最初から $A$ が次の形をしていると仮定して構わない:
\begin{equation*}
  A = \alpha E + N, \qquad
  N = 
  \begin{bmatrix}
    0 & a_{12} & \cdots & a_{1n} \\
      & 0      & \ddots & \vdots \\
      &        & \ddots & a_{n-1,n} \\
    \bigzerol & &       & 0 \\
  \end{bmatrix}.
\end{equation*}
問題は巾零行列 $N$ の形をある正則行列 $P$ による相似変換 $P^{-1}NP$ によって
できるだけ単純化することである.  
$\alpha E$ の部分は任意の $P$ と可換なので無視して構わない.

答を説明するために $m$ 次正方行列 $J_m(\alpha)$ を次のように定義する:
\begin{equation*}
  J_m(\alpha) := 
  \begin{bmatrix}
    \alpha    & 1      &        & \bigzerou \\
              & \alpha & \ddots & \\
              &        & \ddots & 1 \\
    \bigzerol &        &        & \alpha \\
  \end{bmatrix}
  = \alpha E_m + J_m(0),
  \qquad
  J_m(0) =
  \begin{bmatrix}
    0         & 1 &        & \bigzerou \\
              & 0 & \ddots & \\
              &   & \ddots & 1 \\
    \bigzerol &   &        & 0 \\
  \end{bmatrix}.
\end{equation*}
$J_m(\alpha)$ の形の行列を {\bf Jordan ブロック行列 (Jordan block matrix)} 
と呼び, $J_m(0)$ の形の行列を {\bf 巾零 Jordan ブロック行列 (nilpotent Jordan
block matrix)} と呼ぶことにする.  
特に $J_1(\alpha)$ は $1$ 次の正方行列なので
数の $\alpha$ と同一視できる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

さて, 問題の答は以下の通り.

\begin{theorem}[巾零行列の標準形]
\label{theorem:nilpotent-normal-form}
  任意の巾零行列 $N\in M_n(K)$ に対してある正則行列 $P\in GL_n(K)$ 
  をうまく選んで, $P^{-1}NP$ が対角線に
  巾零 Jordan ブロック $J_{m_1}(0),\dots,J_{m_t}(0)$ が並んだ形の行列に
  なるようにできる:
  {\small
  \begin{equation*}
    P^{-1}NP =
    \begin{bmatrix}
      J_{m_1}(0) &        & \bigzerou \\
                 & \ddots & \\
      \bigzerol  &        & J_{m_t}(0) \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      0         & 1        & \cdots & \bigzerou & & & & & & \bigzerou \\
                & 0        & \ddots & \vdots    & & & & & & \\
                &          & \ddots & 1         & & & & & & \\
      \bigzerol &          &        & 0         & & & & & & \\
                & & & & \ddots & & & & \\
                & & & & & \ddots & & & \\
                & & & & & & 0         & 1        & \cdots & \bigzerou \\
                & & & & & &           & 0        & \ddots & \vdots \\
                & & & & & &           &          & \ddots & 1 \\
      \bigzerol & & & & & & \bigzerol &          &        & 0 \\
    \end{bmatrix}.
  \end{equation*}
  }しかも $(m_1,\dots,m_t)$ はその並べ方の順序を除いて $P$ の取り方に
  よらずに $N$ のみから一意に定まる.
  この形の $P^{-1}NP$ を巾零行列 $N$ の Jordan 標準形と呼び, 
  各 $J_{m_i}(0)$ を $N$ の Jordan 細胞と呼ぶ.
  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

我々が目標としている最終定理は次の Jordan 標準形の存在と一意性である.

\begin{theorem}[Jordan 標準形]
\label{theorem:Jordan-normal-form}
  任意の正方行列 $A\in M_n(K)$ に対してある正則行列 $P\in GL_n(K)$ 
  で $P^{-1}AP$ が
  対角線に Jordan ブロック $J_{m_1}(\alpha_1),\dots,J_{m_t}(\alpha_t)$ が
  並んだ形の行列になるようにできる:
  {\small
  \begin{equation*}
    P^{-1}AP =
    \begin{bmatrix}
      J_{m_1}(\alpha_1) &        & \bigzerou \\
                        & \ddots & \\
      \bigzerol         &        & J_{m_t}(\alpha_t) \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      \alpha_1  & 1        &        & \bigzerou & & & & & & \bigzerou \\
                & \alpha_1 & \ddots &           & & & & & & \\
                &          & \ddots & 1         & & & & & & \\
      \bigzerol &          &        & \alpha_1  & & & & & & \\
                & & & & \ddots & & & & \\
                & & & & & \ddots & & & \\
                & & & & & & \alpha_t  & 1        &        & \bigzerou \\
                & & & & & &           & \alpha_t & \ddots & \\
                & & & & & &           &          & \ddots & 1 \\
      \bigzerol & & & & & & \bigzerol &          &        & \alpha_t \\
    \end{bmatrix}.
  \end{equation*}
  }しかも $(m_1,\alpha_1;\dots;m_t,\alpha_t)$ はその並べ方の順序を除い
  て $P$ の取り方によらず, $A$ だけから一意に定まる.
  上の $P^{-1}AP$ を行列 $A$ の
  {\bf Jordan 標準形 (Jordan normal form, Jordan canonical form)} 
  と呼び, 各 $J_{m_i}(\alpha_i)$ を $A$ の 
  {\bf Jordan 細胞 (Jordan cell)} と呼ぶ.
  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

以下における我々の目標は以上の結果を証明することである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:existence-Jordan}
  Jordan 標準形の一歩手前 \qref{q:Jordan-decomp-3} の結果と
  巾零行列の標準形の存在 (\theoremref{theorem:nilpotent-normal-form}の一部) 
  を仮定して, 正方行列の Jordan 標準形の存在 
  (\theoremref{theorem:Jordan-normal-form}の一部) を証明せよ. 
  \qed
\end{question}

\noindent
ヒント: Jordan 標準形の一歩手前 \qref{q:Jordan-decomp-3} の結果より, 
任意の正方行列 $A\in M_n(K)$ に対してある正則行列 $Q\in GL_n(K)$ が
存在して $Q^{-1}AQ$ は次の形になる:
\begin{equation*}
  Q^{-1}AQ = 
  \begin{bmatrix}
    \alpha_1 E_{n_1} &        & \bigzerou \\
                     & \ddots & \\
    \bigzerol        &        & \alpha_s E_{n_s} \\
  \end{bmatrix}
  +
  \begin{bmatrix}
    N_1       &        & \bigzerou \\
              & \ddots & \\
    \bigzerol &        & N_s \\
  \end{bmatrix}.
\end{equation*}
ここで $\alpha_1,\dots,\alpha_s$ は $A$ の相異なる固有値の全体で
あり, $n_i$ は $\alpha_i$ の重複度であり, $N_i$ は $n_i$ 次の巾零行列である.
巾零行列の標準形の存在より, 
各 $N_i$ に対してある正則行列 $R_i\in GL_{n_i}(K)$ が
存在して $R_i^{-1}N_iR_i$ が次の形になる:
\begin{equation*}
  R_i^{-1}N_iR_i =
  \begin{bmatrix}
    J_{m_{i1}}(0) &        & \bigzerou \\
                  & \ddots & \\
    \bigzerol     &        & J_{m_{i,t(i)}}(0) \\
  \end{bmatrix}.
\end{equation*}
$R_i$ を順に対角線に並べてできる行列を $R$ と書き, $P=QR$ と置く.
$\alpha_{ij}=\alpha_i$ ($i=1,\dots,s$, $j=1,\dots,t(i)$) と置き,
$(m_{ij}, \alpha_{ij})$ 全体の番号を付け
直して, $(m_k, \alpha_k)$ ($k=1,\dots,t$) と書く.
このとき $P^{-1}AP$ はちょうど\theoremref{theorem:Jordan-normal-form}の
Jordan 標準形の形になっている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

巾零行列 $N\in M_n(K)$ に対して $V=K^n$ の部分空間 $V_j$ を
次のように定める:
\begin{equation*}
  V_j = \Ker N^j = \{\, v\in V=K^n \mid N^j v = 0 \,\}
  \qquad (j=0,1,2,\ldots).
\end{equation*}
これ以後 $N^{\nu-1}\ne 0$, $N^\nu=0$ であると仮定する.
このとき, $j$ が大きくなるほど $N^j$ の作用で $0$ になるベクトルは増えるので
\begin{equation*}
  0 = V_0 \subset V_1 \subset V_2 \subset 
      \cdots \subset V_{\nu-1} \subset V_\nu = V = K^n.
\end{equation*}
そして $NV_j \subset V_{j-1}$ が成立している.  
この様子と相性の良い $V=K^n$ の基底を取ることが目標である.
(その基底で $N$ を表示すると巾零行列の標準形の形になっている.)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

この段落は一般論であり, 
この段落に限っては $V$ と書いても $K^n$ であるとは限らない.
一般に $K$ 上のベクトル空間 $U$ とその部分空間 $V$ に
対して $U$ の部分空間 $W$ が $V$ の{\bf 補空間 (complement)} である
とは $U$ が $V$ と $W$ の直和分解されること
(すなわち $U=V\oplus W$) である%
\footnote{任意の $u\in U$ が $u=v+w$ ($v\in V$, $w\in W$) と一意的に表わされ
  るとき $U$ は $V$ と $W$ に直和分解されるといい, $U=V\oplus W$ と書く.
  $V$ と $W$ が $U$ の部分空間であるとき $U=V\oplus W$ であるための必要十分
  条件は $U=V+W$ かつ $V\cap W=0$ が成立することである.}.
$V$ の基底を $\{v_i\}_{i\in I}$ とすると
それに一次独立な $U$ のベクトルの集合 $\{w_j\}_{j\in J}$ を追加
して $U$ の基底を構成することができる%
\footnote{$U$ が無限次元の場合は選択公理と同値な Zorn の補題が必要になる.
  Jordan 標準形の理論では有限次元の場合だけを扱うので Zorn の補題を用いた証
  明を知らなくても何も問題がない.}.
そのとき $W$ を $\{w_j\}_{j\in J}$ で張られる $U$ の部分空間%
\footnote{$\sum_{j\in J} b_j w_j$  ($b_j\in K$ は有限個を除いて $0$) の
  形の $U$ のベクトル全体の集合は $U$ の部分空間をなす.  
  それを $\{w_j\}_{j\in J}$ で張られる $U$ の部分空間と呼ぶ.}%
とすると $W$ は $V$ の補空間である.  以下では $U$ の任意の部分空間 $V$ 
の $U$ における補空間 $W$ が存在することを自由に用いる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

さて我々の議論の基礎になるのは次の結果である.

\begin{question}
\label{q:nilp-1}
  上の方の記号のもとで $j=2,\dots,\nu$ に
  対して, $V_j$ における $V_{j-1}$ の補空間 $X_j$ を任意に取る.
  このとき $N$ の $X_j$ への制限は単射である.
  さらに $NX_j\subset V_{j-1}$, $NX_j\cap V_{j-2}=0$ が
  成立しているので $V_{j-1}$ における $V_{j-2}$ の補空間で $NX_j$ を
  含むものが存在する. \qed
\end{question}

\noindent
ヒント: $v\in X_j$, $Nv=0$ ならば $N^{j-1}v=0$ すなわち $v\in V_{j-1}$ とな
り $v\in X_j\cap V_{j-1}=0$ となる. よって $N$ の $X_j$ への制限は単射である.
$X_j\subset V_j$ なので $NX_j\subset NV_j\subset V_{j-1}$ である.
$v\in X_j$ が $Nv\in V_{j-2}$ を満たしているならば $N^{j-1}v=0$ 
すなわち $v\in V_{j-1}$ となるので $v\in X_j\cap V_{j-1}=0$ 
なので $Nv=N0=0$ である.  これで $NX_j\cap V_{j-2}=0$ も示された.
よって $NX_j$ の基底と $V_{j-2}$ の基底の和集合を
拡張して $V_{j-1}$ の基底を構成できる. 
拡張した分と $NX_j$ の基底の和集合で張られる $V_{j-1}$ の
部分空間は $V_{j-1}$ における $V_{j-2}$ の補空間になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

上の問題 \qref{q:nilp-1} の状況で $X_j$ の基底を $x_1,\dots,x_p$ と書き, 
$V_{j-1}$ における $V_{j-2}$ の補空間で $NX_j$ を含むもの
の基底を $Nx_1,\dots,Nx_p$, $y_1,\dots,y_q$ と
取り,  $V_{j-2}$ の基底
を $N^2x_1,\dots,N^2x_p$, $Ny_1,\dots,Ny_q$, $z_1,\dots,z_r$ と
取ると, 以下のように $V_j$, $V_{j-1}$, $V_{j-2}$ の基底が取れたことになる:
\begin{equation*}
  V_j
  \left\{
    \begin{array}{l}
      \hphantom{V_{j-1}\{\}} 
      \hphantom{V_{j-2}\{\}}\;\;
            x_1,\dots,x_p \\
      V_{j-1}
      \left\{
        \begin{array}{l}
          \hphantom{V_{j-2}\{\}} 
            Nx_1,\dots,Nx_p,\;\;\;\; y_1,\dots,y_q \\
          V_{j-2}
          \left\{\;
            N^2x_1,\dots,N^2x_p,\; Ny_1,\dots,Ny_q,\; z_1,\dots,z_r
          \right. \\
        \end{array}
      \right. \\
    \end{array}
  \right.
\end{equation*}
この様子を $V$ 全体に拡張しよう.
そのために $j=\nu,\nu-1,\nu-2,\ldots,1$ と上から順に
$V_j$ の部分空間 $U_j\subset W_j$ を以下のように定める.

まず, $V_\nu$ における $V_{\nu-1}$ の補空間 $U_\nu$ を任意に取り, 
$V_\nu$ の部分空間 $W_\nu$ を次のように定義する:
\begin{equation*}
  W_\nu = U_\nu + NU_\nu + \cdots + N^{\nu-1}U_\nu.
\end{equation*}

次に, $V_{\nu-1}$ における $NU_\nu+V_{\nu-2}$ の補空間 $U_{\nu-1}$ を
任意に取り, $V_{\nu-1}$ の部分空間 $W_{\nu-1}$ を次のように定義する:
\begin{equation*}
  W_{\nu-1} = U_{\nu-1} + NU_{\nu-1} + \cdots + N^{\nu-2}U_{\nu-1}.
\end{equation*}

その次に, $V_{\nu-2}$ における $N^2U_\nu+NU_{\nu-1}+V_{\nu-3}$ の
補空間 $U_{\nu-1}$ を任意に取り,
$V_{\nu-2}$ の部分空間 $U_{\nu-2}$ を次のように定義する:
\begin{equation*}
  W_{\nu-2} = U_{\nu-2} + NU_{\nu-2} + \cdots + N^{\nu-3}U_{\nu-1}.
\end{equation*}

帰納的に $V_j$ の部分空間 $U_j\subset W_j$ が $j=\nu,\nu-1,\dots,k+1$ 
まで構成されたと仮定する.  
もしも $k+1=1$ ならばそれで部分空間の構成を終了する.
もしも $k+1\ge 2$ ならば $V_k$ に
おける $N^{\nu-k}U_\nu+N^{\nu-k-1}U_{\nu-1}+\cdots+NU_{k+1}+V_{k-1}$ の
補空間 $U_k$ を任意に取り, $V_k$ の部分空間 $W_k$ を次のように定義する:
\begin{equation*}
  W_k = U_k + NU_k + \cdots + N^{k-1}U_k.
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:nilp-2}
  以上の構成のもとで以下が成立している:
  \begin{enumerate}
  \item $V = W_1\oplus W_2\oplus\cdots\oplus W_\nu$.
  \item $W_k = U_k\oplus NU_k\oplus\cdots\oplus N^{k-1}U_k$.
  \item $N$ は次の同型写像の列を与える: $
    U_k\isomto NU_k\isomto\cdots\isomto N^{k-1}U_k$. 
    \qed
  \end{enumerate}
\end{question}

\noindent
解説: この問題の結論は $V$ が以下の表にあるベクトル空間の直和に分解
され, 各 $k$ に対して $U_k,NU_k,\dots,N^{k-1}U_k$ はすべて $N$ による対応に
よって同型になるということである:
\begin{equation*}
  \begin{array}{ccccccc}
             U_\nu & & & & & & \\
          N  U_\nu &          U_{\nu-1} & & & & & \\
          N^2U_\nu &       N  U_{\nu-1} &          U_{\nu-2} & & & & \\
            \vdots &             \vdots &             \vdots & \ddots & & & \\
    N^{\nu-3}U_\nu & N^{\nu-4}U_{\nu-1} & N^{\nu-5}U_{\nu-2} & \cdots &    U_3 & & \\
    N^{\nu-2}U_\nu & N^{\nu-3}U_{\nu-1} & N^{\nu-4}U_{\nu-2} & \cdots &   NU_3 &  U_2 & \\
    N^{\nu-1}U_\nu & N^{\nu-2}U_{\nu-1} & N^{\nu-3}U_{\nu-2} & \cdots & N^2U_3 & NU_2 & U_1 \\
  \end{array}
  \tag{$\ast$}
\end{equation*}
そして右から $k$ 番目の縦の列の直和が $W_k$ に等しく, 下から $k$ 段目までの
直和が $V_k$ になる.

\medskip
\noindent
ヒント: 問題 \qref{q:nilp-1} の結果を用いて上の図 ($\ast$) の上の方から順番
に示したい結果が成立していることを証明する.  $U_\nu$ の構成の仕方より
\begin{equation*}
  V=K^n=V_\nu=U_\nu\oplus V_{\nu-1}.
\end{equation*}
問題 \qref{q:nilp-1} より $U_\nu$ は $NU_\nu\subset V_{\nu-1}$ に同型
に移される.  $U_{\nu-1}$ の構成の仕方より
\begin{equation*}
  V_{\nu-1}=NU_\nu\oplus U_{\nu-1}\oplus V_{\nu-2}.
\end{equation*}
問題 \qref{q:nilp-1} より $NU_\nu\oplus U_{\nu-1}$ 
は $N^2U_\nu\oplus NU_{\nu-1}\subset V_{\nu-2}$ に同型にうつされる%
\footnote{同型写像は直和を保つ.}. 
$U_{\nu-2}$ の構成より
\begin{equation*}
  V_{\nu-2} = N^2U_\nu\oplus NU_{\nu-1}\oplus U_{\nu-2}\oplus V_{\nu-2}.
\end{equation*}
以上の議論を帰納的に繰り返せば良い.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

各 $U_k$ の基底 $u_{k1},\dots,u_{k,t_k}$ 任意に取り,
それらを次のような順番に並べる:
\begin{align*}
  &
  u_{11};\;\dots;\; u_{1t_1};
  \\ &
  Nu_{21},u_{21};\;\cdots;\; Nu_{2t_2},u_{2t_2};
  \\ &
  N^2u_{31},Nu_{31},u_{31};\;\cdots;\; N^2u_{3t_3},Nu_{3t_3},u_{3t_3};
  \tag{$\ast\ast$}
  \\ &
  \qquad\qquad\qquad\qquad\cdots\cdots\cdots
  \\ &
  N^{\nu-1}u_{\nu1},\dots,N^2u_{\nu1},Nu_{\nu1},u_{\nu1};\;\cdots;\; 
  N^{\nu-1}u_{\nu t_\nu},\dots,N^2u_{\nu t_\nu},Nu_{\nu t_\nu},u_{\nu t_\nu}.
\end{align*}
問題 \qref{q:nilp-2} よりこれらは $V$ の基底をなす.  
これらの全体を $p_1,\dots,p_n$ と書き $P=[p_1\ \cdots\ p_n]$ と置く.

\begin{question}
\label{q:nilp-3}
  以上の構成のもとで $P^{-1}NP$ は\theoremref{theorem:nilpotent-normal-form}
  の意味で標準形になっている.
  \qed
\end{question}

\noindent
ヒント: ($\ast\ast$) の ($u_{11};\cdots;
N^{\nu-1}u_{\nu t_\nu},\dots,Nu_{\nu t_\nu},u_{\nu t_\nu})$ の
部分列 ($N^{k-1}u_{ki},\dots,Nu_{ki},u_{ki}$) で
張られる $V=K^n$ の部分空間は $N^ku_{ki}=0$ なので $N$ の作用で閉じている.
$N$ を $N^{k-1}u_{ki},\dots,Nu_{ki},u_{ki}$ に作用させると,
\begin{equation*}
  N[N^{k-1}u_{ki}\ \dots\ Nu_{ki}\ u_{ki}]
  = [N^{k-1}u_{ki}\ \dots\ Nu_{ki}\ u_{ki}]
  \begin{bmatrix}
    0         & 1 &        & \bigzerou \\
              & 0 & \ddots & \\
              &   & \ddots & 1 \\
    \bigzerol &   &        & 0 \\
  \end{bmatrix}.
\end{equation*}
よって $P^{-1}NP$ はこの式の右辺に表われた巾零 Jordan ブロックを対角線に並べ
た形になる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

以上によって巾零行列の存在 (\theoremref{theorem:nilpotent-normal-form}の一部) 
が証明された.  よって問題 \qref{q:existence-Jordan} によって Jordan 標準形の
存在 (\theoremref{theorem:Jordan-normal-form}の一部) も証明されたことになる.
あとは Jordan 標準形の一意性だけが問題になる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:nilp-4}
  巾零行列 $N\in M_n(K)$ の $j$ 次の\footnote{「サイズが $j$ の」という意味.}
  Jordan 細胞の個数は
  \begin{equation*}
      (\dim\Ker N^j     - \dim\Ker N^{j-1}) 
    - (\dim\Ker N^{j+1} - \dim\Ker N^j)
  \end{equation*}
  に等しい.  特に巾零 Jordan 細胞の全体 $(J_{m_1}(0),\dots,J_{m_t}(0))$ 
  はその並べ方を除いて巾零行列 $N$ だけから一意に定まる. 
  \qed
\end{question}

\noindent
ヒント: $N' = P^{-1}NP$ が標準形になっていると
仮定し, $N'$ に対して図 ($\ast$) の状況を構成し, $U_j$ の代わりに $U'_j$ と
表わす.  $N'$ は標準形になっているので基底 ($\ast\ast$) は $V=K^n$ の標準的
な基底を並べ直すことによって構成できる. 
その作業を実行すれば $N'$ の中のサイズ $j$ の Jordan 細胞の
個数は $\dim U'_j$ に等しいことがわかる.
$N$, $U_j$ を $N'$, $U'j$ で置き換えた図 ($\ast$) に
おいて下から $j$ 段目までの部分空間の直和は $\Ker{N'}^j$ に等しい.
よって下から $j$ 段目だけの部分空間の直和の次元
は $\dim\Ker {N'}^j - \dim\Ker {N'}^{j-1}$ に等しい.
したがって $U'_j$ の次元は「下から $j$ 段目だけの部分空間の直和の次元」から
「下から $j+1$ 段目だけの部分空間の直和の次元」を引いた数に等しい.
以上によって $N'$ の中のサイズ $j$ の Jordan 細胞の個数は
\begin{equation*}
  \dim U'_j 
  = (\dim\Ker {N'}^j - \dim\Ker {N'}^{j-1}) 
  - (\dim\Ker {N'}^{j+1} - \dim\Ker {N'}^j)
\end{equation*}
に等しい.  ${N'}^j = P^{-1}N^jP$ なので $\dim\Ker{N'}^j = \dim\Ker N^j$ なの
で示したい結果が得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

これで\theoremref{theorem:nilpotent-normal-form} 
(巾零行列の標準形の存在と一意性) が証明された.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:nilp-5}
  正方行列 $A\in M_n(K)$ の固有値 $\alpha$ に属する $j$ 次の Jordan 細胞の
  個数は $B=A-\alpha E$ に対する
  \begin{equation*}
      (\dim\Ker B^j     - \dim\Ker B^{j-1}) 
    - (\dim\Ker B^{j+1} - \dim\Ker B^j)
  \end{equation*}
  に等しい.  
  特に Jordan 細胞の全体 $(J_{m_1}(\alpha_1),\dots,J_{m_t}(\alpha_t))$ 
  はその並べ方を除いて正方行列 $A$ だけから一意に定まる. 
  \qed
\end{question}

\noindent
ヒント: $A' = P^{-1}AP$ が Jordan 標準形になっていると
仮定し, $B'=A'-\alpha E$ の中の巾零 Jordan ブロック全体を対角線に並べてできる
行列を $N'$ と書く.  このとき $\dim\Ker{B'}^j = \dim\Ker (N')^j$ で
あり,  $N'$ の中のサイズ $j$ の巾零 Jordan 細胞の個数
と $A'$ の中の固有値 $\alpha$ に属する $j$ 次の Jordan 細胞の個数に等しい.
よって, 問題 \qref{q:nilp-4} の結果
より, $A'$ の中の固有値 $\alpha$ に属する $j$ 次の Jordan 細胞の個数は
\begin{equation*}
    (\dim\Ker{B'}^j     - \dim\Ker{B'}^{j-1}) 
  - (\dim\Ker{B'}^{j+1} - \dim\Ker{B'}^j)
\end{equation*}
に等しい.  ${B'}^j = P^{-1}B^jP$ なので示したい結果が得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

これで\theoremref{theorem:Jordan-normal-form}
(正方行列の Jordan 標準形の存在と一意性) も証明された.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  次の $n$ 次複素正方行列 $A$ の Jordan 標準形 $J$ と $P^{-1}AP=J$ を
  満たす正則行列 $P$ の例と最小多項式 $\varphi(\lambda)$ を求めよ:
  \begin{equation*}
    A = 
    \begin{bmatrix}
      0   & 1 &        & \\
          & 0 & \ddots & \\
          &   & \ddots & 1 \\
      a^n &   &        & 0 \\
    \end{bmatrix}
    \qquad (a\in \C).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $a=0$ のときは $A$ 自身が Jordan 標準形になっているので, $a\ne 0$ の
場合だけが問題になる.  $a\ne 0$ と仮定する.  
$A$ の特性多項式は $p_A(\lambda)=\lambda^n - a^n$ なので $A$ は互いに
異なる $n$ 個の固有値 $a e^{2\pi ik/n}$ ($k=0,1,\ldots,n-1$) を持つ.  
よって $A$ は☆単☆であり, その Jordan 標準形 $J$ は相異なる固有値を☆角成☆
に並べた対☆☆列になる.  最小多項式は☆☆多☆式に等しい.
固有値 $\alpha_k = a e^{2\pi ik/n}$ に属す固有ベクトルと
して $p_k = \tp{[1\ \alpha_k\ \alpha_k^2\ \cdots\ \alpha_k^{n-1}]}$ が取れる.
これを並べてできる行列を $P$ とすれば $P^{-1}AP=J$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $p$ は任意の素数であるとし, $K$ は標数 $p$ の代数閉体であるとする%
  \footnote{最小の標数 $p$ の代数閉体は $p$ 個の元を持つ
    有限体 $\F_p$ に $1$ の巾根をすべて付け加えてできる $\F_p$ の
    代数閉包 $\closure\F_p$ である.}.
  次のように定められた $p$ 次正方行列 $A\in M_p(K)$ の Jordan 標準形を求めよ:
  \begin{equation*}
    A = 
    \begin{bmatrix}
      0   & 1 &        & \\
          & 0 & \ddots & \\
          &   & \ddots & 1 \\
      a^p &   &        & 0 \\
    \end{bmatrix}
    \qquad (a\in K).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $a=0$ のときは $A$ 自身が Jordan 標準形になっているので, $a\ne 0$ の
場合だけが問題になる.  $a\ne 0$ と仮定する.
一般に標数 $p$ の世界では $(a-b)^p=a^p-b^p$ である.
よって $A$ の特性多項式は $p_A(\lambda)=\lambda^p-a^p=(\lambda-a)^p$ になる.
$(A-aE)^{p-1}$ の一番右上の成分は $1$ になるので $(A-aE)^{p-1}\ne 0$ である
(問題 \qref{q:minimal-polyn-11} のヒントを見よ).
よって $A$ の最小多項式は特性多項式に一致することがわかる%
\footnote{実は問題 \qref{q:minimal-polyn-10} の特殊な場合.}.
したがって $A$ の Jordan 標準形は $J_p(a)$ になる.
\qed

\medskip
\noindent
参考: 標数 $p$ の世界では $(\lambda-a)
(\lambda^{p-1}+a\lambda^{p-2}+a^2\lambda^{p-3}+\cdots+a^{p-2}\lambda+a^{p-1})
=\lambda^p-a^p=(\lambda-a)^p$ であるから, $(\lambda-a)^{p-1}
=\lambda^{p-1}+a\lambda^{p-2}+a^2\lambda^{p-3}+\cdots+a^{p-2}\lambda+a^{p-1}$ 
である. この公式を用いて $(A-aE)^{p-1}$ を計算してみよ.
すると, $K^p$ の標準的基底を $e_1,\dots,e_p$ と
書くとき, $(A-aE)^{p-1}e_p = \tp{[1\ a\ a^2\ \cdots\ a^{p-1}]}\ne 0$ となる
ことがわかる.  よって 
\begin{equation*}
  (A-aE)^{p-1}e_p,\cdots,(A-aE)^2e_p,(A-aE)e_p,e_p
\end{equation*}
は $K^p$ の基底をなし, その基底に関する $A$ の表現は $A$ の Jordan 標準形に
なる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Frobenius-homomorphism}
  $p$ は任意の素数であるとし, $K$ は標数 $0$ の体であるとする. このとき
  任意の $a,b\in K$ に対して $(a+b)^p=a^p+b^p$ かつ $(-a)^p=-a^p$ である%
  \footnote{$(ab)^p=a^pb^p$ であることは明らかなので $a\mapsto a^p$ は $K$ 
    から $K$ 自身への体の準同型写像になっている.  
    これは {\bf Frobenius 準同型 (Frobenius homomorphism)} と呼ばれている.}.
  \qed
\end{question}

\noindent
ヒント: 二項定理より
\begin{equation*}
  (a+b)^p = 
  a^p + \binom{p}{1}a^{p-1}b + \binom{p}{2}a^{p-2}b^2
  + \cdots + \binom{p}{p-2}a^2b^{p-2} + \binom{p}{p-1}ab^{p-1} + b^p.
\end{equation*}
しかし, $\binom{p}{1},\dots,\binom{p}{p-1}$ は $p$ で割り切れる
ので $K$ の中で $0$ になる.  よって $(a+b)^p=a^p+b^p$ である.
特に $b=-a$ と置くと $0 = (a+(-a))^p=a^p+(-a)^p$ である.
よって $(-a)^p=-a^p$ である%
\footnote{次のように考えても良い. 
  $p=2$ のとき $K$ の中で $2=0$ より $a+a=0$ なので $-a=a$ である.
  よって $p=2$ のとき $(-a)^p=(-a)^2=a^2=-a^2$ である.  
  $p$ が奇素数のとき $(-a)^p=-a^p$ である.}.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Jordan-varphi=p}
  正方行列 $A\in M_n(K)$ の特性多項式を $p_A(\lambda)$ と表わす.
  $K$ は代数閉体だと仮定したので特性多項式は次のように一次式の積に分解される:
  \begin{equation*}
    p_A(\lambda) = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}.
  \end{equation*}
  ここで $\alpha_1,\dots,\alpha_s$ たちは $p_A(\lambda)$ の相異なる根の全体
  である.  このとき以下の二条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] $A$ の最小多項式は特性多項式 $p_A(\lambda)$ に一致する.
  \item[(b)] $A$ の Jordan 標準形 $J$ は次の形になる:
    \begin{equation*}
      J = 
      \begin{bmatrix}
        J_{n_1}(\alpha_1) &        & \bigzerou \\
                          & \ddots & \\
        \bigzerol         &        & J_{n_s}(\alpha_s) \\
      \end{bmatrix}.
    \end{equation*}
    すなわち $A$ の各固有値 $\alpha_i$ に属する Jordan 細胞は唯一つになる.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $A$ の固有値 $\alpha_i$ に属する Jordan 細胞のすべてを対角線に並べて
できる $n_i$ 次正方行列を $J_i$ と書くことにする.  
$A$ の Jordan 標準形 $J$ は $J_i$ を対角線に並べた行列になる.  
$A$ の最小多項式は $J$ の最小多項式に等しいので, (a) が成立するための
必要十分条件は $(J_i-\alpha_i)^{n_i-1}\ne 0$ が成立することである.  
それが成立するための必要十分条件は $J_i=J_{n_i}(\alpha_i)$ すなわち (b) が
成立することである.  もしも $J_i$ の中に Jordan 細胞が複数含まれているとすれ
ばある $m<n_i$ で $(J_i-\alpha_i)^m=0$ となってしまうことが簡単に確かめられ
る.  $J_m(0)^{m-1}\ne 0$, $J_m(0)^m=0$ に注意せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{行列方程式 $AX-XB=C$}
\label{sec:AX-XB=C}

すでに行列の対角化や Jordan 標準形の重要な応用先として $A^n$ や $e^{At}$ を
計算する問題があることを\secref{sec:exp}, \secref{sec:2x2}, \secref{sec:3x3}で
説明した.  この節では別の応用先について説明しよう.

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

この節では $A=[a_{ij}]$ は $m$ 次正方行列であると
し, $B=[b_{ij}]$ は $n$ 次正方行列であると
し, $C=[c_{ij}]$ は $(m,n)$ 型行列であるとする.  
すなわち $A\in M_m(K)$, $B\in M_n(K)$, $C\in M_{m,n}(K)$ であるとする.
この節では $X=[x_{ij}]\in M_{m,n}(K)$ に関する
\begin{equation*}
  AX - XB = 0
\end{equation*}
という方程式と
\begin{equation*}
  AX - XB = C
\end{equation*}
という方程式について考える.  これらの方程式は応用上たびたび現われる.

さらに写像 $\phi:M_{m,n}(K)\to M_{m,n}(K)$ を
\begin{equation*}
  \phi(X) = AX - XB
  \qquad (X\in M_{m,n}(K))
\end{equation*}
と定める. このとき $\phi$ は線形写像である. 
実際, $X,Y\in M_{m,n}(K)$, $a,b\in K$ に対して, 
\begin{align*}
  \phi(aX+bY) 
  & = A(aX+bY)-(aX+bY)B = aAX + bBY - aXB - bYB
  \\ &
  = a(AX-XB) + b(AY-YB) = a\phi(X) + b\phi(Y).
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Ker-phi-Image-phi}
  線形写像 $\phi$ の核 (kernel) と像 (image) の定義を説明し, 
  以下の事実を説明せよ:
  \begin{enumerate}
  \item 方程式 $AX-XB=0$ の解全体の集合は $M_{m,n}(K)$ の
    線形部分空間 $\Ker\phi$ に一致する.
  \item 方程式 $AX-XB=C$ の解が存在するような $C\in M_{m,n}(K)$ 全体の
    集合は $M_{m,n}(K)$ の線形部分空間 $\Image\phi$ に一致する.
  \item $X_1$ は方程式 $AX-XB=C$ の任意の解であるとする.  
    このとき方程式 $AX-XB=C$ の解全体の集合は $X_1$ と方程式 $AX-XB=0$ の解
    の和全体の集合と一致する.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Jordan 標準形の理論より, ある正則行列 $P\in GL_m(K)$ と $Q\in GL_n(K)$ が存
在して $J_A=P^{-1}AP$ と $J_B=Q^{-1}BK$ はそれぞれ $A$ と $B$ の Jordan 標準
形になる.  このとき, $Y=PXQ^{-1}$, $D=P^{-1}CQ$ と置けば
方程式 $AX-XB=C$ は方程式 $J_AY-YJ_B=D$ と同値になる.
方程式 $AX-XB=C$ の定性的な性質を調べるためには
最初から $A$, $B$ が Jordan 標準形であると仮定してよい.
そこで $A$, $B$ は Jordan 標準形であると仮定する:
\begin{equation*}
  A = 
  \begin{bmatrix}
    J_{m_1}(\alpha_1) &        & \bigzerou \\
                      & \ddots & \\
    \bigzerol         &        & J_{m_s}(\alpha_s) \\
  \end{bmatrix},
  \qquad
  B = 
  \begin{bmatrix}
    J_{n_1}(\beta_1) &        & \bigzerou \\
                     & \ddots & \\
    \bigzerol        &        & J_{n_t}(\beta_t) \\
  \end{bmatrix}.
\end{equation*}
$X$, $C$ を $(m_\mu,n_\nu)$ 型行列 $X_{\mu\nu}$, $C_{\mu\nu}$ に分割して
\begin{equation*}
  X = 
  \begin{bmatrix}
    X_{11} & \cdots & X_{1t} \\
    \vdots &        & \vdots \\
    X_{s1} & \cdots & X_{st} \\
  \end{bmatrix},
  \qquad
  C = 
  \begin{bmatrix}
    C_{11} & \cdots & C_{1t} \\
    \vdots &        & \vdots \\
    C_{s1} & \cdots & C_{st} \\
  \end{bmatrix}
\end{equation*}
と表わしておく.  このとき方程式 $AX-XB=C$ は次の連立方程式と同値である:
\begin{equation*}
  J_{m_\mu}(\alpha_\mu)X_{\mu\nu}J_{n_\nu}(\beta_\nu) = C_{\mu\nu}
  \qquad (\mu=1,\dots,s,\, \nu=1,\dots,t).
\end{equation*}
これより方程式 $AX-XB=C$ の定性的性質を調べる問題は $A$, $B$ が Jordan ブロ
ック行列である場合に帰着する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:alpha-ne-beta}
  $\alpha\ne\beta$, $A=J_m(\alpha)$, $B=J_n(\beta)$ であるとき
  以下が成立する:
  \begin{enumerate}
  \item 方程式 $AX-XB=0$ の解は $X=0$ 以外に存在しない.
  \item 任意の $C\in M_{m,n}(K)$ に対して $AX-XB=C$ の解が唯一存在する.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント1: $AX$ と $BX$ を具体的に書き下すと,
\begin{align*}
  &
  AX = J_m(\alpha)X =
  \left[
  \begin{array}{llcl}
    \alpha x_{11}    + x_{21} & \alpha x_{12}    + x_{22} & \cdots & \alpha x_{1n}    + x_{2n} \\
    \quad\vdots               & \quad\vdots               &        & \quad\vdots \\
    \alpha x_{m-1,1} + x_{m1} & \alpha x_{m-1,2} + x_{m2} & \cdots & \alpha x_{m-1,n} + x_{m-1,n} \\
    \alpha x_{m1}    + 0      & \alpha x_{m2}    + 0      & \cdots & \alpha x_{m,n}   + 0 \\
  \end{array}
  \right],
  \\ &
  XB = XJ_n(\beta) =
  \left[
  \begin{array}{llcl}
    \beta x_{11}    + 0 & \beta x_{12}    + x_{11}    & \cdots & \beta x_{1n}    + x_{1,n-1} \\
    \quad\vdots         & \quad\vdots                 &        & \quad\vdots \\
    \beta x_{m-1,1} + 0 & \beta x_{m-1,2} + x_{m-1,1} & \cdots & \beta x_{m-1,n} + x_{m-1,n-1} \\
    \beta x_{m1}    + 0 & \beta x_{m2}    + x_{m1}    & \cdots & \beta x_{m,n}   + x_{m,n-1} \\
  \end{array}
  \right].
\end{align*}
まず $AX$ と $XB$ の一番左下の $(m,1)$ 成分を比較する. $\alpha\ne\beta$ と仮
定したので $x_{m1}=0$ であることがわかる.  次に第 $1$ 列を下から順に比較して
行くと $X$ の第 $1$ 列がすべて $0$ であることがわかる.  同様に第 $m$ 行を左
から右に順に比較して行くと $X$ の第 $m$ 行がすべて $0$ であることがわかる.
第 $2$ 列と第 $m-1$ 行以降も左下から上もしくは右に順次成分を比較して行けば
全部 $0$ であることが確かめられる.  よって $AX-XB=0$ の解は $X=0$ だけである.
同様の順序で $AX-XB=C$ の両辺の成分を比較すると, 
任意の $C$ に対して方程式 $AX-XB=C$ の解 $X$ が一意に存在することが確かめら
れる.
\qed

\medskip
\noindent
ヒント2: $AX-XB=0$ の解が $X=0$ だけであることと
問題 \qref{q:Ker-phi-Image-phi} の結果から, 
任意の $C$ に対して $AX-XB=C$ の解が一意に存在することを示せる.
問題 \qref{q:Ker-phi-Image-phi} の 3 より解の一意性が出る.
$\dim\Image\phi = \dim M_{m,n}(K) - \dim\Ker\phi = \dim M_{m,n}(K)$ 
より $\phi$ は全射である.  よって問題 \qref{q:Ker-phi-Image-phi} の 3 より解
の存在が出る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:alpha=beta:AX-XB=0}
  $A=J_m(\alpha)$, $B=J_n(\alpha)$ であるとき以下が成立する:
  \begin{enumerate}
  \item $m\le n$ のとき方程式 $AX-XB=0$ の任意の解は次の形で一意に表わされる:
    \begin{equation*}
      X = 
      \begin{bmatrix}
        0 & \cdots & 0 & x_1 & x_2 & x_3  & \cdots & x_m \\
          & 0 & \cdots & 0   & x_1 & x_2  & \ddots & \vdots \\
          &   & 0 & \cdots   & 0   & x_1  & \ddots & x_3 \\
          &   &   & \ddots   &   & \ddots & \ddots & x_2 \\
        \bigzerol & & &      & 0 & \cdots & 0      & x_1 \\
      \end{bmatrix}.
    \end{equation*}
  \item $m\ge n$ のとき方程式 $AX-XB=0$ の任意の解は次の形で一意に表わされる:
    \begin{equation*}
      X = 
      \begin{bmatrix}
        x_1    & x_2    & x_3    & \cdots & x_n \\
        0      & x_1    & x_2    & \ddots & \vdots \\
        \vdots & 0      & x_1    & \ddots & x_3 \\
        0      & \vdots & 0      & \ddots & x_2 \\
               & 0      & \vdots & \ddots & x_1 \\
               &        & 0      &        & 0 \\
               &        &        & \ddots & \vdots \\
        \bigzerol &     &        &        & 0 \\
      \end{bmatrix}.
    \end{equation*}
  \item 特に方程式 $AX-XB=0$ の解空間 $\Ker\phi$ の次元
    は $\min\{m,n\}$ になる.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $J_m(\alpha)X-XJ_n(\alpha)=J_m(0)X-XJ_n(0)$ なので $\alpha=0$ の場
合に帰着する.  あとはその各成分を具体的に書き表わし, じっと眺めれば問題の結
果が成立していることがわかる.
感じがつかめなければ $(m,n)=(3,5),(4,5),(5,3),(5,4)$ などの
場合に $J_m(0)X-XJ_n(0)$ の全成分を書き下してみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:alpha=beta:AX-XB=C}
  $A=J_m(\alpha)$, $B=J_n(\alpha)$ であるとき以下が成立する:
  \begin{enumerate}
  \item $m\le n$ のとき方程式 $AX-XB=C$ の解が存在するための
    必要十分条件は $C$ が次満たしていることである.
    \begin{align*}
      &
      c_{m1} = 0,
      \\ &
      c_{m-1,1} + c_{m2} = 0,
      \\ &
      \qquad\cdots\cdots
      \\ &
      c_{21} + \cdots + c_{m,m-1} = 0,
      \\ &
      c_{11} + c_{22} + \cdots + c_{mm} = 0.
    \end{align*}
    この条件は $C$ の中の左上から右下に向けて斜めの成分を足し上げたものが
    左下から $m$ 段目まで $0$ になるという条件である.
  \item $m\ge n$ のとき方程式 $AX-XB=C$ の解が存在するための
    必要十分条件は $C$ が次満たしていることである.
    \begin{align*}
      &
      c_{m1} = 0,
      \\ &
      c_{m-1,1} + c_{m2} = 0,
      \\ &
      \qquad\cdots\cdots
      \\ &
      c_{m-n+2,1} + \cdots + c_{m,n-1} = 0,
      \\ &
      c_{m-n+1,1} + c_{m-n+2,2} + \cdots + c_{mn} = 0.
    \end{align*}
    この条件は $C$ の中の左上から右下に向けて斜めの成分を足し上げたものが
    左下から $n$ 段目まで $0$ になるという条件である.
  \item 特に方程式 $AX-XB=C$ が解を持つ $C$ 全体の空間 $\Image\phi$ の
    次元は $mn-\min\{m,n\}$ になる.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $J_m(\alpha)X-XJ_n(\alpha)=J_m(0)X-XJ_n(0)$ なので $\alpha=0$ の場
合に帰着する.  あとはその各成分を具体的に書き表わし, じっと眺めれば問題の結
果が成立していることがわかる.
感じがつかめなければ $(m,n)=(3,5),(4,5),(5,3),(5,4)$ などの
場合に $J_m(0)X-XJ_n(0)$ の全成分を書き下してみよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:A-cap-B=empty}
  $A\in M_m(K)$ の固有値全体の集合と $B\in M_n(K)$ の固有値全体の集合の交わ
  りが空ならば以下が成立する:
  \begin{enumerate}
  \item 方程式 $AX-XB=0$ の解は $X=0$ だけである.
  \item 任意の $C\in M_{m,n}(K)$ に対して方程式 $AX-XB=C$ の解が一意に存在す
    る.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 問題 \qref{q:alpha-ne-beta} に帰着する.
\qed

\medskip
\noindent
解説: この問題の結果は $\det A\ne 0$ ならば任意の $C$ に対して方程式 $AX=C$ 
の解が一意に存在するという結果を含んでいる.  $AX=C$ は $B=0$ の
場合の $AX-XB=C$ という方程式である.  $B=0$ の固有値全体の集合は $\{0\}$ で
ある.  よって $A$ の固有値全体の集合と $B$ の固有値全体の集合の交わりが空で
あるという条件は $A$ のすべての固有値が $0$ でないという条件と同値である.
その条件は $\det A\ne 0$ と同値である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:A=B-generic}
  $m=n$ かつ $A=B$ の場合について考える.
  $A\in M_n(K)$ に対して以下の条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] $A$ の最小多項式は特性多項式に一致する.
  \item[(b)] $A$ の各固有値に属す Jordan 細胞は唯一つである.
  \item[(c)] $X\in M_n(K)$ に関する方程式 $[A,X]=0$ の
    解全体の空間の次元が $n$ になる%
    \footnote{$[A,X]=AX-XA$ である.}.
  \end{enumerate}
  一般に方程式 $[A,X]=0$ の解全体の空間の次元は $n$ 以上になる.
  \qed
\end{question}

\noindent
ヒント: (a)と(b)の同値性は問題 \qref{q:Jordan-varphi=p} である.
よって(b)と(c)の同値性と $[A,X]=0$ の解全体の空間の次元が $n$ 以上である
ことを示すことだけが問題になる. 
最初から $A$ は Jordan 標準形であると仮定して良いので, 解くべき問題は
問題 \qref{q:alpha-ne-beta}, \qref{q:alpha=beta:AX-XB=0} に帰着する.  
たとえば $A$, $X$ が
\begin{equation*}
  A = 
  \begin{bmatrix}
    J_p(\alpha) & 0          \\
    0           & J_q(\beta) \\
  \end{bmatrix},
  \qquad
  X = 
  \begin{bmatrix}
    P & Q \\
    R & S \\
  \end{bmatrix}
\end{equation*}
という形をしている場合に限定すれば以下のように証明される. 
ただしここで $0<p\le q$, $p+q=n$, $P\in M_p(K)$, $Q\in M_{p,q}(K)$, 
$R\in M_{q,p}(K)$, $S\in M_q(K)$ であるとする.  
このとき $[A,X]=0$ は次と同値である:
\begin{alignat*}{2}
  &
  J_p(\alpha)P - PJ_p(\alpha) = 0, \quad
  & &
  J_p(\alpha)Q - QJ_q(\beta)  = 0, \quad
  \\ &
  J_q(\beta)R  - RJ_p(\alpha) = 0, \quad
  & &
  J_q(\beta)S  - SJ_q(\beta)  = 0.
\end{alignat*}
$\alpha\ne\beta$ ならば問題 \qref{q:alpha-ne-beta} の結果
より $Q=0$, $R=0$ であり, 問題 \qref{q:alpha=beta:AX-XB=0} の結果
より $P$ に関する方程式の解空間は $p$ 次元であり, $S$ に関する方程式の解空間
は $q$ 次元になるので, $[A,X]=0$ の解空間の次元は $p+q=n$ になる.
$\alpha=\beta$ ならば問題 \qref{q:alpha=beta:AX-XB=0} の結果
より $P$, $Q$, $R$, $S$ に関する方程式の解空間の次元は
それぞれ $p$, $p$, $p$, $q$ になるので, $[A,X]=0$ の解空間の
次元は $3p+q > n$ となる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $m=n$ かつ $A=B$ の場合について考える.
  $A\in M_n(K)$ が半単純でかつ固有値が重複を持たないと仮定する.
  このとき以下が成立する:
  \begin{enumerate}
  \item 任意の $X\in M_n(K)$ に対して, $[A,X]=0$ が成立すること
    と $A$ と $X$ が同時対角化可能であることは同値である.
  \item 任意の $C\in M_n(K)$ に対して, $X\in M_n(K)$ に関する
    方程式 $[A,X]=C$ の解が存在するための必要十分条件は, 
    ある正則行列 $P\in GL_n(K)$ で $P^{-1}AP$ が対角行列で
    かつ $P^{-1}CP$ の対角成分がすべて $0$ になるものが存在することである.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: $A$ は半単純 (対角化可能) であると仮定しているのでこの問題はすでに 
Jordan 標準形の応用問題ではない.  仮定よりある $P\in GL_n(K)$ 
で $P^{-1}AP=A'=\diag(\alpha_1,\dots,\alpha_n)$ ($\alpha_i$ は互いに異なる) 
となるものが存在する.  $X'=P^{-1}XP$, $C'=P^{-1}CP$ と置けば $[A,X]=C$ 
と $[A',X']=C'$ は同値である.  $[A',X']$ の成分を具体的に
書き下し, $\alpha_i$ たちが互いに異なることに注意すれば問題の結果が容易に示
される.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{量子調和振動子と Hermite の多項式}
\label{sec:Hermite-polynomials}

この節は固有空間分解に関する演習である.

Hermite の多項式は{\bf 量子調和振動子 (quantum harmonic oscillator)} の固有
値問題を解くときに表われる多項式のことである.  量子調和振動子の固有値問題と
は次の常微分微分作用素の二乗可積分な固有函数を全て求めよという問題のことであ
る:
\begin{equation*}
  H = \frac{1}{2m} (-i\hbar \d)^2 + \frac{k}{2} x^2
  = -\frac{\hbar^2}{2m}\d^2 + \frac{k}{2}x^2.
\end{equation*}
ここで $\d = d/dx$ であり, $m,k,\hbar > 0$ である%
\footnote{バネ定数 $k$ のバネの先に質量 $m$ の質点がくっついて
  おりバネの伸び縮みによって振動している状況を考える.
  バネの伸び (縮んだ場合はマイナスの値を取る) を $x$ と書き, 
  質点の運動量を $p=m\dot x$ と書くと, 質点の運動エネルギーは $p^2/(2m)$ と
  なり, 質点の位置エネルギーは $kx^2/2$ となる.  
  よって全エネルギーは $H(p,x) = p^2/(2m) + kx^2/2$ となる.
  この $H(p,x)$ は古典調和振動子の Hamiltonian と呼ばれている.
  そこに $p=-i\hbar\d$ を代入したのが常微分作用素の $H$ である.
  $H$ は量子調和振動子の Hamiltonian と呼ばれており, 
  その固有値は観測したときに見出される全エネルギー
  という物理的意味を持っている. 
  $\hbar=h/(2\pi)$ は {\bf Planck 定数 (Planck constant)} と呼ばれる
  物理定数である.  $h = 6.6260755\times10^{-34}\,\mathrm{Js}$ 
  かつ $\hbar = 1.05457266\times10^{-34}\,\mathrm{Js}$ である.
  $1\,\mathrm{J} = 1\,\mathrm{kg\,m^2/s^2}$.}.
一般の場合は $y = \sqrt{2km}x/\hbar$ と
変数変換すれば上の $H$ は
\begin{equation*}
  H = k \left( -\frac{1}{2}\odfrac{^2}{y^2} + \frac{1}{2}y^2 \right)
\end{equation*}
となる.  よって $m=k=\hbar=1$ の場合の固有値問題が解ければ一般の場合も解ける.
そこで以下では簡単のため $m=k=\hbar=1$ の場合のみを扱う.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[量子調和振動子]
\label{q:quantum-harmonic-oscillator}
  $\R$ 上の急減少 $C^\infty$ 函数全体の空間を $\cS(\R)$ と表わし%
  \footnote{急減少 $C^\infty$ 函数の定義は
    問題 \qref{q:rapidly-decreasing-Cinfty-function} にある.},
  $f e^{-x^2/2}$ ($f\in\C[x]$) の形の函数全体の空間を $\C[x]e^{-x^2/2}$ と
  表わす.  以下を示せ:
  \begin{enumerate}
  \item $\C[x]e^{-x^2/2}$ は $\cS(\R)$ の部分空間である.
  \item $\C[x]e^{-x^2/2}$ は多項式係数の任意の常微分作用素の作用で閉じている.
  \item 多項式係数の常微分作用素 $H$, $a$, $a^*$ を次のように定める:
    \begin{equation*}
      H = - \frac{1}{2}\d^2 + \frac{1}{2}x^2,
      \quad
      a = \frac{i}{\sqrt{2}}(\d + x),
      \quad
      a^* = \frac{i}{\sqrt{2}}(\d - x).
    \end{equation*}
    これらは次を満たしている%
    \footnote{$[A,B] = A\circ A - B\circ A = AB-BA$ である.}:
    \begin{alignat*}{2}
      &
      [a,a^*] = 1, 
      \qquad & &
      H = a^*a + \frac{1}{2},
      \\ &
      [H,a] = - a,
      \qquad & &
      [H,a^*] = a^*,
      \\ &
      \bra f,ag\ket = \bra a^*f,g\ket,
      \qquad & &
      \bra f,Hg\ket = \bra Hf,g\ket.
    \end{alignat*}
    (ヒント: $[\d,x]=1$, $[AB,C]=[A,C]B+A[B,C]$ を用いて計算せよ.
    部分積分によって $\bra f,\d g\ket = -\bra\d f,g\ket$ を示せ.)
  \item $\phi_n = (a^*)^n e^{-x^2/2}\in\C[x]e^{-x^2/2}$ 
    ($n=0,1,2,\ldots$) と置く.  このとき,
    \begin{equation*}
      H \phi_n = \left(n + \frac{1}{2}\right) \phi_n
      \qquad
      (n=0,1,2,\ldots).
    \end{equation*}
    (ヒント: $[H,a^*]=a^*$ より $Ha^*=a^*(H+1)$ で
    あるから $H(a^*)^n = (a^*)^n(H+n)$ であり, 
    $a e^{-x^2/2} = 0$ より $H e^{-x^2/2} = \frac{1}{2} e^{-x^2/2}$ 
    である.  よって $H\phi_n = (a^*)^n(H+n)e^{-x^2/2}
    =\bigl(n+\frac{1}{2}\bigr)(a^*)^ne^{-x^2/2}
    =\bigl(n+\frac{1}{2}\bigr)\phi_n$.)
  \item $\phi_0,\phi_1,\phi_2,\ldots$ は $\C[x]e^{-x^2/2}$ の基底である.
    \\(ヒント: $\phi_n$ を $\phi_n=f_n e^{-x^2/2}$ ($f_n\in\C[x]$) と表わす
    と, $f_n$ は $n$ 次の多項式になる.)
    \qed
  \item $m\ne n$ のとき $\bra \phi_m,\phi_n\ket = 0$.
    \\(ヒント: $\bigl(n+\frac{1}{2}\bigr)\bra\phi_m,\phi_n\ket
    = \bra\phi_m,H\phi_n\ket 
    = \bra H\phi_m,\phi_n\ket
    = \bigl(m+\frac{1}{2}\bigr)\bra\phi_m,\phi_n\ket$.)
  \item $a\phi_n = n \phi_{n-1}$.
    \\(ヒント: $a e^{-x^2/2}=0$ であり, 
    $[a,a^*]=1$ より $[a,(a^*)^n]=n (a^*)^{n-1}$ である%
    \footnote{一般に次が成立している: $$[A,B_1\cdots B_n]
      =\sum_{i=1}^n B_1\cdots B_{i-1}[A,B_i]B_{i+1}\cdots B_n.$$
      これは次の公式 (Leibnitz rule) に似ている: $$\od{x}(f_1\cdots f_n)
      =\sum_{i=1}^n f_1\cdots f_{i-1}\odfrac{f_i}{x}f_{i+1}\cdots f_n.$$}. 
    よって $a\phi_n = a(a^*)e^{-x^2/2} = [a,(a^*)^n]e^{-x^2/2} 
    = n(a^*)^{n-1} e^{-x^2/2} = n\phi_{n-1}$.)
  \item $\norm{\phi_n}^2 = n!\sqrt{\pi}$.
    \\(ヒント: $a\phi_n = n\phi_{n-1}$ より $a^n\phi_n = n!e^{-x^2/2}$ である.
    よって $\norm{\phi_n}^2 = \bra\phi_n,\phi_n\ket
    = \bra (a^*)^n e^{-x^2/2},\phi_n\ket
    = \bra e^{-x^2/2},a^n\phi_n\ket
    = \bra e^{-x^2/2},n! e^{-x^2/2}\ket
    = n!\int_{-\infty}^\infty e^{-x^2}\,dx$.)
  \item $e_n = \phi_n/\norm{\phi_n}$ と置くと, $e_0,e_1,e_2,\ldots$ 
    は $\C[x]e^{-x^2/2}$ の正規直交基底をなす%
    \footnote{$e_0,e_1,e_2,\ldots$ が $\C[x]e^{-x^2/2}$ の正規直交基底である
      とは $e_0,e_1,e_2,\ldots$ が $\C[x]e^{-x^2/2}$ の基底で
      かつ $\bra e_m,e_n\ket = \delta_{mn}$ を満たしていることである.
      $\C[x]e^{-x^2/2}$ は $\cS(\R)$ でも $L_2(\R)$ でも稠密 (dense)
      なので $e_0,e_1,e_2,\ldots$ は $L_2(\R)$ の
      {\bf 完全(完備)正規直交系 (complete orthonormal system, CONS)} をなす.}.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Hermite の多項式]
  問題 \qref{q:Hermite-polyn-1} の状況を考える%
  \footnote{問題 \qref{q:Hermite-polyn-2} も参照せよ.}.
  すなわち $V=\C[x]$ でかつ $V$ には
  次のように内積 $(\ ,\ )$ が定められていると仮定する:
  \begin{equation*}
    (f, g) = \int_{-\infty}^\infty \cc{f(x)}g(x)\,e^{-x^2}dx
    \qquad \bigl(f,g\in V=\C[x]\bigr).
  \end{equation*}
  内積の記号を問題 \qref{q:Hermite-polyn-1} とは変えた
  のは問題 \qref{q:quantum-harmonic-oscillator} の結果と比べるためにである.
  {\bf Hermite の多項式 (Hermite's polynomials)} $H_n(x)$ が次のように定義さ
  れる:
  \begin{equation*}
    H_n(x) = (-1)^n e^{x^2} \odfrac{^n}{x^n}e^{-x^2}
    \qquad (n=0,1,2,\ldots).
  \end{equation*}
  問題 \qref{q:quantum-harmonic-oscillator} の $\phi_n\in\C[x]e^{-x^2/2}$ 
  を $\phi_n = f_n e^{-x^2/2}$ ($f_n\in\C[x]$) と表わしておく.
  問題 \qref{q:quantum-harmonic-oscillator} の結果を用いて以下を示せ:
  \begin{enumerate}
  \item $H_n(x)$ は最高次の係数が $2^n$ の整数係数 $n$ 次多項式であり, 
    $n$ が偶数か奇数かに応じて $H_n(x)$ は偶函数または奇函数になる.
    \\(ヒント: $-\d(2^nx^n e^{-x^2}) 
    = (2^{n+1}x^{n+1} - 2^n n x^{n-1})e^{-x^2}$.)
  \item $H_n(x) = (\sqrt{2}i)^n f_n(x)$.
    \\(ヒント: $H_n(x)e^{-x^2/2}= (\sqrt{2}i)^n \phi_n(x)$ を示せば良い.
    $e^{x^2/2}\circ\d\circ e^{-x^2/2} = \d - x = -\sqrt{2}ia^*$
    であるから $H_n e^{-x^2/2} = e^{x^2/2}(-\d)^n(e^{-x^2/2}e^{-x^2/2})
    = (-e^{x^2/2}\circ\d\circ e^{-x^2/2})^ne^{-x^2/2}
    = (\sqrt{2}ia^*)^n e^{-x^2/2}
    = (\sqrt{2}i)^n \phi_n$.)
  \item $(H_m, H_n)=2^n n!\sqrt{\pi} \delta_{m,n}$.
    \\(ヒント: $(f,g)=\bra fe^{-x^2/2}, ge^{-x^2/2}\ket$ 
    より問題 \qref{q:quantum-harmonic-oscillator} の結果とすぐ上の結果を用い
    ればすぐにわかる.)
  \item $H_n$ は次の微分方程式を満たしている:
    \begin{equation*}
      (\d^2 - 2x\d + 2n)H_n
      = H_n'' - 2 x H_n' + 2n H_n
      = 0
      \qquad (n=0,1,2,\ldots).
    \end{equation*}
    (ヒント: $H_n e^{-x^2} = (-\d)^n e^{-x^2}$ の両辺に $-\d$ を
    作用させることによって $- H_n' + 2x H_n = H_{n+1}$ であることがわかる.
    よって $(\d-2x)H_n = -H_{n+1}$ である.
    一方 $-\d e^{-x^2} = 2x e^{-x^2}$ の両辺に $(-\d)^n$ を作用させること
    によって $H_{n+1} = 2x H_n - 2n H_{n-1}$ であることもわかる%
    \footnote{Leibnitz の公式 \qref{q:Leibnitz-formula} を使う.}.
    よって $\d H_n = 2n H_{n-1}$ である.
    よって $(\d^2 - 2x\d)H_n = (\d-2x)\d H_n = 2n(\d-2x)H_{n-2} = -2n H_n$.
    もちろん, 問題 \qref{q:quantum-harmonic-oscillator} 
    の $H_n(x)e^{-x^2/2}$ は $H$ の固有函数であるという結果を変形することに
    よっても目標の結果が得られる.) 
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Hermite の多項式の母函数]
  上の問題の続き:
  \begin{enumerate}
  \item $\displaystyle e^{-t^2+2tx} = \sum_{n=0}^\infty H_n(x)\frac{t^n}{n!}$.
    \\(ヒント: $e^{-t^2+2tx} = e^{x^2} e^{-(t-x)^2}$ を $t$ に関する巾級数
    に展開せよ%
    \footnote{$t$ の解析函数 $f(t)$ に
      対して $f(t) = \sum_{n=0}^\infty \frac{1}{n!}f^{(n)}(0)t^n$ であること
      を用いて良い.}.
    ただし, そのとき $\bigl(\pd{t}\bigr)^n e^{-(t-x)^2}
    =\bigl(-\pd{x}\bigr)^n e^{-(t-x)^2}$ を使う.)
  \item $\int_{-\infty}^\infty e^{-s^2+2sx}e^{-t^2+2tx}e^{-x^2}\,dx
    = \sqrt{\pi} e^{2st}.$ 
    \\(ヒント: $-s^2+2sx-t^2+2tx-x^2 = - (x-s-t)^2 + 2st$.)
  \item $(H_m, H_n)=2^n n!\sqrt{\pi} \delta_{m,n}$ \quad ($n=0,1,2,\ldots$).
    \\(ヒント: すぐ上の公式の両辺を $s$, $t$ の巾級数に展開せよ.)
  \item $\left(\pdfrac{^2}{x^2} - 2x \pd{x} + 2t \pd{t}\right)e^{-t^2+2tx}=0$.
    \\(ヒント: $t\pd{t}e^{x^2-(t-x)^2}
    = -2t(t-x)e^{x^2-(t-x)^2} = (-2t^2+2tx)e^{x^2-(t-x)^2}$ を $x$ だけを
    含む微分作用素の作用で表わすことを考える.
    そのために $\pd{x}e^{-t^2+2tx} = 2t e^{-t^2+2tx}$, 
    $\pdfrac{^2}{x^2}e^{-t^2+2tx} = 4t^2 e^{-t^2+2tx}$ 
    と計算してみれば $t\pd{t}$ と $-\frac{1}{2}\pdfrac{^2}{x^2}+x\pd{x}$ 
    を $e^{-t^2+2tx}=e^{x^2-(t-x)^2}$ に作用させた結果が等しいことがわかる.)
  \item $H_n'' - 2 x H_n' + 2n H_n = 0$ \quad ($n=0,1,2,\ldots$).
    \\(ヒント: すぐ上の公式の左辺を $t$ の巾級数に展開して各係数を $0$ と置
    いた式が目的の公式である.)
    \qed
  \end{enumerate}
\end{question}

\noindent
解説: このように母函数を使えば Hermite の多項式の性質をコンパクトな計算で導
くことができる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{単因子の計算と Jordan 標準形}
\label{sec:calc-elem-div-Jordan}

この節では単因子に基いた Jordan 標準形の計算の仕方を解説する.
単因子論とそれに基いた Jordan 標準形の理論の完全な
展開は\secref{sec:K[x]-module}で行ない, 
この節は計算法だけを天下り的に解説するだけですませる.
どうしてこの節で解説する方法で Jordan 標準形が正しく求まるかに
関しては\secref{sec:K[x]-module}を見よ.

なお, 他のほとんどの場所では体 $K$ 上の多項式環として文字 $\lambda$ から生成
されるものを主に用いているがこの節では文字 $x$ から生成されるものを用いる%
\footnote{その理由は式を大量にコンピューターに入力するときには $\lambda$ よ
  りも $x$ の方が易しいからである.  $\lambda$ と出力するため
  には {\tt\char'134 lambda} と入力しなければいけない.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{一変数多項式環上の行列の単因子の計算}
\label{sec:calc-elem-div}

$A$ は体 $K$ 上の一変数多項式環 $K[x]$ 上の $(m,n)$ 型行列であるとする.
$A$ に以下の基本操作を有限回ほどこすことを行列の基本変形と呼ぶ:
\begin{itemize}
\item $A$ のある行の多項式倍を別の行に加える.
\item $A$ のある行に $K$ の $0$ でない元をかける.
\item $A$ の2つの行を交換する.
\item $A$ のある列の多項式倍を別の列に加える.
\item $A$ のある列に $K$ の $0$ でない元をかける.
\item $A$ の2つの列を交換する.
\end{itemize}
$A$ は行列の基本変形によって次の形に変形できる:
\begin{equation*}
  \begin{bmatrix}
    g_1 &     &     & & \bigzerou \\
        & g_2 &     & & \\
        &     & g_3 & & \\
    \bigzerol & &   & \ddots & \\
  \end{bmatrix},
  \qquad
  \text{$g_i$ はモニックまたは $0$ で $g_1\mid g_2\mid g_3\mid\cdots$}.
\end{equation*}
ここで $f\mid g$ は「$f$ が $g$ を割り切る」という意味である.
$0$ は任意の $f$ で割り切れることに注意せよ ($0=0\cdot f$).
しかも $(g_1,g_2,\ldots)$ は $A$ に対して一意的である.
$(g_1,g_2,\ldots)$ を $A$ の{\bf 単因子 (elementary divisor)} と呼ぶ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}
\label{example:elem-div-1}
  単因子の計算の仕組みの一端を理解するために $\Q[x]$ 上の次の行列の単因子を
  求めてみよう:
  \begin{equation*}
    A := 
    \begin{bmatrix}
      x+1 & 0  \\
       0  & x \\
    \end{bmatrix}.
  \end{equation*}
  $x+1$ は $x$ を割り切らないので $(x,x+1)$ は $A$ の単因子ではない.
  しかし, 次のように基本変形して $A$ の単因子が $(1,x(x+1))$ であること
  がわかる:
  \begin{align*}
    \begin{bmatrix}
      x+1 & 0 \\
       0  & x \\
    \end{bmatrix}
    &
    \to
    \begin{bmatrix}
      x+1 & x \\
       0  & x \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      x+1 & -1 \\
       0  &  x \\
    \end{bmatrix}
    \\ &
    \to
    \begin{bmatrix}
      1  & x+1 \\
      -x &  0  \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      1 & x+1 \\
      0 & x(x+1) \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      1 & 0 \\
      0 & x(x+1) \\
    \end{bmatrix}.
  \end{align*}
  各矢印の操作はそれぞれ順に以下の通りである: 
  第2行を第1行に加える, 
  第1列を第2列から引く,
  第1列と第2列を交換してから第1列を $-1$ 倍する,
  第1行の $x$ 倍を第2行に足す,
  第1列の $x+1$ 倍を第2列から引く.
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}
\label{example:elem-div-2}
  単因子の計算の例をもう一つ示しておこう.
  これを見れば一般の場合にどのように計算すればよいかがわかるはずである.
  例として $\Q[x]$ 上の次の行列の単因子を求めてみよう:
  \begin{equation*}
    A :=  \left[ 
      \begin{array}{ccc}
        4\,{x}^{2} + 8\,{x} + 4 & {x}^{2} + 4\,{x} + 3 & {x}^{3} + 3\,{x}
        ^{2} - 2\,{x} - 5 \\
        - 8\,{x}^{3} - 8\,{x}^{2} + 6\,{x} + 6 &  - 2\,{x}^{3} - 6\,{x}
        ^{2} + {x} + 5 &  - 2\,{x}^{4} - 4\,{x}^{3} + 9\,{x}^{2} + 6\,{x}
        - 8 \\
        - 6\,{x}^{2} - 6\,{x} &  - 2\,{x}^{2} - 3\,{x} - 1 &  - 2\,{x}^{
          3} - {x}^{2} + 4\,{x} + 1
      \end{array}
    \right].
  \end{equation*}
  第 $1$ 列と第 $2$ 列を交換して, 
  第 $1$ 行の $2x-2$ 倍を第 $2$ 行に足して,
  第 $1$ 行と第 $2$ 行を交換して,
  第 $1$ 行を $-1$ 倍した結果を $A_1$ とする:
  \begin{equation*}
    A_1 =  \left[ 
      \begin{array}{ccc}
        {x} + 1 & 2\,{x} + 2 & {x}^{2} - 2 \\
        {x}^{2} + 4\,{x} + 3 & 4\,{x}^{2} + 8\,{x} + 4 & {x}^{3} + 3\,{x}
        ^{2} - 2\,{x} - 5 \\
        - 2\,{x}^{2} - 3\,{x} - 1 &  - 6\,{x}^{2} - 6\,{x} &  - 2\,{x}^{
          3} - {x}^{2} + 4\,{x} + 1
      \end{array}
    \right].
  \end{equation*}
  第 $1$ 行の $x+3$ 倍を第 $2$ 行から引き去り,
  第 $1$ 行と第 $2$ 行を交換し,
  第 $1$ 列と第 $3$ 列を交換した結果を $A_2$ とする:
  \begin{equation*}
    A_2 =  \left[ 
      \begin{array}{ccc}
        1 & 2\,{x}^{2} - 2 & 0 \\
        {x}^{2} - 2 & 2\,{x} + 2 & {x} + 1 \\
        - 2\,{x}^{3} - {x}^{2} + 4\,{x} + 1 &  - 6\,{x}^{2} - 6\,{x} & 
        - 2\,{x}^{2} - 3\,{x} - 1
      \end{array}
    \right].
  \end{equation*}
  第 $1$ 行の倍数を第 $2$ 行以降から引き去り,
  第 $1$ 列の倍数を第 $2$ 列以降から引き去り,
  第 $1$ 列と第 $1$ 行の第 $(1,1)$ 成分以外をすべて $0$ に
  した結果を $A_3$ とする:
  \begin{equation*}
    A_3 =  \left[ 
      \begin{array}{rcc}
        1 & 0 & 0 \\
        0 &  - 2\,{x}^{4} + 6\,{x}^{2} + 2\,{x} - 2 & {x} + 1 \\
        0 & 4\,{x}^{5} + 2\,{x}^{4} - 12\,{x}^{3} - 10\,{x}^{2} + 2\,{x}
        + 2 &  - 2\,{x}^{2} - 3\,{x} - 1
      \end{array}
    \right].
  \end{equation*}
  第 $2$ 列と第 $3$ 列を交換して,
  第 $2$ 行の倍数を第 $3$ 行から引き去り,
  第 $2$ 列の倍数を第 $3$ 列から引き去り,
  第 $2$ 列と第 $2$ 行の第 $(2,2)$ 成分以外をすべて $0$ にした
  結果を $A_4$ とすると第 $(3,3)$ 成分も $0$ になる:
  \begin{equation*}
    A_4 =  \left[ 
      \begin{array}{rcr}
        1 & 0 & 0 \\
        0 & {x} + 1 & 0 \\
        0 & 0 & 0
      \end{array}
    \right].
  \end{equation*}
  したがって $A$ の単因子は $(1,x+1,0)$ である. 
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-1}
  $\Q[x]$ 上の次の行列の単因子を求めよ:
  \begin{equation*}
    \left[ 
      \begin{array}{ccc}
        2\,{x}^{4} - 8\,{x}^{3} + 9\,{x}^{2} - 4\,{x} + 1 &  - 2\,{x}^{3}
        + 4\,{x}^{2} - 2\,{x} & 4\,{x}^{4} - 8\,{x}^{3} + 4\,{x}^{2} + {
          x} - 1 \\
        2\,{x}^{4} - 7\,{x}^{3} + 5\,{x}^{2} + {x} - 1 &  - 2\,{x}^{3} + 
        3\,{x}^{2} - 1 & 4\,{x}^{4} - 6\,{x}^{3} + 3\,{x} - 1
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $(x-1, (x-1)^2)$.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-2}
  $\Q[x]$ 上の次の行列の単因子を求めよ:
  {\small
  \begin{equation*}
    \left[ 
      \begin{array}{ccc}
        {x}^{5} - {x}^{4} - {x} + 1 & {x}^{5} + 2\,{x}^{4} - {x} - 2 & {x
          }^{5} + {x}^{4} - {x} - 1 \\
        {x}^{6} - 3\,{x}^{5} + {x}^{4} + {x}^{3} + 4\,{x} & {x}^{6} - 4\,
        {x}^{4} - {x}^{3} - 2\,{x}^{2} - {x} + 3 & {x}^{6} - {x}^{5} - 2
        \,{x}^{4} - {x}^{2} + {x} + 2
      \end{array}
    \right].
  \end{equation*}
  }計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $((x^2+1)(x+1), (x^2+1)(x+1)(x-1))$.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-3}
  $\Q[x]$ 上の次の行列の単因子を求めよ:
  \begin{equation*}
    \left[ 
      \begin{array}{ccc}
        - 2\,{x}^{2} + 3\,{x} + 3 & 0 &  - 2\,{x} - 1 \\
        8\,{x}^{4} - 6\,{x}^{3} - 32\,{x}^{2} + 7\,{x} + 19 & 4\,{x}^{3}
        - 3\,{x} + 1 & 8\,{x}^{4} + 8\,{x}^{3} + 4\,{x}^{2} - 6\,{x} - 7
        \\
        4\,{x}^{3} - {x}^{2} - 13\,{x} - 8 & 2\,{x}^{2} + 2\,{x} & 4\,{x}
        ^{3} + 8\,{x}^{2} + 7\,{x} + 3
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $(1,x+1,x+1)$.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-4}
  $\Q[x]$ 上の次の行列の単因子を求めよ:
  {\footnotesize
  \begin{equation*}
    \left[ 
      \begin{array}{ccccc}
        - 2\,{x}^{3} - 2\,{x}^{2} + 3\,{x} + 2 & {x}^{2} + {x} - 2 &  - 
        {x} + 1 & {x}^{2} + {x} - 1 & {x} - 2 \\
        - 2\,{x}^{4} + 2\,{x}^{2} & {x}^{3} - {x} & {x}^{2} - 1 & {x}^{3
          } - {x} &  - 2\,{x}^{4} + 4\,{x}^{2} - 2 \\
        3\,{x}^{2} - {x} - 2 &  - 2\,{x} + 2 &  - 2\,{x}^{2} + 2\,{x} & 
        - {x} + 1 & 2\,{x}^{4} - 3\,{x}^{2} - 3\,{x} + 4 \\
        4\,{x}^{4} + 4\,{x}^{3} - 5\,{x} - 3 &  - 2\,{x}^{3} - 2\,{x}^{2}
        + 4 &  - 2\,{x}^{2} + 2\,{x} &  - 2\,{x}^{3} - 2\,{x}^{2} + 2 & 
        4\,{x}^{4} - 8\,{x}^{2} - 3\,{x} + 7
      \end{array}
    \right].
  \end{equation*}
  }計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $(1,x+1,(x+1)(x-1),0)$. 
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{単因子に基いた Jordan 標準形の計算}
\label{sec:calc-ed-Jordan}

$K$ は代数閉体であるとする%
\footnote{代数閉体という言葉が怖ければ $K=\C$ だと仮定して良い.}.
$K$ 上の正方行列 $A$ の
{\bf 有理標準形 (rational normal form, rational canonical form, 
Frobebius 標準形, Frobenius normal form, Frobenius canonical form)} 
と {\bf Jordan 標準形 (Jordan normal form, Jordan canonical form)} を
単因子に基いた以下の手続きで求めることができる:
\begin{enumerate}
\item {\bf 特性行列 (characteristic matrix)} $xE-A$ の単因子を求める.
\item 単因子の中から $1$ を除いたものを $f_1,\dots,f_s$ とする.
\item このとき $A$ の有理標準形は $f_1,\dots,f_s$ に対応するコンパニオン
  行列を対角線に並べてできる正方行列になる.  ただし多項式
  \begin{equation*}
    f(x) = x^n + a_0x^{n-1} + a_1x^{n-2} + \cdots + a_{n-2}x + a_{n-1}
    \in K[x]
  \end{equation*}
  に対応する{\bf コンパニオン行列 (同伴行列, companion matrix)} $C_f$ は
  次のように定義される:
  \begin{equation*}
    C_f = 
    \begin{bmatrix}
      0         &    1     &        &      & \bigzerou \\
                &    0     & \ddots &      & \\
                &          & \ddots &  1   & \\
      \bigzerol &          &        &  0   &  1 \\
      -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
    \end{bmatrix}.
  \end{equation*}
\item すべての $f_i$ を一次式の積に分解する:
  \begin{equation*}
    f_i(x) = (x-\alpha_{i,1})^{n_{i,1}}\cdots(x-\alpha_{i,r_i})^{n_{i,r_i}}.
  \end{equation*}
  ここで $\alpha_{i,1},\dots,\alpha_{i,r_i}\in K$ は互いに異なり,
  $n_{i,1},\dots,n_{i,r_i}$ は正の整数である.
\item このとき $A$ の {\bf Jordan 細胞 (Jordan cell)} の全体は
  \begin{equation*}
    J_{n_{i,j}}(\alpha_{i,j})
    \qquad
    (i=1,\dots,s,\ j=1,\dots,r_i).
  \end{equation*}
  になり,  $A$ の Jordan 標準形はこれらの Jordan 細胞を対角線に並べて
  できる正方行列になる.
  ただし $J_n(\alpha)$ は次の形の $n$ 次正方行列である:
  \begin{equation*}
    J_n(\alpha) = 
    \begin{bmatrix}
      \alpha &    1   &        &        & \bigzerou \\
             & \alpha &    1   &        & \\
             &        & \alpha & \ddots & \\
             &        &        & \ddots & 1 \\
      \bigzerol &     &        &        & \alpha \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-companion}
  体 $K$ 上の一変数多項式
  \begin{equation*}
    f(x) = x^n + a_0 x^{n-1} + a_1 x^{n-2} + \cdots + a_{n-2}x + a_{n-1}x
    \in K[x]
  \end{equation*}
  に対応するコンパニオン行列 $C_f$ の特性行列 $xE - C_f$ の単因子
  が $(1,\dots,1,f)$ になることを直接確かめよ.
  \qed
\end{question}

\noindent
ヒント: たとえば $f(x)=x^4+ax^3+bx^2+cx+d $ の特性行列 $xE-C_f$ は以下のよう
に基本変形できる:
\begin{align*}
  &
  \begin{bmatrix}
    x & -1 &  0 &  0 \\
    0 &  x & -1 &  0 \\
    0 &  0 &  x & -1 \\
    d &  c &  b & a+x \\
  \end{bmatrix}
  \to
  \begin{bmatrix}
    -1 &  0 &  0  & x \\
     x & -1 &  0  & 0 \\
     0 &  x & -1  & 0 \\
     c &  b & a+x & d \\
  \end{bmatrix}
  \to
  \begin{bmatrix}
    -1 &  0 &  0  & 0 \\
     x & -1 &  0  & x^2 \\
     0 &  x & -1  & 0 \\
     c &  b & a+x & d+cx\\
  \end{bmatrix}
  \\ &
  \to
  \begin{bmatrix}
    -1 &  0 &  0  & 0 \\
     x & -1 &  0  & 0 \\
     0 &  x & -1  & x^3 \\
     c &  b & a+x & d+cx+bx^2 \\
  \end{bmatrix}
  \to
  \begin{bmatrix}
    -1 &  0 &  0  & 0 \\
     x & -1 &  0  & 0 \\
     0 &  x & -1  & 0 \\
     c &  b & a+x & d+cx+bx^2+ax^3+x^4\\
  \end{bmatrix}
  \\ &
  \to
  \begin{bmatrix}
    -1 &  0 &  0 & 0 \\
     0 & -1 &  0 & 0 \\
     0 &  0 & -1 & 0 \\
     0 &  0 &  0 & f(x) \\
  \end{bmatrix}
  \to
  \begin{bmatrix}
    1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & f(x) \\
  \end{bmatrix}.
\end{align*}
ここでそれぞれの矢印は順に次のような行列の基本変形である:
第 $1$ 列が第 $4$ 列にくるように列を巡回置換する,
第 $1$ 列の $x$ 倍を第 $4$ 列に加える,
第 $2$ 列の $x^2$ 倍を第 $4$ 列に加える,
第 $3$ 列の $x^3$ 倍を第 $4$ 列に加える,
行の基本変形によって対角成分以外を $0$ にする,
第 $1$ 行から第 $3$ 行に $-1$ をかけて対角成分の $-1$ を $1$ にする.
これで $C_f$ の特性行列の単因子が $(1,1,1,f(x))$ になることがわかった.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}
\label{example:ed-Jordan}
  単因子に計算に基いた Jordan 標準形の計算の例を一つ示そう.
  これを見れば一般の場合にもどのように計算すればよいかがわかるはずである.
  例として $\Q$ 上の次の行列の Jordan 標準形を求めてみよう:
  \[
  A := \left[ 
    \begin{array}{rrrrr}
      -4 & -7 &  6 & -11 & -6 \\
       2 &  1 & -1 &   2 & -1 \\
       4 &  4 & -2 &   4 & -1 \\
       2 &  5 & -4 &   7 &  5 \\
       0 & -4 &  5 &  -8 & -8 \\
    \end{array}
  \right].
  \]
  この行列の特性行列 $xE-A$ を $A_0$ と書くことにする:
  \[
  A_0 = x E - A = \left[ 
    \begin{array}{ccccc}
      {x} - 4 & -7 & 6 & -11 & -6 \\
      2 & {x} + 1 & -1 & 2 & -1 \\
      4 & 4 & {x} - 2 & 4 & -1 \\
      2 & 5 & -4 & {x} + 7 & 5 \\
      0 & -4 & 5 & -8 & {x} - 8 \\
    \end{array}
  \right].
  \]
  これに行列の基本変形をほどこして単因子を求めよう.
  $A_0$ の第2行に $-1$ をかけて, 第2行と第1行を交換し, 第5列を第1列と交換し
  た結果を $A_1$ とする:
  \[
  A_1 =  \left[ 
    \begin{array}{ccccc}
      1 &  - {x} - 1 & 1 & -2 & -2 \\
      -6 & -7 & 6 & -11 & {x} - 4 \\
      -1 & 4 & {x} - 2 & 4 & 4 \\
      5 & 5 & -4 & {x} + 7 & 2 \\
      {x} - 8 & -4 & 5 & -8 & 0
    \end{array}
  \right].
  \]
  第 $1$ 行の倍数を残りの行から引き去り, 第 $1$ 列の倍数を残りの列から引き去
  ることによって, 第 $1$ 行と第 $1$ 列の第 $(1,1)$ 成分以外をすべて $0$ にし
  た結果を $A_2$ とする:
  \[
  A_2 =  \left[ 
    \begin{array}{rcccc}
      1 & 0 & 0 & 0 & 0 \\
      0 &  - 6\,{x} - 13 & 12 & -23 & {x} - 16 \\
      0 &  - {x} + 3 & {x} - 1 & 2 & 2 \\
      0 & 5\,{x} + 10 & -9 & {x} + 17 & 12 \\
      0 & {x}^{2} - 7\,{x} - 12 &  - {x} + 13 & 2\,{x} - 24 & 2\,{x} - 16
    \end{array}
  \right].
  \]
  第 $5$ 列に $1/2$ をかけて, 第 $5$ 列と第 $2$ 列を交換し, 第 $3$ 行と
  第 $2$ 列を交換した結果を $A_3$ とする:
  \[
  A_3 =  \left[ 
    \begin{array}{rcccc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & {x} - 1 & 2 &  - {x} + 3 \\
      0 & {\frac {1}{2}}\,{x} - 8 & 12 & -23 &  - 6\,{x} - 13 
        \\ [2ex]
      0 & 6 & -9 & {x} + 17 & 5\,{x} + 10 \\
      0 & {x} - 8 &  - {x} + 13 & 2\,{x} - 24 & {x}^{2} - 7\,{x} - 12
    \end{array}
  \right].
  \]
  第 $2$ 行の倍数を第 $3$ 行以降から引き去り, 
  第 $2$ 列の倍数を第 $3$ 列以降から引き去ることによって, 
  第 $2$ 行と第 $2$ 列の第 $(2,2)$ 成分以外をすべて $0$ に
  した結果を $A_4$ とする:
  \[
  A_4 =  \left[ 
    \begin{array}{rrccc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 &  - \,{\frac {1}{2}}\,{x}^{2} + 
      {\frac {17}{2}}\,{x} + 4 &  - {x} - 7 & 
      {\frac {1}{2}}\,{x}^{2} - {\frac {31
          }{2}}\,{x} + 11 \\ [2ex]
      0 & 0 &  - 6\,{x} - 3 & {x} + 5 & 11\,{x} - 8 \\
      0 & 0 &  - {x}^{2} + 8\,{x} + 5 & -8 & 2\,{x}^{2} - 18\,{x} + 12
    \end{array}
  \right].
  \]
  第 $5$ 行に $-1/8$ をかけて第 $5$ 行と第 $3$ 行を交換し, 
  第 $4$ 列と第 $3$ 行を交換した結果を $A_5$ とする:
  \[
  A_5 = \left[ 
    \begin{array}{rrccc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 1 & {\frac {1}{8}}\,{x}^{2} - {x} - 
      {\frac {5}{8}} &  - \,{\frac {1}{4}}
      \,{x}^{2} + {\frac {9}{4}}\,{x} - {
        \frac {3}{2}} \\ [2ex]
      0 & 0 & {x} + 5 &  - 6\,{x} - 3 & 11\,{x} - 8 \\
      0 & 0 &  - {x} - 7 &  - \,{\frac {1}{2}}\,{x}^{2}
      + {\frac {17}{2}}\,{x} + 4 & {
        \frac {1}{2}}\,{x}^{2} - {\frac {31}{2}}\,{x} + 11
    \end{array}
  \right].
  \]
  第 $3$ 行の倍数を第 $4$ 行以降から引き去り, 
  第 $3$ 列の倍数を第 $4$ 列以降から引き去ることによって, 
  第 $3$ 行と第 $3$ 列の第 $(3,3)$ 成分以外をすべて $0$ に
  した結果を $A_6$ とする:
  \[
  A_6 =  \left[ 
    \begin{array}{rrrcc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 \\
      0 & 0 & 0 &  - \,{\frac {1}{8}}\,{x}^{3} + 
      {\frac {3}{8}}\,{x}^{2} - {\frac {3}{
          8}}\,{x} + {\frac {1}{8}} & {\frac {1
          }{4}}\,{x}^{3} - {x}^{2} + {\frac {5}{4}}\,{x} - 
      {\frac {1}{2}} \\ [2ex]
      0 & 0 & 0 & {\frac {1}{8}}\,{x}^{3} - 
      {\frac {5}{8}}\,{x}^{2} + {\frac {7}{
          8}}\,{x} - {\frac {3}{8}} &  - \,{
        \frac {1}{4}}\,{x}^{3} + {x}^{2} - {\frac {5}{4}}\,
      {x} + {\frac {1}{2}}
    \end{array}
    \right].
  \]
  第 $4$ 行を第 $5$ 行に加えて, 第 $5$ 行と第 $4$ 行を交換した結果を $A_7$ 
  とする:
  \[
  A_7 =  \left[ 
    \begin{array}{rrrcc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 \\
      0 & 0 & 0 &  - \,{\frac {1}{4}}\,{x}^{2} + 
      {\frac {1}{2}}\,{x} - {\frac {1}{4}}
      &  - \,{\frac {1}{2}}\,{x}^{2} + {x} - 
      {\frac {1}{2}} \\ [2ex]
      0 & 0 & 0 &  - \,{\frac {1}{8}}\,{x}^{3} + 
      {\frac {3}{8}}\,{x}^{2} - {\frac {3}{
          8}}\,{x} + {\frac {1}{8}} &  - \,{
        \frac {1}{4}}\,{x}^{2} + {\frac {1}{2}}\,{x} - 
      {\frac {1}{4}}
    \end{array}
  \right].
  \]
  第 $4$ 列の $2$ 倍を第 $5$ 列から引き去り, 第 $4$ 行の $x/2-1/2$ 倍を
  第 $5$ 行から引き去り, 第 $4$ 行を $-4$ 倍し, 第 $5$ 行を $4$ 倍した
  結果を $A_8$ とする:
  \[
  A_8 =  \left[ 
    \begin{array}{rrrcc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 \\
      0 & 0 & 0 & x^2-2\,x+1 & 0 \\
      0 & 0 & 0 & 0 & x^3-4\,x^2+5\,x-2
    \end{array}
  \right].
  \]
  成分を因数分解すると第 $(4,4)$ 成分が第 $(5,5)$ 成分を割り切ることがわかる:
  \[
  A_8 =  \left[ 
    \begin{array}{rrrcc}
      1 & 0 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 & 0 \\
      0 & 0 & 1 & 0 & 0 \\
      0 & 0 & 0 & (\,{x} - 1\,)^{2} & 0 \\
      0 & 0 & 0 & 0 & (\,{x} - 2\,)\,(\,{x} - 1\,)^{2}
    \end{array}
  \right].
  \]
  よって特性行列 $xE - A$ の単因子は次に等しい:
  \begin{equation*}
    (1,1,1, x^2-2x+1, x^3-4x^2+5x-2)
    = (1,1,1, (x-1)^2, (x-2)(x-1)^2).
  \end{equation*}
  これより, $A$ の Jordan 細胞は $J_1(2)$, $J_2(1)$, $J_s(1)$ の3つになり, 
  $A$ の有理標準形 (Frobenius 標準形) $F$ と Jordan 標準形 $J$ がそれぞれ次
  の形になることがわかった:
  \begin{equation*}
    F =
    \left[
      \begin{array}{ccc|cc}
        0 &  1 & 0 & & \bigzerou\\
        0 &  0 & 1 & & \\
        2 & -5 & 4 & & \\
        \hline
                  & & &  0 & 1 \\
        \bigzerol & & & -1 & 2 \\
      \end{array}
    \right],
    \quad
    J =
    \left[
      \begin{array}{c|cc|cc}
        2 & \multicolumn{4}{r}{\bigzerou} \\
        \cline{1-3}
        \multicolumn{1}{c|}{} & 1 & 1 & \multicolumn{2}{c}{} \\
        \multicolumn{1}{c|}{} & 0 & 1 & \multicolumn{2}{c}{} \\
        \cline{2-5}
        \multicolumn{3}{c|}{}          & 1 & 1 \\
        \multicolumn{3}{l|}{\bigzerol} & 0 & 1 \\
      \end{array}
    \right].
  \qed
  \end{equation*}
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-1}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    A_1 = \left[ 
      \begin{array}{rrrr}
        -4 & -6 & 3 & 6 \\
        -4 & -3 & 2 & 4 \\
        10 & 4 & -7 & -10 \\
        -12 & -10 & 8 & 14
      \end{array}
    \right],
    \quad
    A_2 = \left[ 
      \begin{array}{rrrr}
        11 & 4 & -8 & -8 \\
        10 & 5 & -8 & -8 \\
        6 & 2 & -5 & -4 \\
        14 & 6 & -10 & -11
      \end{array}
    \right]
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-A_1$ の単因子は $(1,1,1,(x+2)(x+1)(x-1)(x-2))$ であるから,
$A_1$ の Jordan 細胞は $(J_1(-2),J_1(-1),J_1(1),J_1(2))=(-2,-1,1,2)$ である.
$xE-A_2$ の単因子は $(1,1,(x-1)(x+1),(x-1)(x+1))$ であるから,
$A_2$ の Jordan 細胞は $(-1,-1,1,1)$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-2}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    A_3 = \left[ 
      \begin{array}{rrrr}
        -10 & 13 & -3 & -4 \\
        -9 & 9 & -3 & -1 \\
        9 & -19 & 2 & 10 \\
        -9 & 7 & -3 & 1
      \end{array}
    \right],
    \quad
    A_4 = \left[ 
      \begin{array}{rrrr}
        6 & 7 & 14 & 7 \\
        8 & 7 & 16 & 8 \\
        -6 & -6 & -13 & -6 \\
        -3 & -3 & -6 & -4
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-A_3$ の単因子は $(1,1,x+1,(x+1)(x-2)^2)$ であるから,
$A_3$ の Jordan 細胞は $(-1,-1,J_2(2))$ である.
$xE-A_4$ の単因子は $(1,x+1,x+1,(x+1)^2)$ であるから,
$A_4$ の Jordan 細胞は $(-1,-1,J_2(-1))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-3}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    A_5 = \left[ 
      \begin{array}{rrrr}
        5 & -2 & -3 & 0 \\
        -4 & -2 & 2 & -3 \\
        12 & -3 & -7 & 1 \\
        4 & 1 & -2 & 2
      \end{array}
    \right],
    \quad
    A_6 = \left[ 
      \begin{array}{rrrr}
        4 & -10 & -4 & -5 \\
        3 & -8 & -6 & -5 \\
        1 & -6 & 0 & -3 \\
        -6 & 20 & 12 & 12
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-A_5$ の単因子は $(1,1,1,(x-1)(x+1)^3)$ であるから,
$A_5$ の Jordan 細胞は $(1,J_3(-1))$ である.
$xE-A_6$ の単因子は $(1,1,x-2,(x-2)^3)$ であるから,
$A_6$ の Jordan 細胞は $(2,J_3(2))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-4}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    A_7 = \left[ 
      \begin{array}{rrrr}
        1 & 5 & 1 & 2 \\
        0 & 5 & 1 & 1 \\
        -2 & -8 & -2 & -1 \\
        -1 & -1 & -1 & 2
      \end{array}
    \right],
    \quad
    A_8 = \left[ 
      \begin{array}{rrrr}
        9 & -12 & 6 & 10 \\
        15 & -19 & 5 & 19 \\
        5 & -6 & -1 & 8 \\
        5 & -6 & 0 & 7
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-A_7$ の単因子は $(1,1,1,(x-1)^2(x-2)^2)$ であるから,
$A_7$ の Jordan 細胞は $(J_2(1),J_2(2))$ である.
$xE-A_8$ の単因子は $(1,1,(x+1)^2,(x+1)^2)$ であるから,
$A_8$ の Jordan 細胞は $(J_2(-1),J_2(-1))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-5}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    A_9 = \left[ 
      \begin{array}{rrrr}
        -5 & -1 & 2 & 1 \\
        17 & 3 & -12 & -2 \\
        1 & 0 & -3 & 1 \\
        10 & 3 & -7 & -3
      \end{array}
    \right],
    \quad
    A_{10} = \left[ 
      \begin{array}{rrrr}
        6 & 6 & -11 & -9 \\
        -2 & -1 & 5 & 4 \\
        2 & 3 & -5 & -6 \\
        -2 & -3 & 7 & 8
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-A_9$ の単因子は $(1,1,1,(x+2)^4)$ であるから,
$A_9$ の Jordan 細胞は $J_4(-2)$ だけである.
$xE-A_{10}$ の単因子は $(1,1,(x-2)^2,(x-2)^2)$ であるから,
$A_{10}$ の Jordan 細胞は $(J_2(2),J_2(2))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-6}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    B_1 = \left[ 
      \begin{array}{rrrrr}
        -2 & 6 & -1 & 1 & 8 \\
        2 & 2 & -1 & 1 & -1 \\
        -4 & 6 & 1 & 1 & 8 \\
        0 & -2 & 1 & 1 & -2 \\
        -4 & 4 & 0 & 0 & 8
      \end{array}
    \right],
    \quad
    B_2 = \left[ 
      \begin{array}{rrrrr}
        -14 & 0 & -4 & 5 & -7 \\
        1 & 1 & -1 & 0 & 1 \\
        8 & 0 & 2 & -3 & 4 \\
        -4 & -4 & 3 & 0 & -4 \\
        19 & -4 & 9 & -8 & 8
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-B_1$ の単因子は $(1,1,x-2,(x-2)^2,(x-2)^2)$ であるから,
$B_1$ の Jordan 細胞は $(2,J_2(2),J_2(2))$ である.
$xE - B_2$ の単因子は $(1,1,1,(x+1)^2,(x-1)(x+1)^2)$ であるから,
$B_2$ の Jordan 細胞は $(1,J_2(-1),J_2(-1))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ed-j-7}
  $\C$ 上の次の行列の特性行列の単因子と Jordan 標準形を求めよ:
  \begin{equation*}
    B_3 = \left[ 
      \begin{array}{rrrrr}
        -6 & 6 & -3 & -8 & 0 \\
        0 & 2 & 7 & -1 & -4 \\
        0 & -1 & -2 & 1 & 1 \\
        2 & 0 & 6 & 1 & -3 \\
        -5 & 5 & -4 & -7 & 0
      \end{array}
    \right],
    \quad
    B_4 = \left[ 
      \begin{array}{rrrrr}
        5 & 3 & 0 & 3 & -5 \\
        -6 & -3 & 3 & -2 & 5 \\
        4 & 3 & 1 & 3 & -5 \\
        -10 & -7 & 3 & -4 & 10 \\
        -6 & -4 & 3 & -2 & 6
      \end{array}
    \right].
  \end{equation*}
  計算の過程の概略も説明せよ. \qed
\end{question}

\commentout{
\noindent
略解: $xE-B_3$ の単因子は $(1,1,1,(x+1)^2,(x+1)^3)$ であるから,
$B_3$ の Jordan 細胞は $(J_2(-1),J_3(-1))$ である.
$xE-B_4$ の単因子は $(1,1,x-1,x-1,(x-1)^3)$ であるから,
$B_4$ の Jordan 細胞は $(1,1,J_3(1))$ である.
\qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{コンパニオン行列の Jordan 標準形}
\label{sec:Jordan-companion}

この節では\secref{sec:K[x]-module}で体 $K$ 上のベクトル空間の理論から一変数
多項式環 $K[\lambda]$ 上の加群の理論に進む前に後者がどのように役に立つかに関
して感じをつかむためにコンパニオン行列の Jordan 標準形について解説する.

$K$ は任意の代数閉体であると仮定し, $K$ の元を成分に持つ行列について考える.
$K$ の元を数と呼ぶことがある. 「任意の代数閉体」という言葉を使うのが怖い人
は $K=\C$ であると考えてよい.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{\protect{$(\lambda-\alpha)^n$} に
  対応するコンパニオン行列の Jordan 標準形}
\label{sec:companion-jordan-(x-a)^n}

\begin{question}
\label{q:generalized-remainder}
  $\Z$ 係数の $s$ 変数多項式環 $R=\Z[x_1,\dots,x_s]$ を
  考え, $n_i\in\Z_{>0}$, $n_1+\cdots+n_s=n$ 
  とし, $R$ 係数の多項式 $p(\lambda)\in R[\lambda]$ を次のように定める:
  \begin{equation*}
    p(\lambda) = (\lambda - x_1)^{n_1}\cdots(\lambda - x_s)^{n_s}.
  \end{equation*}
  これを $\lambda$ について展開して $a_i\in R$ を次のように定める:
  \begin{equation*}
    p(\lambda) 
    = \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-1} 
    + \cdots + a_{n-2}\lambda + a_{n-1}.
  \end{equation*}
  このとき $\frac{1}{k!}p^{(k)}(\lambda)\in R[\lambda]$ ($k\in\Z_{\ge0}$) で
  あり, $\frac{1}{k!}p^{(k)}(x_i)=0$ ($k=0,1,\dots,n_i-1$) が成立している.
  すなわち
  \begin{align*}
    &
    \binom{n}{k} x_i^{n-k} 
    + \binom{n-1}{k}a_0 x_i^{n-k-1}
    + \cdots 
    + \binom{k+1}{k}a_{n-k-2} x_i
    + \binom{k}{k}a_{n-k-1}
    = 0
    \\ &
    \hphantom{
    \binom{n}{k} x_i^{n-k} 
    + \binom{n-1}{k}a_0 x_i^{n-k-1}
    + \cdots 
    + \binom{k+1}{k}a_{n-k-2}
    }
    (k=0,1,\dots,n_i-1).
  \end{align*}
  さらに, この公式中の $x_1,\dots,x_s$ のそれぞれに
  任意の体 $K$ の任意の元 $\alpha_1,\dots,\alpha_s$ を代入することができ%
  \footnote{$a_0,a_1,\dots,a_{n-1}$ たちの中にも $x_1,\dots,x_s$ が含まれて
    いることに注意せよ},  %
  代入後の公式も成立している.
  \qed
\end{question}

\noindent
ヒント: $\frac{1}{k!}\left(\pd{\lambda}\right)^k\lambda^l =
\binom{l}{k}\lambda^{l-k}$ より $\frac{1}{k!}\left(\pd{\lambda}\right)^k$ の
作用は $R[\lambda]$ の元を $R[\lambda]$ の元に移す. 
$\frac{1}{k!}p^{(k)}(x_i)=0$ ($k=0,1,\dots,n_i-1$) を書き直せば問題の結論が
得られる.  整数係数の多項式の中の変数には任意の体の元を代入できるので最後の
結論も得られる.
\qed

\medskip
\noindent
注意: $K=\C$ (もしくは $K$ の標数は $0$) とみなしている人にとって上の問題は
重要ではない.  もしも $K$ の標数が正で $k!$ が標数で割り切れるならば $K$ の
中で $k!=0$ になる.  正標数の世界では任意の $k!$ で割る操作を考えることがで
きない.   しかし, 上の問題のように整数係数の多項式の世界を経由すれば $k!$ で
割った後の公式が正当化される場合がある.  
整数係数多項式の世界で成立している公式は変数に任意の体の元%
\footnote{任意の可換環の元でもよい.}%
を代入した結果も成立している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:p_C=(lambda-alpha)^n}
  任意に $\alpha\in K$ を取り, $a_0,\dots,a_{n-1}\in K$ を次のように定める:
  \begin{equation*}
    (\lambda-\alpha)^n 
    = \lambda^n + a_0 \lambda^{n-1} + \cdots + a_{n-2}\lambda + a_{n-1}.
  \end{equation*}
  行列 $C,P\in M_n(K)$ を次のように定める%
  \footnote{$P$ の定義において
    二項係数の定義は $\binom{n}{k} = n(n-1)(n-2)\cdots(n-k+1)/k!$ 
    なので $k=n+1,n+2,\ldots$ の
    とき $\binom{n}{k} = n(n-1)\cdots(n-n)\cdots(n-k+1)/k! = 0$ となる
    ことに注意せよ.}:
  \begin{equation*}
    C =
    C(a_0,\dots,a_{n-1}) =
    \begin{bmatrix}
      0         &    1     &        &      & \bigzerou \\
                &    0     & \ddots &      & \\
                &          & \ddots &  1   & \\
      \bigzerol &          &        &  0   &  1 \\
      -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
    \end{bmatrix},
  \end{equation*}
  \begin{equation*}
    P = \left[ \binom{i-1}{j-1}\alpha^{i-j} \right]_{i,j=1}^n = 
    \begin{bmatrix}
      1            &                   &         & & & \bigzerou \\
      \alpha       & 1                 &         & & & \\
      \alpha^2     & 2\alpha           & 1       & & & \\
      \alpha^3     & 3\alpha^2         & 3\alpha & 1 & & \\
      \vdots       & \vdots            & \vdots  & & \ddots & \\
      \alpha^{n-1} & (n-1)\alpha^{n-2} & \binom{n-1}{2}\alpha^{n-3} & \binom{n-1}{3}\alpha^{n-4} & \cdots & 1 \\
    \end{bmatrix}.
  \end{equation*}
  このとき $P$ による相似変換は $C$ を Jordan 標準形に変換する:
  \begin{equation*}
    P^{-1}CP = J_n(\alpha).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント1: $p(\lambda)=(\lambda-\alpha)^n
=\lambda^n+a_0\lambda^{n-1}+\cdots+a_{n-1}$ と置くと,
問題 \qref{q:generalized-remainder} の結果より, 
\begin{align*}
  &
  \binom{n}{k}\alpha^{n-k}
  =
  - \binom{k}{k}a_{n-k-1}
  - \binom{k+1}{k}a_{n-k-2}\alpha
  - \cdots
  - \binom{n-1}{k}a_0\alpha^{n-k-1}
  \\ &
  \hphantom{
  \binom{n}{k}\alpha^{n-k}
  =
  - \binom{k}{k}a_{n-k-1}
  - \binom{k+1}{k}a_{n-k-2}\alpha
  - \cdots
  }
  (k=0,1,\dots,n-1).
\end{align*}
この公式と二項係数の漸化式 (Pascal の三角形) を用いて $CP=PJ_n(\alpha)$ の両
辺が一致することを直接確かめることができる.

たとえば $n=4$ のとき
\begin{align*}
  CP 
  &
  =
  \begin{bmatrix}
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1 \\
    -a_3 & -a_2 & -a_1 & -a_0 \\
  \end{bmatrix}
  \begin{bmatrix}
    1        & 0         & 0       & 0 \\
    \alpha   & 1         & 0       & 0 \\
    \alpha^2 & 2\alpha   & 1       & 0 \\
    \alpha^3 & 3\alpha^2 & 3\alpha & 1 \\
  \end{bmatrix}
  \\ &
  =
  \begin{bmatrix}
    \alpha   & 1         & 0       & 0 \\
    \alpha^2 & 2\alpha   & 1       & 0 \\
    \alpha^3 & 3\alpha^2 & 3\alpha & 1 \\
    -a_3-a_2\alpha-a_1\alpha^2-a_0\alpha^3 & -a_2-2a_1\alpha-3a_0\alpha^2 &
    -a_1-3a_0\alpha & -a_0 \\
  \end{bmatrix},
\end{align*}
\begin{equation*}
  PJ_n(\alpha) = 
  \begin{bmatrix}
    1        & 0         & 0       & 0 \\
    \alpha   & 1         & 0       & 0 \\
    \alpha^2 & 2\alpha   & 1       & 0 \\
    \alpha^3 & 3\alpha^2 & 3\alpha & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    \alpha & 1      & 0      & 0 \\
    0      & \alpha & 1      & 0 \\
    0      & 0      & \alpha & 1 \\
    0      & 0      & 0      & \alpha \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    \alpha   & 1         & 0         & 0 \\
    \alpha^2 & 2\alpha   & 1         & 0 \\
    \alpha^3 & 3\alpha^2 & 3\alpha   & 1 \\
    \alpha^4 & 4\alpha^3 & 6\alpha^2 & 4\alpha
  \end{bmatrix}.
\end{equation*}
これに以下を適用すれば $CP=PJ_n(\alpha)$ であることがわかる:
\begin{align*}
  &
  0 = p(\alpha) = \alpha^4 + a_0\alpha^3 + a_1\alpha^2 + a_2\alpha + a_3,
  \\ &
  0 = p'(\alpha) = 4\alpha^3 + 3a_0\alpha^2 + 2a_1\alpha + a_2,
  \\ &
  0 = \frac{1}{2}p''(\alpha) = 6\alpha^2 + 3a_0\alpha + a_1,
  \\ &
  0 = \frac{1}{3!}p^{(3)}(\alpha) = 4\alpha + a_0.
  \qed
\end{align*}

\medskip
\noindent
ヒント2: 文字 $t$ が $(t-\alpha)^n=0$ を満たしていると仮定すると%
\footnote{このように仮定して良いかどうかに疑問を持った人は
  多項式環 $K[\lambda]$ のイデアル
  \begin{equation*}
    \bigl((\lambda-\alpha)^n\bigr)
    = K[\lambda](\lambda-\alpha)^n
    = \{\, g(\lambda)(\lambda-\alpha)^n \mid g\in K[\lambda] \,\}
  \end{equation*}
  で割ってできる剰余環 (residue ring, 商環, quotient ring) %
  $R=K[\lambda]/\bigl((\lambda-\alpha)^n\bigr)$ について学ばなければいけない.

  代数学において $M/N$ は「$M$ の中の $N$ の元をすべて $0$ とみなしてでき
  る空間」を意味している.  したがって $R$ は多項式環 $K[\lambda]$ の
  中で $\bigl((\lambda-\alpha)^n\bigr)$ の元をすべて $0$ とみなしてできる空
  間である. よって $\lambda$ に対応する $R$ の元を $t$ と
  書けば $(t-\alpha)^n=0$ が成立している.

  $R$ は $K$ 上の $n$ 次元ベクトル空間をなし, 
  その基底として $1,t,\dots,t^{n-1}$ と $1,t-\alpha,\dots,(t-\alpha)^{n-1}$ 
  が取れる.  この基底に関して $t$ の積が定める一次変換を行列表示
  するとそれぞれ $\tp{C}$, $\tp{J_n(\alpha)}$ になり, 
  それら二つの基底のあいだの変換行列は $\tp{P}$ になっている.
  これが以下の計算の数学的意味である.}
\begin{equation*}
  t^n=-a_0t^{n-1}-a_1t^{n-2}-\cdots-a_{n-1}
\end{equation*}
なので以下が成立する:
\begin{align*}
  &
  t [1,t,\dots,t^{n-2},t^{n-1}]
  \\ &
  = [t,t^2,\dots,t^{n-1},-a_0t^{n-1}-a_1t^{n-2}-\cdots-a_{n-1}]
  \\ &
  = [1,t,\dots,t^{n-2},t^{n-1}] \tp{C},
  \\[\medskipamount] &
  t [1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}]
  \\ &
  = [t,t(t-\alpha),\dots,t(t-\alpha)^{n-2},t(t-\alpha)^{n-1}]
  \\ &
  = [\alpha+(t-\alpha), \alpha(t-\alpha)+(t-\alpha)^2,\dots,
     \alpha(t-\alpha)^{n-2}+(t-\alpha)^{n-1},\alpha(t-\alpha)^{n-1}]
  \\ &
  = [1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}] \tp{J_n(\alpha)}.
\end{align*}
そして, 二項定理より,
\begin{align*}
  [1,t,\dots,t^{n-2},t^{n-1}]
  &
  = [1,\alpha+(t-\alpha),\dots,(\alpha+(t-\alpha))^{n-2},
     (\alpha+(t-\alpha))^{n-1}]
  \\ &
  = [1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}] \tp{P}.
\end{align*}
以上を用いて $t [1,t,\dots,t^{n-2},t^{n-1}]$ を二通りに計算すると,
\begin{align*}
  t [1,t,\dots,t^{n-2},t^{n-1}] 
  &
  = [1,t,\dots,t^{n-2},t^{n-1}]\tp{C}
  \\ &
  = [1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}] 
    \tp{P}\tp{C},
  \\[\medskipamount]
  t [1,t,\dots,t^{n-2},t^{n-1}]
  &
  = t[1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}]\tp{P}
  \\ &
  = [1,t-\alpha,\dots,(t-\alpha)^{n-2},(t-\alpha)^{n-1}] 
    \tp{J_n(\alpha)}\tp{P}.
\end{align*}
よって $\tp{P}\tp{C}=\tp{J_n(\alpha)} \tp{P}$ 
すなわち $CP=PJ_n(\alpha)$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{一般のコンパニオン行列の Jordan 標準形}
\label{sec:companion-jordan}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[コンパニオン行列の Jordan 標準形 1]
\label{q:Jordan-companion-1}
  問題 \qref{q:minimal-polyn-10} で定義された
  コンパニオン行列 $C=C(a_0,\dots,a_{n-1})$ ($a_i\in K$) について考える:
  \begin{equation*}
    C =
    C(a_0,\dots,a_{n-1}) =
    \begin{bmatrix}
      0         &    1     &        &      & \bigzerou \\
                &    0     & \ddots &      & \\
                &          & \ddots &  1   & \\
      \bigzerol &          &        &  0   &  1 \\
      -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
    \end{bmatrix}.
  \end{equation*}
  $K$ は代数閉体だと仮定したので%
  \footnote{代数閉体という言葉が怖ければ $K=\C$ だと考えて良い.},
  $C$ の特性多項式
  \begin{equation*}
    p_C(\lambda)
    = \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-2}
    + \cdots + a_{n-2}\lambda + a_{n-1}
    \tag{$\ast$}
  \end{equation*}
  は次のように一次式の積に分解される:
  \begin{equation*}
    p_C(\lambda) = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}.
  \end{equation*}
  ここで $\alpha_1,\dots,\alpha_s$ たちは $p_C(\lambda)$ の相異なる根の全体
  であり, $n_1+\cdots+n_s=n$ である.  このとき $C$ の Jordan 標準形 $J$ は次
  の形になる: 
  \begin{equation*}
    J = 
    \begin{bmatrix}
      J_{n_1}(\alpha_1) &        & \bigzerou \\
                        & \ddots & \\
      \bigzerol         &        & J_{n_s}(\alpha_s) \\
    \end{bmatrix}.
  \end{equation*}
  すなわち $C$ の各固有値 $\alpha_i$ に属する Jordan 細胞は唯一つになる.
  \qed
\end{question}

\noindent
ヒント:  問題 \qref{q:minimal-polyn-10} の結論は,
コンパニオン行列 $C=C(a_0,\dots,a_{n-1})$ の特性多項式が ($\ast$) の形
になることと最小多項式が特性多項式に等しくなることであった.
後者の結論と問題 \qref{q:Jordan-varphi=p} の結果を合わせれば
この問題の結論がただちに得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

上のヒントの方法では問題 \qref{q:p_C=(lambda-alpha)^n} の場合と
違って $P^{-1}CP=J$ となる正則行列 $P$ の具体形がわからない.  
しかも, そこで使用されている問題 \qref{q:Jordan-varphi=p} のヒント
では Jordan 標準形の存在を仮定してしまっていたので, 
Jordan 標準形の存在の別証明にも使えない.

しかし, 問題 \qref{q:p_C=(lambda-alpha)^n} の結果を一般化することに
よって $p_C(\lambda)$ の根の情報から $P$ を直接的にかつ具体的に構成
することができる.  問題 \qref{q:Jordan-companion-2} を見よ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Vandermonde の公式の一般化]
\label{q:generalized-Vandermonde}
  $\Z$ 係数の $s$ 変数多項式環 $R=\Z[x_1,\dots,x_s]$ を
  考え, $n_i\in\Z_{>0}$, $n_1+\cdots+n_s=n$ とする.
  $R$ の元を成分に持つ $(n,n_i)$ 型
  行列 $P_i\in M_{n,n_i}(K)$ を次のように定義する:
  \begin{equation*}
    P_i = \left[
      \binom{\mu-1}{\nu-1} x_i^{\mu-\nu} 
    \right]_{1\le\mu\le n,\; 1\le\nu\le n_i}.
  \end{equation*}
  具体的に書き下すと%
  \footnote{印刷上では $P_i$ が横長に見えてしまうかもしれないが,
    実際には $P_i$ は縦長の $(n,n_i)$ 型の行列である.},
  \begin{equation*}
    P_i =
    \left[
    \begin{array}{llllll}
      \binom{0}{0}       & & & & & \qquad\bigzerou \\
      \binom{1}{0} x_i   & \binom{1}{1}       & & & & \\
      \binom{2}{0} x_i^2 & \binom{2}{1} x_i   & \binom{2}{2} & & & \\
      \binom{3}{0} x_i^3 & \binom{3}{1} x_i^2 & \binom{3}{2} x_i & \binom{3}{3} & & \\
      \quad\vdots        & \quad\vdots        & \quad\vdots      &              & \ddots & \\
      \binom{n_i-1}{0} x_i^{n_i-1} & \binom{n_i-1}{1} x_i^{n_i-2} & \binom{n_i-1}{2} x_i^{n_i-3} & \binom{n_i-1}{3} x_i^{n_i-4} & \cdots & \binom{n_i-1}{n_i-1} \\
      \binom{n_i}{0} x_i^{n_i}     & \binom{n_i}{1} x_i^{n_i-1}   & \binom{n_i}{2} x_i^{n_i-2}   & \binom{n_i}{3} x_i^{n_i-3}   & \cdots & \binom{n_i}{n_i-1} x_i \\
      \quad\vdots                  & \quad\vdots                  & \quad\vdots                  & \quad\vdots                  &        & \quad\vdots \\
      \binom{n-1}{0} x_i^{n-1}     & \binom{n-1}{1} x_i^{n-2}     & \binom{n-1}{2} x_i^{n-3}     & \binom{n-1}{3} x_i^{n-4}     & \cdots & \binom{n-1}{n_i-1} x_i^{n-n_i} \\
    \end{array}
    \right].
  \end{equation*}
  $P$ は $P_1,\dots,P_s$ を横に並べてできる $n$ 次正方行列であるとする:
  \begin{equation*}
    P = [P_1\ \cdots\ P_s].
  \end{equation*}
  このとき次が成立している:
  \begin{equation*}
    \det P = \prod_{1\le i<j\le s} (x_j-x_i)^{n_in_j}.
  \end{equation*}
  この公式の $n=s$, $n_1=\cdots=n_s=1$ の場合は Vandermonde の公式なので, 
  この結果は Vandermonde の公式の一般化になっている.

  この公式より, 任意の体 $K$ とその相異なる元 $\alpha_1,\dots,\alpha_s$ に
  対して, $P$ の中の $x_1,\dots,x_s$ のそれぞれに $\alpha_1,\dots,\alpha_s$ 
  を代入してできる $K$ の元を成分に持つ正方行列は可逆であることがわかる.
  \qed
\end{question}

\noindent
ヒント: $n_1\ge\cdots\ge n_s$ であると仮定して良い.
さらに $n_{t-1}>n_t\ge 1=n_{t+1}=\cdots=n_s$ と仮定する.
$m=n_1+\cdots+n_t$ に関する帰納法で公式を証明する.
$m=0$ すなわち $n=s$, $n_1=\cdots=n_s=1$ のとき, 
示すべき公式は Vandermonde の公式に一致するので成立している.  
$m$ まで公式が成立していると仮定する.  

$\det P$ の中の第 $m-n_t+1$ 列から第 $m+1$ 列は次のような様子をしている:
\begin{equation*}
  \det P = 
  \left|
  \begin{array}{cllclcc}
    *      & \binom{0}{0}     &              &  & \qquad\bigzerou & 1       & * \\
    *      & \binom{1}{0} x_t & \binom{1}{1} &        &           & x_{t+1} & * \\
    \vdots & \quad\vdots      & \quad\vdots  & \ddots &           & \vdots  & \vdots \\
    *      & \binom{n_t-1}{0} x_t^{n_t-1} & \binom{n_t-1}{1} x_t^{n_t-2} & \cdots & \binom{n_t-1}{n_t-1}           & x_{t+1}^{n_t-1} & * \\
    *      & \binom{n_t}{0} x_t^{n_t}     & \binom{n_t}{1} x_t^{n_t-1}   & \cdots & \binom{n_t}{n_t-1} x_t         & x_{t+1}^{n_t}   & * \\
    \vdots & \quad\vdots                  & \quad\vdots                  &        & \quad\vdots                    & \vdots          & \vdots \\
    *      & \binom{n-1}{0} x_t^{n-1}     & \binom{n-1}{1} x_t^{n-2}     & \cdots & \binom{n-1}{n_t-1} x_t^{n-n_t} & x_{t+1}^{n-1}   & * \\
  \end{array}
  \right|.
\end{equation*}
よって, $\det P$ に $\frac{1}{n_t!}\left(\pd{x_{t+1}}\right)^{n_t}$ を作用
させて, $(x_{t+1},x_{t+2},\dots,x_s)$ に $(x_t,x_{t+1},\dots,x_{s-1})$ を
代入した結果は $n_t$ を1つ増やした場合の公式の左辺に一致する. したがって, 
公式の右辺に $\frac{1}{n_t!}\left(\pd{x_{t+1}}\right)^{n_t}$ を
作用させて $(x_{t+1},x_{t+2},\dots,x_s)$ に $(x_t,x_{t+1},\dots,x_{s-1})$ 
を代入した結果が公式の右辺で $n_t$ を1つ増やして $s$ を1つ減らした結果に
一致することを示せば良い.  

公式の右辺に含まれる $x_{t+1}$ を含む因子
は $n_{t+1}=\cdots=n_s=1$ であるから
\begin{equation*}
  (x_{t+1}-x_1)^{n_1}\dots(x_{t+1}-x_{t-1})^{n_{t-1}}
  (x_{t+1}-x_t)^{n_t}
  (x_{t+2}-x_{t+1})\cdots(x_s-x_{t+1}).
\end{equation*}
公式の右辺に $\frac{1}{n_t!}\left(\pd{x_{t+1}}\right)^{n_t}$ を
作用させて $x_{t+1}$ に $x_t$ を代入した結果は
公式の右辺の $x_{t+1}$ を含む因子を次に置き換えた結果に等しい:
\begin{equation*}
  (x_t-x_1)^{n_1}\dots(x_t-x_{t-1})^{n_{t-1}}
  (x_{t+2}-x_t)\cdots(x_s-x_t).
\end{equation*}
よって, その結果は公式の右辺の $x_{t+1}$ を含む因子を消去し,
右辺の $x_t$ を含み $x_{t-1}$ を含まない因子
\begin{equation*}
  (x_t-x_1)^{n_1n_t}\dots(x_t-x_{t-1})^{n_{t-1}n_t}
  (x_{t+2}-x_t)^{n_t}\cdots(x_s-x_t)^{n_t}
\end{equation*}
を次で置換した結果に一致する:
\begin{equation*}
  (x_t-x_1)^{n_1(n_t+1)}\dots(x_t-x_{t-1})^{n_{t-1}(n_t+1)}
  (x_{t+2}-x_t)^{n_t+1}\cdots(x_s-x_t)^{n_t+1}.
\end{equation*}
よって, さらに $(x_{t+2},\dots,x_s)$ に $(x_{t+1},\dots,x_{s-1})$ を代入した
結果は次に等しい:
\begin{equation*}
  \prod_{1\le i<j\le s-1} (x_j - x_i)^{m_im_j}.
\end{equation*}
ここで
\begin{equation*}
  m_i = 
  \begin{cases}
    n_i     & \qquad (i=1,\dots,t-1), \\
    n_t + 1 & \qquad (i=t), \\
    n_{i+1} & \qquad (i=t+1,\dots,s-1). \\
  \end{cases}
\end{equation*}
この結果は公式の右辺で $n_t$ を1つ増やして $s$ を1つ減らした結果に
一致している.
\qed

\medskip
\noindent
解説: $y_1,\dots,y_n$ に関する Vandermonde の行列式を考える:
\begin{equation*}
  \Delta = \prod_{1\le i<j\le n}(y_j-y_i) =
  \begin{vmatrix}
    1         & 1         & 1         & \cdots & 1 \\
    y_1       & y_2       & y_3       & \cdots & y_n \\
    y_1^2     & y_2^2     & y_3^2     & \cdots & y_n^2 \\
    \vdots    & \vdots    & \vdots    &        & \vdots \\
    y_1^{n-1} & y_2^{n-1} & y_3^{n-1} & \cdots & y_n^{n-1} \\
  \end{vmatrix}.
\end{equation*}
変数 $y_{n_1+\cdots+n_{i-1}+\nu+1}$ ($\nu=0,\dots,n_i-1$)
を $x_{i,\nu}$ と表わし, $y_i$ たちに関する偏微分作用素 $L$ を
次のように定める:
\begin{equation*}
  L = 
  \prod_{i=1}^s \prod_{\nu=0}^{n_i-1}
  \frac{1}{\nu!}\left(\pd{x_{i,\nu}}\right)^\nu.
\end{equation*}
このとき, $\det P$ は $L\Delta$ の中の $x_{i,\nu}$ 
($\nu=0,\dots,n_i-1$) に $x_i$ を代入したものに等しい.
上のヒントは実質的にこの事実を用いている.

例として $n=5$, $s=2$, $n_1=3$, $n_2=2$ の場合を考えよう. 
このとき
\begin{equation*}
  L\Delta = 
  \pd{y_2}\frac{1}{2!}\pdfrac{^2}{y_3^2}\pd{y_5}\Delta = 
  \begin{vmatrix}
    1     & 0      & 0      & 1     & 0      \\
    y_1   & 1      & 0      & y_4   & 1      \\
    y_1^2 & 2y_2   & 1      & y_4^2 & 2y_5   \\
    y_1^3 & 3y_2^2 & 2y_3   & y_4^3 & 3y_5^2 \\
    y_1^4 & 4y_2^3 & 4y_3^2 & y_4^4 & 4y_5^3 \\
  \end{vmatrix}.
\end{equation*}
よって $L\Delta$ の中の $y_1,y_2,y_3$ に $x_1$ を代入
し $y_4,y_5$ に $x_2$ を代入したものは $\det P$ に等しい. 一方, 
\begin{align*}
  \Delta 
  &
  = \prod_{1\le i<j\le 5}(y_j-y_i)
  = (y_2-y_1)\prod_{3\le j\le 5}[(y_j-y_1)(y_j-y_2)]
    \prod_{3\le i<j\le 5}(y_j-y_i),
  \\[\medskipamount]
  \Gamma_1 
  &
  := \left. \pd{y_2}\Delta \right|_{y_2=y_1} 
  = \prod_{3\le j\le 5}(y_j-y_1)^2
    \prod_{3\le i<j\le 5}(y_j-y_i)
  \\ &
  = (y_3-y_1)^2 \prod_{4\le j\le 5}(y_j-y_1)^2\prod_{4\le j\le 5}(y_j-y_3)
  \cdot(y_5-y_4),
  \\[\medskipamount]
  \Gamma_2
  &
  := \left. \frac{1}{2!}\pdfrac{^2}{y_3^2} \right|_{y_3=y_1}
  = (y_5-y_4)\prod_{4\le j\le 5}(y_j-y_1)^3,
  \\[\medskipamount]
  \Gamma_3
  &
  := \left. \pd{y_5}\Gamma_2 \right|_{y_5=y_4}
  = (y_4-y_1)^6.
\end{align*}
$\Gamma_3$ は $L\Delta$ で $y_1=y_2=y_3$, $y_4=y_5$ と置いた結果に等しい.
よって $\det P = (x_2-x_1)^6=(x_2-x_1)^{n_1n_2}$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

\begin{question}[コンパニオン行列の Jordan 標準形 2]
\label{q:Jordan-companion-2}
  問題 \qref{q:Jordan-companion-1} の状況を仮定する.
  $(n,n_i)$ 型行列 $P_i\in M_{n,n_i}(K)$ を次のように定義する:
  \begin{equation*}
    P_i = \left[
      \binom{\mu-1}{\nu-1}\alpha_i^{\mu-\nu} 
    \right]_{1\le\mu\le n,\; 1\le\nu\le n_i}.
  \end{equation*}
  具体的に書き下すと%
  \footnote{印刷上では $P_i$ が横長に見えてしまうかもしれないが,
    実際には $P_i$ は縦長の $(n,n_i)$ 型の行列である.},
  \begin{equation*}
    P_i =
    \left[
    \begin{array}{llllll}
      \binom{0}{0}         & & & & & \qquad\bigzerou \\
      \binom{1}{0}\alpha_i   & \binom{1}{1}         & & & & \\
      \binom{2}{0}\alpha_i^2 & \binom{2}{1}\alpha_i   & \binom{2}{2} & & & \\
      \binom{3}{0}\alpha_i^3 & \binom{3}{1}\alpha_i^2 & \binom{3}{2}\alpha_i & \binom{3}{3} & & \\
      \quad\vdots            & \quad\vdots            & \quad\vdots          &              & \ddots & \\
      \binom{n_i-1}{0}\alpha_i^{n_i-1} & \binom{n_i-1}{1}\alpha_i^{n_i-2} & \binom{n_i-1}{2}\alpha_i^{n_i-3} & \binom{n_i-1}{3}\alpha_i^{n_i-4} & \cdots & \binom{n_i-1}{n_i-1} \\
      \binom{n_i}{0}\alpha_i^{n_i}     & \binom{n_i}{1}\alpha_i^{n_i-1}   & \binom{n_i}{2}\alpha_i^{n_i-2}   & \binom{n_i}{3}\alpha_i^{n_i-3}   & \cdots & \binom{n_i}{n_i-1}\alpha_i \\
      \quad\vdots                      & \quad\vdots                      & \quad\vdots                      & \quad\vdots                      &        & \quad\vdots \\
      \binom{n-1}{0}\alpha_i^{n-1}     & \binom{n-1}{1}\alpha_i^{n-2}     & \binom{n-1}{2}\alpha_i^{n-3}     & \binom{n-1}{3}\alpha_i^{n-4}     & \cdots & \binom{n-1}{n_i-1}\alpha_i^{n-n_i} \\
    \end{array}
    \right].
  \end{equation*}
  このとき $P_1,\dots,P_s$ を横に並べてできる $n$ 次正方行列
  を $P$ とすると, $P$ は逆行列を持ち $P^{-1}CP$ は Jordan 標準形になる. 
  すなわち $P=[P_1\ \cdots\ P_s]$ と置くと $P\in GL_n(K)$ 
  かつ $P^{-1}CP=J$ が成立する.
  \qed
\end{question}

\noindent
ヒント1: 問題 \qref{q:p_C=(lambda-alpha)^n} のヒント1の一般化.

$P$ が逆行列を持つことは Vandermonde の公式の
一般化 \qref{q:generalized-Vandermonde} よりわかる.

$P_iJ_{n_i}(\alpha_i)$ の第 $\nu$ 列は $P_i$ の
第 $\nu-1$ 列と第 $\nu$ 列の $\alpha$ 倍の和に等しい.
よって, $P_iJ_{n_i}(\alpha_i)$ の $(\mu,\nu)$ 成分は $
  \binom{\mu-1}{\nu-2}\alpha^{\mu-\nu+1} 
+ \binom{\mu-1}{\nu-1}\alpha^{\mu-\nu+1}
= \binom{\mu}{\nu-1}\alpha^{\mu-\nu+1}$ に等しい.

$CP_i$ の第 $1$ 行から第 $n-1$ 行はそれぞれ $P_i$ の第 $2$ 行から第 $n$ 行に
等しいので, $\mu=1,\dots,n-1$ に対して $CP_i$ の $(\mu,\nu)$ 成分
は $\binom{\mu}{\nu-1}\alpha^{\mu-\nu+1}$ に等しい.
よって $CP_i$ と $P_iJ_{n_i}(\alpha_i)$ の第 $1$ 行から第 $n-1$ 行は互いに等
しい.

問題 \qref{q:generalized-remainder} の結果で $x_i=\alpha_i$, $k=\nu-1$ と置
けば, 
\begin{align*}
  &
  \binom{n}{\nu-1}\alpha_i^{n-\nu+1} 
  =
  - a_{n-\nu}\binom{\nu-1}{\nu-1}
  - a_{n-\nu-1}\binom{\nu}{\nu-1}\alpha_i
  - \cdots 
  - a_0\binom{n-1}{\nu-1}\alpha_i^{n-\nu}
  \\ &
  \hphantom{
  \binom{n}{\nu-1}\alpha_i^{n-\nu+1} 
  =
  - a_{n-\nu}\binom{\nu-1}{\nu-1}
  - a_{n-\nu-1}\binom{\nu}{\nu-1}\alpha_i
  - \cdots 
  -
  }
  (\nu=1,\dots,n_i).
\end{align*}
$CP_i$ の第 $(n,\nu)$ 成分はこの式の右辺に等しい. 
よって $CP_i$ と $P_iJ_{n_i}(\alpha_i)$ の第 $n$ 行は互いに等しい.

これで $CP_i=P_iJ_{n_i}(\alpha_i)$ が示された.  よって
\begin{align*}
  CP
  &
  =[CP_1\ \cdots\ CP_s]
  =[P_1J_{n_1}(\alpha_1)\ \cdots\ P_sJ_{n_s}(\alpha_s)]
  \\ &
  =[P_1\ \cdots\ P_s]
  \begin{bmatrix}
    J_{n_1}(\alpha_1) &        & \bigzerou \\
                      & \ddots & \\
    \bigzerol         &        & J_{n_s}(\alpha_s) \\
  \end{bmatrix}
  = PJ.
\end{align*}
これで $CP=PJ$ が証明された.
\qed

\bigskip

上のヒント1の方法は直接的であるが, その考え方では天下り的に導入された
複雑な行列 $P$ の正体も不明なままだし,  
$P$ の可逆性を証明するためには $\det P$ を計算しなければいけなかった.
次のヒント2の方法を用いれば行列 $P$ の正体が明らかになり, $P$ の可逆性も
自然に証明される.  二項定理より, 
\begin{equation*}
  \lambda^\mu 
  = ((\lambda-\alpha_i) + \alpha_i)^\mu
  = \sum_{\nu=0}^{\mu} 
    \binom{\mu}{\nu} \alpha_i^{\mu-\nu} (\lambda-\alpha_i)^\nu.
\end{equation*}
$(\lambda-\alpha_i)^\nu$ の係数は $P_i$ の $(\mu+1,\nu+1)$ 成分に等しい.
これが行列 $P$ の正体である.  より詳しい説明については以下のヒント2を見よ.

ただし初歩的な可換環論の知識を用いている.
複雑に見える数式の正体を明らかにするためには理論が必要になる.
初歩的な可換環論に関しては\secref{sec:K[x]-module}で解説する.

\bigskip

{\Large 我々は{\bf 体の世界を離れて可換環の世界に本格的に旅立つことが必要な
    段階}に到達した.  
  体 $K$ の次に出会う可換環は体上の一変数多項式環 $K[\lambda]$ である.}

\bigskip
\noindent
ヒント2: 問題 \qref{q:p_C=(lambda-alpha)^n} のヒント2の一般化.
次の自然な $K[\lambda]$ 加群の同型が成立している%
\footnote{問題 \qref{q:Chinese-remainder-K[x]} のヒントで証明の方針
  を示す. この同型は中国式剰余定理 (Chinese remainder theorem) の特殊な場合
  である.}:
\begin{equation*}
  K[\lambda]/(p(\lambda)) 
  \isomto 
  \prod_{i=1}^s K[\lambda]/\bigl((\lambda-\alpha_i)^{n_i}\bigr),
  \quad
  f(\lambda)\MOD p(\lambda)
  \mapsto
  \bigl(f(\lambda)\MOD (\lambda-\alpha_i)^{n_i}\bigr)_{i=1}^s.
\end{equation*}
$t\in R$ と $t_i\in R_i$ を $t=\lambda\MOD p(\lambda)$, 
$t_i=\lambda\MOD(\lambda-\alpha_i)^{n_i}$ と定める.
それらは $p(t)=0$, $(t_i-\alpha_i)^{n_i}=0$ を満たしている.

$1,t,\dots,t^{n-1}$ は同型の左辺の $K$ 基底である.
$1,t_i-\alpha_i,\dots,(t_i-\alpha_i)^{n_i-1}$ 
は同型の右辺における $R_i$ の基底になっている.  
$(t_i-\alpha_i)^\nu\in R_i$ に対応する $R$ の元を $e_{i,\nu}$ と書くことにす
る. このとき $e_{i,\nu}$ ($i=1,\dots,s$, $\nu=0,1,\dots,n_i-1$) 
は $R$ の別の $K$ 基底をなす.

同型の両辺への $\lambda$ 倍の作用と上の同型写像は可換である.
両辺への $\lambda$ 倍の作用は両辺への $K$ 上の一次変換を定める.
$\lambda$ は左辺には $t$ 倍で作用し, 
右辺の各 $R_i$ には $t_i$ 倍で作用する.
よって以下が成立することがわかる.

$p(t)=0$ より, $\lambda$ の $R$ への作用の
基底 $1,t,\dots,t^{n-1}$ に関する行列表示は
コンパニオン行列の転置 $\tp{C}$ になる:
\begin{equation*}
  \lambda [1,t,\dots,t^{n-1}] = [1,t,\dots,t^{n-1}]\tp{C}.
\end{equation*}
$(t_i-\alpha_i)^{n_i}=0$ より, $\lambda$ の $R_i$ への作用の
基底 $1,t_i-\alpha_i,\dots,(t_i-\alpha_i)^{n_i-1}$ に関する行列表示は
は Jordan ブロック行列の転置 $\tp{J_{n_i}(\alpha_i)}$ になる:
\begin{equation*}
  \lambda [1, t_i-\alpha_i, \dots, (t_i-\alpha_i)^{n_i-1}]
  = [1, t_i-\alpha_i, \dots, (t_i-\alpha_i)^{n_i-1}] \tp{J_{n_i}(\alpha_i)}.
\end{equation*}
この結果を上の同型を通して $R$ の基底 $e_{i,\nu}$ に関する結果に翻訳すると, 
$\lambda$ の $R$ への作用の基底 $e_{i,\nu}$ に関する
行列表示が Jordan ブロック行列の転置を対角線に並べた形の
行列 $\tp{J}$ になることがわかる:
\begin{equation*}
  \lambda [e_{i,\nu}] = [e_{i,\nu}] \tp{J}.
\end{equation*}
ここで $[e_{i,\nu}]=
[e_{1,0},\dots,e_{1,n_1-1},\ldots\ldots,e_{s,0},\dots,e_{s,n_s-1}]$ である.

したがって, もしも $R$ の2つの基底 $t^\mu$ と $e_{i,\nu}$ のあいだの
変換行列が $\tp{P}$ であることがわかれば, $P$ が可逆であること
と $\tp{P}\tp{C}=\tp{J}\tp{P}$ すなわち $CP=PJ$ が成立することがわかる.

$t^\mu$ に対応する $R_i$ の元は $t_i^\mu$ に等しい.  二項定理より,
\begin{equation*}
  t_i^\mu 
  = ((t_i-\alpha_i) + \alpha_i)^\mu
  = \sum_{\nu=0}^{n_i-1} 
    \binom{\mu}{\nu} \alpha_i^{\mu-\nu} (t_i-\alpha_i)^\nu.
\end{equation*}
係数に $P_i$ の $(\mu+1,\nu+1)$ 成分が現われていることに注意すれば次が
成立することがわかる:
\begin{equation*}
  [1,t,\dots,t^{n-1}] = [e_{i,\nu}]\tp{P}.
\end{equation*}
$\tp{P}$ は2つの基底のあいだの変換行列なので可逆である.
したがって $P$ も可逆である.

以上の結果を使って $\lambda [1,t,\dots,t^{n-1}]$ を2通りに計算すると,
\begin{align*}
  &
  \lambda [1,t,\dots,t^{n-1}] 
  = [1,t,\dots,t^{n-1}] \tp{C}
  = [e_{i,\nu}] \tp{P}\tp{C},
  \\ &
  \lambda [1,t,\dots,t^{n-1}]
  = \lambda [e_{i,\nu}] \tp{P}
  = [e_{i,\nu}] \tp{J}\tp{P}.
\end{align*}
よって $\tp{P}\tp{C}=\tp{J}\tp{P}$ すなわち $CP=PJ$ が成立する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{体上の1変数多項式環上の加群}
\label{sec:K[x]-module}

$K$ は任意の体であるとする. 
「任意の体」という用語に慣れていない人は $K=\Q,\R,\C$ であると考えて良い.
(さらに $K$ が代数閉体だと仮定する場合には $K=\C$ であると考えて良い.)

すっきりした説明をするためにはどうしても可換環とその上の加群の一般論が必要に
なるので必要最小限の一般論を混じえながら, 体上の一変数多項式環とその上の加群
の理論について解説する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{可換環とイデアルと単項イデアル整域}
\label{sec:ring-ideal-PID}

$R$ が{\bf 可換環 (commutative ring)} であるとは%
\footnote{面倒な場合には単に環 (ring) と呼ぶ場合もある.},
$R$ が集合であり,
加法 $+:R\times R\to R$
と $0\in R$
と加法の逆元 $-:R\to R$
と乗法 $\cdot:R\times R\to R$
と $1\in R$ が与えられていて,
以下が成立していることである:
\begin{enumerate}
\item $R$ は加法に関して可換群をなす. すなわち $a,b,c\in M$ に対して,
  \begin{enumerate}
  \item $(a + b) + c = a + (b + c)$;
  \item $0 + a = a + 0 = a$;
  \item $(-a) + a = a + (-a) = 0$;
  \item $a + b = b + a$.
  \end{enumerate}
\item 乗法 $\cdot:R\times R\to R$ は{\bf 結合的 (associative)} かつ
  {\bf 双加法的 (bi-additive)} であり, $1\in R$ は乗法に関する単位元になる.
  すなわち $a,b,c\in R$ に対して,
  \begin{enumerate}
  \item $(ab)c = a(bc)$;
  \item $a(b + c) = ab + ac$;
  \item $(a + b)c = ac + bc$;
  \item $1a = a1 = a$.
  \end{enumerate}
\item $R$ の乗法は{\bf 可換 (commutative)} である. 
  すなわち $a,b\in R$ に対して
  \begin{enumerate}
  \setcounter{enumii}{4}
  \item $ab=ba$.
  \end{enumerate}
\end{enumerate}
さらに次の条件が成立しているならば $R$ は{\bf 体 (field)} であるという%
\footnote{{\bf 可換体 (commutative field)} と呼ぶ場合もある.
  非可換な体は{\bf 斜体 (skew field)} と呼ばれる.}:
\begin{enumerate}
  \setcounter{enumi}{3}
\item 任意の $a\in R\setminus\{0\}$ に対してある $b\in R\setminus\{0\}$ が
  存在して $ba = ab = 1$.
\end{enumerate}
このような $b$ は $a$ に対して一意的に定まる. 
実際 $ba=1$, $ab'=1$ ならば $b'=1b'=(ba)b'=b(ab')=b1=b$.
要するに $0$ でない $a\in R$ に対してその逆元 $a^{-1}=1/a$ が常に $R$ 自身の
中に存在するような可換環を体と呼ぶのである.
たとえば $\Q$, $\R$, $\C$ は体である.

可換環 $R$ が{\bf 整域 (integral domain)} であるとは, 任意の $a,b\in R$ に
対して $ab=0$ ならば $a=0$ または $b=0$ が成立することである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  体は整域である. \qed
\end{question}

\begin{question}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ は整域である.
  \qed
\end{question}

\begin{question}
  $\Z$ は整域である.
  \qed
\end{question}

\begin{question}
  $R$ が整域ならば $R$ 上の $n$ 変数多項式環 $R[x_1,\dots,x_n]$ も整域
  である.  \qed
\end{question}

可換環論について習いたての時期には
整域の元としては整数や多項式のようなものを想像しておけばよい.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ を体とし, $R$ は $K$ の元を成分に持つ $n$ 次の対角行列全体の集合である
  とすると, $R$ は自然に可換環をなす. $n\ge 2$ ならば $R$ は整域でない. 
  \qed
\end{question}

\noindent
ヒント: $n\ge 2$ のとき, 
$a=\diag(1,0,0,\ldots,0)$, $b=\diag(0,1,0,\ldots,0)$ と
置くと $ab=0$ である.  よって $n\ge 2$ のとき $R$ は整域でない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

可換環 $R$ の部分集合 $I$ が $R$ の{\bf イデアル (ideal)} であるとは
次の2つの条件が成立していることである:
\begin{enumerate}
\item 任意の $f,g\in I$ に対して $f+g\in I$;
\item 任意の $a\in R$ と $f\in I$ に対して $af\in I$.
\end{enumerate}
後者の条件を $RI\subset I$ と略記することがある%
\footnote{より正確に言えば $R$ の元と $I$ の元の積の有限和全体の
  集合を $RI$ と定義しておく.}.
$1\in R$ なので実際には $RI=I$ が成立している.

$R$ の部分集合 $I$ に対して, $I$ がイデアルであること
は $I$ の元たちの任意の $R$ 係数有限一次結合が $I$ に含まれることと同値である.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $I$ が $R$ のイデアルのとき $1\in I$ と $I=R$ は同値である. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$R$ のイデアル $I$, $J$ に対して, 
$I$ の元と $J$ の元の和全体の集合を $I+J$ と書き,
$I$ の元と $J$ の元の積の有限和全体の集合を $IJ$ と書くことにする.

\begin{question}
  $I$, $J$, $J'$ が可換環 $R$ のイデアルであるとき,
  $I+J$ と $I\cap J$ と $IJ$ も $R$ のイデアルであり,
  以下が成立している:
  \begin{enumerate}
  \item $IJ\subset I\cap J\subset I\subset I+J$.
  \item $I(J+J')=IJ+IJ'$,\quad $RI=I$,\quad $I+R=R$.
  \item $I\subset J$ ならば $I\cap J=I$, $I+J=J$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $f_1,\dots,f_n\in R$ に対して $R$ の部分集合 $I$ を次のように定める:
  \begin{equation*}
    I = Rf_1+\cdots+Rf_n 
    = \{\, a_1f_1+\cdots+a_nf_n \mid a_1,\dots,a_n\in R\}.
  \end{equation*}
  このとき $I$ は $f_1,\dots,f_n$ を含む最小のイデアルである.
  これを {\bf $f_1,\dots,f_n$ から生成されるイデアル (ideal generated 
  by $f_1,\dots,f_n$)} と呼び $(f_1,\dots,f_n)$ と表わす. 
  \qed
\end{question}

\noindent
ヒント: $I$ は $f_1,\dots,f_n$ の $R$ 係数一次結合全体の集合
なので $f_1,\dots,f_n$ を含むイデアルは $I$ を含んでいなければいけない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

整域 $R$ が{\bf 単項イデアル整域 (principal ideal domain)} 
もしくは {\bf PID} であるとは, $R$ の任意のイデアル $I$ に対して
ある $a\in R$ で $I=(a)=Ra$ を満たすものが存在することである.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[体のイデアルによる特徴付け]
\label{q:field-ideal}
  $R$ は可換環であるとする. 
  このとき $R$ が体であるための必要十分条件は $R$ のイデアルが $0$ と $R$ 以
  外に存在しないことである. 
  体のイデアルの全体は $(0)$, $(1)$ なので体は単項イデアル整域である.
  \qed
\end{question}

\noindent
ヒント: $R$ が体であるとき $I$ が $R$ の $0$ でないイデアル
ならば $0$ でない $a\in I$ が存在する. 
よって $1=a^{-1}a\in I$ であるから $I=R$ となる.  
$R$ が体でないならば逆元を持たない $0$ でない $a\in R$ が存在する.
このとき, $I=Ra$ は $R$ の $0$ でないイデアルであり, $1\not\in I$ である
から $I\ne R$ である.
\qed

\medskip
\noindent
解説: \secref{sec:module}で解説するように可換環 $R$ のイデアルの定義は $R$ 
自身の $R$ 部分加群の定義と一致し, 体 $K$ 上の加群の定義は体 $K$ 上のベクト
ル空間の定義と一致している.  上の問題の結論の意味は
「体上の1次元ベクトル空間の部分空間の次元は1以下になる」ということである.
単項イデアル整域の定義はこの事実の一般化になっている.
厳密な言い方ではないが「$M=Ru$ のように表わされる $R$ 加群 $M$ の``次元は1以
下''である」と仮にいうことにすれば,  
整域 $R$ が単項イデアル整域であるとは $R$ 自身の
任意の $R$ 部分加群の``次元が1以下''になることである.
もちろん一般の整域では``次元''の大きさに関するこのような直観は通用しない
(問題 \qref{q:K[x,y]-not-PID}, \qref{q:Z[x]-not-PID}).
``次元''の大きさに関する直観が通用する単項イデアル整域上の加群の世界は
体上のベクトル空間の世界の次に簡単になる.  
それとは対照的に一般の整域や可換環上の加群の世界はおそろしく複雑である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[体上の1変数多項式環はPID]
\label{q:K[x]-PID}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ の $0$ でない任意の
  イデアル $I$ に対して, 
  モニックな多項式 $f\in I$ で $I=K[\lambda]f=(f)$ を
  満たすものが一意に存在する. 
  よってモニックな多項式 $f\in K[\lambda]$ と $K[\lambda]$ の $0$ でない
  イデアルは一対一に対応している.
  特に $K[\lambda]$ は単項イデアル整域である.
  \qed
\end{question}

\noindent
ヒント: $I\ne\{0\}$ なので $I$ に含まれる $0$ でない多項式の中に
次数が最小の多項式 $f\in I$ が存在する.  
必要ならば最高次の係数で割ることによって $f$ はモニックなものに取れる.
任意に $g\in I$ を取り, $g$ を $f$ で割った余りを $r$ とする.
$r\in I$ でかつ $r$ の次数は $f$ より小さいので $f$ の次数の
最小性より $r=0$ である.  よって $g\in (f)$ である.
これで $I=(f)$ であることがわかった.
モニックな多項式 $f,g\in I$ が $I=(f)=(g)$ を満たしているとする.
このときある $a,b\in K[\lambda]$ が存在して $g=af$, $f=bg$ が成立する.
このとき, $g=af=abg$ なので $ab=1$ よって $a,b\in K\setminus\{0\}$ である.
しかし $f$ も $g$ もモニックなので $a=b=1$ である.
これで $f=g$ であることがわかった.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[$\Z$ はPID]
\label{q:Z-PID}
  $\Z$ の任意のイデアル $I$ に対して,
  非負の整数 $m\in I$ で $I=m\Z=(m)$ を満たすものが一意に存在する.
  よって $0$ 以上の整数 $m\in\Z_{\ge0}$ と $\Z$ のイデアルは
  一対一に対応している.
  特に $\Z$ は PID である.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:K[x]-PID} とまったく同様.
\qed

\medskip
\noindent
解説: 上の問題の結果を用いてよく使われる
問題 \qref{q:Euclidean-algorithm-3-Z} の結果を再証明しておこう. 
上の問題の結果より, $\Z$ は単項イデアル整域なので, 
任意の $m_1,\dots,m_N\in\Z$ に対して, 
ある $h\in\Z$ で $(m_1,\dots,m_N)=(h)$ を満たすものが存在する.
このとき $m_i\in h\Z$ なので $m_i$ はどれも $h$ で割り切れ,
$h\in m_1\Z+\cdots+m_N\Z$ なので $h$ は $m_1,\dots,m_N$ の
任意の公約数で割り切れる. よって $h$ は $m_1,\dots,m_N$ の最大公約数である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

問題 \qref{q:K[x]-PID}, \qref{q:Z-PID} より「割り算」できる整域は
単項イデアル整域になることがわかる. 

「割り算」ができる整域を正確に定義したもの
は {\bf Euclid 整域 (Euclidean domain)} と呼ばれている.
整域 $R$ が Euclid 整域であるとは, 
$\{0,1,2,\ldots\}$ と同型な全順序集合 $\cV$ と写像 $\sigma:R\to\cV$ が与えら
れていて%
\footnote{$\cV$ は任意の整列集合に取っても良い.}, 
以下の条件が成立していることである:
\begin{enumerate}
\item[(a)] 任意の $a\in R$ に対して $a=0$ であることと $\sigma(a)$ が $\cV$ 
  の最小限であることは同値である.
\item[(b)] 任意の $a,b\in R$ に対して, $a\ne 0$ ならばある $q,r\in R$ 
  で $b=aq+r$ かつ $\sigma(r)<\sigma(a)$ を満たすものが存在する%
  \footnote{商 $q$ と余り $r$ は一意的に定まらなくてもよい.}.
\end{enumerate}
このとき $\sigma$ を{\bf サイズ函数 (size function)} と呼ぶことにする.

たとえば, $R=\Z$ は $\cV=\{0,1,2,\ldots\}$, $\sigma(a)=|a|$ 
によって Euclid 整域であり, $R$ が体 $K$ 上の1変数多項式環 $K[\lambda]$ 
は $\cV=\{-\infty,0,1,2,\ldots\}$, $\sigma(a)=\deg a$ によって Euclid 整域で
ある. 便宜的に $\deg 0 = -\infty$ と定義しておいたのであった.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[\protect{$\Z[i]$} は Euclid 整域]
\label{q:Z[i]-Euclidean}
  $\Z[i]=\{m+ni\mid m,n\in\Z\}$ は自然に可換環をなす.
  $\Z[i]$ の元を {\bf Gauss 整数}と呼び, 
  $\Z[i]$ を {\bf Gauss の整数環} と呼ぶ.
  サイズ函数 $\sigma:\Z[i]\to\{0,1,2,\ldots\}$ 
  を $m+ni\in\Z[i]$ ($m,n\in\Z$) に対して $\sigma(m+ni)=|m+ni|^2=m^2+n^2$ と
  定めれば, $\Z[i]$ は Euclid 整域である.
  \qed
\end{question}

\noindent
ヒント: まず $\Z[i]$ を複素平面上に図示せよ.
$a,b\in\Z[i]$, $a\ne 0$ であるとする. 
このとき $b/a$ に最も近い $\Z[i]$ の元を $q$ と
すると, $\Z[i]$ の形より $|b/a - q|\le \sqrt{2}/2<1$ であることがわかる.
$|b-aq|<|a|$ であるから, $r=b-aq\in\Z[i]$ と置く
と $\sigma(r)=|r|^2=|b-aq|^2<|a|^2=\sigma(a)$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Z[omega]-Euclidean}
  $1$ の原始 $3$ 乗根を $\omega=e^{2\pi i/3}=(-1+\sqrt{-3})/2$ と書くことに
  する.  $\Z[\omega]=\{m+n\omega\mid m,n\in\Z\}$ は自然に可換環をなす.
  サイズ函数 $\sigma:\Z[\omega]\to\{0,1,2,\ldots\}$ 
  を $m+n\omega\in\Z[i]$ ($m,n\in\Z$) に
  対して $\sigma(m+n\omega)=|m+n\omega|^2=m^2-mn+n^2$ と
  定めれば, $\Z[\omega]$ は Euclid 整域である.
  \qed
\end{question}

\noindent
ヒント: まず $\Z[\omega]$ を複素平面上に図示せよ.
$a,b\in\Z[\omega]$, $a\ne 0$ であるとする. 
$b/a$ に最も近い $\Z[\omega]$ の元を $q$ と
すると, $\Z[\omega]$ の形より $|b/a - q|<1$ であることがわかる.
そのとき $|b-aq|<|a|$ であるから, $r=b-aq\in\Z[\omega]$ と置く
と $\sigma(r)=|r|^2=|b-aq|^2<|a|^2=\sigma(a)$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euclid整域はPID]
  Euclid 整域は PID である. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:K[x]-PID} とまったく同様.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:gcd-lcm-K[x]}
  体 $K$ 上の多項式 $f_1,\dots,f_n\in K[\lambda]$ に対して
  \begin{equation*}
    (f_1,\dots,f_n) = (g),
    \qquad
    (f_1)\cap\cdots\cap(f_n) = (h)
  \end{equation*}
  を満たす $g,h\in K[\lambda]$ が存在し, $g$ は $f_1,\dots,f_n$ の最大公約元
  になり, $h$ は $f_1,\dots,f_n$ の最小公倍元になる.
  \qed
\end{question}

\noindent
ヒント: そのような $g$ と $h$ の存在は問題 \qref{q:K[x]-PID} の
結果から得られる.  
$g\in (f_1,\dots,f_n)=K[\lambda]f_1+\cdots+K[\lambda]f_n$ なので $g$ 
は $f_1,\dots,f_n$ の任意の公約元で割り切れる.
$f_i\in K[\lambda]g$ なのでどの $f_i$ も $g$ で割り切れる. 
よって $g$ は $f_1,\dots,f_n$ の最大公約元である.
$(f_1)\cap\cdots\cap(f_n)=K[\lambda]f_1\cap\cdots\cap K[\lambda]f_n$ 
は $f_i$ たちの公倍元全体の集合なので $(f_1)\cap\cdots\cap(f_n) = (h)$ なら
ば $h$ は $f_i$ たちの公倍元であり, $f_i$ たちの任意の公倍元は $h$ で割り切
れる.  よって $h$ は $f_1,\dots,f_n$ の最小公倍元である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:gcd-lcm-Z}
  任意の整数 $a_1,\dots,a_n\in\Z$ に対して
  \begin{equation*}
    (a_1,\dots,a_n) = (b),
    \qquad
    (a_1)\cap\cdots\cap(a_n) = (c)
  \end{equation*}
  を満たす $b,c\in\Z$ が存在し, $b$ は $a_1,\dots,a_n$ の最大公約数
  になり, $c$ は $a_1,\dots,a_n$ の最小公倍元になる.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:gcd-lcm-K[x]} とまったく同様.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:K[x,y]-not-PID}
  体 $K$ 上の2変数多項式環 $K[x,y]$ のイデアル $I=(x,y)$ に対して,
  どのような $h\in I$ を取っても $I\ne (h)$ となる.
  よって $K[x,y]$ は単項イデアル整域ではない.
  \qed
\end{question}

\noindent
ヒント: 任意の $f\in K[x,y]$ に対して, $f\in I=(x,y)$ が成立するための
必要十分条件は $f$ の定数項が $0$ であることである.
よって $I\ne 0,K[x,y]$ である.
ある $h\in I$ で $I=(h)$ を満たすものが存在すると仮定して矛盾を導く.
ある $a,b\in K[x,y]$ が存在して $x=ah$, $y=bh$ となる.
$h\in K$ ならば $(h)=0,K[x,y]$ となるので $h\not\in K$ である.
すなわち $h$ は次数が $1$ 以上の多項式である.
よって $x=ah$ の両辺の多項式としての次数を考えると $a\in K\setminus\{0\}$ で
なければいけないことがわかる. 
よって $h = a^{-1}x$ なので $y=bh=a^{-1}bx$ となって矛盾する.
\qed

\medskip
\noindent
参考: 上の問題より, $n\ge 2$ のとき体上の $n$ 変数多項式環は PID にならない
こともわかる.  そのせいで多変数多項式環のイデアルの世界はおそろしく複雑にな
る.  それとは対照的に一変数多項式環のイデアルの世界は易しい.
幾何的には体上の $n$ 変数多項式環のイデアルは $n$ 次元アフィン空間内の代数的
な図形と対応している%
\footnote{Hilbert の基定理より $R=K[x_1,\dots,x_n]$ の任意のイデアル $I$ は
  ある $f_1,\dots,f_N\in I$ によって $I=(f_1,\dots,f_N)$ と表わされる.
l  このイデアルは $x_1,\dots,x_n$ に関する連立方程式 $f_1=\dots=f_n=0$ に対応
  していると考えられる.  
  たとえば $R=\R[x,y,z]$ のとき $I=(x^2+y^2-1, z)$ は $xy$ 平面上の単位円の
  方程式に対応している.}. 
次元が $1$ ならば直線上の図形なのでせいぜい有限個の点が並ぶ程度であり易しい.
しかし, 次元が $2$ 以上になると図形として曲線や曲面などが存在可能なのでおそ
ろしく複雑になる.  多変数多項式環のイデアルの世界がおそろしく複雑な理由は幾
何的にはこのように理解できる.  
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Z[x]-not-PID}
  体 $\Z$ 上の1変数多項式環 $\Z[x]$ のイデアル $I=(7,x)$ に対して,
  どのような $h\in I$ を取っても $I\ne (h)$ となる.
  よって $\Z[x]$ は単項イデアル整域ではない.
  \qed
\end{question}

\noindent
ヒント: $f\in \Z[x]$ に対して, $f\in I=(7,x)$ が成立するための
必要十分条件は $f$ の定数項が $7$ で割り切れることである.
よって $I\ne 0,\Z[x]$ である.
ある $h\in I$ で $I=(h)$ を満たすものが存在すると仮定して矛盾を導く.
ある $a,b\in\Z[x]$ が存在して $7=ah$, $x=bh$ となる.
$h=0,\pm1$ ならば $(h)=0,\Z[x]$ となるので $h\ne0,\pm1$ である.
$x$ に関する $7=ah$ の両辺の次数を考えると $a,h\in\Z$ で
あり,  $a=\pm1$, $h=\pm7$ であることがわかる.
よって $x=bh=\pm7 b$ となって矛盾する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{可換環上の加群}
\label{sec:module}

集合 $M$ が環 $R$ 上の{\bf 加群 (module over $R$)} 
もしくは{\bf $R$ 加群 ($R$-module)} であるとは
加法 $+:M\times M\to M$, ゼロ元 $0\in M$ 
と加法に関する逆元 $-:M\to M$ 
と $R$ の元の $M$ の元への作用 $\cdot:R\times M\to M$ が定義されていて, 
以下の $R$ 加群の公理が成立していることである%
\footnote{実は以下の定義において $R$ は非可換環であっても良い.
  その場合には非可換環 $R$ 上の{\bf 左 $R$ 加群 (left $R$-module)} の定義
  になる.  可換環上の加群については左加群と右加群を区別する必要はないが, 
  非可換環上の加群については左加群と右加群を区別する必要がある.

  たとえば, 複素 $n$ 次正方行列全体の集合 $M_n(\C)=M_{n,n}(\C)$ 
  は $n\ge2$ ならば自然に非可換環をなす.
  複素 $n$ 次元縦ベクトルには左から複素 $n$ 次正方行列をかけることができる
  ので, 複素 $n$ 次元縦ベクトル全体の空間 $M_{n,1}(\C)$ は自然に $M_n(\C)$
  上の左加群とみなされる.  同様に複素 $n$ 次元横ベクトルには右から複素 $n$ 
  次正方行列をかけることができるので, 複素 $n$ 次元横ベクトル全体の
  空間 $M_{1,n}(\C)$ は自然に $M_n(\C)$ 上の右加群とみなされる.
  この場合には縦ベクトルと横ベクトルの違いが左加群と右加群の違いに対応してい
  る.}:
\begin{enumerate}
\item $M$ は加法に関して可換群をなす. 
  すなわち任意の $u,v,w\in M$ に対して,
  \begin{enumerate}
  \item $(u + v) + w = u + (v + w)$;
  \item $0 + u = u + 0 = u$;
  \item $(-u) + u = u + (-u) = 0$;
  \item $u + v = v + u$.
  \end{enumerate}
\item スカラー倍 $\cdot:R\times M\to M$ は結合的かつ{\bf 双加法的 
  (bi-additive)} であり, $1\in R$ の作用は恒等写像になる.
  すなわち任意の $a,b\in R$, $u,v\in M$ に対して,
  \begin{enumerate}
  \item $(ab)u = a(bu)$;
  \item $a(u + v) = au + av$;
  \item $(a + b)u = au + bu$;
  \item $1u = u$.
  \end{enumerate}
\end{enumerate}
$R$ が体ならばこの公理は体上のベクトル空間の公理に等しい.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  たとえば $R$ 自身は自然に $R$ 加群とみなせる.
  数ベクトル空間の場合と同様に $n$ 個の $R$ の元の組全体の
  集合 $R^n$ も自然に $R$ 加群をなす.
  この事実を正確に説明せよ.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$M$ が $R$ 加群であるとき, $M$ の部分集合 $N$ が $M$ 
の {\bf $R$ 部分加群 ($R$-submodule)} であるとは
次の2つの条件が成立していることである:
\begin{enumerate}
\item 任意の $u,v\in N$ に対して $u+v\in N$;
\item 任意の $a\in R$ と $u\in N$ に対して $au\in N$.
\end{enumerate}
後者の条件を $RN\subset N$ と略記することがある%
\footnote{より正確に言えば, $R$ の元と $N$ の元の積の有限和全体の
  集合を $RN$ と定義しておく.}.
$1\in R$ なので実際には $RN=N$ が成立している.

イデアルは部分加群の特別な場合である.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  可換環 $R$ のイデアルの定義と $R$ 自身の $R$ 部分加群の定義が一致している
  ことを確かめよ. 
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $L$ が $R$ 加群であり, $M$, $N$ が $L$ の $R$ 部分加群であるとき, 
  $M$ との元と $N$ の元の和全体の集合 $M+N$ と $M\cap N$ は共に $L$ の $R$ 部
  分加群になる.  さらに $I$ が $R$ のイデアルであるとき $I$ の元と $M$ の元
  の積の有限和全体の集合 $IM$ は $M$ の $R$ 部分加群である.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$M$, $N$ が $R$ 加群であるとき, 写像 $\phi:M\to N$ が $R$ 上の
{\bf 準同型写像 (homomorphism over $R$)} もしくは
{\bf $R$ 準同型 ($R$-homomorphism)} であるとは
次の2つの条件が成立していることである:
\begin{enumerate}
\item 任意の $u,v\in M$ に対して $\phi(u+v)=\phi(u)+\phi(v)$.
\item 任意の $a\in R$ と $u\in M$ に対して $\phi(au)=a\phi(u)$.
\end{enumerate}
$R$ が体ならば $R$ 準同型の定義は体上の線形写像の定義に一致する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  可換環 $R$ の元を成分に持つ $(m,n)$ 型行列全体の集合を $M_{m,n}(R)$ と
  表わし, $n$ 次正方行列全体の集合を $M_n(R)$ と表わす.
  ベクトル空間の場合と同様に $R^n$ と縦ベクトルの空間 $M_{n,1}(R)$ を
  同一視しておく.
  このとき行列 $A\in M_{m,n}(R)$ に対して写像 $\phi:R^n\to R^m$ 
  を $\phi(u)=Au\in M_{m,1}(R)$ ($u\in R^n=M_{n,1}(R)$) と定める
  と $\phi$ は $R$ 準同型である.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:R-hom-matrix}
  任意の $R$ 準同型 $\phi:R^n\to R^m$ は $(m,n)$ 型
  行列 $A\in M_{m,n}(R)$ で一意的に表現できる.
  \qed
\end{question}

\noindent
ヒント: ベクトル空間の場合と同様である.
第 $i$ 成分だけが $1$ で他の成分が $0$ であるような $R^n$ の
元を $e_i$ と書くことにする.  文脈によって区別が付く場合は $R^m$ 
の $e_i$ も同じ記号 $e_i$ で表わすことにする. 
$R$ 準同型 $\phi:R^n\to R^m$ を与える行列 $A\in M_{m,n}(R)$ は
次の式によって得られる:
\begin{equation*}
  [\phi(e_1),\dots,\phi(e_n)] = [e_1,\dots,e_m]A = A.
\end{equation*}
このとき $x=\tp{[x_1,\dots,x_n]}\in R^n$ に対して
\begin{align*}
  \phi(x) 
  &
  = \phi(x_1e_1+\cdots+x_ne_n)
  = x_1\phi(e_1) + \cdots + x_n\phi(e_n)
  \\ &
  = \phi(e_1)x_1 + \cdots + \phi(e_n)x_n
  = [\phi(e_1),\dots,\phi(e_n)]x
  = Ax.
\end{align*}
これで $\phi$ の行列表現が存在することがわかった. 
$A,B\in M_{m,n}$ が $\phi(x)=Ax=Bx$ ($x\in R^n$) を満たしている
ならば $(\text{$A$ の第 $i$ 列})=Ae_i=Be_i=(\text{$B$ の第 $i$ 列})$ と
なるので $A=B$ である.  これで行列表現の一意性もわかった.
\qed

\medskip
\noindent
解説: 注意 $R$ が体でないならば $R^n$ と同型でない有限生成 $R$ 加群が存在す
る. たとえば $R=\Z$ のとき $M=\Z/24\Z$ は有限群なので絶対に $\Z^n$ と同型に
ならない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[同型写像]
  $R$ 加群のあいだの $R$ 準同型 $\phi:M\to N$ が逆写像 $\phi^{-1}$ を持つと
  き, $\phi^{-1}$ も $R$ 準同型になる.
  このとき $\phi$ は {\bf $R$ 同型 ($R$-isomorphism)} であるという.
  $R$ 加群 $M$, $N$ のあいだに $R$ 同型が存在するとき, 
  $M$ と $N$ は {\bf $R$ 上同型 (isomorphic over $R$)} であるという.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[核と像]
  $R$ 加群のあいだの $R$ 準同型 $\phi:M\to N$ に対して, 
  その{\bf 核 (kernel)} $\Ker\phi$ と{\bf 像 (image)} $\Image\phi$ が次のよ
  うに定義される: 
  \begin{equation*}
    \Ker\phi = \phi^{-1}(0) = \{\, u\in M \mid \phi(u) = 0 \,\},
    \qquad
    \Image\phi = \phi(M) = \{\, \phi(u) \mid u \in M \,\}.
  \end{equation*}
  このとき, $\Ker\phi$ は $M$ の $R$ 部分加群であり, 
  $\Image\phi$ は $N$ の $R$ 部分加群である.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $R$ 加群のあいだの準同型写像 $\phi:M\to N$ に対して以下が成立する:
  \begin{enumerate}
  \item $M$ の $R$ 部分加群 $M'$ に対して $\phi(M')$ は $N$ の $R$ 部分加群
    である.
  \item $N$ の $R$ 部分加群 $N'$ に対して $\phi^{-1}(N')$ は $M$ の $R$ 部分
    加群である.
  \item $M$ の $R$ 部分加群 $M'$ に対して $\phi^{-1}(\phi(M'))=M'+\Ker\phi$.
  \item $N$ の $R$ 部分加群 $N'$ に
    対して $\phi(\phi^{-1}(N'))=N'\cap\Image\phi$. 
  \item $\phi$ が全射ならば,  $\Ker\phi$ を含む $M$ の $R$ 部分加群 $M'$
    と $N$ の $R$ 部分加群 $N'$ が対応 $M'\mapsto N'=\phi(M')$ 
    およびその逆対応 $N'\mapsto M'=\phi^{-1}N'$ によって一対一に対応する.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 1, 2, 3, 4 から 5 が出る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

\begin{question}[直積加群]
\label{q:direct-product-module}
  可換環 $R$ 上の加群の族 $\{M_i\}_{i\in I}$ の
  直積集合 $\prod_{i\in I}M_i$ には自然に $R$ 群の構造が入る.
  そして各 $i\in I$ に対して写像 $\pi_i:\prod_{j\in I}M_j\to M_i$ 
  を $\pi_i((v_j)_{j\in I})=v_i$ と定めると, $\pi_i$ は全射 $R$ 準同型である.
  以上を確かめよ.
  $R$ 加群としての $\prod_{i\in I}M_i$ を $\{M_i\}_{i\in I}$ 
  の{\bf 直積加群 (direct product module)} と呼ぶ.
  \qed
\end{question}

\noindent
ヒント: $M=\prod_{i\in I}M_i$ の加法は各成分ごとに
定め, $a\in R$ と $(v_i)_{i\in I}\in M$ 
に対して $a(v_i)_{i\in I}=(av_i)_{i\in I}$ と定める.
\qed

\begin{question}[直和加群1]
\label{q:direct-sum-module-1}
  可換環 $R$ 上の加群の直積 $\prod_{i\in I}M_i$ の $R$ 部分
  加群 $\bigoplus_{i\in I}M_i$ を次のように定めることができる:
  \begin{equation*}
    \bigoplus_{i\in I}M_i = 
    \Bigl\{\, (v_i)_{i\in I} \in \prod_{i\in I}M_i 
    \Bigm| \text{有限個を除いて $v_i=0$} \,\Bigr\}.
  \end{equation*}
  特に $I$ が有限集合ならば $\bigoplus_{i\in I}M_i=\prod_{i\in I}M_i$ である.
  写像 $\iota_i:M_i\to\bigoplus_{j\in I}M_j$ 
  を $\iota_i(v_i)=(v_{i,j})_{j\in I}$ と定める.
  ここで $v_{i,i}=v_i$ でかつ $j\ne i$ のとき $v_{i,j}=0\in M_j$ である.
  このとき $\iota_i$ は単射 $R$ 準同型である.
  以上を確かめよ.
  通常 $M_i$ と $\iota_i(M_i)\subset\bigoplus_{i\in I}M_i$ は $\iota_i$ を通
  して同一視され, $\bigoplus_{i\in I}M_i$ は $\{M_i\}_{i\in I}$ 
  の{\bf 直和加群 (direct sum module)} と呼ばれる.
  \qed
\end{question}

$I=\{1,\dots,n\}$ のとき直積加群と直和加群を次のように書くことも多い:
\begin{equation*}
  \prod_{i\in I}M_i = M_1\times\cdots\times M_n,
  \qquad
  \bigoplus_{i\in I}M_i = M_1\oplus\cdots\oplus M_n.
\end{equation*}
たとえば
\begin{equation*}
  R^n 
  = \overbrace{R\times\cdots\times R}^{\text{$n$ times}}
  = \overbrace{R\oplus\cdots\oplus R}^{\text{$n$ times}}.
\end{equation*}

\begin{question}[直和加群2]
\label{q:direct-sum-module-2}
  可換環 $R$ 上の加群 $M$ の部分加群の族 $\{M_i\}_{i\in I}$ が与えられた
  とき, $R$ 準同型 $\phi:\bigoplus_{i\in I}M_i\to M$ 
  を $\phi((v_i)_{i\in I})=\sum_{i\in I}v_i$ と定めることができる.
  右辺の和は直和加群の定義より有限和なので well-defined である.
  このとき以下の条件は互いに同値である:
  \begin{enumerate}
  \item[(a)] $\phi:\bigoplus_{i\in I}M_i\to M$, 
    $(v_i)_{i\in I}\mapsto\sum_{i\in I}v_i$ は $R$ 同型である.
  \item[(b)] 任意の $v\in M$ が $v = \sum_{i\in I} v_i$ \enspace
    ($v_i\in M_i$ であり, 有限個を除いて $v_i=0$) と一意に表わされる.
  \end{enumerate}
  この条件が成立するとき $\phi$ を
  通して $\bigoplus_{i\in I}M_i$ と $M$ を同一視して,
  $M$ は部分加群 $M_i$ たちの直和であるということが多い.
  \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{商加群と加群の準同型定理}
\label{sec:quotient-module}

以下 $R$ は可換環であるとする.

$R$ 加群 $M$ とその $R$ 部分加群 $N$ に対して, $M$ を $N$ で
割ってできる{\bf 商加群 (quotient module)} $M/N$ が以下のように定義される.
まず各 $u\in M$ に対して $u\MOD N$ を次のように定める:
\begin{equation*}
  u\MOD N := u + N = \{\, u + v \mid v\in N \,\}.
\end{equation*}
さらに $M/N$ を次のように定める:
\begin{equation*}
  M/N := \{\, u\MOD N \mid u \in M \,\}.
\end{equation*}
$M/N$ には以下の条件によって $R$ 加群の構造を入れることができる:
\begin{enumerate}
\item $u,v\in M$ に対して $(u\MOD N) + (v\MOD N) = (u+v)\MOD N$.
\item $a\in R$ と $u\in M$ に対して $a(u\MOD N) = (au)\MOD N$.
\end{enumerate}
ただし, この定義が well-defined でかつ実際に $R$ 加群の構造を $M/N$ に定める
ことをチェックしなければいけない.

\begin{question}
  実際にそのことを以下の方針でチェックせよ.
  \begin{enumerate}
  \item $u,v\in M$ に対して $u\MOD N=v\MOD N$ と $u-v\in N$ は同値である.
  \item $u,u',v,v'\in M$ は $u\MOD N=u'\MOD N$, $v\MOD N=v'\MOD N$ を満たし
    ていると仮定する.  このとき $(u+v)-(u'+v')=(u-u')+(v-v')\in N$ である.
    よって $(u+v)\MOD N = (u'+v')\MOD N$ である.
    これで $(u\MOD N) + (v\MOD N)$ が $u,v$ の取り方によらずに
    うまく定義されることがわかった.
  \item $u,u'\in M$ は $u\MOD N=u'\MOD N$ を満たし
    ていると仮定する.  このとき $a\in R$ に
    対して $au-au'=a(u-u')\in N$ である.
    よって $(au)\MOD N = (au')\MOD N$ である.
    これで $a(u\MOD N)$ が $u$ の取り方によらずに
    うまく定義されることがわかった.
  \item $M$ が $+$ について可換群をなすことから, 
    $M/N$ が $+$ について可換群をなすことを導ける.
  \item $M$ が $R$ 加群であることから $M/N$ も $R$ 加群であることを導ける.
  \item 自然な写像 $\pi:M\to M/N$, $u\mapsto u\MOD N$ は全射 $R$ 準同型であ
    る.
  \item $\Ker\pi = N$ である.
    \qed
  \end{enumerate}
\end{question}
体 $K$ 上のベクトル空間の商加群は{\bf 商ベクトル空間 (quotient vector
space)} と呼ばれる.

商加群を理解するときに $u\MOD N = u + N$ を $M$ の部分集合であることにこだわ
り続けてはいけない.  $u\MOD N = u + N$ をあたかも「一点」であるかのように
考えなければいけない.

$u$ を通る $N$ に「平行」な $M$ の部分空間 $u+N$ の上の点をすべて同一の点だ
とみなしてできる加群が $M/N$ である.  直観的に $M/N$ は $M$ を $N$ 方向に潰
してできる加群である.

代数学において記号法 $M/N$ は $M$ の中の $N$ を $0$ に潰してできる空間という
意味で使われる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\R^3$ の部分空間 $Z$ を $Z=\{\,(0,0,z)\mid z\in\R\,\}$ と定める.
  このとき, $\R^3/Z$ は $\R$ 上の2次元のベクトル空間になる.
  \qed
\end{question}

\noindent
ヒント: $e_1\MOD Z$, $e_2\MOD Z$ が $\R^3/Z$ の基底をなすことを示せ. \qed

\medskip
\noindent
解説: $\R^3/Z$ は直観的に3次元空間 $\R^3$ を $z$ 軸方向に潰してできる2次元空
間だとみなせる. すなわち $\R^3$ の中の $z$ 軸に平行な直線を「一点」に潰して
できる2次元空間が $\R^3/Z$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\Z$ 加群 $\Z$ を部分加群 $3\Z$ で割ってできる $\Z$ 加群 $\Z/3\Z$ 
  の元の個数は $3$ である.
  \qed
\end{question}

\noindent
ヒント: $\Z/3\Z=\{3\Z,\, 1+3\Z,\, 2+3\Z\}$ である. 
\qed

\medskip
\noindent
解説: $\Z/3\Z$ は $3$ の倍数をすべて $0$ と同一視してできる加群である.
$\Z/3\Z$ において $3$ の倍数はすべて $0$ と同一視されているので
差が $3$ の倍数であるような2つの数はすべて同一視される.
結果的に $\Z/3\Z$ は $3$ で割った余りの値で整数全体を分類してできる空間になる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

$R$ 加群のあいだの $R$ 準同型 $\phi:M\to N$ に対して, 
その{\bf 余核 (cokernel)} $\Coker\phi$ と{\bf 余像 (coimage)} $\Coimage\phi$ 
が次のように定義される: 
\begin{equation*}
  \Coker\phi = N/\Image\phi,
  \qquad
  \Coimage\phi = M/\Ker\phi.
\end{equation*}

\begin{question}
  $R$ 加群のあいだの $R$ 準同型 $\phi:M\to N$ に対して以下が成立する:
  \begin{enumerate}
  \item $\phi$ が単射 $\iff$ $\Ker\phi=0$.
  \item $\phi$ が全射 $\iff$ $\Coker\phi=0$.
  \item $\phi$ が同型 $\iff$ $\Ker\phi=0$ かつ $\Coker\phi=0$.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

次の{\bf 準同型定理 (homomorphism theorem)} は準同型写像に関する最も基本的な
結果であり, 空気のごとく自由に使われる.

\begin{question}[加群の準同型定理]
  $R$ 加群のあいだの $R$ 準同型 $\phi:M\to N$ は
  次の $R$ 同型を誘導 (induce) する:
  \begin{equation*}
    \tilde\phi:
    \Coimage\phi \isomto \Image\phi,
    \quad
    u\MOD\Ker\phi \mapsto \phi(u).
  \end{equation*}
  $\Image\phi=\phi(M)$ と $\Coimage\phi=M/\Ker\phi$ を代入すれば
  この同型は次のように表わされる:
  \begin{equation*}
    \tilde\phi:
    M/\Ker\phi \isomto \phi(M),
    \quad
    u\MOD\Ker\phi \mapsto \phi(u).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 記号の簡単のため $N=\Ker\phi$ と置く.
$u,u'\in M$ が $u\MOD N = u'\MOD N$ を満たしている
とき, $u-u'\in N$ なので $\phi(u)-\phi(u')=\phi(u-u')=0$ である.
よって $\tilde\phi$ は well-defined である.
$u,v\in M$ と $a\in R$ に対して,
\begin{align*}
  &
  \tilde\phi((u\MOD N)+(v\MOD N))
  = \tilde\phi((u+v)\MOD N)
  \\ &
  = \phi(u+v)
  = \phi(u) + \phi(v)
  =\tilde\phi(u\MOD N) + \tilde\phi(v\MOD N),
  \\[\medskipamount] &
  \tilde\phi(a(u\MOD N))
  = \tilde\phi((au)\MOD N)
  = \phi(au)
  = a\phi(u)
  = a\tilde\phi(u\MOD N).
\end{align*}
これで $\tilde\phi$ が $R$ 準同型であることがわかった.
任意の $\phi(u)\in\phi(M)$ に対して $\tilde\phi(u\MOD N)=\phi(u)$ で
あるから $\tilde\phi$ は全射である.
任意の $u\in M$ に対して $0=\tilde\phi(u\MOD N)=\phi(u)$ ならば $u\in N$ 
であり, よって $M/N$ の中で $u\MOD N = 0$ である. 
これで $\tilde\phi$ が単射であることもわかった.
全単射準同型は同型写像である.  
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:dim-K[x]/(f)}
  体 $K$ 上の一変数 $n$ 次多項式 $f\in K[\lambda]$ を任意に取る.
  このとき $f$ で生成されるイデアル $(f)=K[\lambda]f$ は $K[\lambda]$ 自身
  の $K[\lambda]$ 部分加群である.
  よって $K[\lambda]$ 自身の商加群 $K[\lambda]/(f)$ が定義される.
  $K\subset K[\lambda]$ なので自然に $K[\lambda]$ 加群は $K$ 上のベクトル空
  間とみなされる. 
  $K[\lambda]/(f)$ は $K$ 上の $n$ 次元のベクトル空間である.
  \qed
\end{question}

\noindent
ヒント: 次数が $n$ 未満の多項式全体のなす $K[\lambda]$ の $K$ 部分ベクトル空
間を $V$ と書く.  $\dim_K V = n$ である.  
自然な写像 $\pi:K[\lambda]\to K[\lambda]/(f)$, $a\mapsto a\MOD f$ の $V$ 上
への制限 $\phi=\pi|_V$ が $K$ 同型であることを示す%
  \footnote{$K[\lambda]/(f)$ の元を $g\MOD(f)$ の代わりに $g\MOD f$ と書くこ
    とにする.   $g\MOD f$ を「$g$ モッド $f$」と読んだり, 「$g$ modulo $f$」
    と読んだりする.  直観的に $g\MOD f$ は $g$ を $f$ で割った余りのことであ
    る.}. 
$a\in K$, $g\in K[\lambda]$ に
対して $\phi(ag)=(ag)\MOD f= a(g\MOD f)=a\phi(g)$ なの
で $\phi$ は $K$ 線形写像である.
$g\MOD f\in K[\lambda]/(f)$ が $0$ であるための
必要十分条件は $g$ が $f$ で割り切れる
ことである.  $g\in V$ のとき $\deg g < n$ なので $\phi(g)=g\MOD f=0$ 
ならば $g=0$ である. よって $\phi:M\to K[\lambda]/(f)$ は単射である.
任意の $g\in K[\lambda]$ に対して $g$ を $f$ で割った余りを $r\in V$ と
書くと, $g-r\in (f)$ なので $\phi(r)=r\MOD f=g\MOD f$ である.
よって $\phi:M\to K[\lambda]/(f)$ は全射である.
これで $\phi$ が $K$ 同型であることがわかった.
\qed

\medskip
\noindent
解説: 上の問題とそのヒントは $K[\lambda]/(f)$ は「$f$ で割った余り」全体のな
す $K[\lambda]$ 加群とみなせることを示している.  
直観的に $K[\lambda]/(f)$ は一変数多項式環 $K[\lambda]$ の中で $f$ およびそ
の多項式倍を $0$ とみなすことによってできる加群である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:|Z/nZ|}
  任意に正の整数 $n\in\Z$ を取る.
  このとき $n$ で生成されるイデアル $(n)=n\Z$ は $\Z$ 自身の $\Z$ 部分加群で
  ある.  よって $\Z$ 自身の商加群 $\Z/n\Z$ が定義される.
  このとき $\Z/n\Z$ の元の個数は $n$ である.
  \qed
\end{question}

\noindent
ヒント: 集合 $N$ を $N=\{0,1,2,\dots,n-1\}$ と定める.
自然な写像 $\pi:\Z\to \Z/n\Z$, $a\mapsto a\MOD n$ の $N$ 上への
制限 $\phi=\pi|_N$ が全単射であることを示す%
  \footnote{$\Z/(n)=\Z/n\Z$ の元を $a\MOD(n)$ や $a\MOD n\Z$ の
    代わりに $a\MOD n$ と書くことにする. 
    直観的に $a\MOD n$ は $a$ を $n$ で割った余りのことである.}.
$a\MOD n\in\Z/n\Z$ が $0$ であるための必要十分条件は $a$ が $n$ で割り切れる
ことである.  $a\in N$ のとき $0\le a < n$ なので $\phi(a)=a\MOD m=0$ 
ならば $a=0$ である. よって $\phi:N\to\Z/n\Z$ は単射である.
任意の $a\in\Z$ に対して $a$ を $n$ で割った余りを $r\in N$ と
書くと, $a-r\in n\Z$ なので $\phi(r)=r\MOD n=a\MOD n$ である.
よって $\phi:N\to\Z/n\Z$ は全射である.
これで $\phi$ が全単射であることがわかった.
\qed

\medskip
\noindent
解説: 上の問題とそのヒントは $\Z/n\Z$ は「$n$ で割った余り」全体の
なす加群とみなせることを示している.  
直観的に $\Z/n\Z$ は有理整数環 $\Z$ の中で $n$ および
その倍数を $0$ とみなすことによってできる加群である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

以下の{\bf 同型定理たち (isomorphism theorems)} は非常に有用である.

\begin{question}
\label{q:isom-theorem-1}
  $R$ 加群のあいだの全射 $R$ 準同型 $\phi:M\to N$ と $N$ の $R$ 
  部分加群 $N'$ に対して, $\phi^{-1}(N')$ は $M$ 
  の $R$ 部分加群であり, 次の $R$ 同型が存在する:
  \begin{equation*}
    M/\phi^{-1}(N') \isomto N/N',
    \quad
    u\MOD\phi^{-1}(N') \mapsto \phi(u)\MOD N'.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $N$ から $N/N'$ への自然な全射 $R$ 準同型 $v\mapsto v\MOD N'$ 
を $N\onto N'$ と書くことにする.  
$R$ 準同型の列 $M \xrightarrow{\;\phi\;} N \onto N/N'$ の合成が全射で
かつその核が $\phi^{-1}(N')$ であることを示し, 準同型定理を適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[第二同型定理]
\label{q:isom-theorem-2}
  $R$ 加群 $L$ の2つの $R$ 部分加群 $M$, $N$ に対して
  次の $R$ 同型が存在する:
  \begin{equation*}
    M/(M\cap N) \isomto (M+N)/N,
    \quad
    u\MOD M\cap N \mapsto u\MOD N.
    \qed
  \end{equation*}
\end{question}

\noindent
参考: 準同型定理を{\bf 第一同型定理 (first isomorphism theorem)} と
呼ぶことがある. \qed

\medskip
\noindent
ヒント: 集合 $A$ が集合 $X$ の部分集合であるとき $A$ の $X$ への
{\bf 包含写像 (inclusion mapping)} を $A\injto X$ と書くことにする.
$R$ 準同型の列 $M\injto M+N\onto (M+N)/N$ の合成が全射で
かつその核が $M\cap N$ であることを示し, 準同型定理を適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[第三同型定理]
\label{q:isom-theorem-3}
  $R$ 加群 $L$ とその $R$ 部分加群 $N\subset M\subset L$ に対して, 
  $M/N$ は $L/N$ の $R$ 部分加群になり, 次の $R$ 同型が存在する:
  \begin{equation*}
    L/M \isomto (L/N)/(M/N),
    \quad
    u\MOD M \mapsto (u\MOD N)\MOD M/N.
  \end{equation*}
\end{question}

\noindent
ヒント: $R$ 準同型の列 $L\onto L/N\onto (L/N)/(M/N)$ の合成が全射で
かつその核が $M$ であることを示し, 準同型定理を適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

次の結果もよく使われる.

\begin{question}
\label{q:quot-sum}
  $\{M_i\}_{i\in I}$ は $R$ 加群の族であり, 
  各 $i\in I$ に対して $N_i$ は $M_i$ の $R$ 部分加群であるとする.
  このとき $\bigoplus_{i\in I}N_i$ は自然に $\bigoplus_{i\in I}M_i$ 
  の $R$ 部分加群とみなせ, 次の自然な $R$ 同型が存在する:
  \begin{equation*}
    \bigoplus_{i\in I}M_i\Big/\bigoplus_{i\in I}N_i
    \isomto \bigoplus_{i\in I}M_i/N_i,
    \quad
    (v_i)_{i\in I}\MOD \bigoplus_{i\in I}N_i
    \mapsto
    (v_i\MOD N_i)_{i\in I}.
  \end{equation*}
  つまり直和を構成する操作と商加群を構成する操作は可換である%
  \footnote{直和は他の多くの操作と可換になる. ここでは曖昧に「操作」という言
    葉を使っているが, {\bf 圈 (category)} と{\bf 函手 (functor)} の言葉を
    使えばより正確に「操作」の概念を扱うことができる. 
    {\bf 加法圈 (additive category)} のあいだの
    {\bf 加法函手 (additive functor)} は常に有限直和と可換になる.  
    加群の準同型定理に類似の結果が成立している加法圈
    は {\bf Abel 圈 (Abelian category)} と呼ばれており, 
    {\bf ホモロジー代数 (homological algebra)} のような道具の
    基礎になっている.}.
  \qed
\end{question}

\noindent
ヒント: $R$ 準同型 $\phi:\bigoplus_{i\in I}M_i\to\bigoplus_{i\in I}M_i/N_i$ 
を $\phi((v_i)_{i\in I})=(v_i\MOD N_i)_{i\in I}$ と定めることができる.
これに準同型定理を適用せよ
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{剰余環と環の準同型定理}
\label{sec:ring-hom}

可換環のあいだの写像 $\phi:A\to B$ が{\bf 環準同型 (ring homomorphism)} で
あるとは以下の条件を満たしていることである:
\begin{enumerate}
\item 任意の $a,b\in A$ に対して $\phi(a+b)=\phi(a)+\phi(b)$ 
  かつ $\phi(ab)=\phi(a)\phi(b)$.
\item $\phi(1)=1$.
\end{enumerate}

\begin{question}[剰余環]
  $A$ は任意の可換環であり, $I$ はそのイデアルであるとする.
  このとき $A$ 自身の商加群 $A/I$ には次によって自然に可換環の構造が入る:
  \begin{equation*}
    (a\MOD I)\cdot(b\MOD I) := (ab)\MOD I
    \qquad (a,b\in A).
  \end{equation*}
  $A/I$ を $A$ の{\bf 剰余環 (residue ring)} 
  もしくは{\bf 商環 (quotient ring)} と呼ばれる.  
  自然な写像 $\pi:A\to A/I$, $a\mapsto a\MOD I$ は
  環準同型である.  \qed
\end{question}

\noindent
ヒント: $a,a',b,b'\in A$ が $a\MOD I=a'\MOD I$, $b\MOD I=b'\MOD I$ を満たし
ているとき, $a-a',b-b'\in I$ であるから, $
  ab - a'b' = ab - ab' + ab' - a'b' = a(b-b')+b'(a-a')\in I
$ である.  よって $A/I$ における積は well-defined である.  
$A/I$ が可換環をなすことが $A$ が可換環であることより容易に導かれる. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[環の同型写像]
  可換環のあいだの環準同型 $\phi:A\to B$ が逆写像 $\phi^{-1}$ を
  持つとき, $\phi^{-1}$ も環準同型である.
  このとき $\phi$ は{\bf 環の同型写像 (ring isomorphism)} であるという.
  可換環 $A$ と $B$ が{\bf 環として同型 (isomorphic as rings)}である
  とは $A$ と $B$ のあいだの環の同型写像が存在することである. \qed
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

可換環 $A$ の部分集合 $B$ が和と差と積に関して閉じており $1$ を
含むならば $B$ は自然に可換環をなす.
そのとき $B$ は {\bf $A$ の部分環 (subring of $A$)} であるという.

可換環のあいだの環準同型 $\phi:A\to B$ に対してもその核と像が
加群のあいだの準同型写像の場合と同様に定義される:
\begin{equation*}
  \Ker\phi = \{\, a\in A \mid \phi(a) = 0 \,\},
  \qquad
  \Image\phi = \phi(A) = \{\, \phi(a) \mid a \in A \,\}.
\end{equation*}

\begin{question}
\label{q:phi:A->B}
  $\phi:A\to B$ は可換環のあいだの環準同型であるとすると以下が成立する:
  \begin{enumerate}
  \item $A'$ が $A$ の部分環であれば $\phi(A')$ は $B$ の部分環である.
  \item $B'$ が $B$ の部分環であれば $\phi^{-1}(B')$ は $A$ の部分環である.
  \item $I$ が $A$ のイデアルであれば $\phi(I)$ は $\phi(A')$ のイデアルであ
    る.  しかし $\phi(I)$ は $B$ のイデアルであるとは限らない.
  \item $J$ が $B$ のイデアルであれば $\phi^{-1}(J)$ は $A$ のイデアルである.
  \item $I$ が $A$ のイデアルであれば $\phi^{-1}(\phi(I))=I+\Ker\phi$.
  \item $J$ が $B$ のイデアルであれば $\phi(\phi^{-1}(J))=J\cap\Image\phi$.
  \item もしも $\phi$ が全射ならば, $\Ker\phi$ を含む $A$ のイデアル $I$ 
    と $B$ のイデアル $J$ は対応 $I\mapsto J=\phi(I)$ 
    と逆対応 $J\mapsto I=\phi^{-1}(J)$ によって一対一に対応する.
  \end{enumerate}
\end{question}

\noindent
ヒント: 3 の後半は次のような例がある. 
$A=\Z$, $B=\Z[x]$ であるとし, $\phi$ は $\Z\subset\Z[x]$ の包含写像であると
する.  このとき任意の $m\in\Z_{\ne0}$ に対して, $I=m\Z$ は $A=\Z$ のイデアル
であるが $\phi(I)=m\Z\subset\Z[x]$ は $B=\Z[x]$ のイデアルではない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[環の準同型定理]
  可換環のあいだの環準同型 $\phi:A\to B$ に対して $\Ker\phi$ は $A$ の
  イデアルになり, $\Image\phi$ は $B$ の部分環をなす.
  しかも次の自然な環の同型写像が存在する:
  \begin{equation*}
    \tilde\phi: A/\Ker\phi \isomto \Image\phi,
    \quad
    a\MOD\Ker\phi \mapsto \phi(a).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 加群の準同型定理とほとんど同じ. \qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:ring-isom-theorem-1}
  可換環のあいだの全射環準同型 $\phi:A\to B$ と $B$ のイデアル $J$ に
  に対して, $\phi^{-1}(J)$ は $A$ のイデアルであり, 
  次の環同型が存在する:
  \begin{equation*}
    A/\phi^{-1}(J) \isomto B/J,
    \quad
    a\MOD\phi^{-1}(J) \mapsto \phi(a)\MOD J.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $A\to B\onto B/J$ の合成に準同型定理を適用せよ. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[第二同型定理]
\label{q:ring-isom-theorem-2}
  可換環 $A$ とそのイデアル $I$ と部分環 $B$ に対して, 
  $B\cap I$ は $B$ のイデアルになり,
  次の環同型が存在する:
  \begin{equation*}
    B/(B\cap I) \isomto (B+I)/I,
    \quad
    a\MOD B\cap I \mapsto a\MOD I.
    \qed
  \end{equation*}
\end{question}

\medskip
\noindent
ヒント: $B\injto B+I\onto (B+I)/I$ の合成に準同型定理を適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[第三同型定理]
\label{q:ring-isom-theorem-3}
  可換環 $A$ とそのイデアル $J\subset I\subset A$ に対して, 
  $I/J$ は $A/J$ のイデアルになり, 次の環同型が存在する:
  \begin{equation*}
    A/I \isomto (A/J)/(I/J),
    \quad
    a\MOD I \mapsto (a\MOD J)\MOD I/J.
  \end{equation*}
\end{question}

\noindent
ヒント: $A\onto A/J\onto (A/J)/(I/J)$ の合成に準同型定理を適用せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

可換環 $R_1,\dots,R_s$ の
直積 $R=\prod_{i=1}^s R_i=R_1\times\cdots\times R_s$ には自然に可換環の構造
が入る.  $R$ の加法と乗法は各成分ごとに定め, $R$ の $1$ は $1=(1,\dots,1)$ 
と定める.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Chinese-remainder-K[x]}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ を考え,
  互いに異なる $\alpha_1,\dots,\alpha_s\in K$ を任意に取り,
  $n_i\in\Z_{>0}$ とし, $p(\lambda)\in K[\lambda]$ を次のように定める:
  \begin{equation*}
    p(\lambda) = (\lambda-\alpha_1)^{n_1}\cdots(\lambda-\alpha_s)^{n_s}.
  \end{equation*}
  このとき次の環同型存在する:
  \begin{equation*}
    K[\lambda]/(p(\lambda)) 
    \isomto 
    \prod_{i=1}^s K[\lambda]/\bigl((\lambda-\alpha_i)^{n_i}\bigr),
    \quad
    f(\lambda)\MOD p(\lambda)
    \mapsto
    \bigl(f(\lambda)\MOD (\lambda-\alpha_i)^{n_i}\bigr)_{i=1}^s.
  \end{equation*}
  しかもこれは $K[\lambda]$ 加群の同型写像でもある. \qed
\end{question}

\noindent
ヒント: 記号の簡単のため $A=K[\lambda]$, $I=(p(\lambda))$, 
$I_i=\bigl((\lambda-\alpha_i)^{n_i}\bigr)$ と置く.
写像 $\phi:A\to\prod_{i=1}^s A/I_i$ を $\phi(a)=(a\MOD I_i)_{i=1}^s$ と
定める.  $\phi$ は環準同型かつ $A$ 準同型である.  
よって準同型定理より $\phi$ が全射でかつ $\Ker\phi=I$ であることを
示せば示したい結果がすべて得られる.  

$p_i(\lambda)=p(\lambda)/(\lambda-\alpha_i)^{n_i}\in A$ と置くと,
$p_1,\dots,p_s$ は共通因子を持たないので
問題 \qref{q:Euclidean-algorithm-3} の結果より,
ある $a_1,\dots,a_s\in A$ で $a_1p_1+\cdots+a_sp_s=1$ を満たすものが存在する.
よって $a_ip_i\equiv \delta_{ij}\mod I_j$ である.
したがって任意の $(f_i\MOD I_i)_{i=1}^s\in \prod_{i=1}^s A/I_i$ に対して,
$f=f_1a_1p_1+\cdots+f_sa_sp_s\in A$ と置くと,
$f\equiv f_ia_ip_i\equiv f_i\mod I_i$ である.
すなわち $\phi(f)=(f_i\mod I_i)_{i=1}^s$ である. 
これで $\phi$ が全射であることがわかった.

$f\in A$ に対して $\phi(f)=(f\MOD I_i)_{i=1}^s = 0$ となるための必要十分条件
は $f$ がすべての $(\lambda-\alpha_1)^{n_1},\dots,(\lambda-\alpha_s)^{n_s}$ 
で割り切れることである.  この条件は $f$ が $p(\lambda)$ で割り切れることと同
値である.  よって $\Ker\phi=(p(\lambda))=I$ である.
\qed

\medskip
\noindent
解説: 上の問題の結果は問題 \qref{q:Lagrange-interpolation-4} の結果や
Lagrange-Sylvester の補間公式 (\theoremref{theorem:Lagrange-Sylvester}) を
本質的に含んでいる.
上の問題の結果は問題 \qref{q:Jordan-companion-2} のヒント2の出発点になってい
る.  上の問題を使えばコンパニオン行列の Jordan 標準形の存在を証明でき,
しかも Jordan 標準形と相似変換行列の具体形も求まる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[$f$ 進展開]
\label{q:f-adic}
  体 $K$ 係数の $n$ 次多項式 $f\in K[\lambda]$ と正の整数 $e$ が任意に与えら
  れたとき,  $K[\lambda]/(f^e)$ の任意の元は次の形で一意に表わされる:
  \begin{align*}
    &
    g\MOD f^e 
    = (a_0 + a_1 f + a_2 f^2 + \cdots + a_{e-1} f^{e-1})\MOD f^e
    \\ &
    \hphantom{
    g\MOD f^e 
    = (a_0 + a_1 f 
    }
    (g,a_i\in K[\lambda],\ \deg g < n^e,\ \deg a_i < n).
    \qed
  \end{align*}
\end{question}

\noindent
ヒント: 問題 \qref{q:dim-K[x]/(f)} の結果とヒントを $f^e$ に適用することに
よって $K[\lambda]/(f^e)$ の元と次数が $n^e$ 未満の多項式は一対一に対応して
いることがわかる.  よって次数が $n^e$ 未満の多項式 $g\in K[\lambda]$ が
\begin{equation*}
  g = a_0 + a_1 f + a_2 f^2 + \cdots + a_{e-1} f^{e-1}
  \qquad
  (a_i\in K[\lambda],\ \deg a_i < n)
  \tag{$\ast$}
\end{equation*}
と一意に表わされることを示せば良い.  
$g$ が与えられたとき以下の手続きで
次数が $n$ 未満の $a_0,a_1,a_2,\ldots\in K[\lambda]$ が得られる:
\begin{enumerate}
\item $g$ を $f$ で割った余りを $a_0$ とし, 商を $g_1$ とする.
\item もしも $g_k=0$ ならば手続きを終了し, $a_k,a_{k+1},\dots$ はすべて $0$ 
  であるとする.
\item もしも $g_k\ne 0$ ならば $g_k$ を $f$ で割った余りを $a_k$ とし,
  商を $g_{k+1}$ として, 1つ前のステップに戻る.
\end{enumerate}
$g_k$ の次数はこの手続きの各ステップで $n$ 以上下がるので, $\deg g<n^e$ なら
ばこの手続きは遅くとも $a_{e-1}$ を求めた段階で終了する.  
そのとき ($\ast$) が成立しているので表示の存在が証明される.
逆に ($\ast$) が成立しているならば各 $a_i$ は上の手続きで求めたものと一致す
ることも容易に確かめられるので, 表示の一意性も確かめられる.
\qed

\medskip
\noindent
解説: $f(\lambda)=\lambda-\alpha$ のとき上の問題の展開は
\begin{equation*}
  g \equiv
  a_0 + a_1(\lambda-\alpha) + a_2(\lambda-\alpha)^2 
  + \cdots + a_{e-1}(\lambda-\alpha)^{e-1}
  \mod (\lambda-\alpha)^e
  \quad (a_i\in K)
\end{equation*}
と $\lambda-\alpha$ に関する巾級数展開 (Taylor 展開) を $e-1$ 次で切ったもの
になる.  だから可換環 $K[\lambda]/\bigl((\lambda-\alpha)^e\bigr)$ 
は $\lambda-\alpha$ に関する巾級数展開を $e-1$ 次で切ることによって得られた
世界になっている.  代数の世界では Taylor 展開の概念はこのように定式化される.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Chinese-remainder-Z}
  $2$ 以上の整数 $n\in\Z_{\ge2}$ を任意に取り, 
  $n=p_1^{e_1}\cdots p_s^{e_r}$ は $n$ の素因数分解であるとする%
  \footnote{$p_i$ の $p$ は prime (素数) の頭文字であり,
    $e_i$ の $e$ は exponent (指数) の頭文字である.}.
  すなわち $p_1,\dots,p_s$ は互いに異なる素数であり, $e_i\in\Z_{>0}$ である
  とする.  このとき次の環同型が存在する:
  \begin{equation*}
    \Z/n\Z \isomto (\Z/p_1^{e_1}\Z)\times\cdots\times(\Z/p_r^{e_r}\Z),
    \quad
    a\MOD n \mapsto (a\MOD p_1^{e_1},\dots,a\MOD p_s^{e_r}).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 問題 \qref{q:Chinese-remainder-K[x]} とまったく同様.
\qed

\medskip
\noindent
解説: 上の問題の結果は問題 \qref{q:Lagrange-interpolation-4-Z} の結果
と本質的に同値である.  次の問題を見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[$n$ 進展開]
\label{q:n-adic}
  正の整数 $n$, $e$ が任意に与えられたとき, 
  $\Z/n^e\Z$ の任意の元は次の形で一意に表わされる:
  \begin{align*}
    &
    m\MOD n^e 
    = (a_0 + a_0 n + a_2 n^2 + \cdots a_{e-1} n^{e-1})\MOD n^e
    \\ &
    \hphantom{
    m\MOD n^e 
    = (a_0 +
    }
    (m,a_i\in\Z,\ 0\le m<n^e,\ 0\le a_i<n).
    \qed
  \end{align*}
\end{question}

\noindent
ヒント: 問題 \qref{q:|Z/nZ|} の結果とヒントを使えば問題 \qref{q:f-adic} とま
ったく同様である. 
\qed

\medskip
\noindent
参考: $n=10$ の場合は通常の十進法の話になる.  面白いのは負の整数を $n$ 進展
開した場合である. たとえば $-1$ を $2$ 進展開すると,
\begin{equation*}
  -1 \equiv 2^e - 1 = 1 + 2 + 2^2 + \cdots + 2^{e-1} \mod 2^e.
\end{equation*}
ここで形式的に $e\to\infty$ とすると%
\footnote{$-1$ を素数 $2$ に対応する``点''で ``Taylor 展開'' するという風に
  考えよ.  素数 $p$ と $\lambda-\alpha$ は非常に似ている.  
  $\lambda-\alpha$ に関する巾級数展開はTaylor展開と呼ばれている.
  それと同様の展開を素数に対しても考えることができるのである. },
\begin{equation*}
  -1 = 1 + 2 + 2^2 + 2^3 + 2^4 + \cdots
\end{equation*}
が成立する.  これは等比級数の和の公式 $1 + a + a^2 + \cdots = 1/(1-a)$ 
の $a=2$ の場合である.  このような議論を数学的に厳密に正当化すると $p$ 進数
の理論が得られる.  $\Z_2$ もしくは $\Q_2$ の中で $1+2+2^2+\cdots$ は実際に
収束して $-1$ に等しくなる%
\footnote{各素数 $p$ に対して定まる $\Z_p$, $\Q_p$ は
  それぞれ {\bf $p$ 進整数環 ($p$-adic integer ring)}, 
  {\bf $p$ 進数体 ($p$-adic number field)} と呼ばれており, 
  集合として以下のように表わされる:
  \begin{align*}
    & 
    \Z_p =
    \{\, a_0 + a_1 p + a_2 p^2 + a_3 p^3 + \cdots
    \mid a_i=0,1,\dots,p-1 \,\},
    \\ &
    \Q_p =
    \{\, a_n p^n + a_{n+1}p^{n+1} + a_{n+2} p^{n+2} + \cdots
    \mid n\in\Z,\ a_i=0,1,\dots,p-1 \,\}.
  \end{align*}
  $\Z_p$ は $\Z/p^e\Z$ の $e\to\infty$ での{\bf 射影極限 (projective limit)}
  として構成され, $\Q_p$ は $\Z_p$ の分数体に等しい.
  }.  %
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

可換環 $R$ のイデアル $I$, $J$ が $I+J=R$ を満たしているとき, $I$ と $J$ は
{\bf 互いに素 (coprime)} であるという. 

問題 \qref{q:Chinese-remainder-K[x]}, \qref{q:Chinese-remainder-Z} の
結果は{\bf 中国式剰余定理 (Chinese remainder theorem)} の特殊な場合である.

\begin{question}[中国式剰余定理]
\label{q:Chinese-remainder-theorem}
  $R$ は任意の可換環であるとし, $I_1,\dots,I_n$ は $R$ のイデアルであり,
  その中のどの2つも互いに素であると仮定する. すなわち $I_i+I_j=R$ ($i\ne j$) 
  が成立していると仮定する.  このとき以下が成立する:
  \begin{enumerate}
  \item[(1)] $J_i=I_1\cdots I_{i-1}I_{i+1}\cdots I_n$ と
    置くと\footnote{$n=1$ のとき $J_1=R$ であると約束しておく.} %
    $J_1+\cdots+J_n=R$ が成立する.
  \item[(2)] $I_1I_2\cdots I_n=I_1\cap\cdots\cap I_n$ である.
  \item[(3)] 記号の簡単のため $I=I_1I_2\cdots I_n=I_1\cap\cdots\cap I_n$ と
    置く. 次の環同型が存在する:
    \begin{equation*}
      R/I \isomto \prod_{i=1}^n R/I_i,
      \quad
      f\MOD I \mapsto \bigl(f\MOD I_i\bigr)_{i=1}^n.
    \end{equation*}
    これは $R$ 加群の同型写像でもある.
    \qed
  \end{enumerate}
\end{question}

\noindent
注意: 上の問題の(1)は「$a_1,\dots,a_n\in K[\lambda]$ のどの2つも互いに素
であるならば, $b_i=a_1\cdots a_{i-1}a_{i+1}\cdots a_n$ と
置くと $b_1,\dots,b_n$ の最大公約元は $1$ になる」
という結果の一般化になっている.
さらに(2)は「$a_1,\dots,a_n\in K[\lambda]$ のどの2つも互いに素である
ならば, $a_1,\dots,a_n$ の最小公倍元は $a_1\cdots a_n$ に等しい」
という結果の一般化になっている.  
問題 \qref{q:gcd-lcm-K[x]} を見よ.

\medskip
\noindent
ヒント1: (1) $n$ に関する帰納法で証明する.
$n=1$ の場合は定義より $J_1=R$ なので成立している.
$n\ge 1$ のとき, 
帰納法の仮定より $J'_i=I_1\cdots I_{i-1}I_{i+1}\cdots I_{n-1}$ 
($i=1,\dots,n-1$) と置くと, $J'_1+\cdots+J'_{n-1}=R$ が成立する.
$i=1,\dots,n-1$ に対して $I_n+I_i=R$ なので,
ある $a_i\in I_n$ と $b_i\in I_i$ で $a_i+b_i=1$ を満たすものが存在する.  
このとき $\prod_{i=1}^{n-1}(a_i+b_i)=1$ であり, 
この等式の左辺を展開すると $b_1\cdots b_{n-1}\in I_1\cdots I_{n-1}$ 以外の項
がすべて $I_n$ に含まれることがわかる.  これで $I_n+I_1\cdots I_{n-1}=R$ が
示された.  したがって
\begin{align*}
  R 
  &
  = (J'_1+\cdots+J'_{n-1})(I_n + I_1\cdots I_{n-1})
  \\ &
  = J'_1I_n + \cdots + J'_{n-1}I_n + I_1\cdots I_{n-1}
  = J_1+\cdots+J_n.
\end{align*}

(2) $I_1\cdots I_n\subset I_1\cap\cdots\cap I_n$ は常に成立するので逆の包含
関係を示せば良い.  (1)よりある $g_i\in J_i$ で $g_1+\cdots+g_n=1$ を満たすも
のが存在する.  任意の $f\in I_1\cap\cdots\cap I_n$ に
対して $fg_i\in I_1\cdots I_n$ なので $f=fg_1+\cdots+fg_n\in I_1\cdots I_n$ 
である.
 
(3) 写像 $\phi:R\to\prod_{i=1}^n R/I_i$ 
を $\phi(f)=\bigl(f\MOD I_i\bigr)_{i=1}^n$ と定める
と $\phi$ は環準同型かつ $R$ 準同型である.
したがって, 環の準同型定理と $R$ 加群の準同型定理
より, $\Ker\phi=I_1\cap\cdots\cap I_n$ および $\phi$ の全射性を示せば良い.
$\phi(f)=0$ と $f\in I_i$ ($i=1,\dots,n$) は同値であり,
これはさらに $f\in I_1\cap\cdots\cap I_n$ と同値である.
よって $\Ker\phi=I_1\cap\cdots\cap I_n$ である. 
(1)よりある $g_i\in J_i$ で $g_1+\cdots+g_n=1$ を満たすものが存在する.
任意の $f_1,\dots,f_n\in R$ に対して, 
$f=f_1g_1+\cdots+f_ng_n$ と置くと $f\equiv f_i\mod I_i$ である. 
すなわち $\phi(f)= \bigl(f_i\MOD I_i\bigr)_{i=1}^n$ である.
これで $\phi$ の全射性が示された.
\qed

\medskip
\noindent
ヒント2: (1) を次のように証明することもできる. 
$i<j$ のとき $I_i+I_j=R$ であるから, 
ある $a^{ij}_i\in I_i$, $a^{ij}_j\in I_j$ で $a^{ij}_i+a^{ij}_j=1$ を満たす
ものが存在する.  このとき $\prod_{1\le i<j\le n}(a^{ij}_i+a^{ij}_j)=1$ であ
る. 左辺を展開すると次の形にまとめられることがわかる:
\begin{equation*}
  g_1+\cdots+g_n=1, \qquad g_i\in J_i.
\end{equation*}
$I_1\cdots I_n$ に含まれる項は $I_1\cdots I_n\subset J_i$ なので $g_i$ の
どれにくりこんでも良い.
\qed

\medskip
\noindent
解説: 上の問題で $R=K[\lambda]$, $I_i=\bigl((\lambda-\alpha_i)^{n_i}\bigr)$ 
とすれば問題 \qref{q:Chinese-remainder-K[x]} の結果が導かれる.
そのとき, $(p(\lambda))=I_1\cdots I_n=I$ であり, 
問題 \qref{q:Chinese-remainder-K[x]} のヒントにおける $a_ip_i$ は
上の問題のヒントにおける $g_i$ の役目を果たしており, 
$(p_i(\lambda))=J_i$ が成立している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{単元と素元と既約元}
\label{sec:factorization}

$R$ は可換環であるとする.

$a\in R$ が{\bf 可逆元 (invertible element)} もしくは{\bf 単元 (単数, unit)} 
であるとは, ある $a'\in R$ で $a'a=aa'=1$ を満たすものが存在することである. 
そのとき $a'$ を $a$ の逆元と呼び, $a^{-1}$ と表わす.
$a$ の逆元は存在するとすれば唯一である.

可換環 $R$ の中の可逆元全体の集合を $R^\times$ と表わし, 
$R$ の{\bf 単元群 (単数群, unit group)} と呼ぶことにする.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  以下を証明せよ:
  \begin{enumerate}
  \item 可換環 $R$ に対して $R^\times$ は Abel 群をなす.
  \item $\Z^\times = \{\pm1\}$.
  \item 体 $K$ 上の1変数多項式環 $K[\lambda]$ の単数群
    は $K^\times=\{a\in K\mid a\ne 0\}$ に等しい.
    \qed
  \end{enumerate}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:U(K[x]/(f))}
  $K$ は体であるとし, $0$ でない $f\in K[\lambda]$ を任意に取るとき,
  \begin{equation*}
    \bigl(K[\lambda]/(f)\bigr)^\times =
    \{\, g\MOD f \mid g\in K[\lambda],\ \text{$f$ と $g$ は互いに素} \,\}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 問題 \qref{q:K[x]-PID} の結果および解説より, $f$ と $g$ の最大公約元
を $d$ とすると $(f,g)=(d)$ であるから, 
任意の $g\in K[\lambda]$ に対して, $g\MOD f\in K[\lambda]/(f)$ が可逆である
ための必要十分条件が $(f,g)=(1)$ であることを示せば良い.
$(f,g)=(1)$ であることと, ある $a,b\in K[\lambda]$ で $af+bg=1$ を満たすもの
が存在することは同値であり, さらにこの条件はある $b\in K[\lambda]$ 
で $bg\equiv 1 \mod f$ を満たすものが存在することと同値である. 
よって $(f,g)=(1)$ であることと $g\MOD f$ が可逆であることは同値である. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $K$ は体であるとし, $\alpha\in K$, $n\in\Z_{>0}$ であるとする. このとき,
  \begin{equation*}
    \Bigl(K[\lambda]\big/\bigl((\lambda-\alpha)^n\bigr)\Bigr)^\times
    =
    \{\, f\MOD (\lambda-\alpha)^n 
    \mid f\in K[\lambda],\ f(\alpha)\ne 0 \,\}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 任意の $f\in K[\lambda]$ に対して剰余定理より $f(\alpha)\ne 0$ 
と $f$ が $\lambda-\alpha$ で割り切れないことは同値である. 
よって問題 \qref{q:U(K[x]/(f))} の結果を使えば示したい結果が導かれる.
\qed

\medskip
\noindent
解説: $f(\alpha)\ne 0$ のとき $f\MOD (\lambda-\alpha)^n$ の逆元の具体的な形
は等比級数の和の公式 $1+a+a^2+\cdots=(1-a)^{-1}$ を用いて
以下のように計算できる. 
$a_0=f(\alpha)\in K^\times$ と置くと, 
$f$ は $f(\lambda)=a_0\bigl(1-(\lambda-\alpha)g(\lambda)\bigr)$ 
($g\in K[\lambda]$) と表わされる. よって形式的に
\begin{equation*}
  f(\lambda)^{-1} = 
  a_0^{-1} \bigl(
  1 
  + (\lambda-\alpha)g(\lambda)
  + (\lambda-\alpha)^2g(\lambda)^2
  + (\lambda-\alpha)^3g(\lambda)^3
  + \cdots
  \bigr).
\end{equation*}
括弧の中の級数を $n-1$ 次の巾までで切ることによって得られる
多項式を $h$ とする:
\begin{equation*}
  h(\lambda) = 
  a_0^{-1} \bigl(
  1 
  + (\lambda-\alpha)g(\lambda)
  + (\lambda-\alpha)^2g(\lambda)^2
  + \cdots
  + (\lambda-\alpha)^{n-1}g(\lambda)^{n-1}
  \bigr).
\end{equation*}
このとき $fh\equiv 1 \mod (\lambda-\alpha)^n$ が成立する:
\begin{align*}
  f(\lambda)h(\lambda)
  & \equiv
  \bigl(1 - (\lambda-\alpha)g(\lambda)\bigr)
  \bigl(
  1 
  + (\lambda-\alpha)g(\lambda)
  + \cdots
  + (\lambda-\alpha)^{n-1}g(\lambda)^{n-1}
  \bigr)
  \\ &
  \equiv
  1 
  + (\lambda-\alpha)g(\lambda) 
  + \cdots 
  + (\lambda-\alpha)^{n-1}g(\lambda)^{n-1}
  \\ &
  \hphantom{\equiv 1\,{}}
  - (\lambda-\alpha)g(\lambda) 
  - \cdots 
  - (\lambda-\alpha)^{n-1}g(\lambda)^{n-1}
  - (\lambda-\alpha)^ng(\lambda)^n
  \\ &
  \equiv 1.
\end{align*}
これはもちろん $\bmod\,(\lambda-\alpha)^n$ での計算である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:U(Z/mZ)-2}
  $0$ でない整数 $n\in\Z$ を任意に取るとき,
  \begin{equation*}
    (\Z/n\Z)^\times = 
    \{\, m\MOD n \mid m\in\Z,\ \text{$m$ と $n$ は互いに素} \,\}.
  \end{equation*}
  特に素数 $p$ に対して $\F_p:=\Z/p\Z$ は体をなす.
  \qed
\end{question}

\noindent
ヒント: 前半は問題 \qref{q:U(K[x]/(f))} とまったく同様.
前半より素数 $p$ に対して $m\MOD p$ が可逆であることと $m$ と $p$ が互いに素
であることは同値である. その条件は $m$ が $p$ で割り切れないことと同値であり, 
さらにその条件は $m\not\equiv 0\mod p$ であることである.  
よって $\Z/p\Z$ の $0$ でない元は可逆になり, $\Z/p\Z$ は体をなす.
\qed

\medskip
\noindent
例: たとえば $p=7$ のとき $2\cdot4\equiv 3\cdot5\equiv6\cdot6\equiv1\mod7$
である. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euler 函数]
\label{q:Euler-function}
  正の整数 $n\in\Z_{>0}$ に対して, 
  $(\Z/n\Z)^\times$ の元の個数を $\varphi(n)$ と書き,
  {\bf Euler 函数}と呼ぶ.
  $n$ の素因数分解を $n=p_1^{e_1}\cdots p_r^{e_r}$ と書くと,
  \begin{equation*}
    \varphi(n) 
    = \prod_{i=1}^r (p_i^{e_i} - p_i^{e_i-1})
    = n \prod_{i=1}^r\left(1 - \frac{1}{p_i}\right).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 問題 \qref{q:Chinese-remainder-Z} の
結果より $\varphi(n)=\prod_{i=1}^r\varphi(p_i^{e_i})$ である.
問題 \qref{q:U(Z/mZ)-2} の結果より
素数 $p$ に対して $(\Z/p^e\Z)^\times$ の元の個数は $0$ 以上 $p^e$ 未満の
整数で $p$ で割り切れないもの全体の個数に一致する. 割り切れるものの個数
は $p^{e-1}$ なので $\varphi(p^e)=p^e-p^{e-1}$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

可換環 $R$ のイデアル $I$ が{\bf 素イデアル (prime ideal)} である
とは $I\ne R$ でかつ任意の $a,b\in R$ に対して $ab\in I$ ならば $a\in I$ 
または $b\in I$ となることである.
この条件の対偶を考えれば, $I$ が素イデアルであることと $I$ の補集合が積に関
して閉じていることが同値であることもわかる.

\begin{question}[それで割って整域になるのが素イデアル]
\label{q:prime-ideal-integral-domain}
  可換環 $R$ のイデアル $I\ne R$ に対して, $I$ が素イデアルになるための必要
  十分条件は $R/I$ が整域になることである. 
  \qed
\end{question}

\noindent
ヒント: $R/I$ が整域になるための必要十分条件は
任意の $a,b\in R$ に対して $(ab)\MOD I=(a\MOD I)(b\MOD I)=0$ 
ならば $a\MOD I=0$ または $b\MOD I=0$ が成立することである. 
$a\MOD I=0$ と $a\in I$ は同値なので, 
これは任意の $a,b\in R$ に対して $ab\in I$ ならば $a\in I$ 
または $b\in I$ となることと同値である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

可換環 $R$ のイデアル $I$ が{\bf 極大イデアル (maximal ideal)} であると
は $I\ne R$ でかつ $I$ を含むイデアルが $I$ と $R$ 以外に存在しないことである. 

\begin{question}[それで割って体になるのが極大イデアル]
\label{q:maximal-ideal-field}
  可換環 $R$ のイデアル $I\ne R$ に対して, $I$ が極大イデアルになるための
  必要十分条件は $R/I$ が体になることである. 
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:field-ideal} の結果より $R/I$ が体になるための必要十分
条件は $R/I$ のイデアルが $0$ と $R$ だけになることである.
問題 \qref{q:phi:A->B} の最後の結果より, その条件は $R$ の $I$ を含むイデア
ルが $I$ と $R$ だけになることと同値である. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

問題 \qref{q:prime-ideal-integral-domain}, \qref{q:maximal-ideal-field} によ
る素イデアルと極大イデアルの特徴付けは定義そのものと同じくらい自由に使用され
る.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[極大ならば素]
\label{q:maximal-implies-prime}
  可換環 $R$ の極大イデアルは素イデアルである. \qed
\end{question}

\noindent
ヒント: 体は整域であるから, 
問題 \qref{q:prime-ideal-integral-domain},
\qref{q:maximal-ideal-field} の結果を使えばただちに得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  素イデアルだが極大イデアルでない例を一つ挙げよ. \qed
\end{question}

\noindent
ヒント: $R=\Z[x]$, $I=\Z[x]x$ と置くと $R/I\isom\Z$. \qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Spec-mSpec}
  $\phi:A\to B$ は可換環のあいだの環準同型であるとする.
  このとき $B$ の素イデアル $P$ に対して $\phi^{-1}(P)$ は $A$ の素イデアル
  になる.  しかし $B$ の極大イデアル $\frakm$ に対して $\phi^{-1}(\frakm)$ 
  は $A$ の極大イデアルになるとは限らない.
  \qed
\end{question}

\noindent
ヒント: 素イデアルの定義より $P\ne B$ である. 
そのとき $1\not\in P$ なので $1\not\in \phi^{-1}(P)$ である. 
よって $\phi^{-1}(P)\ne A$ である.
$a,b\in A$ が $ab\in\phi^{-1}(P)$, $a\not\in\phi^{-1}(P)$ を
満たしているならば, $\phi(a)\phi(b)=\phi(ab)\in P$, $\phi(a)\not\in P$ 
であるから $\phi(b)\in P$ すなわち $b\in\phi^{-1}(P)$ である.
これで $\phi^{-1}(P)$ が $A$ の素イデアルであることがわかった.

$\phi$ は $\Z[x]$ の $\Q[x]$ への包含写像であるとする.
$\frakm=\Q[x]x$ と置くと $\Q[x]/\frakm\isom\Q$ である
から $\frakm$ は $\Q[x]$ の極大イデアルである. 
しかし, $\phi^{-1}(\frakm)=\Z[x]x$ であり, $\Z[x]/\Z[x]x\isom\Z$ である
から, $\phi^{-1}(\frakm)$ は $\Z[x]$ の
素イデアルであるが極大イデアルではない.
\qed

\medskip
\noindent
参考: 任意の可換環 $A$ と{\bf アフィン概型 (affine scheme)} と
呼ばれるある種の多様体 (図形) は一対一に対応している.  

たとえば体 $K$ 上の1変数多項式環 $K[x]$ に対応する多様体は $K$ 上定義された
直線であり, 2変数多項式環 $K[x,y]$ に対応する多様体は $K$ 上定義された平面で
ある.  $a,b\in K$ に対して $R=K[x,y]/(y^2-x^3-ax-b)$ に対応する多様体は
方程式 $y^2=x^3+ax+b$ で定義された曲線 ($K$ 上定義された楕円曲線) である.

$A$ に対応するアフィン概型は $\Spec A$ と表わされる.
集合として $\Spec A$ は $A$ の素イデアル全体の集合である.
たとえば $\Spec\Z=\{(0),(2),(3),(5),(7),(11),\ldots\}$ である
から, $\Z$ に対応する多様体は集合として素数全体の集合
に一点 $\ast=(0)$ を付け加えたものであるとみなせる.

上の問題 \qref{q:Spec-mSpec} より, 
素イデアル全体の集合が環準同型による引き戻しで閉じている
という良い性質を持つことがわかる.
どうして素イデアル全体の集合が多様体 (図形) とみなせるかに関しては
リード \cite{reid} を参照せよ.

可換環論は多様体の局所理論であるという認識抜きで可換環論を勉強すると, 
代数的感覚に特別に秀でた人以外は抽象的過ぎて何をやっているか
わからなくなってしまう.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

整域 $R$ の元 $a$ が{\bf 素元 (prime element)}である
とは $a\ne 0$ でかつ $(a)=Ra$ が $R$ の素イデアルになることであると定める.
素元 $a$ は単元ではない. もしもそうならば $(a)=R$ となり, 素イデアルの定義に
反する.

可換環 $R$ の元 $a$, $b$ に対して, $a\sim b$ である
とはある $u\in R^\times$ で $a=ub$ となるものが存在することであると定める.

整域 $R$ の元 $a$ が{\bf 既約元 (irreducible element)} である
とは, $a$ が単元ではなく, 
任意の $b,c\in R$ に対して $a=bc$ ならば $b\in R^\times$ 
または $c\in R^\times$ になることであると定める.
上の記号を用いれば, この条件は $a=bc$ ならば $a\sim b$ または $a\sim c$ と
なるという条件と同値である.
既約元は $0$ にはならない. なぜならば $0=0\cdot 0$ かつ $0\not\in R^\times$ 
であるからである.

体上の多項式環 $K[\lambda]$ の既約元を既約多項式と呼び, $\Z$ の既約元を素数
と呼ぶ.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $R$ は整域であるとし, $a,b\in R$ であるとする.
  このとき $a\sim b$ と $(a) = (b)$ は同値である.
  \qed
\end{question}

\noindent
ヒント: $a\sim b$ と仮定する. ある $u\in R^\times$ で $a=ub$ となるものが
存在する. このとき $r\in R$ に対して, $ra\in(a)$ ならば $ra=rub\in(b)$ であり, 
$rb\in(b)$ ならば $rb=ru^{-1}a\in(a)$ である.  よって $(a)=(b)$ である.
逆に $(a)=(b)$ と仮定する. このときある $r,s\in R$ で $a=rb$, $b=sa$ となる
ものが存在する.  このとき $a=rb=rsa$ なので $R$ が整域であることを
使うと $1=rs$ である. よって $r,s\in R^\times$ である. これで $a\sim b$ であ
ることが示された.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[素元ならば既約元]
\label{q:prime-implies-irred}
  $R$ は整域であるとする. このとき $R$ の素元は $R$ の既約元である. 
  \qed
\end{question}

\noindent
ヒント: $a$ は素元であると仮定し, $b,c\in R$ は $a=bc$ を満たしている仮定す
る.  このとき $bc\in (a)$ なので $c\not\in(f)$ と仮定すると $b\in(f)$ である.
よってある $d\in R$ が存在して $b=ad$ である. よって $a=adc$ である. $R$ は整
域なので $dc=1$ である. これで $c\in R^\times$ であることがわかった.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:PID-maximal-prime}
  $R$ が単項イデアル整域であるとき, $0$ でない $a\in R$ に対して以下の条件は
  互いに同値である:
  \begin{enumerate}
  \item[(1)] $(a)$ は $R$ の極大イデアルである.
  \item[(2)] $(a)$ は $R$ の素イデアルである.
  \item[(3)] $a$ は $R$ の素元である.
  \item[(4)] $a$ は $R$ の既約元である.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 問題 \qref{q:maximal-implies-prime} の結果より(1)ならば(2)である.
素元の定義より(2)と(3)は同値である.
問題 \qref{q:prime-implies-irred} の結果より(3)ならば(4)である.
(4)から(1)を導こう. 
$a$ は既約元であると仮定し, $I$ は $R$ に等しくない $(a)$ を含むイデアルであ
るとする. $R$ は単項イデアル整域なので, ある $b\in R$ が存在して $I=(b)$ と
なる. $a\in I=(b)$ よりある $c\in R$ が存在して $bc=a\in(a)$ となる.
$(b)=I\ne R$ より $b\not\in R^\times$ であり, $a$ は既約元
なので $c\in R^\times$ となる. よって $(a)=(bc)=(b)=I$ である.
これで $(a)$ が極大イデアルであることがわかった.
\qed

\medskip

上の問題の結果は体 $K$ 上の一変数多項式環 $K[\lambda]$ 
や有理整数環 $\Z$ のような単項イデアル整域において空気のごとく自由に使われる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $0$ でない多項式 $f\in K[\lambda]$ に対して, 
  $f$ が既約多項式であることと $K[\lambda]/(f)$ が体になることは同値である.
  \qed
\end{question}

\noindent
ヒント: $K[\lambda]$ は単項イデアル整域であるから
問題 \qref{q:PID-maximal-prime} からただちに得られる.
\qed

\medskip
\noindent
参考: この問題の結果は体 $K$ から $K$ を含む別の体を構成するための最も基本的
な方法である.  代数学で体の Galois 理論を習うときに用いられる非常に基本的な
結果である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\R[\lambda]$ において $\lambda^2+1$ は既約多項式である.
  よって $\R[\lambda]/(\lambda^2+1)$ は体になる.
  この体は複素数体に同型である. 
  \qed
\end{question}

\noindent
ヒント: $\R[\lambda]$ の中で $\lambda^2+1$ を $0$ とみなせば $\lambda$ は虚
数単位 $i$ と同一視できる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

整域 $R$ が{\bf 素元分解整域 (factorial domain)} であるとは次の条件を満たし
ていることであると定める:
\begin{enumerate}
\item[(a)] $R$ の $0$ でない任意の元は有限個の素元の積で表わされる%
  \footnote{$0$ 個の元の積は単元になると約束しておく.}.
\end{enumerate}
整域 $R$ が{\bf 一意分解整域 (unique factorization domain, UFD)} であるとは
次の2つの条件を満たしていることであると定める:
\begin{enumerate}
\item[(b)] $R$ の $0$ でない任意の元は有限個の既約元の積で表わされ, 
  しかもその表示は積の順序と単元倍の違いを除いて一意的である.
\item[(c)] $R$ の既約元は $R$ の素元である.
\end{enumerate}

\begin{theorem}
\label{theorem:FD=UFD}
  整域 $R$ が素元分解整域であることと一意分解整域であることは同値である.
  \qed
\end{theorem}

演習問題の羅列によってこの定理を証明しよう.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[素元分解整域における既約元は素元]
\label{q:UFD-irred-implies-prime}
  $R$ が素元分解整域ならば $R$ の既約元は $R$ の素元である.
  \qed
\end{question}

\noindent
ヒント: $R$ は素元分解整域であるとし, $x\in R$ は $R$ の $0$ でも単元でも素
元でもないと仮定する.  このとき $x$ は $x=p_1\cdots p_r$ ($p_i$ は $R$ の
素元でかつ $r\ge2$) と表わされる.  よって $x$ は $R$ の既約元ではない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[整域における素元分解の一意性]
\label{q:prime-decomp-unique}
  整域 $R$ において $0$ でない元の素元分解 (有限個の素元の積による表示) は存
  在するとすれば, 積の順序と単元倍を除いて一意的である.
  \qed
\end{question}

\noindent
ヒント: $p_i$, $q_j$ は素元であり, $p_1\cdots p_m = q_1\cdots q_n$ が成立
していると仮定する.  このとき $q_1\cdots q_n\in(p_1)$ であり, $(p_1)$ は素イデ
アルなのでどれかの $q_j$ は $(p_1)$ に含まれる. 
番号を入れ替えて $q_1\in(p_1)$ としてよい.
ある $a_1\in R$ で $q_1=a_1p_1$ となるものが存在する.
素元は定義より単元ではないので $p_1\not\in R^\times$ である.
問題 \qref{q:prime-implies-irred} より素元は既約元なので $a\in R^\times$ で
ある. 
$q_1=a_1p_1$ を $p_1\cdots p_m = q_1\cdots q_n$ に代入し, $R$ が整域であるこ
とを使うと, $p_2\cdots p_m = a_1 q_2\cdots q_n$ であることがわかった.
以下同様の論法で番号を入れ替えれば, 
結局ある $a_i\in R^\times$ で $q_i=a_ip_i$ ($i=1,\dots,m$) を満たすもの
が存在して, $1=a_1\cdots a_m q_{m+1}\cdots q_n$ となることがわかる. 
素元は単元ではないので $m=n$ でなければいけない.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:prime-implies-irred}, 
  \qref{q:UFD-irred-implies-prime}, 
  \qref{q:prime-decomp-unique}の結果を用いて\theoremref{theorem:FD=UFD}を
  証明せよ.  \qed
\end{question}

\noindent
ヒント: $R$ は素元分解整域であると仮定する.
問題 \qref{q:prime-implies-irred}, \qref{q:prime-decomp-unique} の結果より, 
(b)が導かれる.  問題 \qref{q:UFD-irred-implies-prime} の結果より,
(c)が導かれる. よって素元分解整域ならば一意分解整域である.
逆に $R$ が一意分解整域であると仮定すれば(a)が成立するので, 
$R$ は素元分解整域である. 
\qed

\medskip

以下では素元分解整域と一意分解整域を区別せずに扱い, 
主として一意分解整域という用語を用いる.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ は一意分解整域である.
  \qed
\end{question}

\noindent
ヒント: $K[\lambda]$ は単項イデアル整域なので素元と既約多項式は一致している.
任意の $0$ でない多項式 $f\in K[\lambda]$ が既約多項式の積に分解することを示
せば良い. $\deg f$ に関する帰納法で証明する.
$\deg f=1$ のとき $f$ は既約多項式である.
$\deg f\ge 2$ とする. $f$ が既約ならばこれ以上示すべきことは何もない.
$f$ が既約でないならば次数が $1$ 以上の
多項式 $g,h\in K[\lambda]$ が存在して $f=gh$ となる.
このとき $\deg f = \deg g + \deg h$ なので $\deg g,\deg h< \deg f$ である.
よって帰納法の仮定より $g$, $h$ は既約多項式の積に分解される.
そのとき $f=gh$ も既約多項式の積に分解している.
\qed

\medskip
\noindent
参考: 一般に $R$ が一意分解整域ならば $R$ 上の $n$ 変数
多項式環 $R[x_1,\dots,x_n]$ も一意分解整域になる (Gauss の定理).
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $\Z$ は一意分解整域である.
  \qed
\end{question}

\noindent
ヒント: $\Z$ は単項イデアル整域なので素元と既約元すなわち素数は一致している.
$0$ でない整数 $a$ が素数の積に分解されることを示せば良い.
$|a|$ に関する帰納法で証明する.
$|a|=1$ のとき $a$ は単元なので $0$ 個の素数の積に分解されている.
$|a|\ge 2$ とする. $a$ が素数ならばこれ以上示すことは何もない.
$a$ が素数でないならば絶対値が $2$ 以上の整数 $b$, $c$ が
存在して $a=bc$ となる. $b$, $c$ の絶対値は $a$ より小さいので
帰納法の仮定より $b$, $c$ は素数の積に分解される.
そのとき $a=bc$ も素数の積に分解されている.
\qed

\medskip
\noindent
参考: 実は任意の単項イデアル整域が一意分解整域であることを証明できる.
しかし, そのためには「可換環 $R$ の任意のイデアル $I$ に対して $R\ne I$ 
ならば $I$ を含む $R$ の極大イデアルが存在する」という結果を用いなければ
いけない. その証明には Zorn の補題が必要である.  
直観的には $I$ が極大でないならばそれにどんどん元を付け加えて行けばいつかは
極大イデアルになるはずである.  しかし実際には無限に元を付け加えなければいけ
ないかもしれない.  そういう場合には「Zorn の補題を使って解決」というのが
数学の常套手段になっている. 
興味のある方はたとえば堀田 \cite{gun-kagun} の45頁の定理9.1(iii)と47頁の定理 
9.2を参照して欲しい.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:R[t^2,t^3]-not-UFD}
  体 $K$ 上の一変数多項式環 $K[t]$ の $t^2$, $t^3$ から生成される部分環
  を $R=K[t^2,t^3]$ と表わす.  $R$ は一意分解整域ではない.
  \qed
\end{question}

\noindent
ヒント: $R=K[t^2,t^3]$ は基底 $1,t^2,t^3,t^4,\ldots$ を持つ. 
特に $t\not\in R$ である. $R^\times=K^\times$ である.
よって $t^2$ と $t^3$ は $R$ の既約元であり, $t^2\not\sim t^3$ である.
したがって, $t^6=(t^2)^3=(t^3)^2$ は $t^6$ の2つの既約元分解であり,
積の順序の置換や単数倍によって互いに移り合わない.
これで $R$ が一意分解整域でないことがわかった.
\qed

\medskip
\noindent
参考: $x=t^2$, $y=t^3$ は曲線 $y^2=x^3$ のパラメーター表示になっている.
曲線 $y^2=x^3$ のグラフを描くと点 $(x,y)=(0,0)$ でとがっている.
曲線 $y^2=x^3$ における $(x,y)=(0,0)$ のような特異点
を{\bf カスプ (cusp)} と呼ぶ%
\footnote{cusp は「とがった先端」という意味の名詞である.}.
$K[x,y]/(y^2-x^3)=K[t^2,t^3]$ はカスプを持つ曲線 $y^2=x^3$ の上の
多項式函数のなす環である.  
それに $t$ を加えて $K[t]$ という特異点のない直線上
の函数環を構成する操作は特異点解消 (resolution of singularities) の
最も簡単な場合である.
広中平祐 (1931--) は標数が $0$ の場合には任意の次元において
特異点が常に解消可能であることを証明し, 
1970年に Fields 賞 (Fields medal prize) を受賞している.
広中の特異点解消定理は様々な分野に応用を持つ大定理である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[\protect{$\Z[\sqrt{-5}]$} は一意分解整域ではない]
\label{q:Z[sqrt(-5)]-not-UFD}
  $\Z$ と $\alpha\in\C$ に対して $\Z$ と $\alpha$ を含む $\C$ の最小の部分環
  を $\Z[\alpha]$ と書く.  このとき以下が成立することを示せ:
  \begin{enumerate}
  \item $\Z[\sqrt{-5}] = \{\, m+n\sqrt{-5} \mid m,n\in\Z \,\}$.
  \item $\Z[\sqrt{-5}]^\times = \{\pm1\}$.
  \item $2$, $3$, $1\pm\sqrt{-5}$ は $\Z[\sqrt{-5}]$ の既約元である.
  \item $6=2\cdot 3=(1+\sqrt{-5})(1-\sqrt{-5})$ 
    より $\Z[\sqrt{-5}]$ は一意分解整域ではないことがわかる.
  \item 複素平面上に $\Z[\sqrt{-5}]$ とその
    イデアル $(2)$, $(3)$, $A=(2,1+\sqrt{-5})=(2,1-\sqrt{-5})$, 
    $B=(3,1+\sqrt{-5})$, $C=(3,1-\sqrt{-5})$ が
    どのような集合であるかをわかり易く図示せよ. 
  \item $1\pm\sqrt{-5}$ は $\MOD 2$ でも $\MOD 3$ でも $0$ ではないが,
    $(1+\sqrt{-5})(1-\sqrt{-5})=6$ は $\MOD 2$ でも $\MOD 3$ でも $0$ になる.
    このことより $2$, $3$ は $\Z[\sqrt{-5}]$ の素元でないことがわかる.
  \item $A$, $B$, $C$ は $\Z[\sqrt{-5}]$ の素イデアルである.
  \item $(2)=A^2$, $(3)=BC$ であるから, $(6)=A^2BC$ である.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 1. $\Z[\alpha]$ は $\Z$ と $\sqrt{-5}$ を含み加法と乗法で閉じている
ので $\Z[\alpha]$ は右辺を含まなければいけない.  その右辺は $\C$ の部分環を
なすので等号が成立する. 

2. $\Z[\sqrt{-5}]$ の絶対値が $1$ 未満の元は $0$ に限る.
よって $\Z[\sqrt{-5}]$ の元が単元であるためにはその絶対値が $1$ であることが
必要である.  複素平面上に $\Z[\sqrt{-5}]$ の図を描いてみれば明らかなようにそ
のような元は $\pm1$ しかない.  よって $\Z[\sqrt{-5}] = \{\pm1\}$ である.

3. $\Z[\sqrt{-5}]$ の $0,\pm1$ 以外の元の絶対値は $2$ 以上である. 
よって $\Z[\sqrt{-5}]$ の $0$ でも単元でもない2個以上の元の積の絶対値
は $4$ 以上になる.  このことから $2$, $3$, $1\pm\sqrt{-5}$ が $\Z[\sqrt{-5}]$ 
の既約元であることがわかる.  

4. $6=2\cdot 3=(1+\sqrt{-5})(1-\sqrt{-5})$ は $6$ の既約元の積への二種類の分
解であり,  $1\pm\sqrt{-5}\not\sim 2,3$ である. 
よって $\Z[\sqrt{-5}]$ は一意分解整域ではない.

5. $A=\Z 2+\Z(1+\sqrt{-5})=\Z 2+\Z(1-\sqrt{-5})$, 
$B=\Z 3+\Z(1+\sqrt{-5})$,
$C=\Z 3+\Z(1-\sqrt{-5})=\Z 3+\Z(1+2\sqrt{-5})$.

7. $\Z[\sqrt{-5}]/A\isom\F_2$,
$\Z[\sqrt{-5}]/B\isom\Z[\sqrt{-5}]/C\isom\F_3$.

8. $2=-2\cdot 2+(1+\sqrt{-5})(1-\sqrt{-5})\in A^2$ で
あるから $(2)\subset A^2$ である.
逆に $(1+\sqrt{-5})^2=-4+2\sqrt{-5}\in(2)$ で
あるから $A^2\subset(2)$ であることもわかる.
よって $(2)=A^2$ である.
同様にして $(3)=BC$ も確かめられる.
\qed

\medskip
\noindent
参考: 上の問題の結果は E.~Kummner (1810--1893) による理想数 (ideal number) 
としてのイデアルのアイデアを説明するためによく使われる. 
たとえば高木 \cite{takagi2} 第5章第41節273--274頁を見よ.
$\Z[\sqrt{-5}]$ では数の既約元の積への分解の一意性も成立していないし, 
数の素元の積への分解も存在するとは限らない. しかし, 
イデアルの素イデアルの積への一意分解可能性は成立している.
数の世界では成立していない素因数分解の一意存在がイデアル(理想数)の
世界では成立しているのである.
この事実を抽象化することによって {\bf Dedekind 整域 (Dedekind domain)} の
理論が構築され, 代数的整数論の基礎になっている.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{行列の基本変形}
\label{sec:fundamental-operation}

$R$ は可換環であるとする.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $A\in M_n(R)$ の逆行列が $M_n(R)$ の中に存在するための
  必要十分条件は $\det A\in R^\times$ が成立することである.
  \qed
\end{question}

\noindent
ヒント: ある $B\in M_n(R)$ で $AB=BA=E$ となるものが
存在するならば $\det A \det B=1$ なので $\det A\in R^\times$ である.
$A$ の $(i,j)$ 余因子を $(i,j)$ 成分に持つ行列を $\Delta$ と
書くと $\tp{\Delta}A=A\tp{\Delta}=(\det A)E$ 
なので, $\det A\in R^{\times}$ ならば $(\det A)^{-1}\tp{\Delta}$ は $A$ の
逆行列である. 
\qed

\medskip

群 $GL_n(R)$, $SL_n(R)$ を次のように定義する:
\begin{equation*}
  GL_n(R) = \{\, A\in M_n(R) \mid \det A \in R^{\times} \,\},
  \quad
  SL_n(R) = \{\, A\in M_n(R) \mid \det A = 1 \,\}.
\end{equation*}
たとえば $GL_n(\Z)$ は整数を成分に持つ $n$ 次正方行列で行列式が $\pm 1$ にな
るもの全体の集合である.  $SL_n(R)$ は $GL_n(R)$ の部分群をなす.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:(ai1,...,ain)=(1)}
  $A=[a_{ij}]\in GL_n(R)$ ならば $(a_{1j},\dots,a_{nj})=(1)=R$
  \enspace($j=1,\dots,n$).
  \qed
\end{question}

\noindent
ヒント: $A$ の $(i,j)$ 余因子を $\tilde{a}_{ij}$ と
書くと $\sum_{i} \tilde{a}_{ij}a_{ij}=|A|\in R^\times$.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$(i,j)$ 成分だけが $1$ で他の成分が $0$ で
あるような $n$ 次正方行列を $E_{ij}$ と書き,
$n$ 次の単位行列を $E$ と書くことにする.
$n$ を陽に示したい場合は $E_{n;ij}$, $E_n$ と書くことにする.

任意の $a\in R$ と $b\in R^{\times}$ に対して
{\bf 基本行列 (elementary matrices)} 
$U_{ij}(a)\in SL_n(R)$, $D_i(b)\in GL_n(R)$ を次のように定める%
\footnote{$U_{ij}(a)$ の $U$ は unipotent matrix (巾単行列) の頭文字であり,
  $D_i(b)$ の $D$ は diagonal matrix (対角行列) の頭文字である.}:
\begin{align*}
  &
  U_{ij}(a) 
  = E + a E_{ij}  \qquad (i\ne j),
  \\ &
  D_i(b) 
  = E_{11} + \cdots + E_{i-1,i-1}
  + bE_{ii}
  + E_{i+1,i+1} + \cdots + E_{nn}.
\end{align*}
$U_{ij}(a)$ の方は任意の $a\in R$ に対して定義されている
が, $i\ne j$ の場合だけに定義されている.
$D_i(b)$ の方は単数 $b\in R^\times$ のみに対して定義されている.
$n$ を陽に示したい場合には $U_{n;ij}(a)$, $D_{n;i}(b)$ と書くことにする.

$U_{ij}$ は対角成分がすべて $1$ の
三角行列なので $\det U_{ij}(a)=1$ である.
$D_i(b)$ は対角行列であり, $i$ 番目の対角成分だけが $b$ で他の対角成分
が $1$ であるような行列なので $\det D_i(b)=b\in R^\times$ である.

\begin{question}
  $n=3$ の場合に6種類の $U_{ij}(a)$ と3種類の $D_i(b)$ を書き下してみよ.
  そして, $n=3$ の場合に $U_{ij}(a)^{-1}=U_{ij}(-a)$ 
  および $D_i(b)^{-1}=D_i(b^{-1})$ を証明せよ.
  \qed
\end{question}

\begin{question}
  一般の $n$ で $U_{ij}(a)^{-1}=U_{ij}(-a)$, $D_i(b)^{-1}=D_i(b^{-1})$ 
  が成立している. 
  \qed
\end{question}

\begin{question}
  $i\ne j$ のとき $e^{aE_{ij}} = U_{ij}(a)$ である.
  \qed
\end{question}

\noindent
上の2問のヒント: $E_{ij}E_{kl}=\delta_{jk}E_{il}$ である. 
特に $i\ne j$ のとき $E_{ij}E_{ij}=0$.
\qed

\begin{question}
\label{q:DU-UD}
  $i\ne 0$, $b\in R^\times$ のとき %
  $D_i(b)U_{ij}(a)=U_{ij}(ba)D_i(b)$, $U_{ij}(a)D_j(b)=D_j(b)U_{ij}(a)$ 
  であり, $k\ne i,j$ ならば $D_k(b)U_{ij}(a)=U_{ij}D_k(b)$ である.
  \qed
\end{question}

\noindent
ヒント: $D_i(b)U_{ij}(a)=U_{ij}(ba)D_i(b)$ は $i,j$ に関係した部分だけを抜き
出せば次のように証明される:
\begin{equation*}
  \begin{bmatrix}
    b & 0 \\
    0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    1 & a \\
    0 & 1 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    b & ba \\
    0 & 1 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    1 & ba \\
    0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    b & 0 \\
    0 & 1 \\
  \end{bmatrix}.
  \qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

$n=3$, $(i,j,k)=(1,2,3)$, $x=\tp{[x_i,x_j,x_k]}$, $y=[y_i,y_j,y_k]$ に対して,
\begin{align*}
  &
  U_{ij}(a)x = 
  \begin{bmatrix}
    1 & a & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x_i \\ x_j \\ x_k \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    x_i + a x_j \\ x_j \\ x_k \\
  \end{bmatrix},
  \\ &
  D_i(b)x =
  \begin{bmatrix}
    b & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x_i \\ x_j \\ x_k \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    b x_i \\ x_j \\ x_k \\
  \end{bmatrix},
  \\ &
  y U_{ij}(a) = 
  \begin{bmatrix}
    y_i & y_j & y_k \\
  \end{bmatrix}
  \begin{bmatrix}
    1 & a & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    y_i & ay_i + y_j & y_k \\
  \end{bmatrix},
  \\ &
  y D_i(b) =
  \begin{bmatrix}
    y_i & y_j & y_k \\
  \end{bmatrix}
  \begin{bmatrix}
    b & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    by_i & y_j & y_k \\
  \end{bmatrix}.
\end{align*}
これより, 以下が成立することがわかる:
\begin{itemize}
\item $U_{m;ij}(a)$ を $(m,n)$ 型行列 $A$ に左からかける操作
  は $A$ の第 $i$ 行に第 $j$ 行の $a$ 倍を加えるという操作に等しい.
\item $D_{m;i}(b)$ を $(m,n)$ 型行列 $A$ に左からかける操作
  は $A$ の第 $i$ 行を $b$ 倍するという操作に等しい.
\item $U_{n;ij}(a)$ を $(m,n)$ 型行列 $A$ に右からかける操作
  は $A$ の第 $i$ 列の $a$ 倍を第 $j$ 列に加えるという操作に等しい.
\item $D_{n;i}(b)$ を $(m,n)$ 型行列 $A$ に右からかける操作
  は $A$ の第 $i$ 列を $b$ 倍するという操作に等しい.
\end{itemize}
これらの操作を行列の{\bf 基本操作 (elementary operation)} と呼び,
基本操作を任意有限回繰り返すことによって得られる行列の変形を
行列の{\bf 基本変形 (elementary transformation)} と呼ぶことにする%
\footnote{堀田 \cite{gun-kagun}, \cite{10wa} では基本操作を
  {\bf 基本変形 (fundamental transformation)} と呼び,
  基本変形を{\bf 初等変形 (elementary transformation)} と呼んでいる.}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:elem-op-permutation}
  行列の基本変形は行の任意置換と列の任意置換を含んでいる.
  \qed
\end{question}

\noindent
ヒント: $D_j(-1)U_{ij}(1)U_{ji}(-1)U_{ij}(1)$ の左からのかけ算は
第 $i$ 行と第 $j$ 行を交換することが以下のように確かめられる:
\begin{align*}
  &
  \begin{bmatrix}
    1 & 1 \\
    0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x_i \\
    x_j \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    x_i + x_j \\
    x_j \\
  \end{bmatrix},
  \quad
  \begin{bmatrix}
     1 & 0 \\
    -1 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x_i + x_j \\
    x_j \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    x_i + x_j \\
    -x_i \\
  \end{bmatrix},
  \\ &
  \begin{bmatrix}
    1 & 1 \\
    0 & 1 \\
  \end{bmatrix}
  \begin{bmatrix}
    x_i + x_j \\
    -x_i \\
  \end{bmatrix}
  =
  \begin{bmatrix}
     x_j \\
    -x_i \\
  \end{bmatrix},
  \quad
  \begin{bmatrix}
    1 & 0 \\
    0 & -1 \\
  \end{bmatrix}
  \begin{bmatrix}
     x_j \\
    -x_i \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    x_j \\
    x_i \\
  \end{bmatrix}.
\end{align*}
これより $P_{ij}=D_j(-1)U_{ij}(1)U_{ji}(-1)U_{ij}(1)$ が
\begin{equation*}
  P_{ij}=E_{ij}+E_{ji}+\sum_{k\ne i,j}E_{kk}  
\end{equation*}
という形であることが確かめられるので, $P_{ij}$ の
右からのかけ算が第 $i$ 列と第 $j$ 行を交換することもわかる%
\footnote{$P_{ij}$ の $P$ は permutation (置換) の頭文字である.
  $P_{ij}$ は transposition (互換) の操作に対応した行列なの
  で $T_{ij}$ と書くという考え方もあるが, 置換 $\sigma\in S_n$ に
  対応する置換行列を $P_\sigma=\sum_{i=1}^n E_{\sigma(i)i}$ と書いた場合に
  記号の統一が取れるようにするためには $P$ にした方が良い.}.
\qed

\medskip
\noindent
注意: 上の $P_{ij}$ をも基本行列とみなし, 行列の基本操作に行の置換と列の置換
を始めから含めておく流儀もある.  上の問題によってどちらでも同じことなので本
質的な違いはない. 
ただし, 上で定義した行列の基本操作は体上の一変数多項式環 $K[\lambda]$ や
有理整数環 $\Z$ のような Euclid 整域の元を成分に持つ行列の基本操作である.
一般の単項イデアル整域を扱う場合には次の行列 $X_{ij}(a,b,c,d)$ の左と右から
の積が定める操作も行列の基本操作の中に含めておかなければいけない%
\footnote{たとえば堀田 \cite{gun-kagun} 67頁を参照せよ.  
  そこでは $X_{ij}(a,b,c,d)$ は $E_{ij}(\alpha,\beta,\gamma,\delta)$ と
  書かれている.}:
\begin{equation*}
  X_{ij}(a,b,c,d) 
  = a E_{ii} + b E_{ij} + c E_{ji} + d E_{jj} + \sum_{k\ne i,j} E_{kk}
  \quad
  (ad-bc\in R^{\times},\ i\ne j).
\end{equation*}
このとき $X_{ij}(1,a,0,1) = U_{ij}(a)$, $X_{ij}(b,0,0,1) = D_i(b)$,
$X_{ij}(0,1,1,0) = P_{ij}$ ある.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euclid の互除法再論]
\label{q:elem-transf-Euclid}
  $R$ が体 $K$ 上の一変数多項式環 $K[\lambda]$ であるとき, 
  行列の基本変形によって $K[\lambda]$ の元を成分に持つ縦ベクトル
  と横ベクトルに関して Euclid の互除法を実行できる. 
  すなわち, $f_1,\dots,f_n\in K[\lambda]$ の最大公約元を $g$ とすると, 
  有限個の基本行列の積で表示できる
  行列 $A,B\in GL_n(K[\lambda])$ 
  で $A\tp{[f_1,\dots,f_n]}=\tp{[g,0,\dots,0]}$,  
  $[f_1,\dots,f_n]B=[g,0,\dots,0]$ を満たすものが存在する.
  \qed
\end{question}

\noindent
ヒント: $A$ の存在が証明されれば $B$ は $B=\tp{A}$ として
得られるので $A$ の存在だけを証明すれば良い.
ベクトル $\tp{[f_1,\cdots,f_n]}$ に基本変形を以下のような手続きをほどこす:
\begin{enumerate}
\item $f_1=\cdots=f_n=0$ ならば手続きを終了する.
\item 成分の置換によって $0$ でない成分の中で次数が最小のものを $f_1$ に
  持って来る.
\item $f_2,\dots,f_n$ から $f_1$ の多項式倍を引き去ることに
  よって $f_2,\ldots,f_n$ をそれぞれを $f_1$ で割った余りに変換できる.
\item もしも $f_2=\dots=f_n=0$ ならばこの手続きを終了し, 
  そうでないならばステップ 2 に戻る.
\end{enumerate}
この手続きによって $f_2,\dots,f_n$ の次数の最大値は単調に減少するので有限回
でこの手続きは終了し, 最終的に $\tp{[g,0,\dots,0]}$ の形のベクトルが得られる.
しかもどのステップでも $f_1,\dots,f_n$ の最大公約元が保たれることが確かめら
れるので%
\footnote{$f_i=q_if_1+r_i$ ($i=1,\dots,n$) 
  ならば $f_1,r_2,\dots,r_n$ の公約元は $f_1,f_2,\dots,f_n$ の公約元である. 
  $r_i=f_i-p_1f_1$ ($i=1,\dots,n$) なので
  逆に $f_1,f_2,\dots,f_n$ の公約元は $f_1,r_2,\dots,r_n$ の公約元である. 
  よって $f_1,r_2,\dots,r_n$ と $f_1,f_2,\dots,f_n$ の公約元の集合は
  一致するので, 特に最大公約元も一致する.}, 
$g$ は $f_1,\dots,f_n$ の最大公約元である%
\footnote{$g$ と $0$ の最大公約元は $g$ であることが次のようにして示される.
  $g$ と $0$ は $g$ で割り切れる ($g=1\cdot g$, $0=0\cdot g$). 
  $0$ はいつでも割り切れるので, $0$ と $g$ の公約元は $g$ の約元に等しい.
  よって $0$ と $g$ の任意の公約元は $g$ を割り切る.}.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:elem-transf-GL_n(K[x])}
  体 $K$ 上の一変数多項式環 $K[\lambda]$ に関して以下が成立する:
  \begin{enumerate}
  \item $GL_n(K[\lambda])$ の任意の元は有限個の基本行列の積で表わされる.
  \item $SL_n(K[\lambda])$ の任意の元は $U_{ij}(a)$ の型の有限個の基本行列
    の積で表わされる.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 1. $n$ に関する帰納法で $A\in GL_n(K[\lambda])$ が行列の
基本変形で単位行列に変形できることを示せばよい. 
問題 \qref{q:(ai1,...,ain)=(1)} の結果と問題 \qref{q:elem-transf-Euclid} の
結果より, 行列の行に関する基本変形によって $A$ の第 $1$ 列に Euclid の互除法
を適用して $A$ を $
\begin{bmatrix}
  1 & * \\
  0 & A'\\
\end{bmatrix}$ の形に変形できる. ここで $A'\in GL_{n-1}(K[\lambda])$ 
は $n-1$ 次の正方行列である. さらに行列の列に関する基本変形によって, これを $
\begin{bmatrix}
  1 & 0  \\
  0 & A' \\
\end{bmatrix}$ の形に変形できる. よって $A'$ に帰納法の仮定を
適用すれば任意の $A\in GL_n(K[\lambda])$ が行列の基本変形によって
単位行列に変形できることがわかる.

2. 上の1の結果より, 任意の $A\in SL_n(K[\lambda])$ は基本行列の積
で表わされる. 問題 \qref{q:DU-UD} の結果より, 
基本行列の積は $U_{ij}(a)$, $D_k(b)$ の順序を並び換えて 
\begin{equation*}
  D_{k_1}(b_1)\cdots D_{k_r}(b_r)U_{i_1j_1}(a_1)\cdots U_{i_sj_s}(a_s),
  \qquad b_i\in K^\times
\end{equation*}
と表わされる. このとき $1=\det A=b_1\cdots b_r$ である.
問題 \qref{q:elem-op-permutation} のヒントの議論を参考に
すれば, $i\ne j$, $b\in K[\lambda]^\times$ に
対して $S_{ij}(b)=U_{ij}(b)U_{ji}(-b^{-1})U_{ij}(b)$ と置くと, 
\begin{equation*}
  S_{ij}(b) = bE_{ij} - b^{-1}E_{ji} + \sum_{k\ne i,j}E_{kk}
\end{equation*}
であることがわかる%
\footnote{$i,j$ に関係ある部分だけを抜き出すと,
  \begin{equation*}
    S_{ij}(b) =
    \begin{bmatrix}
      1 & b \\
      0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
         1    & 0 \\
      -b^{-1} & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
      1 & b \\
      0 & 1 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      1 & b \\
      0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
         1    & b \\
      -b^{-1} & 0 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      0       & b \\
      -b^{-1} & 0 \\
    \end{bmatrix}.
  \end{equation*}
  }. %
よって $S_{ij}(-1)S_{ij}(b) = D_i(b^{-1})D_j(b)$ である%
\footnote{$i,j$ に関係する部分だけを抜き出すと,
  \begin{equation*}
    S_{ij}(-1) S_{ij}(b) = 
    \begin{bmatrix}
      0 & -1 \\
      1 & 0 \\
    \end{bmatrix}
    \begin{bmatrix}
      0       & b \\
      -b^{-1} & 0 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      b^{-1} & 0 \\
        0    & b \\
    \end{bmatrix}.
  \end{equation*}
  }. %
したがって
\begin{equation*}
  \prod_{k_i\ne 1} [S_{k_i1}(-1)S_{k_i1}(b_i)]
  \cdot D_{k_1}(b_1)\cdots D_{k_r}(b_r)
  = D_1(b_1\cdots b_r) = D_1(1) = E.
\end{equation*}
よって $D_{k_1}(b_1)\cdots D_{k_r}(b_r)$ の部分も $U_{ij}(a)$ の形の基本行列
の積で表わされることがわかった. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[Euclid の互除法再論]
\label{q:elem-transf-Euclid-Z}
  $R=\Z$ であるとき, 行列の基本変形によって整数を成分に持つ縦ベクトル
  と横ベクトルに関して Euclid の互除法を実行できる. 
  すなわち, $a_1,\dots,a_n\in K[\lambda]$ の最大公約元を $b$ とすると, 
  有限個の基本行列の積で表示できる
  行列 $A,B\in GL_n(\Z)$ 
  で $A\tp{[a_1,\dots,a_n]}=\tp{[b,0,\dots,0]}$,  
  $[a_1,\dots,a_n]B=[b,0,\dots,0]$ を満たすものが存在する.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:elem-transf-Euclid} とまったく同様. \qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:elem-transf-GL_n(Z)}
  $\Z$ に関して以下が成立する:
  \begin{enumerate}
  \item $GL_n(\Z)$ の任意の元は有限個の基本行列の積で表わされる.
  \item $SL_n(\Z)$ の任意の元は $U_{ij}(a)$ の型の有限個の基本行列
    の積で表わされる.
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 問題 \qref{q:elem-transf-GL_n(K[x])} とまったく同様.

\medskip
\noindent
解説: 問題 \qref{q:elem-transf-GL_n(K[x])}, \qref{q:elem-transf-GL_n(Z)} 
の結果より, $R=K[\lambda],\Z$ の場合の $(m,n)$ 型行列 $A$ の
基本変形は $P\in GL_m(R)$ と $Q\in GL_n(R)$ を左と右からかける
操作 $A\mapsto PAQ$ に等しいことがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{example}
\label{example:Euclid-v}
  $R=\Q[x]$ とする.
  $v\in R^3$ を $v=\tp{[x^2-1,x^2+x-2,x^2+2x-3]}$ と定める.
  $P\in GL_3(R)$ で $Pv = \tp{[x-1,0,0]}$ となるものを一つ求めよう. 
  基本変形による Euclid の互除法を $v$ に適用すると,
  \begin{equation*}
    \begin{bmatrix}
      x^2 -1 \\ x^2+x-2 \\ x^2+2x-3 \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      x^2-1 \\ x-1 \\ 2x-2 \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      0 \\ x-1 \\ 0 \\
    \end{bmatrix}
    \to
    \begin{bmatrix}
      x-1 \\ 0 \\ 0 \\
    \end{bmatrix}.
  \end{equation*}
  1番目の矢印は第1成分を第2および第3成分から引く操作であり,
  2番目の矢印は第2成分に $x+1$ をかけて第1成分から引き,
  第2成分の2倍を第3成分から引く操作であり,
  3番目の矢印は第1成分と第2成分を交換する操作である.
  この基本変形に対応する行列 $P$ は次のようになる:
  \begin{equation*}
    P = 
    \begin{bmatrix}
      0 & 1 & 0 \\
      1 & 0 & 0 \\
      0 & 0 & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
      1 & -(x+1) & 0 \\
      0 &   1    & 0 \\
      0 &  -2    & 1 \\
    \end{bmatrix}
    \begin{bmatrix}
       1 & 0 & 0 \\
      -1 & 1 & 0 \\
      -1 & 0 & 1 \\
    \end{bmatrix}
    =
    \begin{bmatrix}
      -1  &   1    & 0 \\
      x+2 & -(x+1) & 0 \\
       1  &  -2    & 1 \\
    \end{bmatrix}.
  \end{equation*}
  このとき,
  \begin{equation*}
    P^{-1} =
    \begin{bmatrix}
      x+1 & 1 & 0 \\
      x+2 & 1 & 0 \\
      x+3 & 1 & 1 \\
    \end{bmatrix}.
  \end{equation*}
  $P^{-1}$ の第1列がこの形にならなければいけない
  ことは $v=P^{-1}\tp{[x-1,0,0]}$ 
  と $v=\tp{[(x+1)(x-1),(x+2)(x-1),(x+3)(x-1)]}$ よりわかる.  
  残りの2列をうまく選んで $\det P^{-1} = 1$ となるように
  できれば構成したい $P$ が得られる.
  \qed
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Euclid-v-1}
  $R=\Q[x]$ であるとし, $v\in R^3$ を
  \begin{equation*}
    v=\tp{[x^3+2x^2-x-2,x^3+4x^2+x-6,x^3+3x^2-x-3]}
  \end{equation*}
  と定める.  
  $P\in GL_3(R)$ で $Pv = \tp{[x-1,0,0]}$ となるものを
  一つ求め, $P^{-1}$ を計算せよ. \qed
\end{question}

\commentout{
\noindent
略解: たとえば $P$ を次のように取れば良い:
{\small
\begin{equation*}
  P =
  \begin{bmatrix}
    \frac{1}{2} & \frac{1}{2} & -1 \\
    -(x+3)      & -(x+1)      & 2(x+2) \\
    -\frac{1}{2}x(x+3) & -\frac{1}{2}(x+1)(x+2) & (x+1)(x+2) \\
  \end{bmatrix},
  \ %
  P^{-1} = 
  \begin{bmatrix}
    (x+1)(x+2) & 0           & 1 \\
    (x+2)(x+3) & 1           & 1 \\
    (x+1)(x+3) & \frac{1}{2} & 1 \\
  \end{bmatrix}.
\end{equation*}
}$P^{-1}$ の第1列がこの形になることは $v$ の成分を因数分解すれば確かめられ
る.  $\det P^{-1}=1$ であることも容易に確かめられる.  \qed
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:Euclid-v-2}
  $R=\Q[x]$ であるとし, $v_1,v_2\in R^4$ を
  \begin{equation*}
    v_1 =
    \left[ 
      \begin{array}{c}
        {x}^{4} + 2\,{x}^{3} - 2\,{x} - 1 \\
        {x}^{3} - 3\,{x} - 2 \\
        {x}^{4} + 3\,{x}^{3} + 4\,{x}^{2} + 3\,{x} + 1 \\
        {x}^{3} - 2\,{x}^{2} - 7\,{x} - 4
      \end{array}
    \right],
    \quad
    v_2 =
    \left[ 
      \begin{array}{c}
        {x}^{3} + 3\,{x}^{2} + 2\,{x} \\
        {x}^{3} + 4\,{x}^{2} + 5\,{x} + 2 \\
        {x}^{3} + 5\,{x}^{2} + 8\,{x} + 4 \\
        {x}^{3} - 2\,{x}^{2} - 7\,{x} - 4
      \end{array}
    \right]
  \end{equation*}
  と定める.
  $P_i\in GL_4(R)$ で $P_iv_i$ が $\tp{[*,0,0,0]}$ の形になるものを
  一つ求め, $P_i^{-1}$ を計算せよ. \qed
\end{question}

\commentout{
\noindent
略解: $v_1$, $v_2$ の成分は次のように因数分解される:
\begin{equation*}
  v_1 =
  \left[ 
    \begin{array}{c}
      (\,{x} + 1\,)^{3}\,(\,{x} - 1\,) \\
      (\,{x} + 1\,)^{2}\,(\,{x} - 2\,) \\
      (\,{x} + 1\,)^{2}\,(\,{x}^{2} + {x} + 1\,) \\
      (\,{x} + 1\,)^{2}\,(\,{x} - 4\,)
    \end{array}
  \right],
  \quad
  v_2 =
  \left[ 
    \begin{array}{c}
      {x}\,(\,{x} + 2\,)\,(\,{x} + 1\,) \\
      (\,{x} + 1\,)^{2}\,(\,{x} + 2\,) \\
      (\,{x} + 1\,)\,(\,{x} + 2\,)^{2} \\
      (\,{x} + 1\,)^{2}\,(\,{x} - 4\,)
    \end{array}
  \right].
\end{equation*}
$P_1$, $P_2$ としてたとえば以下が取れる:
\begin{align*}
  &
  P_1 = 
  \left[ 
    \begin{array}{ccrr}
      {\frac {1}{3}} &  - \,{\frac {1}{3}}
      \,{x} - {\frac {2}{3}} & 0 & 0 \\ [2ex]
      {x} - 2 &  - (\,{x} - 1\,)\,(\,{x} + 1\,) & 0 & 0 \\
      - \,{\frac {1}{3}}\,{x}^{2} - {
        \frac {1}{3}}\,{x} - {\frac {1}{3}} & 
      {\frac {1}{3}}\,(\,{x}^{2} + {x} + 1\,)\,(\,{x} + 2
      \,) & 1 & 0 \\ [2ex]
      - \,{\frac {1}{3}}\,{x} + {\frac {4
          }{3}} & {\frac {1}{3}}\,(\,{x} - 4\,)\,(\,{x} + 2\,
      ) & 0 & 1
    \end{array}
  \right],
  \\ &
  P_2 =
  \left[ 
    \begin{array}{ccrc}
      {\frac {1}{6}}\,{x} - {\frac {5}{6}}
      &  - \,{\frac {1}{6}}\,{x} + {
        \frac {5}{6}} & 0 & {\frac {1}{6}} \\ [2ex]
      - {x} - 1 & {x} & 0 & 0 \\
      {x} + 2 &  - {x} - 2 & 1 & 0 \\
      (\,{x} + 1\,)\,(\,{x} - 4\,) &  - (\,{x} + 1\,)\,(\,{x} - 4\,) & 
      0 & {x} + 2
    \end{array}
  \right].
\end{align*}
このとき
\begin{equation*}
  P_1v_1 =
  \left[ 
    \begin{array}{c}
      (\,{x} + 1\,)^{2} \\
      0 \\
      0 \\
      0
    \end{array}
 \right],
 \quad
 P_2v_2 =
 \left[ 
   \begin{array}{c}
     {x} + 1 \\
     0 \\
     0 \\
     0
   \end{array}
 \right]
\end{equation*}
でかつ
\begin{align*}
  &
  P_1^{-1} =
  \left[ 
    \begin{array}{ccrr}
      (\,{x} - 1\,)\,(\,{x} + 1\,) &  - \,{\frac {1}{3}}
      \,{x} - {\frac {2}{3}} & 0 & 0 \\ [2ex]
      {x} - 2 & {\frac {-1}{3}} & 0 & 0 \\ [2ex]
      {x}^{2} + {x} + 1 & 0 & 1 & 0 \\
      {x} - 4 & 0 & 0 & 1
    \end{array}
  \right],
  \\ &
  P_2^{-1} = 
  \left[ 
    \begin{array}{crrc}
      (\,{x} + 2\,)\,{x} & -1 & 0 &  - \,{\frac {1}{6}}\,
      {x} \\ [2ex]
      (\,{x} + 2\,)\,(\,{x} + 1\,) & -1 & 0 &  - \,{
        \frac {1}{6}}\,{x} - {\frac {1}{6}} \\ [2ex]
      (\,{x} + 2\,)^{2} & 0 & 1 &  - \,{\frac {1}{6}}\,{x
        } - {\frac {1}{3}} \\ [2ex]
      (\,{x} + 1\,)\,(\,{x} - 4\,) & 0 & 0 &  - \,{
        \frac {1}{6}}\,{x} + {\frac {5}{6}}
    \end{array}
  \right].
  \qed
\end{align*}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:cannot-Euclid-K[x,y]}
  $K$ は体であり, $R=K[x,y]$ であるとする.  $v = \tp{[x,y]}
  \in R^2=M_{2,1}(R)$ とすると, どのような $P\in GL_2(R)$ を
  取っても $Pv$ は $f(x,y)e_1=\tp{[f(x,y),0]}$ ($f\in R$) の形にならない.
  \qed
\end{question}

\noindent
ヒント: $P$ の逆行列を $P^{-1}=
\begin{bmatrix}
  a & b \\
  c & d \\
\end{bmatrix}$  ($a,b,c,d\in R$) と書けば $Pv=
\begin{bmatrix}
  f \\
  0 \\
\end{bmatrix}$ となるとき, $
\begin{bmatrix}
  x \\
  y \\
\end{bmatrix} 
= v = P^{-1}Pv =
\begin{bmatrix}
  af \\
  cf \\
\end{bmatrix}$ である.  $f$ は $x$, $y$ の共通因子
なので $\alpha:=f\in K^\times$ である.  
よって $a=\alpha^{-1}x$, $b=\alpha^{-1}y$ である.
$P^{-1}\in GL_2(R)$ であるから $ad-bc\in R^\times=K^\times$ である.
よって $ad-bc$ の中の $x$, $y$ に $0$ を代入すると $0$ にならない.
しかし $ad - bc = \alpha^{-1}(xd - yc)$ であるから $x$, $y$ に $0$ を
代入すると $0$ になる.  よって矛盾する. \qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{単因子と行列式因子}
\label{sec:elementary-divisor}

\begin{theorem}[単因子]
\label{theorem:elementary-divisor}
  $R$ は体 $K$ 上の一変数多項式環 $K[\lambda]$ または $\Z$ であるとし%
  \footnote{もちろん $R$ は一般の Euclid 整域でも成立する.
    基本変形を適切に拡張しておけば任意の単項イデアル整域でも成立する.
    たとえば堀田 \cite{gun-kagun} の第12節を参照せよ.}, 
  $R$ の元を成分に持つ $(m,n)$ 型行列 $A\in M_{m,n}(R)$ を任意に取る. 
  このとき行列の基本変形によって $A$ を
  \begin{equation*}
    \begin{bmatrix}
      e_1 &     &        &     &   & & \bigzerou \\
          & e_2 &        &     &   & & \\
          &     & \ddots &     &   & & \\
          &     &        & e_s &   & & \\
          &     &        &     & 0 & & \\
      \bigzerol & &      &     &   & \ddots & \\
    \end{bmatrix}
  \end{equation*}
  の形の行列で次をみたすものに変形できる:
  \begin{equation*}
    e_1\mid e_2\mid\cdots\mid e_s, \qquad e_s\ne 0.
  \end{equation*}
  しかもこのような $e_1,\dots,e_s$ は単元倍を除いて一意に定まる.  
  $e_1,\dots,e_s$ を行列 $A$ の{\bf 単因子 (elementary divisors)} と呼ぶ%
  \footnote{任意の可換環において $0\in R$ は任意の $a\in R$ で割り切れる
    (なぜならば $0=0\cdot a$).
    よって $N=\min\{m,n\}$, $e_{s+1}=\cdots=e_N=0$ と
    置けば $e_1\mid e_2\mid\cdots\mid e_N$ が成立する.
    したがって $0$ を例外扱いする必要はなく, $0$ も単因子に含めておいても問
    題は生じない.}. 
  \qed
\end{theorem}

以下において $K$ は体であるとし, $R$ が $K$ 上の一変数多項式環 $K[\lambda]$
の場合と有理整数環 $\Z$ の場合を扱う.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:exists-elementary-divisor}
  $R=K[\lambda]$ の場合に\theoremref{theorem:elementary-divisor}の
  条件を満たす基本変形の存在を証明せよ. \qed
\end{question}

\noindent
ヒント1: $m$ に関する帰納法.  $A=0$ ならば何もすることはない. 
よって $A\ne 0$ と仮定して良い.
$A$ に基本変形をほどこした結果全体の集合を $\cE$ と書き, 
ある $B\in\cE$ の成分になっているような $R$ の元全体の集合を $\cF$ と
書くことにする. $\cF$ に含まれる $0$ でない次数が最小の元を $e_1$ とする.
$e_1$ を第 $(1,1)$ 成分とする $B\in\cE$ が存在する. 
$B$ の第 $1$ 列と第 $1$ 行の第 $(1,1)$ 以外の成分の中に $e_1$ で割
り切れないものが存在するとすれば, 基本変形によってその割り切れない成分
から $e_1$ の多項式倍を引き去ることによって $e_1$ よりも次数が
低い $0$ でない元を構成できるので, $e_1$ の次数の最小性に反する.
したがって $a_{11}=e_1$ でそれ以外の第 $1$ 列と第 $1$ 行の成分は割り切れる.
そのことから行列の基本変形によって, $a_{11}=e_1$ はそのままにそれ以外の
第 $1$ 列と第 $1$ 行の成分を $0$ にできることがわかる.
その結果を $ C =
\begin{bmatrix}
  e_1 & 0 \\
  0   & C' \\
\end{bmatrix}$ と書くことにする. ここで $C'$ は $(m-1,n-1)$ 型行列である.
もしも $C'$ の成分の中に $e_1$ で割り切れない成分が存在するとすれば
その成分を含む $C$ の列を第1列に加えてから上と同様の議論を行なうことに
よって, $e_1$ の次数の最小性に矛盾することがわかる.
よって $C'$ のすべての成分は $e_1$ で割り切れる.
あとは $C'$ に帰納法の仮定を適用すれば証明が終わる.
$C'$ の基本変形で「$C'$ のすべての成分が $e_1$ で割り切れる」という性質が保
たれることに注意せよ.
\qed

\medskip
\noindent
注意: 上のヒント1の証明は単因子を計算するためのアルゴリズムを与えない.
しかし下のヒント2はアルゴリズムを与える.

\medskip
\noindent
ヒント2: $A=[a_{ij}]\in M_{m,n}(R)$ に以下の手続きで基本変形をほどこす:
\begin{enumerate}
\item $A=0$ ならば手続きを終了する.
\item 行と列の置換によって, $A$ の $0$ でない次数が最小の成分を第 $(1,1)$ 成
  分に持って来て, 改めてその行列を $A$ として次に進む.
\item 以下のサブルーチンを実行する:
  \begin{enumerate}
  \item $a_{21},\dots,a_{m1}$ のすべてが $a_{11}$ で割り切れるならば
    第 $1$ 行の多項式倍を第 $2,\dots,m$ 行に
    加えて第 $(2,1),\dots,(m,1)$ 成分をすべて $0$ にする.
    その結果を改めて $A$ として次に進む.
  \item $a_{21},\dots,a_{m1}$ のどれかが $a_{11}$ で割り切れない
    ならば行の基本変形を用いて第 $1$ 列に Euclid の互除法を適用して $A$ を
    次の形に変形する(問題 \qref{q:elem-transf-Euclid} のヒントを見よ):
    \begin{equation*}
      \begin{bmatrix}
        a & b \\
        0 & B \\
      \end{bmatrix},
      \qquad
      0\ne a\in R,\quad
      b\in M_{1,n-1}(R),\quad 
      B\in M_{m-1,n-1}(R).
    \end{equation*}
    ここで $a$ は $A$ の第 $1$ 列の最大公約元であり, 
    $\deg a<\deg a_{11}$ が成立している.
    変形した結果を改めて $A$ として次に進む.
  \item $a_{12},\dots,a_{1n}$ のすべてが $a_{11}$ で割り切れるならば
    第 $1$ 列の多項式倍を第 $2,\dots,m$ 列に
    加えて第 $(1,2),\dots,(1,n)$ 成分をすべて $0$ にする.
    その結果を改めて $A$ として次に進む.
  \item $a_{12},\dots,a_{1n}$ のどれかが $a_{11}$ で割り切れない
    ならば列の基本変形を用いて第 $1$ 行に Euclid の互除法を適用して $A$ を
    次の形に変形する(問題 \qref{q:elem-transf-Euclid} のヒントを見よ):
    \begin{equation*}
      \begin{bmatrix}
        a & 0 \\
        c & B \\
      \end{bmatrix},
      \qquad
      0\ne a\in R,\quad
      c\in M_{m-1,1}(R),\quad 
      B\in M_{m-1,n-1}(R).
    \end{equation*}
    ここで $a$ は $A$ の第 $1$ 行の最大公約元であり, 
    $\deg a<\deg a_{11}$ が成立している.
    その結果を改めて $A$ として次に進む.
  \item もしも $A$ が次の形をしてたらこのサブルーチンを終了する:
    \begin{equation*}
      \begin{bmatrix}
        a & 0 \\
        0 & B \\
      \end{bmatrix},
    \qquad
    0\ne a\in R,\quad
    B\in M_{m-1,n-1}(R).
    \tag{$\sharp$}
    \end{equation*}
    このサブルーチンは必ず有限ステップで終了する. 
    なぜならば, $a_{11}$ で第 $1$ 列もしくは第 $1$ 行の他の成分のすべてが割り
    切れないならば $\deg a_{11}$ の次数がより小さくなるからである.
    そして両方がすべて割り切れるならば $A$ は ($\sharp$) の形に
    変形されてしまう.
  \end{enumerate}
\item この時点で $A$ は ($\sharp$) の形をしている.  
  もしも $B$ のある成分が $a$ で割り切れないならば, 
  その成分が存在する列もしくは行を第 $1$ 列もしくは第 $1$ 行に加える.
  その結果を改めて $A$ としてステップ 3 に戻る.
\item $B$ のすべての成分が $a$ で割り切れるならば $B$ に対して
  この手続き自身を再帰的(帰納的)に適用する.  
  (行列 $B$ を基本変形しても「$B$ のすべての成分が $a$ で割り切れる」
  という性質が保たれることに注意せよ.)
\item この手続きの全体を終了する.
  この手続き全体は必ず有限ステップで終了する.
  なぜならば, ステップ3の終了時に $B$ のある成分が $a$ で割り切れないならば
  ステップ4を経由してステップ3に戻り, ステップ(b)で $\deg a_{11}$ がより小さ
  くなるからである.
  \qed
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:exists-elementary-divisor-Z}
  $R=\Z$ の場合に\theoremref{theorem:elementary-divisor}の条件を満たす
  基本変形の存在を証明せよ. \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:exists-elementary-divisor} とまったく同様.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip
\noindent

$R=K[\lambda],\Z$ のとき, $(m,n)$ 型行列 $A\in M_{m,n}(R)$ に
対して $A$ のすべての $i$ 次小行列式%
\footnote{$(m,n)$ 型行列の $i$ 次小行列式は $\binom{m}{i}\binom{n}{i}$ 通り
  存在する.}%
の最大公約元を $d_i(A)$ と書き, $A$ の{\bf 行列式因子 (determinaltal
divisor)} と呼ぶ%
\footnote{単因子の記号 $e_i$ は elementary divisor の頭文字を取っており,
  行列式因子の記号 $d_i$ は determinantal divisor の頭文字を取っている.
  堀田 \cite{gun-kagun} では単因子は $d_i$ と表わされ, 
  行列式因子を $\varDelta_i$ と表わされているので混乱しないように注意せよ.}.

\begin{question}[行列式因子の基本変形による不変性]
\label{q:invariance-det-div}
  行列式因子は基本変形によって (単元倍を除いて) 不変である.
  \qed
\end{question}

\noindent
ヒント: $A$ に基本操作をほどこした行列を $B$ とする. 基本操作の逆もまた基本
操作なので $d_i(A)$ と $d_i(B)$ が単元倍を除いて等しいことを示すため
には, $d_i(B)$ が $d_i(A)$ で割り切れることを示せば良い.  
そのためには $B$ の $i$ 次の小行列式が $d_i(A)$ で割り切れることを示せば良い.
$B=D_{m;k}(b)A$ と $B=AD_{n,k}(b)$ の場合は $B$ の $i$ 次の小行列式
は $A$ の $i$ 次の小行列式に等しいか $b$ 倍になるので, $B$ の $i$ 次
の小行列式は $d_i(A)$ で割り切れる.
$B=U_{m;k,l}(a)A$ と $B=AU_{n;k,l}$ の場合は $B$ の $i$ 次の小行列式
は $A$ の $i$ 次の小行列式の倍元の和の形になるので $d_i(A)$ で割り切れる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[単因子と行列式因子の関係]
\label{q:elem-div-det-div}
  $A\in M_{m,n}(R)$ の単因子を $e_1,\dots,e_s$ と書き, 
  行列式因子を $d_1,\dots,d_k$ と書くとき, 
  必要ならば単元倍を調整することによって次が成立する:
  \begin{equation*}
    d_1 = e_1,\ d_2 = e_1e_2,\ \dots,\ d_s = e_1e_2\cdots e_s,
    \qquad
    d_i = 0 \quad (i>s).
  \end{equation*}
  これは次と同値なので $A$ の単因子は $A$ から単元倍を除いて一意に定まる
  こともわかる:
  \begin{equation*}
    e_1 = d_1,\ e_2 = d_2/d_1,\ \ldots,\ e_s = d_s/d_{s-1}.
  \qed
  \end{equation*}
\end{question}

\noindent
注意: この問題を解けば\theoremref{theorem:elementary-divisor}の証明が終了す
ることになる.
\qed

\medskip
\noindent
ヒント: $A$ を基本変形することによって次の形の行列が得られたとする:
\begin{equation*}
  B =
  \begin{bmatrix}
    e_1 &     &        &     &   & & \bigzerou \\
        & e_2 &        &     &   & & \\
        &     & \ddots &     &   & & \\
        &     &        & e_s &   & & \\
        &     &        &     & 0 & & \\
    \bigzerol & &      &     &   & \ddots & \\
  \end{bmatrix},
  \qquad
  e_1\mid e_2\mid\cdots\mid e_s, \quad
  e_s\ne 0.
\end{equation*}
問題 \qref{q:elem-div-det-div} の結果より, 
単元倍を調節すれば $d_i(A)=d_i(B)$ である. 
しかし, $d_i(B)$ は容易に計算できる: %
$d_1(B) = e_1$, $d_2(B) = e_1e_2$, $\ldots$, $d_r(B) = e_1e_2\cdots e_s$,
$d_i(B) = 0$ ($i>s$).
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{有限生成加群}
\label{sec:finitely-generated-module}

可換環 $R$ 上の加群 $M$ が {\bf $R$ 上有限生成 (finitely generated over
$R$)} であるとはある $u_1,\dots,u_n\in R$ で
\begin{equation*}
  M = Ru_1 + \cdots + Ru_n
\end{equation*}
を満たすものが存在することである.  このとき任意の $u\in M$ は
\begin{equation*}
  u = a_1 u_1 + \cdots + a_n u_n,
  \qquad
  a_1,\dots,a_n\in R
\end{equation*}
と表わされるが, この表示の一意性が成立するとは限らないことには
注意しなければいけない.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:fin-gen}
  $R$ が単項イデアル整域であるとき, $M$ が $R$ 上高々 $n$ 個の元から
  生成される有限生成 $R$ 加群であるならば, 
  その任意の $R$ 部分加群も $R$ 上高々 $n$ 個の元から生成される%
  \footnote{これは, 単項イデアル整域上の有限生成加群に対して,
    ベクトル空間の場合に成立している「部分空間の次元は小さくなる」
    という結果に近い結果が成立していることを意味している.}.
  \qed
\end{question}

\noindent
ヒント: $n$ に関する帰納法で証明する.

$n=1$ のとき,  $M=Ru_1$ であるとし, 
全射 $R$ 準同型 $\phi:R\to M$ を $\phi(a)=au_1$ と定める. 
$N$ が $M$ の $R$ 部分加群ならば $\phi^{-1}(N)$ は $R$ の $R$ 部分加群
すなわちイデアルである.  $R$ は単項イデアル整域なのである $v\in R$ 
で $\phi^{-1}(N)=Rv$ を満たすものが存在する. 
このとき $N=\phi(\phi^{-1}(N))=\phi(Rv)=R\phi(v)$ である.

$n\ge 2$ であるとし, $n-1$ まで問題の結論が成立していると仮定する.
$M=Ru_1+\cdots+Ru_n$ であるとし, $N$ はその任意の $R$ 部分加群であるとする. 
$n=1$ の場合を $Ru_1$ の $R$ 部分加群 $N\cap Ru_1$ に適用すると, 
ある $v_1\in N\cap Ru_1$ で $N\cap Ru_1 = Rv_1$ を満たすものが存在する.
$M'=M/Ru_1$ と置き, $M$ から $M'$ への自然な全射 $R$ 準同型を $\pi$ と書くこ
とにする. このとき $M'=R\pi(u_2)+\cdots+R\pi(u_n)$ である.
よって帰納法の仮定より, ある  $v_2,\dots,v_n\in N$ 
で $\pi(N)=R\pi(v_2)+\cdots+R\pi(v_n)$ を満たすものが存在する.
よって任意の $v\in N$ に対してある $a_2,\dots,a_n\in R$ 
で $\pi(v)=a_2\pi(v_2)+\cdots+a_n\pi(v_n)$ となるものが存在する.
そのとき, $v-(a_2v_2+\cdots+a_nv_n)\in\Ker\pi|_N=N\cap Ru_1$ である.
よってある $a_1\in R$ で $v-(a_2v_2+\cdots+a_nv_n)=a_1v_1$ となるものが存在
する.  これで $N=Rv_1+\cdots+Rv_n$ であることが証明された.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[有限生成自由加群]
\label{q:free-mod}
  可換環 $R$ 上の加群 $M$ に対して以下の条件は互いに同値である:
  \begin{itemize}
  \item[(a)] $M$ は $R^n$ と $R$ 加群として同型である.
  \item[(b)] ある $u_1,\dots,u_n\in M$ が存在して, 任意の $u\in M$ は
    \begin{equation*}
      u = a_1 u_1 + \cdots + a_n u_n,
      \qquad
      a_1,\dots,a_n\in R
    \end{equation*}
    と一意に表わされる.
  \end{itemize}
  これらの同値な条件が成立しているとき, $M$ 
  は{\bf 階数 $n$ の有限生成自由 $R$ 加群 
  (finitely generated free $R$-module of rank $n$)} と呼ばれ, 
  (b)の $u_1,\dots,u_n$ は $M$ の{\bf 自由 $R$ 基底 (free $R$-basis)} と
  呼ばれる%
  \footnote{free という単語は「ない」という意味でもよく使われる.
    たとえば tax-free と言えば「無税の」という意味である. free module の意味
    での free は「非自明な一次関係がない」「非自明な一次関係に束縛されていな
    いという意味で自由な」という意味である.}. \qed 
\end{question}

\noindent
ヒント: $R$ 同型 $\phi:R^n\isomto M$ が存在する
とき, $\phi(e_1),\dots,\phi(e_n)$ は $M$ の自由 $R$ 基底になる%
\footnote{$e_i$ は第 $i$ 成分だけが $1$ で他は $0$ の縦ベクトル. 
  単因子の記号と混乱しないように注意せよ.}.
$u_1,\dots,u_n$ が $M$ の自由 $R$ 基底であるとき,
$\phi:R^n\to M$ を $\phi(\tp{[a_1,\dots,a_n]})=a_1u_1+\cdots+a_nu_n$ と定め
ると $\phi$ は $R$ 同型である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[階数の一意性]
\label{q:rank-uniquness}
  簡単のため $R$ は $K[\lambda]$ または $\Z$ であるとする%
  \footnote{実際には任意の可換環 $R$ で成立する.
    もしも $R$ が整域ならばヒントにおける体 $F$ として $R$ の商体 (分数体) 
    を取れば良い.  $R$ が一般の可換環の場合には Zorn の補題を用いて存在が
    証明される極大イデアル $\frakm$ で割った剰余体 $k=R/\frakm$ を用いた
    議論で商体 $F$ を用いた議論を置き換えれば良い.
    たとえば堀田 \cite{gun-kagun} 62頁の定理11.2を見よ.}.
  $M$ は有限生成自由 $R$ 加群であるとする.
  そのとき $M$ の階数は自由 $R$ 基底の取り方に寄らず一定である.
  \qed
\end{question}

\noindent
ヒント: $R=K[\lambda]$ ならば $F=K(\lambda)$ ($K$ 上の一変数有理函数体%
\footnote{多項式の分数全体のなす体を有理函数体と呼ぶ.}) であるとし, 
$R=\Z$ ならば $F=\Q$ であるとする. このとき $R$ は体 $F$ の部分環である.
$u_1,\dots,u_m$ と $v_1,\dots,v_n$ は $M$ の自由 $R$ 基底であるとする. 
$u_i$ たちと $v_j$ たちは互いに相手の $R$ 係数の一次結合で一意的に表わされる.
よって, 行列 $A\in M_{m,n}(R)$ と $B\in M_{n,m}(R)$ で
\begin{equation*}
  [u_1,\dots,u_m]A=[v_1,\dots,v_n],
  \qquad
  [v_1,\dots,v_n]B=[u_1,\dots,u_m]
\end{equation*}
を満たすものが一意に存在する. このとき,
\begin{equation*}
  [u_1,\dots,u_m]AB=[u_1,\dots,u_m], 
  \qquad
  [v_1,\dots,v_n]BA=[v_1,\dots,v_n]
\end{equation*}
なので $AB=E_m$ かつ $BA=E_n$ が成立する. 
$R\subset F$ なので $A$, $B$ は体 $F$ の元を成分に持つ行列とみなせる.
よって体上の行列に関する理論より $m=n$ でなければいけないことがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[自由基底の取り換え]
\label{q:free-bases}
  $M$ は可換環 $R$ 上の階数 $n$ の有限生成自由加群であるとし,
  $u_1,\dots,u_n$ はその自由 $R$ 基底であるとすると,
  $v_1,\dots,v_n\in M$ に対して行列 $A=[a_{ij}]\in M_n(R)$ で
  \begin{equation*}
    v_i = a_{1i}u_1 + \cdots + a_{ni}u_n
    \qquad (i=1,\dots,n)
  \end{equation*}
  を満たすものが一意に存在する. このとき, $v_1,\dots,v_n$ が $M$ の自由 $R$ 
  基底になるための必要十分条件は $A\in GL_n(R)$ となることである.
  \qed
\end{question}

\noindent
ヒント: $v_i$ たちを $u_i$ たちの $R$ 係数一次結合で表わす式は %
$[v_1,\dots,v_n]=[u_1,\dots,u_n]A$ と書き直せる.
もしも $v_i$ たちが $M$ の自由 $R$ 基底ならばある $B\in M_n(R)$ 
で $[u_1,\dots,u_n]=[v_1,\dots,v_n]B$ を満たすものが一意に存在する.
このとき $[u_1,\dots,u_n]AB=[u_1,\dots,u_n]$ 
かつ $[v_1,\dots,v_n]BA=[v_1,\dots,v_n]$ なので $AB=BA=E_n$ である.
よって $A\in GL_n(R)$ である.
逆に $A\in GL_n(R)$ であると仮定する.
$[u_1,\dots,u_n]=[v_1,\dots,v_n]A$ と $u_i$ たちを $v_i$ たち $R$ 係数一次結
合で表わせるので, 任意の $M$ の元は $v_i$ たちの $R$ 係数一次結合で表わせる.
$a_1v_1+\cdots+a_nv_n=0$, $a_i\in R$ すなわち $[v_1,\dots,v_n]a=0$, 
$a=\tp{[a_1,\dots,a_n]}$ とすると, $[u_1,\dots,u_n]Aa=0$ であるから, 
$Aa=0$ である. よって $a=0$ である. このことより $v_i$ たちの $R$ 係数一次結合
で $M$ の元を表わす方法は一通りしか存在しないことがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:free-resol}
  $R$ は単項イデアル整域であるとし, $M$ は高々 $n$ 個の元から生成され
  る有限生成 $R$ 加群であるとする.
  このとき, 全射 $R$ 準同型 $\pi:R^n\to M$ と行列 $A\in M_n(R)$ 
  で $\Ker\pi=\Image A$ となるものが存在し, $R$ 同型 $M\isom R^n/\Image A$ 
  が成立する.
  \qed
\end{question}

\noindent
ヒント: 全射 $R$ 準同型 $\pi:R^n\to M$ 
を $\pi(\tp{[a_1,\dots,a_n]})=a_1u_1+\cdots+a_nu_n$ と定めることができる.  
問題 \qref{q:fin-gen} の結果より, $\Ker\pi = Rv_1+\cdots+Rv_n$ と書ける.
$R$ 準同型 $\psi:R^n\to R^n$ 
を $\psi(\tp{[b_1,\dots,b_n]})=b_1v_1+\cdots+b_nv_n$ と
定め, $A$ は $\psi$ を表現する行列であるとする%
\footnote{$A=[v_1,\dots,v_n]$ である. 問題 \qref{q:R-hom-matrix} を見よ.}.
このとき $\Image A=\Image\psi=Rv_1+\cdots+Rv_n=\Ker\pi$ が成立している.
同型 $M\isom R^n/\Image A$ は準同型定理より, ただちに得られる.
\qed

\medskip
\noindent
参考: 準同型の列 $L\to M\to N$ が{\bf 完全 (exact)} である
とは $\Image(L\to M)=\Ker(M\to N)$ が成立していることである.
たとえば, $\Ker(N\to 0)=N$ なので $M\to N\to 0$ が完全である
ことと $M\to N$ が全射 ($\Image(M\to N)=N$) であることは同値である. 
これとは双対的に $\Image(0\to M)=0$ なので $0\to M\to N$ が完全であること
と $M\to N$ が単射 ($\Ker(M\to N)=0$) であることは同値である.
より長い準同型の列を考える場合にはこの条件を考えることができる場所すべてにつ
いてこの条件が成立しているとき, その列は完全であるという.
上の問題の結論は次のように言い換えられる. 単項イデアル整域 $R$ 上の
高々 $n$ 個の元から生成される有限生成加群 $M$ に対して次のような
完全列が存在する:
\begin{equation*}
  \begin{CD}
    0 @<<< M @<\pi<< R^n @<A<< R^n.
  \end{CD}
\end{equation*}
$\pi:R^n\to R^n$ から $A:R^n\to R^n$ を作ったのと同様の手続きでこの完全列
は無限に延長できる:
\begin{equation*}
  \begin{CD}
    0 @<<< M @<\pi<< R^n @<A<< R^n @<<< R^n @<<< \cdots.
  \end{CD}
\end{equation*}
実は $m\le n$ を適切に選んで次のような完全列を構成することができる:
\begin{equation*}
  \begin{CD}
    0 @<<< M @<\pi<< R^n @<A<< R^m @<<< 0.
  \end{CD}
\end{equation*}
この結果は一般の単項イデアル整域でも成立しているが, 
この演習では $R=K[\lambda],\;\Z$ の場合だけを扱う.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}[\protect{$K[\lambda]$} と $\Z$ 上の有限生成加群の構造定理]
\label{theorem:fg-PID-modules}
  $R=K[\lambda],\;\Z$ であるとし, $M$ は $R$ 上の有限生成自由加群であるとする.
  このとき, $r\in\Z_{\ge0}$ と
  \begin{equation*}
    f_1\mid f_2\mid\cdots\mid f_s, \qquad 
    f_1\not\in R^\times, \quad 
    f_s\ne 0
  \end{equation*}
  を満たす $f_1,\dots,f_s\in R$ で $R$ 加群としての同型
  \begin{equation*}
    M \isom R/Rf_1\oplus\cdots\oplus R/Rf_s\oplus R^r
  \end{equation*}
  が成立するものが存在する. しかも $r$ と $f_1,\dots,f_s$ は単元倍を
  除いて $M$ から一意に定まる%
  \footnote{この結果は $R$ が任意の単項イデアル整域の場合にも成立するが,
    この演習では $R=K[\lambda],\;\Z$ の場合のみを扱う.}. 
  そこで 
  \begin{equation*}
    (f_1,f_2,\dots,f_s, \overbrace{0,\dots,0}^r)
  \end{equation*}
  を $M$ の{\bf 単因子型 (type of elementary divisors)} と呼ぶことにする.
  \qed
\end{theorem}

以上の定理の証明を演習問題とヒントの羅列によって解説する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[単因子型の存在]
\label{q:exists-type-of-ed}
  \theoremref{theorem:fg-PID-modules}
  における単因子型の存在を証明せよ.
  \qed
\end{question}

\noindent
ヒント: $M$ が高々 $n$ 個の元から生成される有限生成 $R$ 加群で
あるならば, 問題 \qref{q:free-resol} の結果より, 
全射 $R$ 準同型 $\pi:R^n\to M$ と行列 $A\in M_{n,m}(R)$ で%
\footnote{$m=n$ に取れるがここでは必要ない.} $\Ker\pi=\Image A$ を満たすもの
が存在する.  そのとき $R$ 同型 $M\isom R^n/\Image A$ が存在する.
行列 $A$ を $R$ 準同型 $A:R^m\to R^n$ とみなし, $R^m$, $R^n$ の自由基底の取
り換えによって $A$ をできるだけ簡単な形にすることを考える.
問題 \qref{q:free-bases} と\theoremref{theorem:elementary-divisor}より
$A$ は次の形をしていると仮定して良い:
\begin{equation*}
  A =
  \begin{bmatrix}
    e_1 &     &        &     &   & & \bigzerou \\
        & e_2 &        &     &   & & \\
        &     & \ddots &     &   & & \\
        &     &        & e_t &   & & \\
        &     &        &     & 0 & & \\
    \bigzerol & &      &     &   & \ddots & \\
  \end{bmatrix},
  \qquad
  e_1\mid e_2\mid\cdots\mid e_t, \quad
  e_t\ne 0.
\end{equation*}
さらに $e_{t-s}\in R^\times$, $e_{t-s+1}\not\in R^\times$ である
とし, $f_1=e_{t-s+1},\dots,f_{s-1}=e_{t-1},f_s=e_t$ と置く.
このとき
\begin{equation*}
  \Image A = 
  \overbrace{R\oplus\cdots\oplus R}^{\text{$t-s$ times}}
  \oplus
  R f_1\oplus\cdots\oplus Rf_s
  \oplus
  \overbrace{0\oplus\cdots\oplus 0}^{\text{$n-t$ times}}.
\end{equation*}
よって, $r=n-t$ と置けば問題 \qref{q:quot-sum} の結果より
\begin{align*}
  M 
  &
  \isom R^n/\Image A
  =
  (\overbrace{R\oplus\cdots\oplus R}^{\text{$n$ times}})/\Image A
  \\ &
  \isom
  \overbrace{R/R\oplus\cdots\oplus R/R}^{\text{$t-s$ times}}
  \oplus
  R/R f_1\oplus\cdots\oplus R/Rf_s
  \oplus
  \overbrace{R/0\oplus\cdots\oplus R/0}^{\text{$r$ times}}.
  \\ &
  \isom
  R/R f_1\oplus\cdots\oplus R/Rf_s \oplus R^r.
  \qed
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[ねじれ部分]
\label{q:torsion-part}
  一般に可換環 $R$ 上の加群 $M$ の{\bf ねじれ部分 (torsion part)} $M_\tor$ 
  が次のように定義される:
  \begin{equation*}
    M_\tor = \{\, v\in M \mid \text{ある $a\in R$ で $a\ne 0$ かつ $av=0$ を
      満たすものが存在する} \,\}.
  \end{equation*}
  $M_\tor$ は $M$ の $R$ 部分加群であることを示せ.
  $M=M_\tor$ のとき $M$ は{\bf ねじれ加群 (torsion module)} であるといい,
  $M_\tor=0$ のとき $M$ は{\bf ねじれを持たない (torsion-free)} という.
  $R$ が整域ならば $R$ 自身は $R$ 上の加群としてねじれを持たず, 
  $0$ でない $f\in R$ に対する $R/Rf$ はねじれ加群であることを示せ.
  さらに $\{M_i\}_{i\in I}$ が $R$ 加群の族であるとき, 次が成立することを示せ:
  \begin{equation*}
    \Bigl(\bigoplus_{i\in I}M_i\Bigr)_\tor
    = \bigoplus_{i\in I} (M_i)_\tor.
  \qed
  \end{equation*}
\end{question}

\noindent
ヒント: $M=\bigoplus_{i\in I}M_i$ と置き, $v=(v_i)_{i\in I}\in M$ であるとす
る. もしも $v\in M_\tor$ ならばある $a\in R$ で $a\ne 0$ かつ $av=0$ を満た
すものが存在する.  そのとき $0=av=(av_i)_{i\in I}$ であるから任意の $i\in I$ 
に対して $av_i=0$ である. すなわち $v_i\in(M_i)_\tor$ である.
よって $v=(v_i)_{i\in I}\in\bigoplus_{i\in I} (M_i)_\tor$ である.
逆に $v=(v_i)_{i\in I}\in\bigoplus_{i\in I} (M_i)_\tor$ であると
仮定し, $0$ でない $v_i$ の全体を $v_{i_1},\dots,v_{i_n}$ とする.
$v_{i_\nu}\in (M_{i_\nu})_\tor$ なのである $a_\nu\in R$ 
で $a_\nu\ne 0$ かつ $a_\nu v_{i_\nu}=0$ を満たすものが存在する.
このとき $a=a_1\cdots a_n$ と置くと $av=0$ である. よって $v\in M_\tor$ であ
る. これで $\bigl(\bigoplus_{i\in I}M_i\bigr)_\tor
= \bigoplus_{i\in I} (M_i)_\tor$ が示された.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:M-tor}
  $R$ は整域であるとし, $f_1,\dots,f_s\in R$ はゼロでないとする.
  このとき $R$ 加群としての同型
  \begin{equation*}
    M \isom R/Rf_1\oplus\cdots\oplus R/Rf_s\oplus R^r
  \end{equation*}
  が成立しているならば
  \begin{equation*}
    M_\tor \isom R/Rf_1\oplus\cdots\oplus R/Rf_s.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 問題 \qref{q:torsion-part} の結果より $(R/Rf_i)_\tor = R/Rf_i$ 
かつ $R_\tor = 0$ であり, この問題の結論が成立することがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[$r$ の一意性]
  \theoremref{theorem:fg-PID-modules}
  における $r$ の一意性を証明せよ.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:M-tor} の結果より
\theoremref{theorem:fg-PID-modules}の状況のもとで 
\begin{equation*}
  M_\tor \isom R/Rf_1\oplus\cdots\oplus R/Rf_s
\end{equation*}
である. よって $M/M_\tor\isom R^r$ である. 
したがって, 問題 \qref{q:rank-uniquness} の結果より $r$ が $M$ より
一意的に定まることがわかる.
\qed

\medskip

したがって, \theoremref{theorem:fg-PID-modules}の証明を完了するために
はねじれ加群 $M_\tor$ に対して $f_1,\dots,f_s$ が単元倍を除いて一意に定まる
ことを証明すれば良いことがわかった.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:M/fM}
  $R$ は整域であるとし, 
  $f,g\in R$ はともに $0$ ではなく, 互いに素 ($Rf+Rg=R$) であると仮定する.
  $\nu\in\Z_{>0}$ を任意に取り, 
  $R$ 加群 $M$, $N$ を $M=R/Rf^\nu$, $N=R/Rg^\nu$ と定める. 
  このとき以下が成立する:
  \begin{enumerate}
  \item $R$ 部分加群の
    減少列 $M\supset fM\supset f^2M\supset\cdots f^{\nu-1}M\supset f^\nu M=0$
    が得られ, $R$ 加群としての
    同型 $f^\mu M\isom R/Rf^{\nu-\mu}$, 
    $f^{\mu-1}M/f^\mu M\isom R/Rf$ ($\mu=1,\dots,\nu$) 
    が成立する.
  \item $N=fN=f^2N=\cdots$ であるから, $f^{\mu-1}N/f^\mu N=0$ 
    ($\mu=1,\dots,\nu$) である. 
    \qed
  \end{enumerate}
\end{question}

\noindent
ヒント: 1.\enspace $u=1\MOD f^\nu\in M$ と置くと, 
$M=Ru$ であり, $f^\mu M=Rf^\mu u$ 
であり, $a\in R$ に対して $au=0$ と $a\in Rf^\nu$ は同値である.
$f^\mu M\ni af^\mu u=af\cdot f^{\mu-1}u\in f^{\mu-1}M$ 
なので $f^\mu M\subset f^{\mu-1}M$ である. 
$R$ 準同型 $R\to f^\mu M$, $a\mapsto af^\mu u$ に準同型定理を
適用すれば $f^\mu M\isom R/Rf^{\nu-\mu}$ であることがわかる.
$R$ 準同型 $R\to f^{\mu-1}M/f^\mu M$, $a\mapsto af^{\mu-1}u\MOD f^\mu M$ に
準同型定理を適用すれば $f^{\mu-1}M/f^\mu M\isom R/Rf$ であることがわかる.

2.\enspace $N\subset fN$ を示せば良い. 
$N$ の元は $a\MOD g^\nu$ ($a\in R$) の形をしている.
仮定よりある $b,c\in R$ で $bf+cg=1$ となるものが存在する.
そのとき $1=(af+bg)^\nu=fh+c^\nu g^\nu$ ($h\in R$) が成立し,
したがって $a=fha+ac^\nu g^\nu$ ($a\in R$) が成立する.
よって $a\MOD g^\nu = fha\MOD g^\nu\in fN$ である.
これで $N\subset fN$ が示された.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[ねじれ加群の構造定理]
\label{q:fg-torsion-PID-modules}
  $R=K[\lambda],\;\Z$ であるとし%
  \footnote{実際には $R$ は任意の単項イデアル整域として良いが, 
    この演習ではこの場合だけを扱う.}, %
  $M$ は $R$ 上の有限生成ねじれ加群であると仮定する.
  このとき $R$ の素元 $p_1,\dots,p_n$ および $m_{i,\nu}\in\Z_{\le0}$ 
  ($i=1,\dots,n$, $\nu=1,2,3,\ldots$) で以下の条件を満たすものが存在する:
  \begin{enumerate}
  \item[(1)] $i\ne j$ ならば $p_i\not\sim p_j$ である%
    \footnote{$f\sim g$ であるとはある単元 $c\in R^\times$ で $cf=g$ を満た
      すものが存在することである.}.
  \item[(2)] 各 $i=1,\dots,n$ に対して $m_{i,1},m_{i,2},\ldots$ に
    含まれる $0$ でない数の個数は有限であり, 少なくとも1つは $0$ でない.
  \item[(3)] 以下の $R$ 同型が成立する:
    \begin{equation*}
      M \isom 
      \bigoplus_{i=1}^n 
      \bigoplus_{\nu=1}^\infty 
      (R/Rp_i^\nu)^{m_{i,\nu}}.
    \end{equation*}
  \end{enumerate}
  しかもこのような $p_1,\dots,p_n$ は $M$ から単元倍と並べ方の順序を違いを除
  いて一意的に定まり, $m_{i,\nu}$ も $M$ から一意的に定まる.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:exists-type-of-ed}, \qref{q:M-tor} の
結果より, $0$ でも単元でもない $R$ の元 $f_1\mid\cdots\mid f_s$ が
存在して $R$ 同型 $M \isom R/Rf_1\oplus\cdots\oplus R/Rf_s$ が得られる.  
$R$ は一意分解整域なので $f_i\sim p_1^{\nu_{i,1}}\cdots p_n^{\nu_{i,n}}$ 
と本質的に一意に素元分解される. 
ここで $p_i$ は $R$ の素元であり, $i\ne j$ ならば $p_i\not\sim p_j$ 
であり, $\nu_{i,n}\in\Z_{\ge0}$ である. 
そのとき中国式剰余定理 \qref{q:Chinese-remainder-theorem} によって同型
\begin{equation*}
  R/Rf_i \isom R/Rp_1^{\nu_{i,1}}\oplus\cdots\oplus R/Rp_n^{\nu_{i,n}} 
\end{equation*}
が得られる. よって問題の同型が存在することがわかる.

$p_i$ と $m_{i,\nu}$ の一意性を示そう. (3)の同型を仮定する.
問題 \qref{q:M/fM} の結果より,
\begin{equation*}
  p_i^{\mu-1}M/p_i^\mu M\isom
  \bigoplus_{\nu\ge\mu}
  (R/Rp_i)^{m_{i,\nu}}
  \qquad (\mu=1,2,3,\ldots)
\end{equation*}
が成立する. 問題 \qref{q:PID-maximal-prime}, \qref{q:maximal-ideal-field} の
結果より $K_i=R/Rp_i$ は体であり,
\begin{equation*}
  \dim_{K_i}(p_i^{\mu-1}M/p_i^\mu M) = 
  m_{i,\mu} + m_{i,\mu+1} + m_{i,\mu+2} + \cdots
  \qquad (\text{有限和}).
\end{equation*}
よって
\begin{equation*}
  m_{i,\mu} 
  = \dim_{K_i}(p_i^{\mu-1}M/p_i^\mu M)
  - \dim_{K_i}(p_i^{\mu}M/p_i^{\mu+1} M).
  \tag{$\ast$}
\end{equation*}
$R$ の素元 $p$ で $p\not\sim p_i$ ($=1,\dots,n$) を満たすものを取ると,
問題 \qref{q:M/fM} の結果より, $M/pM=0$ である.  
よって $p_1,\dots,p_n$ は $M/pM\ne 0$ となる素元 $p$ の集合である.
以上のことより, $p_1,\dots,p_n$ が単数倍と順序を除いて $M$ から一意に
定まり, $m_{i,\mu}$ も $M$ から一意に定まることがわかる.
\qed

\medskip
\noindent
注意: 上のヒントにおける ($\ast$) という結果と
問題  \qref{q:nilp-4}, \qref{q:nilp-5} の結果の類似に注意せよ.
この類似性は偶然ではない.
\qed

\medskip
\noindent
参考: $m_{i,\mu}$ の一意性は {\bf Krull-Remak-Schmidt の定理}からも
導かれる.  ここでは詳しい説明は避けるが, Krull-Remak-Schmidt の定理とは
「長さ有限の加群の直既約分解が同値なものを除いて一意に存在する」
という結果である. 単項イデアル整域上の有限生成ねじれ加群 $M$ は長さ有限で
あり, 問題 \qref{q:fg-torsion-PID-modules} (3)の $M$ の分解は $M$ の
直既約分解である.   直既約分解の同値を除いた一意性から
直既約成分の重複度 $m_{i,\mu}$ の一意性が導かれる.
たとえば服部 \cite{hattori} 113--114頁では実際そのようにして単項イデアル整域
上の有限生成ねじれ加群の単因子型の一意性を証明している.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  \theoremref{theorem:fg-PID-modules}
  における $f_1,\dots,f_s$ の一意性を証明せよ.
  \qed
\end{question}

\noindent
ヒント: 問題 \qref{q:fg-torsion-PID-modules} のヒントの議論を詳しく見直せば
次が成立していることがわかる:
\begin{equation*}
  (\nu_{i,s},\nu_{i,s-1},\cdots,\nu_{i,1}) = (
    \overbrace{\nu_i,\dots,\nu_i}^{m_{i,\nu_i}},
    \overbrace{\nu_i-1,\dots,\nu_i-1}^{m_{i,\nu_i-1}},
    \dots\dots,
    \overbrace{1,\dots,1}^{m_{i,1}},
    \overbrace{0,\dots,0}^{m_{i,0}}
  ).
\end{equation*}
ここで $\nu_i$ は $m_{i,\nu}\ne 0$ となる最大の $\nu$ であり,
$m_{i,0} = s - \sum_{\nu=1}^{\nu_i}m_{i,\nu}$ と置いた.
よって $f_i$ は問題 \qref{q:fg-torsion-PID-modules} の結果によって一意性が
保証されている $m_{i,\nu}$ から逆に $f_i$ が $
  f_i\sim p_1^{\nu_{i,1}}\cdots p_n^{\nu_{i,n}}
$ によって $M$ から単数倍を除いて一意に定まることがわかる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

以上によって\theoremref{theorem:fg-PID-modules}の証明が完了した.

$R=K[\lambda]$ の場合の\theoremref{theorem:fg-PID-modules}と $K$ が代数閉体
の場合の問題 \qref{q:fg-torsion-PID-modules} は次の定理にまとめられる.

\begin{theorem}[有限生成 \protect{$K[\lambda]$} 加群の構造定理]
\label{theorem:fg-K[x]-modules}
  $K$ は任意の体であり, $M$ は有限生成 $K[\lambda]$ 加群であるとする.
  このとき, 非負の整数 $r\in\Z_{\ge0}$ と $0$ でない次数が $1$ 以上の
  モニックな多項式 $f_1,\dots,f_s\in K[\lambda]$ で
  \begin{equation*}
    f_1\mid f_2\mid\cdots\mid f_s
  \end{equation*}
  を満たし, $K[\lambda]$ 同型
  \begin{equation*}
    M \isom 
    K[\lambda]/(f_1)\oplus\cdots\oplus K[\lambda]/(f_s)
    \oplus K[\lambda]^r
  \end{equation*}
  が成立するようなものが一意に存在する.  
  さらに $K$ が代数閉体であるならば,
  有限個を除いて $0$ であるような非負の整数の
  族 $\{m_{\alpha,\nu}\}_{\alpha\in K,\;\nu\in\Z_{>0}}$ で $K[\lambda]$ 同型
  \begin{equation*}
    M \isom 
    K[\lambda]^r\oplus
    \bigoplus_{\alpha\in K}\bigoplus_{\nu=1}^\infty
    \Bigl(
      K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)
    \Bigr)^{m_{\alpha,\nu}}
  \end{equation*}
  が成立するようなものが一意に存在する.
  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

$\Z$ 上の有限生成加群の場合に関して,
\theoremref{theorem:fg-PID-modules}と問題 \qref{q:fg-torsion-PID-modules} の
結果は次のようにまとめられる.

\begin{theorem}[有限生成 Abel 群の基本定理]
\label{theorem:fg-Z-modules}
  $M$ は有限生成 $\Z$ 加群であるとする%
  \footnote{任意の Abel 群は自然に $\Z$ 加群とみなせるので, 
    この仮定は $M$ が有限生成 Abel 群であるという仮定に等しい.}.
  素数全体の集合を $\cP=\{2,3,5,7,11,\ldots\}$ と書くことにする.
  このとき, 非負の整数 $r\in\Z_{\ge0}$ と $2$ 以上の
  整数 $f_1,\dots,f_s\in\Z$ で
  \begin{equation*}
    f_1\mid f_2\mid\cdots\mid f_s
  \end{equation*}
  を満たし, 同型
  \begin{equation*}
    M \isom \Z/f_1\Z\oplus\cdots\oplus\Z/f_s\Z\oplus\Z^r
  \end{equation*}
  が成立するようなものが一意に存在する.  
  さらに有限個を除いて $0$ であるような非負の整数の
  族 $\{m_{p,\nu}\}_{p\in\cP,\;\nu\in\Z_{>0}}$ で同型
  \begin{equation*}
    M \isom 
    \Z^r\oplus
    \bigoplus_{p\in\cP}\bigoplus_{\nu=1}^\infty (\Z/p^\nu\Z)^{m_{p,\nu}}
  \end{equation*}
  が成立するようなものが一意に存在する.
  \qed
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Jordan 標準形再論}
\label{sec:Jordan-normal-form-2}

代数閉体 $K$ 上の一変数多項式環 $K[\lambda]$ 上の有限生成加群に関する
\theoremref{theorem:fg-K[x]-modules}の後半は Jordan 標準形の理論を含んでいる.

\begin{question}[Jordan 標準形再論]
\label{q:module-to-Jordan}
  代数閉体 $K$ 上の一変数多項式環 $K[\lambda]$ 上の有限生成加群に関する
  \theoremref{theorem:fg-K[x]-modules}の後半を用いて,
  Jordan 標準形の存在と一意性 (\theoremref{theorem:Jordan-normal-form})
  を証明せよ.
  \qed
\end{question}

\noindent
ヒント: $K$ は任意の代数閉体であるとし, $A\in M_n(K)$ は $K$ 上の任意の正方
行列であるとする. このとき $M=K^n$ には次のようにして自然に $K[\lambda]$ 加
群の構造を定めることができる:
\begin{equation*}
  f(\lambda)v = f(A)v
  \qquad
  (f\in K[\lambda],\ v\in M=K^n).
\end{equation*}
Cayley-Hamilton の定理もしくは最小多項式の理論より, 
ある $0$ でない多項式 $\varphi\in K[\lambda]$ が存在して $\varphi(A)=0$ とな
る.  よって $M$ はねじれ加群である.  
したがって\theoremref{theorem:fg-K[x]-modules}の後半より,
有限個を除いて $0$ であるような非負の整数の
族 $\{m_{\alpha,\nu}\}_{\alpha\in K,\;\nu\in\Z_{>0}}$ で $K[\lambda]$ 同型
\begin{equation*}
  M \isom 
  \bigoplus_{\alpha\in K}\bigoplus_{\nu=1}^\infty
  \Bigl(
    K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)
  \Bigr)^{m_{\alpha,\nu}}
\end{equation*}
が成立するようなものが一意に存在する.  
$u_k\in K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)$ を 
\begin{equation*}
  u_k=(\lambda-\alpha)^k\MOD (\lambda-\alpha)^\nu
  \in K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)
\end{equation*}
定めると, $u_{\nu-1},u_{\nu-2},\dots,u_1,u_0$ 
は $K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)$ の $K$ 基底をなす.
その基底に関して $\lambda$ すなわち $A$ 
の $K[\lambda]\big/\bigl((\lambda-\alpha)^\nu\bigr)$ への作用を
行列表示すると Jordan ブロック行列 $J_\nu(\alpha)$ が得られる:
\begin{align*}
  [\lambda u_{\nu-1},\lambda u_{\nu-2},\dots,\lambda u_0]
  &
  = [\alpha u_{\nu-1}, u_{\nu-1}+\alpha u_{\nu-2}, 
     \dots, u_1 + \alpha u_0 ]
  \\ &
  = [u_{\nu-1},u_{\nu-2},\dots,u_0]J_\nu(\alpha).
\end{align*}
そのような基底を $M$ 全体で考えれば $\lambda$ すなわち $A$ の $M$ 
への作用の行列表示は Jordan 標準形の形をしている.
Jordan 細胞の情報は $M$ から一意に定まる $m_{i,\nu}$ と一致している.
よって Jordan 標準形の一意性も出る.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\medskip

体 $K$ の元 $a_0,\dots,a_{n-1}$ に対して
コンパニオン行列 (同伴行列, companion matrix) $C(a_0,\dots,a_{n-1})$ を次の
ように定義したのであった: 
\begin{equation*}
  C(a_0,\dots,a_{n-1}) =
  \begin{bmatrix}
    0         &    1     &        &      & \bigzerou \\
              &    0     & \ddots &      & \\
              &          & \ddots &  1   & \\
    \bigzerol &          &        &  0   &  1 \\
    -a_{n-1}  & -a_{n-2} & \cdots & -a_1 & -a_0 \\
  \end{bmatrix}.
\end{equation*}
問題 \qref{q:minimal-polyn-10} の結論は, 
コンパニオン行列 $C(a_0,\dots,a_{n-1})$ の特性多項式が
\begin{equation*}
  f(\lambda)
  = \lambda^n + a_0\lambda^{n-1} + a_1\lambda^{n-2}
  + \cdots + a_{n-2}\lambda + a_{n-1} \in K[\lambda]
\end{equation*}
に等しく, かつその最小多項式が特性多項式に等しくなることであった. 
逆にモニックな多項式 $f$ に対して
コンパニオン行列 $C_f$ を次のように定義する:
\begin{equation*}
  C_f = C(a_0,\dots,a_{n-1}).
\end{equation*}

体 $K$ 上の一変数多項式環 $K[\lambda]$ 上の有限生成加群に関する
\theoremref{theorem:fg-K[x]-modules}の前半から次の定理が導かれる.

\begin{question}[正方行列の有理標準形]
\label{q:module-to-rational}
  $K$ は代数閉体とは限らない任意の体であるとし, 
  $A\in M_n(K)$ は $K$ 上の任意の正方行列であるとする. 
  このとき, 次数が $1$ 以上の
  モニックな多項式 $f_1,\dots,f_s\in K[\lambda]$ で
  以下を満たすものが一意に存在する:
  \begin{enumerate}
  \item[(1)] $f_1\mid f_2\mid\cdots\mid f_s$.
  \item[(2)] $n_i=\deg f_i$ と置くと $n_1+\cdots+n_s=n$.
  \item[(3)] ある $P\in GL_n(K)$ で次を満たすものが存在する:
    \begin{equation*}
      P^{-1}AP =
      \begin{bmatrix}
        C_{f_1} &        & \bigzerou \\
                & \ddots & \\
        \bigzerol &      & C_{f_s} \\
      \end{bmatrix}.
      \tag{$\ast$}
    \end{equation*}
  \end{enumerate}
  等式 ($\ast$) の右辺を $A$ の{\bf 有理標準形 (rational canonical form,
  rational normal form)} もしくは {\bf Frobenius 標準形 (Frobenius canonical
  form, Frobenius normal form, Frobenius form)} と呼ぶ.
  \qed
\end{question}

\noindent
ヒント: $M=K^n$ には次のようにして自然に $K[\lambda]$ 加
群の構造を定めることができる:
\begin{equation*}
  f(\lambda)v = f(A)v
  \qquad
  (f\in K[\lambda],\ v\in M=K^n).
\end{equation*}
Cayley-Hamilton の定理もしくは最小多項式の理論より, 
ある $0$ でない多項式 $\varphi\in K[\lambda]$ が存在して $\varphi(A)=0$ とな
る.  よって $M$ はねじれ加群である.  
したがって体 $K$ 上の一変数多項式環 $K[\lambda]$ 上の有限生成加群に関する
\theoremref{theorem:fg-K[x]-modules}の前半より, 
次数が $1$ 以上のモニックな多項式 $f_1,\dots,f_s\in K[\lambda]$ 
で $f_1\mid f_2\mid\cdots\mid f_s$ を満たし, $K[\lambda]$ 同型
\begin{equation*}
  M \isom K[\lambda]/(f_1)\oplus\cdots\oplus K[\lambda]/(f_s)
\end{equation*}
が成立するものが一意に存在する. 
$n_i=\deg f_i$ と置いて,
両辺の $K$ 上のベクトル空間としての次元を
計算すれば $n=n_1+\cdots+n_s$ であることがわかる. $f_i$ を
\begin{equation*}
  f_i(\lambda) = 
  \lambda^{n_i} + a_{i,0}\lambda^{n_i-1} + \cdots
  + a_{i,n_i-3}\lambda^2 + a_{i,n_i-2}\lambda + a_{i,n_i-1},
  \qquad
  a_{i,k}\in K
\end{equation*}
と表わし, $K[\lambda]/(f_i)$ の基底 $v_{i,1},\dots,v_{i,n_i}$ を
次のように定める:
\begin{align*}
  v_{i,1} &= (\lambda^{n_i-1}+a_{i,0}\lambda^{n_i-2}+\cdots+a_{i,n_i-3}\lambda
             +a_{i,n_i-2})\,\MOD f_i,
  \\
  v_{i,2} &= (\lambda^{n_i-2}+a_{i,0}\lambda^{n_i-3}+\cdots+a_{i,n_i-3})
             \,\MOD f_i,
  \\
  &\cdots\cdots
  \\
  v_{i,n_i-1} &= (\lambda + a_0) \,\MOD f_i,
  \\
  v_{i,n_i} &= 1 \MOD f_i.
\end{align*}
この基底に関して $\lambda$ すなわち $A$ の $K[\lambda]/(f_i)$ への作用を行列
表示すると $C_{f_i}$ が得られる:
\begin{align*}
  [\lambda v_{i,1},\lambda v_{i,2},\dots,\lambda v_{i,n_i}]
  &
  = [-a_{i,n_i-1}v_{i,n_i}, v_{i,1}-a_{i,n_i-2}v_{i,n_i},\dots,
     v_{i,n_i-1}-a_0v_{i,n_i}]
  \\ &
  = [v_{i,1},v_{i,2},\dots,v_{i,n_i}]C_{f_i}.
\end{align*}
よって $\lambda$ すなわち $A$ の $M$ への作用を基底 $v_{i,k}$ に関して行列表
示すると $A$ の有理標準形が得られる. 
\qed

\medskip
\noindent
注意: $K[\lambda]/(f_i)$ の基底として, 
より自然な $w_{i,k}=\lambda^k\MOD f_i$ ($k=0,1,\dots,n_i-1$) を
取ると, $\lambda$ の作用の行列表示は $\tp{C_{f_i}}$ になる:
\begin{align*}
  [\lambda w_{i,0},\dots,\lambda w_{i,n_i-2},\lambda w_{i,n_i-1}]
  &
  = [w_{i,1},\dots,w_{i,n_i-1},
     -a_{n_i-1}w_{i,0}-\cdots-a_0w_{i,n_i-1}]
  \\ &
  = [w_{i,1},\dots,w_{i,n_i-2},w_{i,n_i-1}]\tp{C_{f_i}}.
\end{align*}
問題 \qref{q:p_C=(lambda-alpha)^n} のヒント2と
問題 \qref{q:Jordan-companion-2} のヒント2も参照せよ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  問題 \qref{q:module-to-rational} の記号の
  もとで,  $A$ の最小多項式 $\varphi_A$ は $f_s$ に等しく,
  $A$ の特性多項式 $p_A$ は $f_1\cdots f_s$ に等しい:
  \begin{equation*}
    \varphi_A(\lambda) = f_s(\lambda),
    \qquad
    p_A(\lambda) = f_1(\lambda)\cdots f_s(\lambda).
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 問題 \qref{q:minimal-polyn-10} の結果
より $C_i=C_{f_i}$ と置くと $\varphi_{C_i}=p_{C_i}=f_i$ である.
問題 \qref{q:varphi_B} も見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
\label{q:varphi_B}
  $K$ は任意の体であるとする.
  次のような形の正方行列 $B$ の最小多項式は $B_i$ たちの最小多項式の
  最小公倍多項式に等しい:
  \begin{equation*}
    B = 
    \begin{bmatrix}
      B_1 &        & \bigzerou \\
          & \ddots & \\
      \bigzerol &  & B_s \\
    \end{bmatrix},
    \qquad
    B_i\in M_{n_i}(K).
    \qed
  \end{equation*}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

さて, それでは有理標準形や Jordan 標準形を具体的に計算するにはどうすれば良い
のだろうか.

$K$ は任意の体であるとし, $A\in M_n(K)$ は $K$ 上の任意の正方行列
であるとする.  このとき $M=K^n$ には次のように $K[\lambda]$ 加群の構造
を定めることができる: 
\begin{equation*}
  f(\lambda)v = f(A)v
  \qquad
  (f\in K[\lambda],\ v\in M=K^n).
\end{equation*}
Cayley-Hamilton の定理もしくは最小多項式の理論より, 
ある $0$ でない多項式 $\varphi\in K[\lambda]$ が存在して $\varphi(A)=0$ とな
る.  よって $M$ はねじれ加群である.  

$K^n$ と $K[\lambda]^n$ の標準的な基底をどちらも同じ記号 $e_1,\dots,e_n$ と
表わし, 全射 $K[\lambda]$ 準同型 $\pi:K[\lambda]^n\to M$ を次のように定める:
\begin{equation*}
  \pi(a_1e_1+\cdots+a_ne_n) = a_1(A)e_1+\cdots+a_n(A)e_n
  \qquad (a_i\in K[\lambda]).
\end{equation*}
問題は $\Ker\pi$ がどのような形をしているかである.

\begin{question}[特性行列]
\label{q:xE-A}
  行列 $\lambda E - A\in M_n(K[\lambda])$ が定める $K[\lambda]$ 準同型
  を $\phi:K[\lambda]^n\to K[\lambda]^n$ と書く:
  \begin{equation*}
    \phi(v) = (\lambda E - A)v
    \qquad (v \in K[\lambda]^n).
  \end{equation*}
  このとき $\Image\phi=\Ker\pi$ である.
  体 $K$ 上の正方行列 $A\in M_n(K)$ に対して
  多項式環 $K[\lambda]$ 上の行列 $\lambda E - A\in M_n(K[\lambda])$ 
  を $A$ の{\bf 特性行列 (characteristic matrix)} と呼ぶ%
  \footnote{特性行列 $\lambda E - A$ の行列式は特性多項式 $p_A(\lambda)$ に
    なる.  特性多項式 $p_A(\lambda)$ は $A$ の固有値と
    一般固有空間の次元の情報は含んでいるが Jordan 標準形の情報を完全には含ん
    でいない. それに対して, すぐ後に説明するように特性行列 $\lambda E - A$ 
    の単因子は Jordan 標準形の情報を完全に含んでいる.}. 
  \qed
\end{question}

\noindent
ヒント: まず $\Image\phi\subset\Ker\pi$ であることを示そう.
そのためには $\pi\circ\phi = 0$ を示せば良い.
よって $\pi(\phi(e_i)) = 0$ を示せば良い.
実際にそれを計算すると
\begin{equation*}
  \pi(\phi(e_i)) 
  = \pi((\lambda E - A)e_i)
  = \pi(\lambda e_i - Ae_i)
  = Ae_i - Ae_i 
  = 0.
\end{equation*}
次に $\dim_K(K[\lambda]^n/\Image\phi)=n$ を示そう.
$\Image\phi$ は $\phi(e_i)=\lambda e_i - Ae_i$ を含む.
よって $e_i$, $\lambda^k\phi(e_i)$ ($i=1,\dots,n$, $k=0,1,2,\ldots$) 
は $K[\lambda]^n$ の $K$ 基底をなす. 
よって $e_i\MOD\Image\phi$ ($i=1,\dots,n$) 
は $K[\lambda]^n/\Image\phi$ の $K$ 基底をなす.
$\Image\phi=\Ker\pi$ を示そう.
もしも $\Ker\pi$ が $\Image\phi$ よりも真に
大きければ $\dim_K(K[\lambda]^n/\Ker\pi)<n$ となる.
しかし, 準同型定理より $M\isom R^n/\Ker\pi$ 
なので $\dim_K(R^n/\Ker\pi)=n$ であるから矛盾する.
よって $\Image\phi=\Ker\pi$ である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[特性行列の単因子と有理標準形]
\label{q:(xE-A)-to-f_i}
  特性行列 $\lambda E - A$ の単因子を $g_1\mid g_2\mid\dots\mid g_n$ 
  ($g_i$ はモニックまたは $0$) とする.  このとき特性多項式
  に関して $p_A(\lambda)=\det(\lambda E - A)=g_1g_2\cdots g_n$ が成立する.
  特に $g_n\ne 0$ である.
  さらに $g_1,\dots,g_{n-s}=1$, $\deg g_{n-s+1}\ge 1$ と仮定し,
  $f_1=g_{n-s+1},\;f_2=g_{n-s+2},\;\dots,\;f_s=g_n$ と置く.
  すなわち $g_1,\dots,g_n$ から $1$ を除いて得られる列を $f_1,\dots,f_s$ と
  書くことにする. そのときそれらは
  問題 \qref{q:module-to-rational} の $f_1,\dots,f_s$ に等しい.
  すなわちそのとき $A$ の有理標準形は次に等しい:
  \begin{equation*}
    \begin{bmatrix}
      C_{f_1} &        & \bigzerou \\
              & \ddots & \\
      \bigzerol &      & C_{f_s} \\
    \end{bmatrix}.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: ある $P,Q\in GL_n(K)$ が存在して
\begin{equation*}
  P(\lambda E - A)Q = \diag(g_1,g_2,\dots,g_n),
  \qquad
  g_1\mid g_2\mid\cdots\mid g_n,
  \quad
  \text{$g_i$ はモニックまたは $0$}.
\end{equation*}
このとき, $a:=\det P\det Q\in K^\times$ と置く
と, $p_A(\lambda) = \det(\lambda E - A) = ag_1g_2\cdots g_n$ である.
よって最高次の係数を比較すると $g_1,\dots,g_n$ はどれもモニックであり, 
$a=1$ であることがわかる.  
このとき, 問題 \qref{q:xE-A} の結果より, 
問題 \qref{q:exists-type-of-ed} のヒントと同様にして, $K[\lambda]$ 同型
\begin{equation*}
  M \isom K[\lambda]/(f_1)\oplus\cdots\oplus K[\lambda]/(f_s)
\end{equation*}
が成立することがわかる. 
\qed

\medskip
\noindent
参考: 上の記号のもとで $\diag(g_1,g_2,\dots,g_n)$ を特性行列 $\lambda E-A$ 
の {\bf Smith 標準形 (Smith normal form, Smith canonical form)} と呼ぶこと
がある. 
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}[特性行列の単因子と Jordan 標準形]
\label{q:(xE-A)-to-Jordan}
  さらに $K$ は代数閉体であると仮定し, 
  問題 \qref{q:(xE-A)-to-f_i} の $f_1,\dots,f_s$ は次のように一次式の積に
  分解されていると仮定する:
  \begin{equation*}
    f_i(\lambda) = 
    (\lambda-\alpha_{i,1})^{n_{i,1}}
    \cdots
    (\lambda-\alpha_{i,r_i})^{n_{i,r_i}}
    \qquad (i=1,\dots,s).
  \end{equation*}
  ここで $k\ne l$ のとき $\alpha_{i,k}\ne\alpha_{i,l}$ であり,
  $n_{i,k}$ は正の整数である.  このとき $A$ の Jordan 細胞の全体
  は $J_{n_{i,k}}(\alpha_{i,k})$ ($i=1,\dots,s$, $k=1,\dots,r_i$) になる.
  \qed
\end{question}

\noindent
ヒント: 中国式剰余定理より,
\begin{equation*}
  K[\lambda]/(f_i) 
  \isom 
  K[\lambda]\big/\bigl((\lambda-\alpha_{i,1})^{n_{i,1}}\bigr)
  \oplus\cdots\oplus
  K[\lambda]\big/\bigl((\lambda-\alpha_{i,s_i})^{n_{i,s_i}}\bigr).
\end{equation*}
各 $K[\lambda]\big/\bigl((\lambda-\alpha_{i,k})^{n_{i,k}}\bigr)$ の
基底を $(\lambda-\alpha_{i,k})^\nu$ ($\nu=n_{i,k}-1,\dots,1,0$) 
に取り, その基底に関して $\lambda$ すなわち $A$ の作用を行列表示
すれば $A$ の Jordan 標準形が得られる.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bigskip

以上によって, 体 $K$ 上の正方行列 $A\in M_n(K)$ の有理標準形
や Jordan 標準形を求めるためには特性行列 $\lambda E - A\in M_n(K[\lambda])$ 
の単因子を計算すればよいことがわかった.

単因子を計算するための手続きは問題 \qref{q:exists-elementary-divisor} の
ヒント2にある.  Jordan 標準形を計算するためには $f_1\mid\cdots\mid f_s$ で
ある必要はないので, 単因子計算の手続きのステップ5で $B$ のすべての成分
が $a$ で割り切れることをチェックせずに $B$ に対してその手続きを再帰的に
適用する作業に移行して構わない.

\begin{summary}[単因子に基いた行列の標準形の計算の仕方]
\label{q:summary-elem-div-normal-form}
  体 $K$ 上の正方行列 $A\in M_n(K)$ の有理標準形と Jordan 標準形を以下
  のような手続きで求めることができる:
  \begin{enumerate}
  \item まず特性行列 $\lambda E - A$ の単因子 $g_1\mid g_2\mid\cdots\mid g_n$ 
    ($g_i$ はモニックな多項式) を計算する. 
    単因子を計算するための手続きは問題 \qref{q:exists-elementary-divisor} の
    ヒント2にある. 
  \item 単因子の列 $g_1\mid g_2\mid\cdots\mid g_n$ から $1$ を除いたもの
    を $f_1\mid f_s\mid\cdots\mid f_s$ と書けば, $A$ の
    有理標準形 (Frobenius 標準形) は次に等しい:
    \begin{equation*}
      \begin{bmatrix}
        C_{f_1} &        & \bigzerou \\
                & \ddots & \\
        \bigzerol &      & C_{f_s} \\
      \end{bmatrix}.
    \end{equation*}
    これより $A$ の最小多項式が $f_s$ であることもわかる.
  \item $f_1,\dots,f_s$ が次のように一次式の積に分解されているとする:
    \begin{equation*}
      f_i(\lambda) = 
      (\lambda-\alpha_{i,1})^{n_{i,1}}
      \cdots
      (\lambda-\alpha_{i,r_i})^{n_{i,r_i}}
      \qquad (i=1,\dots,s).
    \end{equation*}
    ここで $k\ne l$ のとき $\alpha_{i,k}\ne\alpha_{i,l}$ であり,
    $n_{i,k}$ は正の整数である. 
    このとき $A$ の Jordan 細胞の全体は 
    \begin{equation*}
      J_{n_{i,k}}(\alpha_{i,k})
      \qquad
      (i=1,\dots,s,\ k=1,\dots,r_i)
    \end{equation*}
    になる. この結論が成立するためには単因子が満たすべき
    条件 $g_1\mid g_2\mid\cdots\mid g_n$ が成立していなくても良く,
    特性行列 $\lambda E - A$ が行列の基本変形によって対角化されている
    だけで十分である.
  \end{enumerate}
  そして, この計算法の基礎は体 $K$ 上の一変数多項式環 $K[\lambda]$ 上の
  有限生成加群の構造定理(\theoremref{theorem:fg-K[x]-modules})である.
  \qed
\end{summary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setcounter{section}{0}
\renewcommand\thesection{\Alph{section}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{数学語について}
\label{sec:mathematical-language}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{存在と一意性}
\label{sec:existence-uniqueness}

「××を満たす $x$ が存在する」というタイプの命題と
「××を満たす $x$ は一意的である(唯一である)」というタイプの命題を合わせて
「××を満たす $x$ が一意に存在する(唯一存在する)」のように言うことがよくあ
る.  そのような命題を証明する場合には存在 (existence) と一意性 (uniqueness%
\footnote{英語で一意的であることを unique (ユニーク) であると言う.
  口語で unique は「珍しい」「異常な」「目立つ」という意味で使われるが, 
  数学においては「唯一である」「一意的である」という論理的な意味で使われる.}) 
の両方を証明しなければいけない.

一意性を直接に証明をするためには「$x_1$ と $x_2$ がともに××を満たすこと」を
仮定して「$x_1=x_2$」が成立すること証明すれば良い.  
実際には間接的に一意性を証明することも多いのだが,
直接的な証明が容易に可能ならば直接に証明しておくべきである.

例として $0$ でない任意の複素数 $z$ に対して $z=re^{i\theta}$ かつ $r>0$ 
かつ $0\le\theta<2\pi$ を満たす実数 $r$, $\theta$ が一意に存在することを
証明してみよう.

存在の証明: 実数 $r$ を $r=|z|$ と定めると $r>0$ である. 
$|z/r|=1$ であるから $z/r=e^{i\theta}$ かつ $0\le\theta<2\pi$ を満たす
実数 $\theta$ が存在する. 
このとき $z=re^{i\theta}$ かつ $r>0$ かつ $0\le\theta<2\pi$ が成立している.
\qed

一意性の証明: 実数 $r$, $s$, $\theta$, $\phi$ 
は $z=re^{i\theta}=se^{i\phi}$ かつ $r,s>0$ かつ $0\le\theta,\phi<2\pi$ を
満たしていると仮定する.  このとき $r/s = e^{i(\phi-\theta)}$ である.  
この等式の左辺は正の実数であり, 右辺は絶対値が $1$ の複素数である.
よって両辺は $1$ に等しい.  そのとき $r=s$ でかつ $\theta=\phi$ である.
\qed

「$A_1B_1=A_2B_2$ を $A_2^{-1}A_1 = B_2B_1^{-1}$ と変形して, 
その両辺がどこに含まれるかを調べ, 
その共通部分が唯一つの元からなることを利用する」という論法は一意性の
証明でよく用いられる.  乗法を加法に置き換えた
「$A_1+B_1=A_2+B_2$ を $A_1 - A_2 = B_2 - B_1$ と変形する」という論法も
よく登場する.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{選択公理と Zorn の補題}
\label{sec:axiom-of-choice}

「任意の $x\in X$ に対して条件 $P(x,y)$ を満たす $y\in Y$ が存在する」
という文は論理記号を用いて書くと次のようになる:
\begin{equation*}
  \forall x\in X\, \exists y\in Y\, P(x,y).
  \tag{E}
\end{equation*}
「任意の $x\in X$ に対して条件 $P(x,y)$ を満たす $y\in Y$ は一意的である」
という文もしくは存在を仮定していないことを強調した同じ意味の文
「任意の $x\in X$ に対して条件 $P(x,y)$ を満たす $y\in Y$ は存在するならば一
意的である」は「任意の $x\in X$, $y_1,y_2\in Y$ に対して $P(x,y_1)$ 
かつ $P(x,y_2)$ ならば $y_1=y_2$ である」という意味であり, 
論理記号を用いて書くと次のようになる%
\footnote{$\text{and}$ を $\wedge$ と書けばより徹底しているが,
  ここでは見易さを重視して $\text{and}$ と書いた.}:
\begin{equation*}
  \forall x\in X\, \forall y_1,y_2\in Y\,
  \bigl( P(x,y_1)\;\text{and}\;P(x,y_2) \implies y_1=y_2 \bigr).
  \tag{U}
\end{equation*}
「任意の $x\in X$ に対して条件 $P(x,y)$ 満たす $y\in Y$ が一意に存在する」と
いう文は「(E)かつ(U)が成立する」という意味であり, よく次のように書かれる:
\begin{equation*}
  \forall x\in X\, \exists! y\in Y\, P(x,y).
  \tag{UE}
\end{equation*}
$\exists!$ の代わりに $\exists_1$ と書くこともある.
一意存在条件(UE)が成立するとき, 
写像 $f:X\to Y$ で次を満たすものが一意に定まる:
\begin{equation*}
  \forall x\in X\, P(x,f(x)).
  \tag{F}
\end{equation*}
これは写像の定義から明らかである.

一意性 (U) が成立しているかどうかに関係なく, 
次が成立することは直観的に明らかであるように思われる:
\begin{itemize}
\item[($\ast$)] 存在 (E) が成立しているとき条件 (F) を満たす写像 $f:X\to Y$ 
  が存在する.
\end{itemize}
なぜならば各 $x\in X$ ごとに $P(x,y)$ を満たす $y\in Y$ を $f(x)$ とすれば
条件 (F) を満たす写像 $f:X\to Y$ が得られるからである.

しかし, もしも $X$ が無限集合ならば無限個の $x\in X$ に対して $P(x,y)$ を満
たす $y\in Y$ を選び出さなければいけないので, これは明かでないという立場もあ
り得る.  ($\ast$) は{\bf 選択公理 (axiom of choice)} と呼ばれており, 通常の
数学においては常に成立していると仮定する約束になっている.  

選択公理を論理記号を使って書けば次のようになる:
\begin{equation*}
  \forall x\in X\; \exists y\in Y\; P(x,y)
  \implies
  \exists f:X\to Y\; \forall x\in X\; P(x,f(x)).
  \tag{AC}
\end{equation*}
$\forall$ と $\exists$ の順序が交換されていることに注意せよ%
\footnote{「$\exists y\in Y\, \forall x\in X\, P(x,y)
  \implies \forall x\in X\, \exists y\in Y\, P(x,y)$」は常に成立するが,
  この逆は一般には成立しない. 
  $\exists$ を $\forall$ の左に持って行くとより強い主張になる.
  たとえば $X=Y=\R$ で $P(x,y)$ を $x<y$ とするとき,
  「$\forall x\in X\, \exists y\in Y\, P(x,y)$」は
  「どんな実数に対してもそれより大きな実数が存在する」という意味になるので
  真であることがわかるが, 「$\exists y\in Y\, \forall x\in X\, P(x,y)$」は
  「ある実数 $y$ ですべての実数 $x$ よりも大きなものが存在する」という意味に
  なるので偽であることがわかる.}.
選択公理は $\forall$ と $\exists$ がからみあった複雑な文を簡単化するため
の強力な手段である%
\footnote{解析学で $\eps$-$\delta$ 論法を使う場面ではときどき
  「任意の $\eps>0$ に対してある $\delta>0$ で××を満たすものが
  存在するので, その $\delta$ を $\delta_\eps$ と書くことにする」
  のような文章が登場するが, ここでは選択公理が使われている.}.

選択公理の成立を仮定することは非常に自然である.
数学において選択公理の成立は強い合意事項になっており, 
空気のごとく自由に使われる.

選択公理と同値な命題である {\bf Zorn の補題 (Zorn's lemma)} は
選択公理の便利な言い換えとしてよく使われる. 
Zorn の補題は選択公理自身に比べると相当に非自明な命題なので, 
Zorn の補題を使う場合には陽に断って使う習慣になっている.

無限個の元を適切にどんどん選んで欲しい対象を構成できそうなときに
実際そうできることを示すために Zorn の補題は使われる.

たとえば, 体 $K$ 上の有限次元ではないベクトル空間 $V$ の
基底は $V$ の一次独立なベクトルの集合にそれが基底になるまで
無限に新たなベクトルを付け加えることによって構成される. 
この基底の構成は Zorn の補題を用いて正当化される.

Zorn の補題について説明しよう.  空でない順序集合 $X$ が{\bf 帰納的順序集合 
(inductively ordered set)} であるとは, $X$ の任意の全順序部分集合が
上に有界であることである.  

\begin{lemma}[Zorn の補題]
\label{lemma:Zorn}
  任意の帰納的順序集合は極大元を持つ. \qed
\end{lemma}

\begin{question}
  Zorn の補題を認めて使い, 体 $K$ 上の任意のベクトル空間 $V$ が基底%
  \footnote{$V$ の部分集合 $B$ が $V$ の基底であるとは $V$ の任意の元が $B$ の
    元の有限一次結合で一意的に表わされることである.  
    この条件は $V$ の任意の元が $B$ の元の有限一次結合で表わされてかつ $B$ が
    一次独立であるという条件と同値である.
    $V$ の部分集合 $A$ が一次独立であるとは $A$ の任意の有限部分集合が
    一次独立であることである.}
  を持つことを証明せよ.  \qed
\end{question}

\noindent
ヒント: $V=0$ ならば何も証明すべきことはないので $V\ne 0$ と仮定する.
$V$ の空でない一次独立な部分集合全体の集合を $\cX$ と書くことにする.
$\cX$ は包含関係 $\subset$ に関して順序集合をなす.

$\cX$ が帰納的であることを示そう.
$\cA$ は $\cX$ の全順序部分集合であるとし, $B:=\bigcup_{A\in\cA}A$ と置く.
$B$ の任意の有限部分集合 $\{v_1,\dots,v_n\}$ に対して, $A_1,\dots,A_n\in\cA$ 
で $v_i\in A_i$ ($i=1,\dots,n$) となるものが取れる.
$\cA$ は包含関係に関して全順序なので $A_1,\dots,A_n$ の中に最大のものが
存在する.  それを $A$ とすれば $\{v_1,\dots,v_n\}\subset A\in\cX$ である.
よって $\{v_1,\dots,v_n\}$ は一次独立である.
これで $B\in\cX$ であることがわかった. 
任意の $A\in\cA$ に対して $A\subset B$ なので, $B$ は $\cA$ の上界である.
これで $\cX$ が帰納的であることがわかった.

Zorn の補題より $\cX$ には極大元 $B$ が存在する.
$\cX$ の定義より $B$ は一次独立なので, 任意の $v\in V$ が $B$ の元の有限一次
結合で表わされることが示されれば, $B$ が $V$ の基底であることがわかる.
$v\in V$ が $B$ の元の有限一次結合で表わされないと仮定する.
任意の $v_1,\dots,v_n\in B$ と任意の $a,a_1,\dots,a_n\in K$ に
対して $av+a_1v_1+\cdots+a_nv_n=0$ ならば $a=a_1=\cdots=a_n=0$ である
ことがすぐにわかる.  実際, $a\ne 0$ ならば $v$ が $v_1,\dots,v_n$ の
一次結合で表わされるので矛盾し, $a=0$ ならば $B$ の一次独立性
より $a_1=\cdots=a_n=0$ となる.
よって $B\cup\{v\}$ は一次独立となり, $\cX$ の元になる.
これは $B$ の極大性に矛盾する.
したがって $B$ は $V$ の基底である.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{数学的帰納法}
\label{sec:math-induction}

自然数全体の集合を $\N=\{0,1,2,3,\ldots\}$ と書くことにする.
ここでは自然数に $0$ を含めているが, 自然数に $0$ を含めなくても
以下の説明は $0$ を $1$ とする修正などによってまったく同様に成立する.

自然数 $n$ に関する条件 $P(n)$ に関する数学的帰納法とは
\begin{itemize}
\item[(a)] $P(0)$ が成立する,
\item[(b)] $n\in\N$ のとき, $P(n)$ が成立すれば $P(n+1)$ も成立する
\end{itemize}
という2つの条件が成立するならば
\begin{itemize}
\item[(c)] すべての $n\in\N$ に対して $P(n)$ が成立する
\end{itemize}
ということである. これが成立することは直観的には明らかである.
なぜならば(a)かつ(b)が成立するとき, 
まず(a)によって $P(0)$ が成立し,
(b)によって $P(0+1)=P(1)$ が成立し, 
さらに(b)によって $P(1+1)=P(2)$ が成立し,
さらにさらに(b)によって $P(2+1)=P(3)$ が成立し,
以下同様に繰り返すことによってすべての自然数 $n=0,1,2,3,4,\ldots$ に
対して $P(n)$ が成立することになるからである.

数学的帰納法で「すべての $n\in\N$ に対して $P(n)$ が成立する」ことを証明する
ためには(a)と(b)を証明すればよい.

しかし, 実際には数学的帰納法は様々な形に変形されて用いられる.
よく使われるのは以下で説明するような変形である.

条件 $Q(n)$ を「$n$ 以下のすべての自然数 $k$ に対して $P(k)$ が成立すること」
と定め, $Q(n)$ に数学的帰納法を適用すれば,
\begin{itemize}
\item[(a)] $P(0)$ が成立する,
\item[(b)] $n\in\N$ のとき, $n$ 以下のすべての自然数 $k$ に対して $P(k)$ が
  成立するならば $P(n+1)$ も成立する
\end{itemize}
という2つの条件が成立するならば
\begin{itemize}
\item[(c)] すべての $n\in\N$ に対して $P(n)$ が成立する
\end{itemize}
ということがわかる.  これが成立することも直観的に明らかである.
なぜならば(a)かつ(b)が成立するとき, 
まず(a)によって $P(0)$ が成立し,
(b)によって $P(0)$ かつ $P(1)$ が成立し, 
さらに(b)によって $P(0)$ かつ $P(1)$ かつ $P(2)$ が成立し,
さらにさらに(b)によって $P(0)$ かつ $P(1)$ かつ $P(2)$ かつ $P(3)$ が成立し,
以下同様に繰り返すことによってすべての自然数 $n=0,1,2,3,4,\ldots$ に
対して $P(n)$ が成立することになるからである.

細かい修正だが, (b)の $n$ を $n-1$ で置き換えたバージョンもよく使われる.
すなわち, 
\begin{itemize}
\item[(a)] $P(0)$ が成立する,
\item[(b)] $n\in\N$ かつ $n>0$ のとき,  $n-1$ 以下のすべての自然数 $k$ に
  対して $P(k)$ が成立するならば $P(n)$ も成立する
\end{itemize}
という2つの条件が成立するならば
\begin{itemize}
\item[(c)] すべての $n\in\N$ に対して $P(n)$ が成立する.
\end{itemize}
これが成立することも直観的に明らかである.

出発点の(a)で, $P(0)$ だけを示すのではなく, 
ある $m\in\N$ に関して $P(0),P(1),\dots,P(m)$ を示しておいても良い. 
すなわち, 
\begin{itemize}
\item[(a)] $P(0),P(1),\ldots,P(m)$ が成立する,
\item[(b)] $n\in\N$, $n>m$ のとき, 
  $P(0),P(1),\ldots,P(n-1)$ が成立するならば $P(n)$ も成立する
\end{itemize}
という2つの条件が成立するならば
\begin{itemize}
\item[(c)] すべての $n\in\N$ に対して $P(n)$ が成立する.
\end{itemize}
これが成立することも直観的に明らかであろう.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{簡単に計算できる \protect{$A+B$} の指数函数の例}
\label{sec:exp(A+B)}

問題 \qref{q:exp(A+B)} の結果によれば複素正方行列 $A$ と $B$ が
可換であれば $e^{A+B}=e^A e^B$ が成立する.  
この節ではその結果を少しだけ一般化する.

この節では $A$ と $B$ は互いに可換とは限らない変数である
とし, $e^{A+B}$ などを形式的に計算することにする%
\footnote{指数函数を定義する無限和は何らかの意味で収束しているとし, 
  形式的な計算がすべて自由に許されると仮定する.}.

\begin{question}
  $A$, $B$ の{\bf 交換子 (commutator)} $[A,B]$ 
  と $A$ の $B$ への{\bf 随伴作用 (adjoint action)} $\ad(A)B$ を
  次のように定める:
  \begin{equation*}
    \ad(A)B = [A,B] = AB - BA.
  \end{equation*}
  $\ad(A)$ は $B$ に作用する作用素 (線形変換) である. このとき, 
  \begin{equation*}
    e^{\ad(A)}B = e^A B e^{-A}. \qed
  \end{equation*}
\end{question}

\noindent 
ヒント: $B$ に作用する作用素 $l(A)$, $r(A)$ を次のように定める:
\begin{equation*}
  l(A)B = AB, \quad r(A)B = BA.
\end{equation*}
このとき $l(A)r(A) = r(A)l(A)$ であるから, 
\begin{equation*}
  e^{\ad(A)}B
  = e^{l(A)+r(-A)}B
  = e^{l(A)}e^{r(-A)}B
  = e^{l(A)}(Be^{-A})
  = e^A B e^{-A}.
  \qed
\end{equation*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $[A,B] = C$, $[A,C]=[B,C]=0$ ならば
  \begin{equation*}
    e^A e^B = e^C e^B e^A.
    \qed
  \end{equation*}
\end{question}

\noindent 
ヒント: $\ad(A)B=C$, $\ad(A)^2B=\ad(A)C=0$, $\ldots$ なので,
\begin{equation*}
  e^A B e^{-A}
  = e^{\ad(A)}B
  = \left(1 + \ad(A) + \frac{1}{2}\ad(A)^2 + \cdots \right) B
  = B + \ad(A)B = B + C.
\end{equation*}
$BC = CB$ なので,
\begin{equation*}
  e^A e^B e^{-A} = e^{e^A B e^{-A}} = e^{B+C} = e^C e^B.
\end{equation*}
したがって, $e^Ae^B = e^Ce^Be^A$. \qed

\medskip

\noindent 
注意: 例えば $A=d/dx$, $B=(\text{$x$ を乗じる作用素})$ と
置くと $[A,B]=1$ なので上の問題の仮定が成立する.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{question}
  $[A,B]=C$, $[A,C]=[B,C]=0$ ならば
  \begin{equation*}
    e^{A+B} = e^{-C/2} e^A e^B.
    \qed
  \end{equation*}
\end{question}

\noindent
ヒント: 函数 $F(t)$ と $G(t)$ を
\begin{equation*}
  F(t) = e^{(A+B)t}, \qquad G(t) = e^{\alpha Ct^2} e^{At} e^{Bt}
\end{equation*}
と定める. $\alpha=-1/2$ のとき $F(t)=G(t)$ となることを示せば良い.
$F(t)$, $G(t)$ は以下を満たしている:
\begin{alignat*}{2}
  & F'(t) = (A+B) F(t), \qquad & F(0) = E, \\
  & G'(t) = (2\alpha Ct + A + B + Ct)G(t), \qquad & G(0) = E.
\end{alignat*}
ここで, $e^{At}Be^{-At}=e^{\ad(At)}B=B+Ct$ を用いた. よって,
$\alpha=-1/2$ ならば $F(t)$ と $G(t)$ は同一の初期値問題を満たしている.
よって, そのとき常微分方程式の解の一意性より $F(t)=G(t)$ となることがわかる.
\qed 

\medskip
\noindent
参考: 上の問題の結果は, $[A,[A,B]]=[B,[A,B]]=0$ のとき
\begin{equation*}
  e^A e^B = \exp\left(A+B+\frac{1}{2}[A,B]\right)
\end{equation*}
が成立すると言い直すことができる.  この公式は $A$, $B$ に何も条件を付けない
場合の {\bf Baker-Campbell-Hausdorff の公式}に一般化される:
\begin{equation*}
  e^A e^B 
  = \exp\left(A+B+\frac{1}{2}[A,B]+\frac{1}{12}[A-B,[A,B]]+\cdots\right).
\end{equation*}
右辺の $\cdots$ の部分はすべて $A$, $B$ の交換子で表わされる.
より詳しくは小林・大島 \cite{KO} 213-216頁などを見よ.
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{thebibliography}{ABCD}

\bibitem[U]{umemura}
梅村浩, 楕円関数論---楕円曲線の解析学, 東京大学出版会, 2000

\bibitem[KI]{kan-iri}
韓太舜, 伊理正夫, ジョルダン標準形, UP応用数学選書 8, 東京大学出版会, 1982

\bibitem[C]{cassels}
キャッセルズ,~J.~W., 楕円曲線入門, 徳永浩雄訳, 岩波書店, 1996

\bibitem[KO]{KO}
小林俊行, 大島利雄, Lie 群と Lie 環 1, 岩波講座現代数学の基礎 12,
岩波書店, 1999

\bibitem[St]{satake}
佐武一郎, 線型代数学, 数学選書 1, 裳華房, 1974

\bibitem[Sh]{shafarevich}
シャファレヴィッチ,~I.~R., 代数学とは何か, 蟹江幸博訳, シュプリンガー・フェ
アラーク東京, 2001

\bibitem[ST]{ST}
シルヴァーマン,~J.~H., テイト,~J., 楕円曲線論入門, 
足立恒雄, 木田雅成, 小松啓一, 田谷久雄訳, 
シュプリンガー・フェアラーク東京, 1995

\bibitem[Sg]{sugiura}
杉浦光夫, Jordan標準形と単因子論 I, II, 岩波講座基礎数学, 線型代数 iii, 1976

\bibitem[Tkg1]{takagi1}
高木貞治, 代数学講義, 改定新版, 共立出版, 1965

\bibitem[Tkg2]{takagi2}
高木貞治, 初等整数論講義, 第2版, 共立出版, 1971

\bibitem[Tkc]{takeuchi}
竹内端三, 楕圓凾數論, 岩波全書, 岩波書店, 1936

\bibitem[Ts]{tasaka}
田坂隆士, 2次形式 I, II, 岩波講座基礎数学, 線型代数 iii, 1976

\bibitem[Tn]{tanisaki}
谷崎俊之, リー代数と量子群, 現代数学の潮流, 共立出版, 2002

\bibitem[Hs]{hasegawa-rensai}
長谷川浩司, 線型代数, 『数学セミナー』における連載, 
2001年4月号から2002年10月号まで

\bibitem[Ht]{hattori}
服部昭, 現代代数学, 近代数学講座 1, 朝倉書店, 1968

\bibitem[Kh]{khinchin}
ヒンチン,~A.~Y., 数論の3つの真珠, 蟹江幸博訳, はじめよう数学4, 日本評論社, 
2000

\bibitem[T]{terakan}
寺沢寛一, 自然科学者のための数学概論, 増訂版, 岩波書店, 1954, 1983, 1986

\bibitem[N]{nakamura}
中村佳正編, 可積分系の応用数理, 裳華房, 2000

\bibitem[H1]{gun-kagun}
堀田良之, 代数入門――群と加群――, 数学シリーズ, 裳華房, 1987

\bibitem[H2]{10wa}
堀田良之, 加群十話――加群入門――, すうがくぶっくす 3, 朝倉書店, 1988

\bibitem[YmS]{renzokugunron}
山内恭彦, 杉浦光夫, 連続群論入門, 新数学シリーズ 18, 培風館, 1960

\bibitem[Ykt]{gun-iso}
横田一郎, 群と位相, 基礎数学選書, 裳華房, 1971

\bibitem[Ykn]{yokonuma}
横沼健雄, テンソル代数と外積代数, 岩波講座基礎数学, 線型代数 iv, 1976

\bibitem[R]{reid}
リード,~M., 可換環論入門, 伊藤由佳理訳, 岩波書店, 2000

\bibitem[W]{wakimoto}
脇本実, 無限次元 Lie 環, 岩波講座現代数学の展開 3, 岩波書店, 1999

\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
